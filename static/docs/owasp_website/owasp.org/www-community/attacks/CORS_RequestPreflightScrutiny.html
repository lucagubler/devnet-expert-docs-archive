<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from owasp.org/www-community/attacks/CORS_RequestPreflightScrutiny by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Dec 2024 21:20:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">







<meta name="description" content="CORS RequestPreflightScrutiny on the main website for The OWASP Foundation. OWASP is a nonprofit foundation that works to improve the security of software.">
<meta property="og:description" content="CORS RequestPreflightScrutiny on the main website for The OWASP Foundation. OWASP is a nonprofit foundation that works to improve the security of software.">
<meta propery="og:title" content="CORS RequestPreflightScrutiny | OWASP Foundation">
<meta property="og:url" content="CORS_RequestPreflightScrutiny.html">
<meta property="og:locale" content="en_US">

<!-- should probably look at using article at some point for www-community at least -->
<meta property="og:type" content="website" />
<meta property="og:image" content="https://owasp.org/www--site-theme/favicon.ico" />
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">


<link rel="canonical" href="CORS_RequestPreflightScrutiny.html" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4531126-1"></script> -->
<!-- <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-4531126-1');
</script> -->
<!-- Google Analytics -->


<script src="https://owasp.org/www--site-theme/assets/js/js.cookie.min.js"></script>
<script>
  if(Cookies.get('cookies-ok') == 'true' && window.ga === undefined)
  {
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-4531126-1', 'auto');
    ga('send', 'pageview');
  }
  else if (Cookies.get('cookies-ok') == 'true')
  {
    ga('send', 'pageview');
  }

  function handleOutboundLinkClicks(event) {
    var href = '';
    if(event.target.href == undefined)
      href = event.target.parentElement.href;
    else
      href = event.target.href
  if(Cookies.get('cookies-ok') == 'true'){  
    
    ga('send', 'event', {
      eventCategory: 'Outbound Link',
      eventAction: 'click',
      eventLabel: href,
      transport: 'beacon'
    });
  }
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->
<link rel="stylesheet" href="https://owasp.org/www--site-theme/assets/css/styles.css">
<link rel="shortcut icon" type="images/x-icon" href="https://owasp.org/www--site-theme/favicon.ico">

<script src="https://owasp.org/www--site-theme/assets/js/jquery-3.7.1.min.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/util.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/yaml.min.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/kjua.min.js"></script>
<title>CORS RequestPreflightScrutiny | OWASP Foundation</title>

    <script type="text/javascript">
      $(function(){
        var baseurl = "https://github.com/OWASP/www-community/blob/master/";
        var path = "pages/attacks/CORS_RequestPreflightScrutiny.md";
        $('.repo').html('<a href=' + baseurl + path + '><div class="reset-3c756112--menuItemIcon-206eb252" style="float: left;"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 438.549 438.549" stroke="none" class="icon-7f6730be--text-3f89f380"><g><path d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 0 1-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"></path></g></svg><span style="padding-left:8px;">Edit on GitHub</span></div></a>');
      });
    </script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
  </head>
  <body class="base-grid col-sidebar">

    <div id="blocker"></div>

    <noscript>For full functionality of this site it is necessary to enable JavaScript. Here are the <a href="http://turnonjs.com/"> instructions how to enable JavaScript in your web browser</a>.</noscript>
    <header role="banner">
  <div id="banner" class="notice" aria-label="announcement">
</div>




<style>
  #banner img {
    max-width: 30em;
  }

  @media (max-width: 1131px) {
    #banner img {
      max-width: 30em;
    }
  }

  @media (max-width: 800px) {
    #banner img {
      max-width: 20em;
    }
  }

  @media (max-width: 600px) {
    #banner img {
      max-width: 20em;
    }
  }

  @media (max-width: 450px) {
    #banner img {
      max-width: 250px;
    }
  }
</style>

<script type="text/javascript">
  $(function () {
    var bannerdata = [];
    banneryaml = YAML.load('https://owasp.org/www-community/assets/sitedata/banner-data.yml');
    $.each(banneryaml, function (index) {
      bannerdata.push(this);
    });

    if (bannerdata.length > 0) {
      var htmlstring = "";
      var usebanner = null;
      var defbanner = null;
      var checkdate = new Date(); //local time but who cares about the time?
      bannerdata.forEach(data => {
        if (data.start) {
          var start = data.start;

          if (data.start <= checkdate) {
            if (data.end) {

              var end = data.end;
              if (checkdate < end) {
                usebanner = data;
              }
            }
            else
              usebanner = data;
          }
        }
        else {
          defbanner = data;
        }
      });

      if (defbanner && !usebanner)
        usebanner = defbanner;
      if (usebanner) {
        htmlstring = usebanner.text;
        htmlstring += "<a href='#' id='close-banner' aria-label='close announcement' style='float:right;'><i class='fa fa-times'></i></a>";

        $("#banner").html(htmlstring);
        $("#banner").removeClass("notice");
        $("#banner").addClass(usebanner.type);

        $("#close-banner").click(function() {
          $(this).closest("#banner").remove();
            Cookies.set('banner-seen', 'true', { expires: 7 });
        });
      }
    }
  });
</script>
  <div id="popup" class="notice" aria-label="announcement">
   
</div>




<style>
  #banner img {
    max-width: 30em;
  }

  @media (max-width: 1131px) {
    #banner img {
      max-width: 30em;
    }
  }

  @media (max-width: 800px) {
    #banner img {
      max-width: 20em;
    }
    #popup {
      visibility: hidden;
    }
  }

  @media (max-width: 600px) {
    #popup {
      visibility: hidden;
    }
    #banner img {
      max-width: 20em;
    }
  }

  @media (max-width: 450px) {
    #banner img {
      max-width: 250px;
    }
    #popup {
      visibility: hidden;
    }
  }
</style>

<script type="text/javascript">
  $(function () {
    var popdata = [];
    $("#popup").hide();
    popyaml = YAML.load('https://owasp.org/www-community/assets/sitedata/popup-data.yml');
    $.each(popyaml, function (index) {
      popdata.push(this);
    });

    if (popdata.length > 0) {
      var htmlstring = "";
      var usepop = null;
      var defpop = null;
      var checkdate = new Date(); //local time but who cares about the time?
      popdata.forEach(data => {
        if (data.start) {
          var start = data.start;

          if (data.start <= checkdate) {
            if (data.end) {

              var end = data.end;
              if (checkdate < end) {
                usepop = data;
              }
            }
            else
              usepop = data;
          }
        }
        else {
          defpop = data;
        }
      });

      if (defpop && !usepop)
        usepop = defpop;
      if (usepop) {
        htmlstring = usepop.text;
        htmlstring += "<a href='#' id='close-popup' aria-label='close announcement' style='float:right;'><i class='fa fa-times'></i></a>";

        $("#popup").html(htmlstring);
        $("#popup").removeClass("notice");
        $("#popup").addClass(usepop.type);
        
        if( Cookies.get('popup-seen')!='true')
        {
          $("#popup").show();
        }

        $("#close-popup").click(function() {
          $(this).closest("#popup").remove();
            Cookies.set('popup-seen', 'true', { expires: 7 });
        });
      }
    }
  });
</script>
  <div class="header-wrapper" aria-label="main navigation">
    <nav class="alt-nav">
      <a href="#" class="menu-toggler" aria-hidden="true">
        <i class="fa fa-bars"></i>
      </a>
      <a href="https://owasp.org/" class="alt-logo" aria-label="go to homepage">
          <img src="https://owasp.org/assets/images/logo.png" alt="OWASP logo">
      </a>
      <div id="overlay" class="remove-el">

      </div>
      <!-- jekyll menu stuff -->
    </nav>
    
    <nav class="top-nav" role="navigation" aria-label="primary navigation">
      <a href="https://owasp.org/" class="desktop-logo" aria-label="go to homepage">
        <img src="https://owasp.org/assets/images/logo.png" alt="">
      </a>
      <!-- jekyll menu stuff -->
      <div id="midmenu" class="top-nav"></div>
      
      

      <div class="interactive-wrapper">                
        <div class="nav-button" aria-label="donate to or join OWASP">
        
          <a href="https://owasp.org/store" class="cta-button white inset"><i class="fa fa-shopping-cart" aria-hidden="true"></i> Store</a>
          <a href="https://owasp.org/donate?reponame=www-community" class="cta-button green">Donate</a>
          <a href="https://owasp.org/membership" class="cta-button">Join</a>
        </div>
      </div>
    </nav>
    <div id='disclaimer-container'>
<div id="disclaimer">
    <p>This website uses cookies to analyze our traffic and only share that information with our analytics partners.</p><a class="disclaimerOK">Accept</a>
</div>
<div id="close-disclaimer">x</div>
</div>
  </div>
  <div class="mobile" style="width:100%;display: flex; justify-content: space-evenly;align-items: center;padding: 8px; background-color: #98afc7;">
    <div><a href="https://owasp.org/store" class="cta-button white inset"><i class="fa fa-shopping-cart" aria-hidden="true"></i>Store</a></div>
    <div><a href="https://owasp.org/donate?reponame=www-community" class="cta-button green">Donate</a></div>
    <div><a href="https://owasp.org/membership" class="cta-button">Join</a></div>
  </div>



<script type="text/javascript">
  $(function(){
      
      url = $(location).attr('href');
      if(url.includes('www2'))
      {
        url = url.replace(/www2./, '');
        $(location).attr('href',url);
        return;
      }
    // this works to get data from a json file NOT in data
      $.getJSON("https://owasp.org/www--site-theme/assets/sitedata/menus.json", function(data) {
         var listr = "<ul aria-label='header menu'>";
         
         var mlistr = "<ul class='mobile-menu hide-el' role='navigation' aria-label='mobile primary navigation'>";

          mlistr += "<li><a href='#' class='menu-toggler' aria-hidden='true'><i class='fa fa-times'></i></a></li>";
          mlistr += "<li>";
          mlistr += "<form role='search' method='get' action='https://owasp.org/search'>";   
          mlistr += "<div class='search-div'>";
          mlistr += "<input id='searchString' aria-label='search input' name='searchString' class='search-bar' type='search' placeholder='Search OWASP.org' required='true'>";
          mlistr += "<button id='search-button' aria-label='search button' type='submit' class='fa fa-search' style='padding-left: 8px;'></button></div></form>";
          mlistr += "</li>";
          $.each(data.menus, function (ndx, menu){
              listr += "<li><a href='" + menu.url + "'>" + menu.title + "</a>";
              searchitem = issearch(menu.title);
              if(!menu.items && !searchitem)
              {
                  mlistr += "<li><a href='" + menu.url + "'>" + menu.title + "</a>";
              }
              
              if(menu.items){
                  listr += "<ul class='dropdown-menu'>";
                  if(!searchitem) {
                    mlistr += "<button class='accordion'>" + menu.title + "</button>";
                    mlistr += "<div class='panel'>";
                    mlistr += "<ul>";
                  }
                $.each(menu.items, function(ndx, item){
                
                  if(item.separator)
                  {
                      listr += "<li class='separator'>";
                      if(!searchitem)
                        mlistr += "<li class='separator'>";
                  }
                  else
                  {
                      listr += "<li>";
                      if(!searchitem)
                        mlistr += "<li>";
                  }
                  listr += "<a href='" + item.url + "'";
                  if(!searchitem)
                    mlistr += "<a href='" + item.url + "'";
                  if(item.opentab)
                  {
                    listr += " target='_blank' rel='noopener noreferrer'";
                    if(!searchitem)
                      mlistr += " target='_blank' rel='noopener noreferrer'";
                  }

                  listr += ">" + item.title + "</a></li>";
                  if(!searchitem)
                    mlistr += ">" + item.title + "</a></li>";
                });
                listr += "</ul>";
                if(!searchitem){
                  mlistr += "</ul>";
                  mlistr += "</div>";
                }
              }
              
              listr += "</li>";
              if(!searchitem)
                mlistr += "</li>";
          });
          listr += "</ul>";
          mlistr += "<li><a href='https://owasp.org/donate'>MAKE A DONATION</a></li>";
          mlistr += "<li><a href='https://owasp.org/membership'>BECOME A MEMBER</a></li>";
          mlistr += "<li><a href='https://owasp.org/sitemap'>SITEMAP</a></li>";
          mlistr += "</ul>";
          
          //$('.desktop-logo').after(listr);
          $('#midmenu').html(listr);
          $('#overlay').after(mlistr);

          $(".accordion").click(function () {
              $(this).toggleClass("active");
              if($(this).next('.panel').css('display') == 'block'){
                $(this).next('.panel').css('display', 'none');
              }
              else {
                $(this).next('.panel').css('display', 'block');
              }
            });
            $(".menu-toggler").click(function() {
              $(".mobile-menu").toggleClass('hide-el');
            });
      });
    });

    function issearch(title) {
      return title.indexOf('fa fa-search') > -1;
    }
  </script>
</header>


    <main role="main">
      <div class="main-wrapper">
        
  
  
  
  
  
  
  





        <h1 class="page-title">CORS RequestPreflightScrutiny</h1>
        <div id="main" class="page-body tab" role="tabpanel" aria-labelledby="main-link" tabindex="0">
          
          <section id='sec-main' class='page-body'>
          <div style="font-size: 75%">

  <b>Author:</b> Dominique RIGHETTO <br />


  <b>Contributor(s):</b> Imifos, kingthorin <br />

</div>

<p>Last revision (mm/dd/yyyy): <strong>10/12/2012</strong></p>

<h2 id="introduction">Introduction</h2>

<p><strong>CORS</strong> stands for <strong>C</strong>ross-<strong>O</strong>rigin <strong>R</strong>esource <strong>S</strong>haring.</p>

<p>Is an feature offering the possbility to:</p>

<ul>
  <li>A web application to expose resources to all or restricted domain,</li>
  <li>A web client to made AJAX request for resource on other domain than is source domain.</li>
</ul>

<p>This article will focus on HTTP <strong>Request Preflight</strong> feature proposed
by CORS W3C specification and (mainly) how to setup a protection, on web
application side, against CORS HTTP request that try to bypass the
preflight process.</p>

<h2 id="request-preflight-process-overview">Request preflight process overview</h2>

<p>In order to not duplicate explanation, and because Mozilla wiki have a
great introduction article about CORS, you can read a description of the
process using link below:</p>

<ul>
  <li><a href="https://developer.mozilla.org/en-US/docs/HTTP_access_control#Preflighted_requests">Source</a></li>
  <li><a href="https://webcache.googleusercontent.com/search?q=cache:f1R5zF__S20J:https://developer.mozilla.org/en-US/docs/HTTP_access_contro+cors%2Bmozilla&amp;cd=1&amp;hl=en&amp;ct=clnk&amp;gl=fr">Google cache</a></li>
</ul>

<h2 id="risk">Risk</h2>

<p>Request preflight have to objective to ensure that HTTP request will not
have a bad impact on data, this, using a first request in which browser
describe the final HTTP request that will send later.</p>

<p>The main risk here (for web application), is that the request preflight
process is entirely managed on client side (by the browser) and then
anything warrant web application that the request preflight process will
be always followed…</p>

<p>A user can create/send (using tools like Curl, ZAP,…) a
final HTTP request without previously send the first request for
preflight and then bypass request preflight process in order to act on
data in a unsafe way.</p>

<h2 id="countermeasure">Countermeasure</h2>

<p>We must ensure the <strong>Request Preflight process</strong> compliance on server
side.</p>

<p>To achieve it we will use JEE Web Filter that will check every CORS
request using theses steps:</p>

<ul>
  <li>Step 1 : Determine the type of the incoming request,</li>
  <li>Step 2 : Process request according to is type using temporary cache
  to keep state of preflighting step of the process.</li>
</ul>

<p><strong>Sample implementation: Filter class</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.Filter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.FilterChain</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.FilterConfig</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.ServletException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.ServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.ServletResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.annotation.WebFilter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">net.sf.ehcache.Cache</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.sf.ehcache.CacheManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.sf.ehcache.Element</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.sf.ehcache.config.CacheConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.sf.ehcache.config.PersistenceConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">net.sf.ehcache.store.MemoryStoreEvictionPolicy</span><span class="o">;</span>

<span class="cm">/**
 * Sample filter implementation to scrutiny that CORS "Request Preflight" process is followed by HTTP request concerned.&lt;br/&gt;
 *
 * This implementation has a dependency on EHCache API because it use Caching to store preflighted requests.
 *
 * Assume here that all CORS resources are grouped in context path "/cors/".
 *
 * @see "https://developer.mozilla.org/en-US/docs/HTTP_access_control#Simple_requests"
 */</span>
<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"static-method"</span><span class="o">)</span>
<span class="nd">@WebFilter</span><span class="o">(</span><span class="s">"/cors/*"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CORSRequestPreflightProcessScrutiny</span> <span class="kd">implements</span> <span class="nc">Filter</span> <span class="o">{</span>

    <span class="c1">// Filter configuration</span>
    <span class="kd">private</span> <span class="nc">FilterConfig</span> <span class="n">filterConfig</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="c1">// Period during which we keep a request as correctly followed the request preflight process</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">requestPreflightCacheDelayInSeconds</span> <span class="o">=</span> <span class="mi">60</span><span class="o">;</span>

    <span class="c1">// Cache used to cache preflighted requests</span>
    <span class="kd">private</span> <span class="nc">Cache</span> <span class="n">requestPreflightCache</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="cm">/**
     * {@inheritDoc}
     *
     * @see Filter#init(FilterConfig)
     */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">FilterConfig</span> <span class="n">fConfig</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span> <span class="o">{</span>
        <span class="c1">// Get filter configuration</span>
        <span class="k">this</span><span class="o">.</span><span class="na">filterConfig</span> <span class="o">=</span> <span class="n">fConfig</span><span class="o">;</span>
        <span class="c1">// Initialize preflighted requests dedicated cache with a cache of X minutes expiration delay for each item</span>
        <span class="nc">PersistenceConfiguration</span> <span class="n">cachePersistence</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PersistenceConfiguration</span><span class="o">();</span>
        <span class="n">cachePersistence</span><span class="o">.</span><span class="na">strategy</span><span class="o">(</span><span class="nc">PersistenceConfiguration</span><span class="o">.</span><span class="na">Strategy</span><span class="o">.</span><span class="na">NONE</span><span class="o">);</span>
        <span class="nc">CacheConfiguration</span> <span class="n">cacheConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheConfiguration</span><span class="o">().</span><span class="na">memoryStoreEvictionPolicy</span><span class="o">(</span><span class="nc">MemoryStoreEvictionPolicy</span><span class="o">.</span><span class="na">FIFO</span><span class="o">).</span><span class="na">eternal</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
                <span class="o">.</span><span class="na">timeToLiveSeconds</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCacheDelayInSeconds</span><span class="o">)</span>
                <span class="o">.</span><span class="na">statistics</span><span class="o">(</span><span class="kc">false</span><span class="o">).</span><span class="na">diskExpiryThreadIntervalSeconds</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCacheDelayInSeconds</span> <span class="o">/</span> <span class="mi">2</span><span class="o">)</span>
                <span class="o">.</span><span class="na">persistence</span><span class="o">(</span><span class="n">cachePersistence</span><span class="o">).</span><span class="na">maxEntriesLocalHeap</span><span class="o">(</span><span class="mi">10000</span><span class="o">).</span><span class="na">logging</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="n">cacheConfig</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"PreflightedRequestsCacheConfig"</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCache</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cache</span><span class="o">(</span><span class="n">cacheConfig</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCache</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"PreflightedRequestsCache"</span><span class="o">);</span>
        <span class="nc">CacheManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">addCache</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCache</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * {@inheritDoc}
     *
     * @see Filter#destroy()
     */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Remove Cache</span>
        <span class="nc">CacheManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">removeCache</span><span class="o">(</span><span class="s">"PreflightedRequestsCache"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * {@inheritDoc}
     *
     * @see Filter#doFilter(ServletRequest, ServletResponse, FilterChain)
     */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doFilter</span><span class="o">(</span><span class="nc">ServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">ServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">FilterChain</span> <span class="n">chain</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">,</span> <span class="nc">ServletException</span> <span class="o">{</span>
        <span class="nc">HttpServletRequest</span> <span class="n">htReq</span> <span class="o">=</span> <span class="o">((</span><span class="nc">HttpServletRequest</span><span class="o">)</span> <span class="n">request</span><span class="o">);</span>
        <span class="nc">HttpServletResponse</span> <span class="n">htResp</span> <span class="o">=</span> <span class="o">((</span><span class="nc">HttpServletResponse</span><span class="o">)</span> <span class="n">response</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">accessDeniedHttpResponse</span> <span class="o">=</span> <span class="nc">HttpServletResponse</span><span class="o">.</span><span class="na">SC_FORBIDDEN</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">accessControlAllowMethods</span> <span class="o">=</span> <span class="s">"GET, POST"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">accessControlAllowOrigin</span> <span class="o">=</span> <span class="s">"http://foo.example"</span><span class="o">;</span>

        <span class="cm">/* Step 01 : Determine the type of the incoming request */</span>
        <span class="nc">CORSRequestPreflightType</span> <span class="n">corsReqType</span> <span class="o">=</span> <span class="n">determineRequestType</span><span class="o">(</span><span class="n">htReq</span><span class="o">);</span>

        <span class="cm">/* Step 02 : Process request according to is type */</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">corsReqType</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// --HTTP request send by client to preflight a further 'Complex' request</span>
        <span class="k">case</span> <span class="nl">REQUEST_FOR_PREFLIGHT:</span> <span class="o">{</span>
            <span class="nc">CORSRequestPreflightData</span> <span class="n">corsReq</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CORSRequestPreflightData</span><span class="o">(</span><span class="n">htReq</span><span class="o">);</span>
            <span class="c1">// ----Step 2a: Check that request for preflight is valid, if not, send an access denied (do not give infos about bad resquest root cause)</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">corsReq</span><span class="o">.</span><span class="na">getOrigin</span><span class="o">().</span><span class="na">trim</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">||</span> <span class="n">corsReq</span><span class="o">.</span><span class="na">getExpectedMethod</span><span class="o">().</span><span class="na">trim</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">traceInvalidRequestDetected</span><span class="o">(</span><span class="n">htReq</span><span class="o">);</span>
                <span class="n">htResp</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
                <span class="n">htResp</span><span class="o">.</span><span class="na">sendError</span><span class="o">(</span><span class="n">accessDeniedHttpResponse</span><span class="o">);</span>
                <span class="c1">// Exit Filter : Use 'return' algorithm break in order to avoid multiple IF statement and enhance readability...</span>
                <span class="k">return</span><span class="o">;</span>

            <span class="o">}</span>
            <span class="c1">// ----Step 2b: Store preflight request data in the Cache to keep (mark) the request as correctly followed the request preflight process</span>
            <span class="nc">Element</span> <span class="n">cachedRequest</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Element</span><span class="o">(</span><span class="nc">CORSUtils</span><span class="o">.</span><span class="na">buildRequestCacheIdentifier</span><span class="o">(</span><span class="n">htReq</span><span class="o">),</span> <span class="n">corsReq</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">cachedRequest</span><span class="o">);</span>
            <span class="c1">// ----Step 2c: Return corresponding response - This part should be customized with application specific constraints.....</span>
            <span class="n">htResp</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
            <span class="n">htResp</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="nc">HttpServletResponse</span><span class="o">.</span><span class="na">SC_OK</span><span class="o">);</span>
            <span class="n">htResp</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Origin"</span><span class="o">,</span> <span class="n">accessControlAllowOrigin</span><span class="o">);</span>
            <span class="n">htResp</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Methods"</span><span class="o">,</span> <span class="n">accessControlAllowMethods</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">corsReq</span><span class="o">.</span><span class="na">getExpectedCustomHeaders</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">htResp</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Headers"</span><span class="o">,</span> <span class="n">corsReq</span><span class="o">.</span><span class="na">getExpectedCustomHeaders</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">replaceFirst</span><span class="o">(</span><span class="s">"\\["</span><span class="o">,</span> <span class="s">""</span><span class="o">).</span><span class="na">replaceFirst</span><span class="o">(</span><span class="s">"\\]"</span><span class="o">,</span> <span class="s">""</span><span class="o">).</span><span class="na">trim</span><span class="o">());</span>
            <span class="o">}</span>
            <span class="n">htResp</span><span class="o">.</span><span class="na">setIntHeader</span><span class="o">(</span><span class="s">"Access-Control-Max-Age"</span><span class="o">,</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCacheDelayInSeconds</span><span class="o">));</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">// --Normal HTTP request send by client that require preflight ie 'Complex' resquest in Preflight process</span>
        <span class="k">case</span> <span class="nl">COMPLEX_REQUEST:</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">rid</span> <span class="o">=</span> <span class="nc">CORSUtils</span><span class="o">.</span><span class="na">buildRequestCacheIdentifier</span><span class="o">(</span><span class="n">htReq</span><span class="o">);</span>
            <span class="c1">// ----Step 2a: Check if the current request has an entry into the preflighted requests Cache</span>
            <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rid</span><span class="o">)</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">traceInvalidRequestDetected</span><span class="o">(</span><span class="n">htReq</span><span class="o">);</span>
                <span class="n">htResp</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
                <span class="n">htResp</span><span class="o">.</span><span class="na">sendError</span><span class="o">(</span><span class="n">accessDeniedHttpResponse</span><span class="o">);</span>
                <span class="c1">// Exit Filter : Use 'return' algorithm break in order to avoid multiple IF statement and enhance readability...</span>
                <span class="k">return</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="c1">// ----Step 2b: Check that preflight information declared during the preflight request match the current request on key information</span>
            <span class="nc">CORSRequestPreflightData</span> <span class="n">corsPreflightReq</span> <span class="o">=</span> <span class="o">(</span><span class="nc">CORSRequestPreflightData</span><span class="o">)</span> <span class="k">this</span><span class="o">.</span><span class="na">requestPreflightCache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rid</span><span class="o">).</span><span class="na">getValue</span><span class="o">();</span>
            <span class="nc">String</span> <span class="n">origin</span> <span class="o">=</span> <span class="nc">CORSUtils</span><span class="o">.</span><span class="na">retrieveHeader</span><span class="o">(</span><span class="s">"Origin"</span><span class="o">,</span> <span class="n">htReq</span><span class="o">);</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">customHeaders</span> <span class="o">=</span> <span class="nc">CORSUtils</span><span class="o">.</span><span class="na">retrieveCustomHeaders</span><span class="o">(</span><span class="n">htReq</span><span class="o">);</span>
            <span class="kt">boolean</span> <span class="n">match</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="c1">// ------Start with comparison of "Origin" HTTP header (according to utility method impl. used to retrieve header reference cannot be null)...</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">origin</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">corsPreflightReq</span><span class="o">.</span><span class="na">getOrigin</span><span class="o">()))</span> <span class="o">{</span>
                <span class="c1">// ------Continue with HTTP method...</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">accessControlAllowMethods</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">())</span> <span class="o">&amp;&amp;</span> <span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">corsPreflightReq</span><span class="o">.</span><span class="na">getExpectedMethod</span><span class="o">()))</span> <span class="o">{</span>
                    <span class="c1">// ------Finish with custom HTTP headers (use an method to avoid manual iteration on collection to increase the speed)...</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">customHeaders</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="n">corsPreflightReq</span><span class="o">.</span><span class="na">getExpectedCustomHeaders</span><span class="o">().</span><span class="na">size</span><span class="o">())</span> <span class="o">{</span>
                        <span class="nc">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">customHeaders</span><span class="o">);</span>
                        <span class="nc">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">corsPreflightReq</span><span class="o">.</span><span class="na">getExpectedCustomHeaders</span><span class="o">());</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">customHeaders</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">corsPreflightReq</span><span class="o">.</span><span class="na">getExpectedCustomHeaders</span><span class="o">().</span><span class="na">toString</span><span class="o">()))</span> <span class="o">{</span>
                            <span class="n">match</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">match</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// Continue chain to next filter</span>
                <span class="n">chain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">traceInvalidRequestDetected</span><span class="o">(</span><span class="n">htReq</span><span class="o">);</span>
                <span class="n">htResp</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
                <span class="n">htResp</span><span class="o">.</span><span class="na">sendError</span><span class="o">(</span><span class="n">accessDeniedHttpResponse</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">// --Normal HTTP request send by client that do not require preflight ie 'Simple' resquest in Preflight process</span>
        <span class="k">case</span> <span class="nl">SIMPLE_REQUEST:</span> <span class="o">{</span>
            <span class="c1">// Continue chain to next filter</span>
            <span class="n">chain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">// --Unknown HTTP request type !</span>
        <span class="k">default</span><span class="o">:</span> <span class="o">{</span>
            <span class="n">traceInvalidRequestDetected</span><span class="o">(</span><span class="n">htReq</span><span class="o">);</span>
            <span class="n">htResp</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
            <span class="n">htResp</span><span class="o">.</span><span class="na">sendError</span><span class="o">(</span><span class="n">accessDeniedHttpResponse</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Internal method to determine the type of the incoming request.
     *
     * @param htReq HTTP Request
     * @return the type as enumeration item
     */</span>
    <span class="kd">private</span> <span class="nc">CORSRequestPreflightType</span> <span class="nf">determineRequestType</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">htReq</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">CORSRequestPreflightType</span> <span class="n">type</span> <span class="o">=</span> <span class="nc">CORSRequestPreflightType</span><span class="o">.</span><span class="na">UNKNOWN</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="s">"OPTIONS"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">()))</span> <span class="o">{</span>
            <span class="n">type</span> <span class="o">=</span> <span class="nc">CORSRequestPreflightType</span><span class="o">.</span><span class="na">REQUEST_FOR_PREFLIGHT</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(!</span><span class="nc">CORSUtils</span><span class="o">.</span><span class="na">retrieveCustomHeaders</span><span class="o">(</span><span class="n">htReq</span><span class="o">).</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">type</span> <span class="o">=</span> <span class="nc">CORSRequestPreflightType</span><span class="o">.</span><span class="na">COMPLEX_REQUEST</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="s">"POST"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">())</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="s">"application/x-www-form-urlencoded"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getContentType</span><span class="o">())</span>
                    <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="s">"multipart/form-data"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getContentType</span><span class="o">())</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="s">"text/plain"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getContentType</span><span class="o">()))</span> <span class="o">{</span>
                <span class="n">type</span> <span class="o">=</span> <span class="nc">CORSRequestPreflightType</span><span class="o">.</span><span class="na">COMPLEX_REQUEST</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="s">"HEAD"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">())</span> <span class="o">||</span> <span class="s">"DELETE"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">())</span> <span class="o">||</span> <span class="s">"PUT"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">())</span>
                    <span class="o">||</span> <span class="s">"TRACE"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">())</span> <span class="o">||</span> <span class="s">"CONNECT"</span><span class="o">.</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">()))</span> <span class="o">{</span>
                <span class="n">type</span> <span class="o">=</span> <span class="nc">CORSRequestPreflightType</span><span class="o">.</span><span class="na">COMPLEX_REQUEST</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">type</span> <span class="o">=</span> <span class="nc">CORSRequestPreflightType</span><span class="o">.</span><span class="na">SIMPLE_REQUEST</span><span class="o">;</span>
            <span class="o">}</span>

        <span class="o">}</span>

        <span class="k">return</span> <span class="n">type</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Method to add data of invalid request detected to a trace log
     *
     * @param htReq Invalid request detected
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">traceInvalidRequestDetected</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">htReq</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Customize trace...</span>
        <span class="k">this</span><span class="o">.</span><span class="na">filterConfig</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">log</span><span class="o">(</span><span class="s">"---[CORS Invalid request detected]---"</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">filterConfig</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">log</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Client Address : %s"</span><span class="o">,</span> <span class="n">htReq</span><span class="o">.</span><span class="na">getRemoteAddr</span><span class="o">()));</span>
        <span class="k">this</span><span class="o">.</span><span class="na">filterConfig</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">log</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Target URL     : %s"</span><span class="o">,</span> <span class="n">htReq</span><span class="o">.</span><span class="na">getRequestURL</span><span class="o">()));</span>
        <span class="k">this</span><span class="o">.</span><span class="na">filterConfig</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">log</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"Query String   : %s"</span><span class="o">,</span> <span class="n">htReq</span><span class="o">.</span><span class="na">getQueryString</span><span class="o">()));</span>
        <span class="k">this</span><span class="o">.</span><span class="na">filterConfig</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">log</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"HTTP Method    : %s"</span><span class="o">,</span> <span class="n">htReq</span><span class="o">.</span><span class="na">getMethod</span><span class="o">()));</span>
        <span class="c1">// Print more request useful data.....</span>
        <span class="k">this</span><span class="o">.</span><span class="na">filterConfig</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">log</span><span class="o">(</span><span class="s">"-------------------------------------"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Sample implementation: Utility class used by Filter</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Enumeration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>

<span class="cm">/**
 * Utility class for CORS data retrieving &amp; processing.
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CORSUtils</span> <span class="o">{</span>

    <span class="cm">/**
     * Method to retrieve HTTP request custom headers list.
     *
     * @param httpRequest Source HTTP request
     * @return List of custom headers (converted to uppercase to avoid case issue)
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">retrieveCustomHeaders</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">httpRequest</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">xHeaders</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
        <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">httpRequest</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"HTTP Request cannot be null !"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nc">Enumeration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">httpRequest</span><span class="o">.</span><span class="na">getHeaderNames</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">headers</span><span class="o">.</span><span class="na">hasMoreElements</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="na">nextElement</span><span class="o">().</span><span class="na">toUpperCase</span><span class="o">().</span><span class="na">trim</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">name</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"X-"</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">xHeaders</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">name</span><span class="o">.</span><span class="na">trim</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">xHeaders</span><span class="o">;</span>

    <span class="o">}</span>

    <span class="cm">/**
     * Method to retrieve a HTTP Header value from the source HTTP request. &lt;br/&gt;
     * Manage Header name case issue and take only first value.
     *
     * @param headerName HTTP name
     * @param httpRequest Source HTTP request
     * @return The HTTP Header value or "" if it cannot be found
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">retrieveHeader</span><span class="o">(</span><span class="nc">String</span> <span class="n">headerName</span><span class="o">,</span> <span class="nc">HttpServletRequest</span> <span class="n">httpRequest</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">httpRequest</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"HTTP Request cannot be null !"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">((</span><span class="n">headerName</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">||</span> <span class="n">headerName</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"HTTP header name be null !"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nc">Enumeration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">httpRequest</span><span class="o">.</span><span class="na">getHeaderNames</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">headers</span><span class="o">.</span><span class="na">hasMoreElements</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="na">nextElement</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">name</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">equalsIgnoreCase</span><span class="o">(</span><span class="n">headerName</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">httpRequest</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Method to build an identifier for a request into the preflighted requests cache
     *
     * @param httpRequest Source HTTP request
     * @return The ID as String
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">buildRequestCacheIdentifier</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">httpRequest</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">httpRequest</span><span class="o">.</span><span class="na">getRemoteAddr</span><span class="o">()</span> <span class="o">+</span> <span class="s">"_"</span> <span class="o">+</span> <span class="n">httpRequest</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">()).</span><span class="na">trim</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Sample implementation: Pojo class used to store Preflight request key
information</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>

<span class="cm">/**
 * Class to store information about a CORS preflighted request.
 */</span>
<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"serial"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CORSRequestPreflightData</span> <span class="kd">implements</span> <span class="nc">Serializable</span> <span class="o">{</span>

    <span class="cm">/** Final HTTP request expected method */</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">expectedMethod</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="cm">/** Final HTTP request expected custom headers */</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">expectedCustomHeaders</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="cm">/** Current HTTP request uri */</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">uri</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="cm">/** Current HTTP request origin header */</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">origin</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="cm">/** Current Sender IP address */</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">sender</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="cm">/**
     * Constructor
     *
     * @param httpRequest Source HTTP request
     */</span>
    <span class="kd">public</span> <span class="nf">CORSRequestPreflightData</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">httpRequest</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">tmp</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">httpRequest</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"HTTP request cannot be null !"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sender</span> <span class="o">=</span> <span class="n">httpRequest</span><span class="o">.</span><span class="na">getRemoteAddr</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">uri</span> <span class="o">=</span> <span class="n">httpRequest</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">origin</span> <span class="o">=</span> <span class="nc">CORSUtils</span><span class="o">.</span><span class="na">retrieveHeader</span><span class="o">(</span><span class="s">"Origin"</span><span class="o">,</span> <span class="n">httpRequest</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">expectedMethod</span> <span class="o">=</span> <span class="nc">CORSUtils</span><span class="o">.</span><span class="na">retrieveHeader</span><span class="o">(</span><span class="s">"Access-Control-Request-Method"</span><span class="o">,</span> <span class="n">httpRequest</span><span class="o">);</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="nc">CORSUtils</span><span class="o">.</span><span class="na">retrieveHeader</span><span class="o">(</span><span class="s">"Access-Control-Request-Headers"</span><span class="o">,</span> <span class="n">httpRequest</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">tmp</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">expectedCustomHeaders</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
            <span class="nc">String</span><span class="o">[]</span> <span class="n">hs</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">h</span> <span class="o">:</span> <span class="n">hs</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">((</span><span class="n">h</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">h</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="na">expectedCustomHeaders</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">h</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">().</span><span class="na">trim</span><span class="o">());</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Getter
     *
     * @return the expectedMethod
     */</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getExpectedMethod</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">expectedMethod</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Getter
     *
     * @return the expectedCustomHeaders
     */</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getExpectedCustomHeaders</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">expectedCustomHeaders</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Getter
     *
     * @return the uri
     */</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUri</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">uri</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Getter
     *
     * @return the origin
     */</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getOrigin</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">origin</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Getter
     *
     * @return the sender
     */</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getSender</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">sender</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Sample implementation: Enumeration used to represents the differents
CORS request type</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Enumeration of the differents CORS "request preflight" HTTP request type.
 */</span>
<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">CORSRequestPreflightType</span> <span class="o">{</span>

    <span class="cm">/** HTTP request send by client to preflight a further 'Complex' request */</span>
    <span class="no">REQUEST_FOR_PREFLIGHT</span><span class="o">,</span>

    <span class="cm">/** Normal HTTP request send by client that require preflight ie 'Complex' resquest in Preflight process */</span>
    <span class="no">COMPLEX_REQUEST</span><span class="o">,</span>

    <span class="cm">/** Normal HTTP request send by client that do not require preflight ie 'Simple' resquest in Preflight process */</span>
    <span class="no">SIMPLE_REQUEST</span><span class="o">,</span>

    <span class="cm">/** Cannot determine request type */</span>
    <span class="no">UNKNOWN</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="informations-links">Informations links</h2>

<ul>
  <li><a href="http://www.w3.org/TR/cors/">W3C Specification</a></li>
  <li><a href="https://developer.mozilla.org/en-US/docs/HTTP_access_control">Mozilla Wiki</a></li>
  <li><a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">Wikipedia</a></li>
</ul>

          </section>
          

          
          
          
          
          
          
          
       </div>
       <hr>
       <div class="repo">
       </div>

          <div class="github-buttons">
    <a class="github-button" href="https://github.com/owasp/www-community/subscription" data-icon="octicon-eye" data-size="large" data-show-count="true" aria-label="Watch on GitHub">Watch</a>
    <a class="github-button" href="https://github.com/owasp/www-community" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star on GitHub">Star</a>
 </div>

          <div class="sidebar" role="complementary">
    

    
    
       



  
  <div class='owasp-sidebar-top'>
    <strong>The OWASP<sup>&reg;</sup> Foundation</strong> works to improve the security of software through its community-led open source software projects, 
     hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
</div>


  
  
  <h3 id="important-community-links">Important Community Links</h3>
<ul>
  <li><a href="https://owasp.org/www-community/">Community</a></li>
  <li>Attacks (You are here)</li>
  <li><a href="https://owasp.org/www-community/vulnerabilities">Vulnerabilities</a></li>
  <li><a href="https://owasp.org/www-community/controls">Controls</a></li>
</ul>

  
  
  

  <div class='owasp-sidebar-bottom'>
   <h3>Upcoming OWASP Global Events</h3>
   <div id='global-event-div'>

   </div>
</div>

<script type="text/javascript">
   var events = [];
   $(function () {
      eventsyml = YAML.load('https://owasp.org/assets/sitedata/events.yml');

      $.each(eventsyml, function (index) {
         if (this.category == 'Global') {
            for (e in this.events) {
               events.push(this.events[e]);
            }
         }
      });

      if (events.length > 0) {
         var htmlstring = "<ul>";
         for (evnt in events) {
            if (events[evnt].url)
               htmlstring += '<li><a href="' + events[evnt].url
            else
               htmlstring += '<li><a href="https://owasp.org/events/'

            htmlstring += '" target="_blank rel="noopener">' + events[evnt].name + '</a>';

            if (typeof events[evnt].dates === 'undefined') {
               events[evnt].dates = 'TBA';
            }

            htmlstring += "<ul><li style='list-style-type: circle;margin-top: 0px;padding:0px;margin-left:16px;'>" + events[evnt].dates + "</li></ul></li>";
         }
         htmlstring += "</ul>";

         $("#global-event-div").html(htmlstring);
      }
   });
</script>

  <!--<div>
    <h3>OWASP News & Opinions</h3>
    <ul>
    	
    </ul>	
  </div>-->
</div>

      </div>
    </main>
    <footer>
  
  <section class="member">

  <script type="text/javascript">
    var members = [];
    var plat_indices = [];
    var gold_indices = [];
    var other_indices = [];

    function get_next_member(members, indexUsed){
      // random 6
      // 0 to 2 = Platinum (.2 > Other)
      // 3 to 4 = Gold (.1 > Other)
      // 5 = Other  
      member = null;
      chosenIndex = -1;
      var pick = Math.floor(Math.random() * 100);      
      var randomIndex = -1;
      if(pick < 44){
        // pick a platinum member
        randomIndex = Math.floor(Math.random() * plat_indices.length);
        pIndex = plat_indices[randomIndex];            
        cycleIndex = randomIndex
        while(chosenIndex == -1)
        {
          randomIndex++;
          if(indexUsed.indexOf(pIndex)== -1){
            chosenIndex = pIndex;
            
          }else if(randomIndex >= plat_indices.length){
            randomIndex = 0;
            
          }
          if (randomIndex == cycleIndex){ // we could not find a plat member not already in the list....            
            break;
          }
        }
      }
      if (chosenIndex == -1 && pick < 77) {
        // pick a gold member
        randomIndex = Math.floor(Math.random() * gold_indices.length);
        pIndex = gold_indices[randomIndex];            
        cycleIndex = randomIndex
        while(chosenIndex == -1)
        {
          randomIndex++;
          if(indexUsed.indexOf(pIndex)== -1){
            chosenIndex = pIndex;
            
          }else if(randomIndex >= gold_indices.length){
            randomIndex = 0;
            
          }
          if (randomIndex == cycleIndex){ // we could not find a plat member not already in the list....            
            break;
          }
        }
      }
      if (chosenIndex == -1){
        // pick an other member
        randomIndex = Math.floor(Math.random() * other_indices.length);
        pIndex = other_indices[randomIndex];            
        cycleIndex = randomIndex
        while(chosenIndex == -1)
        {
          randomIndex++;
          if(indexUsed.indexOf(pIndex)== -1){
            chosenIndex = pIndex;
            
          }else if(randomIndex >= other_indices.length){
            randomIndex = 0;
            
          }
          if (randomIndex == cycleIndex){ // we could not find a plat member not already in the list....            
            break;
          }
        }
      }    
      if(chosenIndex >= 0){          
        member = members[chosenIndex];
        indexUsed.push(chosenIndex);
        var membertype = 'not a member';
        if(member.member && (member.membertype == 1 || !member.membertype))
          membertype = 'silver member';
        else if(member.member && member.membertype == 2)
          membertype = 'platinum member';
        else if(member.member && member.membertype == 3)
          membertype = 'gold member';
        else if(member.member && member.membertype)
          membertype = member.membertype;        
      }
      return member;      
    }

    $(function() {  
      var corp_members = YAML.load('https://owasp.org/assets/sitedata/corp_members.yml');
      $.each(corp_members, function (index) {
          index = members.push(this) - 1;  
          if(this.member && this.membertype == 3)
            gold_indices.push(index);
          else if (this.member && this.membertype == 2)
            plat_indices.push(index);
          else
            other_indices.push(index);        
        });

        var indexUsed = [];

        var counter = 0;
        var numberOfImages = 9;
        var member = get_next_member(members, indexUsed);
        htmlstring = '<h2>Spotlight: ' + member["name"] + '</h2>';
        htmlstring += '<a href="'+ member["url"] + '" rel="sponsored nopener noreferrer" target="_blank" onclick="handleOutboundLinkClicks(event);"><img src="https://owasp.org' + member["image"] + '" alt="image" /></a>';
        htmlstring += '<p>' + member["description"] + '</p>';
        $(".member-spotlight").html(htmlstring);

        if(members.length > 0)
        {
          var htmlstring = "";
          while (counter < numberOfImages)
          {
            member = get_next_member(members, indexUsed)
            if (member)
            {
                counter++;
                htmlstring += '<a href="'+ member["url"] + '" class="member-logo" rel="sponsored noopener noreferrer" target="_blank" onclick="handleOutboundLinkClicks(event);"><img src="https://owasp.org' + member["image"] + '" alt="image"/></a>';                                
            }
          }

          $("#corp_member_div").html(htmlstring);
         
          
        }
    });
  </script>
  <div class="member-wrapper">
    <section class="member-spotlight">
    </section>
    <section class="member-list">
      <h2>Corporate Supporters</h2>
      <div id="corp_member_div">
      </div>
      <div class="member-cta">
        <a class="callout-link" href="https://owasp.org/supporters">Become a corporate supporter</a>
      </div>
    </section>
  </div>
</section>

  
  <section class="footer-wrapper">
    <section class="social">
<a href="https://github.com/OWASP/" aria-label="github organization" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-github"></i></a>
<a href="https://owasp.org/slack/invite" aria-label="slack group" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-slack"></i></a>
<a href="https://www.facebook.com/OWASPFoundation" aria-label="facebook group" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-facebook-square"></i></a>
<!-- Mastodon Icon will not load; FA instance is too old. Use the SVG instead-->
<a href="https://infosec.exchange/@owasp" aria-label="mastodon account" target="_blank" rel="me"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54a102.5 102.5 0 0 1 -.9-13.9c85.6 20.9 158.7 9.1 178.8 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.3V197c0-58.5-64-56.6-64-6.9v114.2H90.2c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175z"/></svg></a>
<!-- Twitter X Icon will not load; I suspect another dependency (Jekyll?) is using an older version that is conflicting. So use the SVG instead-->
<a href="https://twitter.com/owasp" aria-label="twitter account" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></a>
<a href="https://www.linkedin.com/company/owasp/" aria-label="linkedin account" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-linkedin"></i></a>
<a href="https://www.youtube.com/user/OWASPGLOBAL" aria-label="youtube account" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-youtube-square"></i></a>
</section>

    <nav class="bot-nav" role="navigation" aria-label="secondary navigation">
      <ul>
        <li><a href="https://owasp.org/">HOME</a></li>
        <li><a href="https://owasp.org/projects/">PROJECTS</a></li>
        <li><a href="https://owasp.org/chapters/">CHAPTERS</a></li>
        <li><a href="https://owasp.org/events/">EVENTS</a></li>
        <li><a href="https://owasp.org/about/">ABOUT</a></li>
        <li><a href="https://owasp.org/www-policy/operational/privacy">PRIVACY</a></li>
        <li><a href="https://owasp.org/sitemap/">SITEMAP</a></li>
        <li><a href="https://owasp.org/contact/">CONTACT</a></li>
      </ul>
    </nav>
    <p class="disclaimer">
      OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our <a href="https://owasp.org/www-policy/operational/general-disclaimer.html">General Disclaimer</a>. OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2024, OWASP Foundation, Inc.
    </p>
  </section>
</footer>

  </body>

<!-- Mirrored from owasp.org/www-community/attacks/CORS_RequestPreflightScrutiny by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Dec 2024 21:20:44 GMT -->
</html>


