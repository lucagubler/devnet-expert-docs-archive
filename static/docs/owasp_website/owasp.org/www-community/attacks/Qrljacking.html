<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from owasp.org/www-community/attacks/Qrljacking by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Dec 2024 21:21:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">







<meta name="description" content="Qrljacking on the main website for The OWASP Foundation. OWASP is a nonprofit foundation that works to improve the security of software.">
<meta property="og:description" content="Qrljacking on the main website for The OWASP Foundation. OWASP is a nonprofit foundation that works to improve the security of software.">
<meta propery="og:title" content="Qrljacking | OWASP Foundation">
<meta property="og:url" content="Qrljacking.html">
<meta property="og:locale" content="en_US">

<!-- should probably look at using article at some point for www-community at least -->
<meta property="og:type" content="website" />
<meta property="og:image" content="https://owasp.org/www--site-theme/favicon.ico" />
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">


<link rel="canonical" href="Qrljacking.html" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4531126-1"></script> -->
<!-- <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-4531126-1');
</script> -->
<!-- Google Analytics -->


<script src="https://owasp.org/www--site-theme/assets/js/js.cookie.min.js"></script>
<script>
  if(Cookies.get('cookies-ok') == 'true' && window.ga === undefined)
  {
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-4531126-1', 'auto');
    ga('send', 'pageview');
  }
  else if (Cookies.get('cookies-ok') == 'true')
  {
    ga('send', 'pageview');
  }

  function handleOutboundLinkClicks(event) {
    var href = '';
    if(event.target.href == undefined)
      href = event.target.parentElement.href;
    else
      href = event.target.href
  if(Cookies.get('cookies-ok') == 'true'){  
    
    ga('send', 'event', {
      eventCategory: 'Outbound Link',
      eventAction: 'click',
      eventLabel: href,
      transport: 'beacon'
    });
  }
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->
<link rel="stylesheet" href="https://owasp.org/www--site-theme/assets/css/styles.css">
<link rel="shortcut icon" type="images/x-icon" href="https://owasp.org/www--site-theme/favicon.ico">

<script src="https://owasp.org/www--site-theme/assets/js/jquery-3.7.1.min.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/util.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/yaml.min.js"></script>
<script src="https://owasp.org/www--site-theme/assets/js/kjua.min.js"></script>
<title>Qrljacking | OWASP Foundation</title>

    <script type="text/javascript">
      $(function(){
        var baseurl = "https://github.com/OWASP/www-community/blob/master/";
        var path = "pages/attacks/Qrljacking.md";
        $('.repo').html('<a href=' + baseurl + path + '><div class="reset-3c756112--menuItemIcon-206eb252" style="float: left;"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 438.549 438.549" stroke="none" class="icon-7f6730be--text-3f89f380"><g><path d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 0 1-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"></path></g></svg><span style="padding-left:8px;">Edit on GitHub</span></div></a>');
      });
    </script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
  </head>
  <body class="base-grid col-sidebar">

    <div id="blocker"></div>

    <noscript>For full functionality of this site it is necessary to enable JavaScript. Here are the <a href="http://turnonjs.com/"> instructions how to enable JavaScript in your web browser</a>.</noscript>
    <header role="banner">
  <div id="banner" class="notice" aria-label="announcement">
</div>




<style>
  #banner img {
    max-width: 30em;
  }

  @media (max-width: 1131px) {
    #banner img {
      max-width: 30em;
    }
  }

  @media (max-width: 800px) {
    #banner img {
      max-width: 20em;
    }
  }

  @media (max-width: 600px) {
    #banner img {
      max-width: 20em;
    }
  }

  @media (max-width: 450px) {
    #banner img {
      max-width: 250px;
    }
  }
</style>

<script type="text/javascript">
  $(function () {
    var bannerdata = [];
    banneryaml = YAML.load('https://owasp.org/www-community/assets/sitedata/banner-data.yml');
    $.each(banneryaml, function (index) {
      bannerdata.push(this);
    });

    if (bannerdata.length > 0) {
      var htmlstring = "";
      var usebanner = null;
      var defbanner = null;
      var checkdate = new Date(); //local time but who cares about the time?
      bannerdata.forEach(data => {
        if (data.start) {
          var start = data.start;

          if (data.start <= checkdate) {
            if (data.end) {

              var end = data.end;
              if (checkdate < end) {
                usebanner = data;
              }
            }
            else
              usebanner = data;
          }
        }
        else {
          defbanner = data;
        }
      });

      if (defbanner && !usebanner)
        usebanner = defbanner;
      if (usebanner) {
        htmlstring = usebanner.text;
        htmlstring += "<a href='#' id='close-banner' aria-label='close announcement' style='float:right;'><i class='fa fa-times'></i></a>";

        $("#banner").html(htmlstring);
        $("#banner").removeClass("notice");
        $("#banner").addClass(usebanner.type);

        $("#close-banner").click(function() {
          $(this).closest("#banner").remove();
            Cookies.set('banner-seen', 'true', { expires: 7 });
        });
      }
    }
  });
</script>
  <div id="popup" class="notice" aria-label="announcement">
   
</div>




<style>
  #banner img {
    max-width: 30em;
  }

  @media (max-width: 1131px) {
    #banner img {
      max-width: 30em;
    }
  }

  @media (max-width: 800px) {
    #banner img {
      max-width: 20em;
    }
    #popup {
      visibility: hidden;
    }
  }

  @media (max-width: 600px) {
    #popup {
      visibility: hidden;
    }
    #banner img {
      max-width: 20em;
    }
  }

  @media (max-width: 450px) {
    #banner img {
      max-width: 250px;
    }
    #popup {
      visibility: hidden;
    }
  }
</style>

<script type="text/javascript">
  $(function () {
    var popdata = [];
    $("#popup").hide();
    popyaml = YAML.load('https://owasp.org/www-community/assets/sitedata/popup-data.yml');
    $.each(popyaml, function (index) {
      popdata.push(this);
    });

    if (popdata.length > 0) {
      var htmlstring = "";
      var usepop = null;
      var defpop = null;
      var checkdate = new Date(); //local time but who cares about the time?
      popdata.forEach(data => {
        if (data.start) {
          var start = data.start;

          if (data.start <= checkdate) {
            if (data.end) {

              var end = data.end;
              if (checkdate < end) {
                usepop = data;
              }
            }
            else
              usepop = data;
          }
        }
        else {
          defpop = data;
        }
      });

      if (defpop && !usepop)
        usepop = defpop;
      if (usepop) {
        htmlstring = usepop.text;
        htmlstring += "<a href='#' id='close-popup' aria-label='close announcement' style='float:right;'><i class='fa fa-times'></i></a>";

        $("#popup").html(htmlstring);
        $("#popup").removeClass("notice");
        $("#popup").addClass(usepop.type);
        
        if( Cookies.get('popup-seen')!='true')
        {
          $("#popup").show();
        }

        $("#close-popup").click(function() {
          $(this).closest("#popup").remove();
            Cookies.set('popup-seen', 'true', { expires: 7 });
        });
      }
    }
  });
</script>
  <div class="header-wrapper" aria-label="main navigation">
    <nav class="alt-nav">
      <a href="#" class="menu-toggler" aria-hidden="true">
        <i class="fa fa-bars"></i>
      </a>
      <a href="https://owasp.org/" class="alt-logo" aria-label="go to homepage">
          <img src="https://owasp.org/assets/images/logo.png" alt="OWASP logo">
      </a>
      <div id="overlay" class="remove-el">

      </div>
      <!-- jekyll menu stuff -->
    </nav>
    
    <nav class="top-nav" role="navigation" aria-label="primary navigation">
      <a href="https://owasp.org/" class="desktop-logo" aria-label="go to homepage">
        <img src="https://owasp.org/assets/images/logo.png" alt="">
      </a>
      <!-- jekyll menu stuff -->
      <div id="midmenu" class="top-nav"></div>
      
      

      <div class="interactive-wrapper">                
        <div class="nav-button" aria-label="donate to or join OWASP">
        
          <a href="https://owasp.org/store" class="cta-button white inset"><i class="fa fa-shopping-cart" aria-hidden="true"></i> Store</a>
          <a href="https://owasp.org/donate?reponame=www-community" class="cta-button green">Donate</a>
          <a href="https://owasp.org/membership" class="cta-button">Join</a>
        </div>
      </div>
    </nav>
    <div id='disclaimer-container'>
<div id="disclaimer">
    <p>This website uses cookies to analyze our traffic and only share that information with our analytics partners.</p><a class="disclaimerOK">Accept</a>
</div>
<div id="close-disclaimer">x</div>
</div>
  </div>
  <div class="mobile" style="width:100%;display: flex; justify-content: space-evenly;align-items: center;padding: 8px; background-color: #98afc7;">
    <div><a href="https://owasp.org/store" class="cta-button white inset"><i class="fa fa-shopping-cart" aria-hidden="true"></i>Store</a></div>
    <div><a href="https://owasp.org/donate?reponame=www-community" class="cta-button green">Donate</a></div>
    <div><a href="https://owasp.org/membership" class="cta-button">Join</a></div>
  </div>



<script type="text/javascript">
  $(function(){
      
      url = $(location).attr('href');
      if(url.includes('www2'))
      {
        url = url.replace(/www2./, '');
        $(location).attr('href',url);
        return;
      }
    // this works to get data from a json file NOT in data
      $.getJSON("https://owasp.org/www--site-theme/assets/sitedata/menus.json", function(data) {
         var listr = "<ul aria-label='header menu'>";
         
         var mlistr = "<ul class='mobile-menu hide-el' role='navigation' aria-label='mobile primary navigation'>";

          mlistr += "<li><a href='#' class='menu-toggler' aria-hidden='true'><i class='fa fa-times'></i></a></li>";
          mlistr += "<li>";
          mlistr += "<form role='search' method='get' action='https://owasp.org/search'>";   
          mlistr += "<div class='search-div'>";
          mlistr += "<input id='searchString' aria-label='search input' name='searchString' class='search-bar' type='search' placeholder='Search OWASP.org' required='true'>";
          mlistr += "<button id='search-button' aria-label='search button' type='submit' class='fa fa-search' style='padding-left: 8px;'></button></div></form>";
          mlistr += "</li>";
          $.each(data.menus, function (ndx, menu){
              listr += "<li><a href='" + menu.url + "'>" + menu.title + "</a>";
              searchitem = issearch(menu.title);
              if(!menu.items && !searchitem)
              {
                  mlistr += "<li><a href='" + menu.url + "'>" + menu.title + "</a>";
              }
              
              if(menu.items){
                  listr += "<ul class='dropdown-menu'>";
                  if(!searchitem) {
                    mlistr += "<button class='accordion'>" + menu.title + "</button>";
                    mlistr += "<div class='panel'>";
                    mlistr += "<ul>";
                  }
                $.each(menu.items, function(ndx, item){
                
                  if(item.separator)
                  {
                      listr += "<li class='separator'>";
                      if(!searchitem)
                        mlistr += "<li class='separator'>";
                  }
                  else
                  {
                      listr += "<li>";
                      if(!searchitem)
                        mlistr += "<li>";
                  }
                  listr += "<a href='" + item.url + "'";
                  if(!searchitem)
                    mlistr += "<a href='" + item.url + "'";
                  if(item.opentab)
                  {
                    listr += " target='_blank' rel='noopener noreferrer'";
                    if(!searchitem)
                      mlistr += " target='_blank' rel='noopener noreferrer'";
                  }

                  listr += ">" + item.title + "</a></li>";
                  if(!searchitem)
                    mlistr += ">" + item.title + "</a></li>";
                });
                listr += "</ul>";
                if(!searchitem){
                  mlistr += "</ul>";
                  mlistr += "</div>";
                }
              }
              
              listr += "</li>";
              if(!searchitem)
                mlistr += "</li>";
          });
          listr += "</ul>";
          mlistr += "<li><a href='https://owasp.org/donate'>MAKE A DONATION</a></li>";
          mlistr += "<li><a href='https://owasp.org/membership'>BECOME A MEMBER</a></li>";
          mlistr += "<li><a href='https://owasp.org/sitemap'>SITEMAP</a></li>";
          mlistr += "</ul>";
          
          //$('.desktop-logo').after(listr);
          $('#midmenu').html(listr);
          $('#overlay').after(mlistr);

          $(".accordion").click(function () {
              $(this).toggleClass("active");
              if($(this).next('.panel').css('display') == 'block'){
                $(this).next('.panel').css('display', 'none');
              }
              else {
                $(this).next('.panel').css('display', 'block');
              }
            });
            $(".menu-toggler").click(function() {
              $(".mobile-menu").toggleClass('hide-el');
            });
      });
    });

    function issearch(title) {
      return title.indexOf('fa fa-search') > -1;
    }
  </script>
</header>


    <main role="main">
      <div class="main-wrapper">
        
  
  
  
  
  
  
  





        <h1 class="page-title">Qrljacking</h1>
        <div id="main" class="page-body tab" role="tabpanel" aria-labelledby="main-link" tabindex="0">
          
          <section class="news-events">
            <div class="alert">  
             <p>Thank you for visiting OWASP.org. We have migrated our community to a new web platform and regretably the content for this page needed to be programmatically ported from its previous wiki page. There’s still some work to be done. </p>
            </div>
            
          </section>
         
         
         <p hidden>This is an example of a Project or Chapter Page.</p>
          
          <section id='sec-main' class='page-body'>
          <div style="font-size: 75%">


</div>

<h2 id="overview">Overview</h2>

<p>QRLJacking or Quick Response Code Login Jacking is a simple social
engineering attack vector capable of session hijacking affecting all
applications that rely on “Login with QR code” feature as a secure way
to login into accounts. In a simple way, In a nutshell victim scans the
attacker’s QR code results of session hijacking.</p>

<h1 id="login-with-qr-codes-a-feature-or-a-bug-security-vs-usability">Login With QR codes, a feature or a bug? (Security vs Usability)</h1>

<p>When it comes to authentication, any given system that doesn’t attain
the state of balance between being sufficiently usable and secure is
basically an impractical authentication system. Since the very
beginning, the traditional credentials-based authentication system has
taken dominance over any other alternatives. But not without many
shortcomings, from risks like replay and phishing attacks to intrinsic
problems like the “password fatigue” problem (in which a user is
burdened with the need to remember an excessive number of passwords as
part of their daily routine), we are left with non-trivial design flaws
that need to be addressed.</p>

<p>Later on, new approaches have emerged to address these problems. One
approach is the single sign-on system (a.k.a SSO), where a user can
simply have one single account that enables them to authenticate to
multiple services. This somewhat resolves the aforementioned “password
fatigue” problem as a user no longer needs to burden himself with too
many passwords to remember and no longer is tempted to develop bad
habits like reusing the same password over and over again. But still it
doesn’t come without its own shortcomings, as in this case, losing the
one password will prevent access to all services associated with the SSO
system; let alone the potential risk of mass account compromising.</p>

<p>Another approach that has been introduced is what’s called “one-time
password (OTP)”, which tries to mitigate many risks such as replay
attacks and any potential of phishing attacks to some extend. But on the
downside, these passwords are typically hard to memorize, and therefore,
they require additional technology to be deployed.</p>

<p>Recently, a new SSO model that relies on QR-code-based one-time
passwords has been introduced to further address such flaws. In a
QR-code-based login, a user may only need to scan a QR code generated by
the service they’re trying to authenticate to, and then a client app on a
trusted device such as a smartphone would scan and transmit the QR code
to an identity provider in order to validate it and further authenticate
the user to the destination service. Hence conducting a seamless and
safe login process even on a potentially compromised device. But as we
explain in detail later––depending on the implementation––such approach
can be easily abused to fool a user into authenticating a malicious
attacker on behalf of himself to sensitive web services, defeating the
whole point of such an approach!</p>

<h1 id="related-researches-and-projects-about-login-by-qr-code">Related researches and projects about “Login by QR Code”</h1>

<p><strong>1. Login Using QR Code (Google Patents / US 20130219479 A1)</strong></p>

<p>Systems and methods are disclosed herein for a user to use a trusted
device to provide sensitive information to an identity provider via QR
(Quick Response) code for the identity provider to broker a website
login or to collect information for the website. A user may securely
transact with the website from unsecured devices by entering sensitive
information into the trusted device. The identity provider may generate
the QR code for display by the website on an unsecured device. A user
running an application from the identity provider on the trusted device
may scan the QR code to transmit the QR code to the identity provider.
The identity provider may validate the QR code and may receive
credential information to authenticate the user or may collect
information for the website. Advantageously, the user may perform a safe
login to the website from untrusted devices using the trusted device</p>

<p><strong>2. Smartphone Login Using QR Code (Google Patents / US 20130167208
A1)</strong></p>

<p>Systems and methods are disclosed for a user to use a mobile device such
as a smart phone to scan a QR (Quick Response) code displayed on a login
webpage of a website. The QR code may encode a server URL of the
website. The mobile device decodes the QR code and transmits a device ID
and other decoded information to a service provider. The service
provider locates login credentials of the user linked to the device ID
and communicates the login credentials to a website server for user
authentication. Alternatively, the mobile device may transmit its device
ID to the website server for the website server to locate a user account
linked to the device ID for user login. Alternatively, the mobile device
may transmit stored login credentials to the website server.
Advantageously, a user may access a website without the need to provide
any login credentials.</p>

<p><strong>3. SQRL Project</strong></p>

<p>SQRL or Secure, Quick, Reliable Login (pronounced “squirrel” /ˈskwɝl/
About this sound en (help·info)) (formerly Secure QR Login) is a draft
open standard for secure website login and authentication. The software
solution typically uses a QR code, which provides authentication, where
a user identifies anonymously rather than providing a user ID and
password. This method is thought to be impervious to a brute force
password attack or data breach. It shifts the burden of security away
from the party requesting the authentication and closer to the operating
system implementation of what is possible on the hardware, as well as to
the user. SQRL was proposed by Steve Gibson of Gibson Research
Corporation in October 2013 as a way to simplify the process of
Authentication protocol, without revealing any information about the
transaction to a third party.</p>

<h1 id="what-is-qrljacking-attack">What is QRLJacking Attack?</h1>

<p>QRLJacking or Quick Response code Login Jacking is a simple-but-nasty
attack vector affecting all the applications that relays on “Login with
QR code” feature as a secure way to login into accounts, In a simple
way, It’s all about convincing the victim to scan the attacker’s QR
code.</p>

<h1 id="qrljacking-attack-flow">QRLJacking Attack Flow</h1>

<p>Here’s how the QRLJacking attack works behind the scenes:</p>

<ol>
  <li>
    <p>The attacker initial a client side QR session and clone the Login QR
Code into a phishing website. “Now a well-crafted phishing page with a
valid and regularly updated QR Code is ready to be sent to a Victim.”</p>
  </li>
  <li>
    <p>The Attacker Sends the phishing page to the victim. (refer to
<a href="https://github.com/OWASP/QRLJacking/wiki/QRLJacking-and-Advanced-Real-Life-Attack-Vectors">QRLJacking real life attack
vectors</a>)</p>
  </li>
  <li>
    <p>The Victim Scans the QR Code with a Specific Targeted Mobile App.</p>
  </li>
  <li>
    <p>The Attacker gains controls over the victim’s Account.</p>
  </li>
  <li>
    <p>The service is exchanging all the victim’s data with the attacker’s
session.</p>
  </li>
</ol>

<p><img src="https://owasp.org/www-community/assets/images/attacks/qrljacking-attack-flow.jpg" alt="QRLJacking Attack Flow" /></p>

<h1 id="qrljacking-implications">QRLJacking Implications</h1>

<p><strong>1. Accounts Hijacking</strong></p>

<p>QRLJacking attack gives attackers the ability to apply a full account
hijacking scenario on the vulnerable Login with QR Code feature
resulting in accounts stealing and reputation affection.</p>

<p><strong>2. Information Disclosure</strong></p>

<p>When the victim scans the QR code they are giving the attacker much more
information like for example (their accurate current GPS location, Device
type, IMEI, SIM Card Information and any other sensitive information
that the client application presents at the login process)</p>

<p><strong>3. Callback Data Manipulation</strong></p>

<p>When the attacker receives the data which we clarified in the
“Information Disclosure” point, Some of this data is used to
communicate with the service servers to clarify some information about
the user which can be used later in the user’s application.
Unfortunately sometimes this data is exchanged over insecure network
connection which makes it easy for this data to be controlled by the
attacker giving them the ability to alter or even remove it.</p>

<h1 id="qrljacking-requirements">QRLJacking Requirements</h1>

<p>As mentioned before one of the attack’s advantages relays in it’s
simplicity, So all what the attackers need to do to initial a successful
QRLJacking attack is to write a script to regularly clone the expirable
QR Codes and refresh the ones that is displayed in the phishing website
they created because as we know a well implemented QR Login process
should have an expiration interval for the QR codes (during our tests
some services doesn’t have that).</p>

<p>So all what we need here is: Attacker (Script kiddie as a minimum
required skills) + QR Code Refreshing Script (on the attacker side) +
well crafted phishing web page/script and a Victim.</p>

<h1 id="qrljacking-and-advanced-real-life-attack-vectors">QRLJacking and Advanced Real Life Attack Vectors</h1>

<p>As we all know, If we combined more than one attack vector together we
can have a great result. QRLJacking attack can be combined with a
powerful attack vectors and techniques to make it more reliable and
trustworthy. Here are some examples:</p>

<p><strong>1. Social Engineering techniques (Targeted Attacks)</strong></p>

<p>A skilled social engineer attacker will find this mission easy to
convince the victim to scan the QR Code by cloning the whole web
application login page with an exact one but with their own attacker side
QR Code.</p>

<p><strong>2. Hacked highly-trusted websites and services</strong></p>

<p>Hacked websites are prone to be injected with a script that displays an
Ad or a newly added section displays a cool offer if the user scanned
this QR Code with a specific targeted mobile application their account
will be hijacked.</p>

<p><strong>3. SSL Stripping</strong></p>

<p>SSL Stripping is an attack which is all about strip the ssl website and
force it to work on a non secured version. Web sites without “HSTS
Policy” enabled are prone to be stripped which gives the attacker
multiple choices to manipulate the content of the website pages by for
example, “altering the QR Code login sections”.</p>

<p><strong>4. Content Delivery Networks (CDNs Downgrading)</strong></p>

<p>A well implemented Login by QR Code feature uses a base64 QR code image
generated and well placed in a secured page which will make it very
difficult to be manipulated if this website is working over HTTPS and
forcing HSTS, but unfortunately a lot of web applications and services
uses a CDN based QR image generation process. These CDNs itself are
sometimes stored on a servers vulnerable to HTTPS Downgrading attacks.
Attackers will find a way to downgrade these secure connections,
redirect the CDN URLs to their own QR Code, and since the QR Code is an
image this will result in a “passive mixed content” hence the browser
will not find any problems by viewing it on the web application login
page instead of the original one.</p>

<p><strong>5. Non-secure Traffic over LAN</strong></p>

<p>This is the most suitable attack vector for attacking users over Local
Area Networks by exploiting the non secured websites and manipulate
traffic, The attacker here is performing MITM (Man in the Middle Attack)
against their local area network, poisoning the traffic on the fly by
injecting a JS file on every non secured web page.</p>

<p><strong>6. Bad Implementation / Logic</strong></p>

<p>Bad implementation logic of the QR code logins may result into a more
easy accounts takeover scenarios. During our research we found a
specific example: A chat app asks you to scan other people’s QR code to
add them as friends, until here it’s normal and there are no problems,
but when it comes to the login process it’s a big problem.
Unfortunately, the application implemented the “login by QR code”
feature on the same screen that you’re using to add a friend, so imagine
that someone cloned their login qr code and told you “Hey, This is my QR
Code, scan it to be my friend, you scanned it, Boom” you lost your
account.</p>

<h1 id="qrljacking-vs-clickjacking">QRLJacking vs Clickjacking</h1>

<p>As known, clickjacking is all about abusing the style of a sensitive web
page hiding and covering and manipulating some elements to convince the
victim “for example” to change their account’s main email address and
password to the attacker’s one, but what if the attacker succeeded in
that and after a while they want to login to the victim’s account and
found that this account has 2 Factor Authentication feature
enabled!!! Of course the attack is ruined and the whole thing became
useless.</p>

<p>QR Login feature was presented to be Single Sign-On and a 2 Factor
Authentication layer and because of that reason it is considered the
final defence line that give the users both security and usability.
“Scan me to login” it’s so easy, secure and efficient way to login on
a daily basis. QRLJacking is here to mess that usability and security
implementation.</p>

<p>It’s obvious now why is QRLJacking attack is more severe than a regular
Clickjacking one.</p>

<h1 id="defending-against-qrljacking-recommendations-and-mitigations">Defending against QRLJacking (Recommendations and Mitigations)</h1>

<p>Our top recommendation is to just stop using Login with QR code except
when it is necessary also there is a lot of ways to mitigate such issue
and here is some ways to be used together or standalone:</p>

<ol>
  <li>
    <p>Session Confirmation, We recommend implementing a confirmation
message/notification displaying characteristic information about the
session made by the client/server.</p>
  </li>
  <li>
    <p>IP Restrictions, Restricting any authentication process on different
networks (WANs) will minimize the attack window.</p>
  </li>
  <li>
    <p>Location-based Restrictions, Restricting any authentication process based on
different locations will minimize the attack window.</p>
  </li>
  <li>
    <p>Sound-based Authentication, One of the techniques to mitigate this kind of
attack [And maintain the same usability level as to not require any
additional interaction from the user other than scanning the QR ] is to add
sound-based authentication step to the process , we have seen this kind of
technology where it is possible to generate unique data and convert it to
audio that can be recognized back into its original form [SlickLogin and
Sound-Proof] so it is possible to include this technology in the process.</p>
  </li>
</ol>

<p>The purposes of this added step is to make sure that scanned QR code is
generated in the same physical location as the mobile device that is
doing the scan and therefore eliminating the possibility of a remote
attacker deceiving the user into scanning their qr code.</p>

<p><img src="https://owasp.org/www-community/assets/images/attacks/qrl-normal-login-scenario.jpg" alt="Nomal Login Scenario" /></p>

<p><strong>The Attack Scenario (with the mitigation):</strong> Attacker visits the
website and opens a session.</p>

<ol>
  <li>The Website Generates QR Code which holds a session key.</li>
</ol>

<p>2. Attacker crafts a phishing website with the received QR Code and
sends it to the user.</p>

<ol>
  <li>
    <p>User scans the attacker’s QR Code in the phishing website.</p>
  </li>
  <li>
    <p>The mobile App generates the authentication sound and play it to the
phishing website.</p>
  </li>
  <li>
    <p>The phishing website fails to process and capture the authentication
audio as it requires additional browser permissions.</p>
  </li>
  <li>
    <p>Even if the attacker tries to generate the authentication sound
based on the (User ID) they still lack the private key.</p>
  </li>
</ol>

<p><img src="https://owasp.org/www-community/assets/images/attacks/qrljacking-mitigation-scenario.jpg" alt="Mitigation Scenario" /></p>

<h1 id="related-vulnerabilities">Related Vulnerabilities</h1>

<ul>
  <li>Clickjacking</li>
</ul>

<h1 id="more-information">More information</h1>

<p>For more information on QRLJacking tools and extra, please visit the
<a href="https://github.com/OWASP/QRLJacking">QRLJacking on Github</a></p>

<h1 id="references">References</h1>

<ul>
  <li>https://www.seekurity.com/blog/tutorials/qrljacking-your-qr-based-session-belongs-to-us/</li>
  <li>https://en.wikipedia.org/wiki/QR_code</li>
  <li>https://en.wikipedia.org/wiki/Single_sign-on</li>
  <li>https://en.wikipedia.org/wiki/Authentication</li>
  <li>https://www.owasp.org/index.php/Clickjacking</li>
  <li>https://en.wikipedia.org/wiki/SQRL</li>
  <li><a href="https://https.cio.gov/mixed-content/">Mixed Content</a></li>
  <li><a href="https://www.google.com/patents/US20130167208">Smart Phone Login Using QR Code</a></li>
  <li><a href="https://www.google.com/patents/US20130219479">Login Using QR Code</a></li>
  <li><a href="https://en.wikipedia.org/wiki/SlickLogin">Sound-Proof Project</a></li>
</ul>

<p><strong>Proof of Concept examples (Videos)</strong></p>

<ul>
  <li><a href="https://www.youtube.com/watch?v=4QwyBXiZhG0">WhatsApp QRHijackingVulnerability</a></li>
  <li><a href="https://www.youtube.com/watch?v=JCoPSdQvESc">WhatsApp Accounts Hijacking and ARPpoisoning</a></li>
  <li><a href="https://www.youtube.com/watch?v=jenmicugWoo">AirDroid vulnerable to QRLJackingVulnerability</a></li>
  <li><a href="https://www.youtube.com/watch?v=lx-qnQ0ltpI">Vulnerable Web Applications and Services uses Login by QR CodeFeature part #1</a></li>
  <li><a href="https://www.youtube.com/watch?v=Nc_NyR06U5Q">Vulnerable Web Applications and Services uses Login by QR CodeFeature part #2</a></li>
</ul>

          </section>
          

          
          
          
          
          
          
          
       </div>
       <hr>
       <div class="repo">
       </div>

          <div class="github-buttons">
    <a class="github-button" href="https://github.com/owasp/www-community/subscription" data-icon="octicon-eye" data-size="large" data-show-count="true" aria-label="Watch on GitHub">Watch</a>
    <a class="github-button" href="https://github.com/owasp/www-community" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star on GitHub">Star</a>
 </div>

          <div class="sidebar" role="complementary">
    

    
    
       



  
  <div class='owasp-sidebar-top'>
    <strong>The OWASP<sup>&reg;</sup> Foundation</strong> works to improve the security of software through its community-led open source software projects, 
     hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
</div>


  
  
  <h3 id="important-community-links">Important Community Links</h3>
<ul>
  <li><a href="https://owasp.org/www-community/">Community</a></li>
  <li>Attacks (You are here)</li>
  <li><a href="https://owasp.org/www-community/vulnerabilities">Vulnerabilities</a></li>
  <li><a href="https://owasp.org/www-community/controls">Controls</a></li>
</ul>

  
  
  

  <div class='owasp-sidebar-bottom'>
   <h3>Upcoming OWASP Global Events</h3>
   <div id='global-event-div'>

   </div>
</div>

<script type="text/javascript">
   var events = [];
   $(function () {
      eventsyml = YAML.load('https://owasp.org/assets/sitedata/events.yml');

      $.each(eventsyml, function (index) {
         if (this.category == 'Global') {
            for (e in this.events) {
               events.push(this.events[e]);
            }
         }
      });

      if (events.length > 0) {
         var htmlstring = "<ul>";
         for (evnt in events) {
            if (events[evnt].url)
               htmlstring += '<li><a href="' + events[evnt].url
            else
               htmlstring += '<li><a href="https://owasp.org/events/'

            htmlstring += '" target="_blank rel="noopener">' + events[evnt].name + '</a>';

            if (typeof events[evnt].dates === 'undefined') {
               events[evnt].dates = 'TBA';
            }

            htmlstring += "<ul><li style='list-style-type: circle;margin-top: 0px;padding:0px;margin-left:16px;'>" + events[evnt].dates + "</li></ul></li>";
         }
         htmlstring += "</ul>";

         $("#global-event-div").html(htmlstring);
      }
   });
</script>

  <!--<div>
    <h3>OWASP News & Opinions</h3>
    <ul>
    	
    </ul>	
  </div>-->
</div>

      </div>
    </main>
    <footer>
  
  <section class="member">

  <script type="text/javascript">
    var members = [];
    var plat_indices = [];
    var gold_indices = [];
    var other_indices = [];

    function get_next_member(members, indexUsed){
      // random 6
      // 0 to 2 = Platinum (.2 > Other)
      // 3 to 4 = Gold (.1 > Other)
      // 5 = Other  
      member = null;
      chosenIndex = -1;
      var pick = Math.floor(Math.random() * 100);      
      var randomIndex = -1;
      if(pick < 44){
        // pick a platinum member
        randomIndex = Math.floor(Math.random() * plat_indices.length);
        pIndex = plat_indices[randomIndex];            
        cycleIndex = randomIndex
        while(chosenIndex == -1)
        {
          randomIndex++;
          if(indexUsed.indexOf(pIndex)== -1){
            chosenIndex = pIndex;
            
          }else if(randomIndex >= plat_indices.length){
            randomIndex = 0;
            
          }
          if (randomIndex == cycleIndex){ // we could not find a plat member not already in the list....            
            break;
          }
        }
      }
      if (chosenIndex == -1 && pick < 77) {
        // pick a gold member
        randomIndex = Math.floor(Math.random() * gold_indices.length);
        pIndex = gold_indices[randomIndex];            
        cycleIndex = randomIndex
        while(chosenIndex == -1)
        {
          randomIndex++;
          if(indexUsed.indexOf(pIndex)== -1){
            chosenIndex = pIndex;
            
          }else if(randomIndex >= gold_indices.length){
            randomIndex = 0;
            
          }
          if (randomIndex == cycleIndex){ // we could not find a plat member not already in the list....            
            break;
          }
        }
      }
      if (chosenIndex == -1){
        // pick an other member
        randomIndex = Math.floor(Math.random() * other_indices.length);
        pIndex = other_indices[randomIndex];            
        cycleIndex = randomIndex
        while(chosenIndex == -1)
        {
          randomIndex++;
          if(indexUsed.indexOf(pIndex)== -1){
            chosenIndex = pIndex;
            
          }else if(randomIndex >= other_indices.length){
            randomIndex = 0;
            
          }
          if (randomIndex == cycleIndex){ // we could not find a plat member not already in the list....            
            break;
          }
        }
      }    
      if(chosenIndex >= 0){          
        member = members[chosenIndex];
        indexUsed.push(chosenIndex);
        var membertype = 'not a member';
        if(member.member && (member.membertype == 1 || !member.membertype))
          membertype = 'silver member';
        else if(member.member && member.membertype == 2)
          membertype = 'platinum member';
        else if(member.member && member.membertype == 3)
          membertype = 'gold member';
        else if(member.member && member.membertype)
          membertype = member.membertype;        
      }
      return member;      
    }

    $(function() {  
      var corp_members = YAML.load('https://owasp.org/assets/sitedata/corp_members.yml');
      $.each(corp_members, function (index) {
          index = members.push(this) - 1;  
          if(this.member && this.membertype == 3)
            gold_indices.push(index);
          else if (this.member && this.membertype == 2)
            plat_indices.push(index);
          else
            other_indices.push(index);        
        });

        var indexUsed = [];

        var counter = 0;
        var numberOfImages = 9;
        var member = get_next_member(members, indexUsed);
        htmlstring = '<h2>Spotlight: ' + member["name"] + '</h2>';
        htmlstring += '<a href="'+ member["url"] + '" rel="sponsored nopener noreferrer" target="_blank" onclick="handleOutboundLinkClicks(event);"><img src="https://owasp.org' + member["image"] + '" alt="image" /></a>';
        htmlstring += '<p>' + member["description"] + '</p>';
        $(".member-spotlight").html(htmlstring);

        if(members.length > 0)
        {
          var htmlstring = "";
          while (counter < numberOfImages)
          {
            member = get_next_member(members, indexUsed)
            if (member)
            {
                counter++;
                htmlstring += '<a href="'+ member["url"] + '" class="member-logo" rel="sponsored noopener noreferrer" target="_blank" onclick="handleOutboundLinkClicks(event);"><img src="https://owasp.org' + member["image"] + '" alt="image"/></a>';                                
            }
          }

          $("#corp_member_div").html(htmlstring);
         
          
        }
    });
  </script>
  <div class="member-wrapper">
    <section class="member-spotlight">
    </section>
    <section class="member-list">
      <h2>Corporate Supporters</h2>
      <div id="corp_member_div">
      </div>
      <div class="member-cta">
        <a class="callout-link" href="https://owasp.org/supporters">Become a corporate supporter</a>
      </div>
    </section>
  </div>
</section>

  
  <section class="footer-wrapper">
    <section class="social">
<a href="https://github.com/OWASP/" aria-label="github organization" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-github"></i></a>
<a href="https://owasp.org/slack/invite" aria-label="slack group" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-slack"></i></a>
<a href="https://www.facebook.com/OWASPFoundation" aria-label="facebook group" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-facebook-square"></i></a>
<!-- Mastodon Icon will not load; FA instance is too old. Use the SVG instead-->
<a href="https://infosec.exchange/@owasp" aria-label="mastodon account" target="_blank" rel="me"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54a102.5 102.5 0 0 1 -.9-13.9c85.6 20.9 158.7 9.1 178.8 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.3V197c0-58.5-64-56.6-64-6.9v114.2H90.2c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175z"/></svg></a>
<!-- Twitter X Icon will not load; I suspect another dependency (Jekyll?) is using an older version that is conflicting. So use the SVG instead-->
<a href="https://twitter.com/owasp" aria-label="twitter account" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></a>
<a href="https://www.linkedin.com/company/owasp/" aria-label="linkedin account" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-linkedin"></i></a>
<a href="https://www.youtube.com/user/OWASPGLOBAL" aria-label="youtube account" target="_blank" rel="noopener noreferrer"><i class="fa fa-lg fa-youtube-square"></i></a>
</section>

    <nav class="bot-nav" role="navigation" aria-label="secondary navigation">
      <ul>
        <li><a href="https://owasp.org/">HOME</a></li>
        <li><a href="https://owasp.org/projects/">PROJECTS</a></li>
        <li><a href="https://owasp.org/chapters/">CHAPTERS</a></li>
        <li><a href="https://owasp.org/events/">EVENTS</a></li>
        <li><a href="https://owasp.org/about/">ABOUT</a></li>
        <li><a href="https://owasp.org/www-policy/operational/privacy">PRIVACY</a></li>
        <li><a href="https://owasp.org/sitemap/">SITEMAP</a></li>
        <li><a href="https://owasp.org/contact/">CONTACT</a></li>
      </ul>
    </nav>
    <p class="disclaimer">
      OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our <a href="https://owasp.org/www-policy/operational/general-disclaimer.html">General Disclaimer</a>. OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2024, OWASP Foundation, Inc.
    </p>
  </section>
</footer>

  </body>

<!-- Mirrored from owasp.org/www-community/attacks/Qrljacking by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 28 Dec 2024 21:21:16 GMT -->
</html>


