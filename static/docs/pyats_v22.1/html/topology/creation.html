<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creating Topology &mdash; pyATS Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using Topology Objects" href="usage.html" />
    <link rel="prev" title="Everything is an Object" href="concept.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pyATS
          </a>
              <div class="version">
                24.11
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Main Components</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../aetest/index.html">AEtest - Test Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../easypy/index.html">Easypy - Runtime Environment</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Testbed &amp; Topology Information</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="concept.html">Everything is an Object</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Creating Topology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#testbed-file">Testbed File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testbed-file-markups">Testbed File Markups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manual-creation">Manual Creation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="usage.html">Using Topology Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="schema.html">Topology Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="example.html">Example Testbed File</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kleenex/index.html">Testbed &amp; Device Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connections/index.html">Connection Meta</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../async/index.html">Asynchronous Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datastructures/index.html">Datastructures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tcl/index.html">Tcl Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../log/index.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results/index.html">Result Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporter/index.html">Reporter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robot/index.html">RobotFramework Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manifest/index.html">Manifest</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../terminology.html">Terminologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/index.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Doc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/index.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyATS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Testbed &amp; Topology Information</a></li>
      <li class="breadcrumb-item active">Creating Topology</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="creating-topology">
<h1>Creating Topology<a class="headerlink" href="#creating-topology" title="Permalink to this heading">¶</a></h1>
<p>There are two ways to create a topology within your testscript:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>create each testbed object from <code class="docutils literal notranslate"><span class="pre">topology</span></code> module classes and craft
their interconnects together manually (eg, by assigning interfaces to
each device).</p></li>
<li><p>create a YAML testbed description file, and load it using the
topology loader function.</p></li>
</ol>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Unless you need to create topology on the fly, the better
option is always to use YAML files to specify your topology.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can pass in a testbed YAML to <code class="docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">run</span> <span class="pre">job</span></code> using the
<code class="docutils literal notranslate"><span class="pre">--testbed-file</span></code> option, which automatically invokes
<code class="docutils literal notranslate"><span class="pre">topology.loader</span></code> to load the YAML file and pass the testbed object to
your script. The value following <code class="docutils literal notranslate"><span class="pre">--testbed-file</span></code> can be a file path or
a URL.</p>
</div>
<section id="testbed-file">
<span id="topology-testbed-file"></span><h2>Testbed File<a class="headerlink" href="#testbed-file" title="Permalink to this heading">¶</a></h2>
<p>Most users will most likely be running their
testscripts using a <em>testbed file</em> as input, and relying on the loader to
convert the YAML description into testbed objects.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examples</span>
<span class="c1"># --------</span>
<span class="c1">#</span>
<span class="c1">#   starting scripts using pyats run job and passing in testbed file/url</span>
<span class="c1">#   using --testbed-file argument</span>

pyats<span class="w"> </span>run<span class="w"> </span>job<span class="w"> </span>jobfile.py<span class="w"> </span>--testbed-file<span class="w"> </span>/path/to/my/testbed/file/testbed.yaml

pyats<span class="w"> </span>run<span class="w"> </span>job<span class="w"> </span>jobfile.py<span class="w"> </span>--testbed-file<span class="w"> </span><span class="s2">&quot;https://&lt;url&gt;/testbed.yaml&quot;</span>
</pre></div>
</div>
<p>Easypy then invokes <code class="docutils literal notranslate"><span class="pre">topology</span></code> module to load and convert this
information into topology object instances, and pass it to the user script.
For example, in <a class="reference internal" href="../aetest/run.html#aetest-jobfile-execution"><span class="std std-ref">aetest</span></a> the provided
testbed object is accessible using the <code class="docutils literal notranslate"><span class="pre">testbed</span></code> parameter.</p>
<p>Internally, the following is really what happened:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Details</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   how testbed file was loaded into testbed object</span>

<span class="kn">from</span> <span class="nn">pyats.topology</span> <span class="kn">import</span> <span class="n">loader</span>

<span class="c1"># load testbed file</span>
<span class="n">testbed</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;/path/to/my/testbed/file/testbed.yaml&#39;</span><span class="p">)</span>

<span class="c1"># voila!</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">topology.loader.load()</span></code> API takes in a loadable input (such as path to a YAML
testbed file or a URL to a YAML testbed file), parses the information, and makes
appropriate Class constructor calls to construct the corresponding objects,
including building the topology interconnect relationships.</p>
<p>Testbed files need to follow the standard testbed-file format (a.k.a schema).
The <a class="reference internal" href="schema.html#schema"><span class="std std-ref">Topology Schema</span></a> controls how and what information can go into each testbed
file, and provides standard best practices so that testbed description is
unanimous for all.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>when <code class="docutils literal notranslate"><span class="pre">topology.loader</span></code> loads a testbed file, if the testbed name is not
specified within <code class="docutils literal notranslate"><span class="pre">testbed:</span></code> section, the loader substitutes the file name
as the testbed name, with prefix/post-fix such as <code class="docutils literal notranslate"><span class="pre">CONFIG.</span></code> and <code class="docutils literal notranslate"><span class="pre">.yaml</span></code>
trimmed.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>there may be cases where users wishes to perform their own loading of
the testbed file, or in rare cases, deal with more than one testbed at a
time per script. In those cases, use the <code class="docutils literal notranslate"><span class="pre">topology.loader.load()</span></code> API to
facilitate the conversion of testbed file to objects.</p>
</div>
</section>
<section id="testbed-file-markups">
<span id="id1"></span><h2>Testbed File Markups<a class="headerlink" href="#testbed-file-markups" title="Permalink to this heading">¶</a></h2>
<p>Another advantage of using testbed files is to leverage the built-in markup
feature. Whereas standard YAML format does not allow variable substitution and
references, <code class="docutils literal notranslate"><span class="pre">topology.loader</span></code> effectively added this using specific syntax
(markups) similar to the Django template language.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Syntax
# ------
#
#   YAML markup syntax

# basic syntax
# ------------
#   %{&lt;path&gt;.&lt;path&gt;.&lt;...&gt;}
#   %INTF{logical_interface_name}
#   %ENV{environment_variable_name}
#   %CALLABLE{path_to_callable}
#   %CALLABLE{path_to_callable(param1,param2,param3)}
#   %INCLUDE{yaml_file_path}
#   %ASK{optional prompt text}
#   %ENC{encoded text}
#   %ENC{encoded text, prefix=x}
#   %CLI(cli_argument_name}
#
#   - use %{ } to denote the begin and end of a markup block
#   - use . to separate reference path
#   - use &#39;self&#39; as first word to reference current device
#   - The %INTF{ } form causes the logical interface name to be
#     replaced with the actual interface name from the
#     device&#39;s topology block.
#   - The %ENV{ } form causes the environment variable name to be
#     replaced with the actual environment value from the os.
#   - The %CALLABLE{ } form causes the callable to be replaced with the
#     actual return value from the callable. All defined parameters
#     will be passed to the callable.
#   - The %INCLUDE{ } form causes the yaml file path to be replaced
#     with the actual content of the yaml file.
#   - The %ASK{ } form causes the user to be prompted to enter information
#     manually.
#   - The %ENC{ } form causes an encoded string to be replaced with a
#     decoded string or secret string which supports decoding.
#   - The %CLI{ } form replaces the variable name with the value provided
#     from the command line argument. If no command line argument was
#     provided for this variable, the value will be an empty string.
#     Supports single and double dash argument style.

# reference to current device name
%{self}

# reference to attributes within current device
%{self.x.y.z}

# reference to logical interface within current device
# (replaced with actual interface name)
%INTF{logical_interface_name}

# reference to arbitrary attribute within this YAML file
%{a.b.c}

# reference to environment variable from the os
# (replaced with actual environment variable name)
%ENV{environment_variable_name}

# reference to callable without parameter
# (replaced with actual path to callable)
%CALLABLE{path.to.callable}

# reference to callable with parameters param1, param2 and param3
# (replaced with actual path to callable)
%CALLABLE{path.to.callable(param1,param2,param3)}

# reference to content from other YAML file
# (replaced with actual path to YAML file)
%INCLUDE{yaml_file_path}

# prompt user to enter string content manually
%ASK{optional prompt text}

# Reference to text encoded with &quot;pyats secret encode&quot; command
# Encoded credential passwords are substituted by secret strings.
# Other encoded references are substituted with their decoded string.
# See secret strings documentation for details.
%ENC{&lt;encoded text&gt;}

# Reference to text encoded with &quot;pyats secret encode --prefix x&quot; command.
# Encoded credential passwords are substituted by secret strings.
# Other encoded references are substituted with their decoded string.
# See secret strings documentation for details.
%ENC{&lt;encoded text&gt;, prefix=x}

# Reference to &quot;some_arg&quot; will be replaced by &quot;some_value&quot; if
# the command line &quot;pyats run job --some_arg some_value&quot; is used.
%CLI{some_arg}

# If the command line argument is provided without a value,
# the value is set to boolean &#39;True&#39;. The following command line
# sets the value for &quot;some_flag&quot; to True.
# &quot;pyats run job --some_flag&quot;
%CLI{some_flag}

# If the command line argument has multiple values,
# the variable is replaced with a list of values.
# The following command line argument creates a list
# of values in place of the devices variable.
# &quot;pyats run job --devices R1 R2&quot;
%CLI{devices}

# If the command line argument contains a number value,
# either integer or float, the variable is converted from
# a string to an integer or float.
# &quot;pyats run job --retries 3&quot;
%CLI{retries}
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure to enclose your markup in quotes if it occurs directly
after a colon.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">testbed</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">my_testbed</span>

    <span class="n">passwords</span><span class="p">:</span>
        <span class="n">enable</span><span class="p">:</span> <span class="n">lab</span>
        <span class="n">line</span><span class="p">:</span> <span class="s2">&quot;%</span><span class="si">{testbed.passwords.enable}</span><span class="s2">&quot;</span>
        <span class="n">tacacs</span><span class="p">:</span> <span class="s2">&quot;%</span><span class="si">{testbed.passwords.enable}</span><span class="s2">&quot;</span>
    <span class="n">tacacs</span><span class="p">:</span>
        <span class="n">username</span><span class="p">:</span> <span class="n">admin</span>
</pre></div>
</div>
</div>
<p>YAML itself does not distinguish the markups from regular text (strings).
Before the creation of testbed objects, the loader walks through the generated
data and replaces all markup languages with referenced data.
Any syntax outside of the above is neither recognized nor processed.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   yaml testbed using markup</span>
<span class="c1">#   notice how markups were used as information references.</span>
<span class="nt">devices</span><span class="p">:</span>
<span class="w">    </span><span class="nt">example_device</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%CALLABLE{mylib.get_device_type}&quot;</span>
<span class="w">        </span><span class="nt">connections</span><span class="p">:</span>
<span class="w">          </span><span class="nt">a</span><span class="p">:</span>
<span class="w">            </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">telnet</span>
<span class="w">            </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.1.1.1&quot;</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2001</span>
<span class="w">          </span><span class="nt">alt</span><span class="p">:</span>
<span class="w">            </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">telnet</span>
<span class="w">            </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%{self.clean.mgt_itf.ipv4.address}&quot;</span>

<span class="w">    </span><span class="nt">dynamic_device</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%CALLABLE{mylib.create_device(2.2.2.2)}&quot;</span>
<span class="nt">topology</span><span class="p">:</span>
<span class="w">    </span><span class="nt">example_device</span><span class="p">:</span>
<span class="w">        </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">Ethernet4/6</span><span class="p">:</span>
<span class="w">                </span><span class="nt">alias</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_logical_interface</span>
<span class="w">                </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">link-x</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%ENV{DEFAULT_INTERFACE_TYPE}&quot;</span>
<span class="w">    </span><span class="nt">dynamic_device</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;%INCLUDE{/path/to/dynamic/generated/device/interfaces/file}&quot;</span>
</pre></div>
</div>
<p>Testbed file can be broken down in multiple yaml files with the extend key.
Each file can represent a subset of the main testbed file.</p>
<p>Let’s say this file is named tb1.yaml</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">devices</span><span class="p">:</span>
<span class="w">  </span><span class="nt">xr-1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">connections</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cli</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.1.1</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssh</span>
<span class="w">    </span><span class="nt">credentials</span><span class="p">:</span>
<span class="w">      </span><span class="nt">default</span><span class="p">:</span>
<span class="w">        </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco</span>
<span class="w">        </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco</span>
<span class="w">      </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">        </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco</span>
<span class="w">    </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iosxr</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iosxr</span>
</pre></div>
</div>
<p>And this file is named tb2.yaml</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">extends</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tb1.yaml</span>
<span class="nt">devices</span><span class="p">:</span>
<span class="w">  </span><span class="nt">xr-2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">connections</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cli</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.2.2.2</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssh</span>
<span class="w">    </span><span class="nt">credentials</span><span class="p">:</span>
<span class="w">      </span><span class="nt">default</span><span class="p">:</span>
<span class="w">        </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco</span>
<span class="w">        </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco</span>
<span class="w">      </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">        </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco</span>
<span class="w">    </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iosxr</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iosxr</span>
</pre></div>
</div>
<p>Now at run time, you can provide the tb2.yaml, which will merge tb1.yaml and
tb2.yaml together to create a merged testbed.</p>
</section>
<section id="manual-creation">
<h2>Manual Creation<a class="headerlink" href="#manual-creation" title="Permalink to this heading">¶</a></h2>
<p>If needed, you can always create and/or manipulate testbed objects manually.
This is the better option when you need to add or remove testbed components
on the fly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   creating a simple testbed topology from scratch</span>

<span class="c1"># import testbed objects</span>
<span class="kn">from</span> <span class="nn">pyats.topology</span> <span class="kn">import</span> <span class="n">Testbed</span><span class="p">,</span> <span class="n">Device</span><span class="p">,</span> <span class="n">Interface</span><span class="p">,</span> <span class="n">Link</span>

<span class="c1"># create your testbed</span>
<span class="n">testbed</span> <span class="o">=</span> <span class="n">Testbed</span><span class="p">(</span><span class="s1">&#39;manuallyCreatedTestbed&#39;</span><span class="p">,</span>
                  <span class="n">alias</span> <span class="o">=</span> <span class="s1">&#39;iWishThisWasYaml&#39;</span><span class="p">,</span>
                  <span class="n">passwords</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;tacacs&#39;</span><span class="p">:</span> <span class="s1">&#39;lab&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;enable&#39;</span><span class="p">:</span> <span class="s1">&#39;lab&#39;</span><span class="p">,</span>
                  <span class="p">},</span>
                  <span class="n">servers</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;tftp&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;my-tftp-server&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;10.1.1.1&#39;</span><span class="p">,</span>
                    <span class="p">},</span>
                  <span class="p">})</span>

<span class="c1"># create your devices</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">Device</span><span class="p">(</span><span class="s1">&#39;tediousProcess&#39;</span><span class="p">,</span>
                <span class="n">alias</span> <span class="o">=</span> <span class="s1">&#39;gimmyYaml&#39;</span><span class="p">,</span>
                <span class="n">connections</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;telnet&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.1.1&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">80</span>
                    <span class="p">}</span>
                <span class="p">})</span>

<span class="c1"># create your interfaces</span>
<span class="n">interface_a</span> <span class="o">=</span> <span class="n">Interface</span><span class="p">(</span><span class="s1">&#39;Ethernet1/1&#39;</span><span class="p">,</span>
                        <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;ethernet&#39;</span><span class="p">,</span>
                        <span class="n">ipv4</span> <span class="o">=</span> <span class="s1">&#39;1.1.1.1&#39;</span><span class="p">)</span>
<span class="n">interface_b</span> <span class="o">=</span> <span class="n">Interface</span><span class="p">(</span><span class="s1">&#39;Ethernet1/2&#39;</span><span class="p">,</span>
                        <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;ethernet&#39;</span><span class="p">,</span>
                        <span class="n">ipv4</span> <span class="o">=</span> <span class="s1">&#39;1.1.1.2&#39;</span><span class="p">)</span>

<span class="c1"># create your links</span>
<span class="n">link</span> <span class="o">=</span> <span class="n">Link</span><span class="p">(</span><span class="s1">&#39;ethernet-1&#39;</span><span class="p">)</span>

<span class="c1"># now let&#39;s hook up everything together</span>
<span class="c1"># define the relationship.</span>
<span class="n">device</span><span class="o">.</span><span class="n">testbed</span> <span class="o">=</span> <span class="n">testbed</span>
<span class="n">device</span><span class="o">.</span><span class="n">add_interface</span><span class="p">(</span><span class="n">interface_a</span><span class="p">)</span>
<span class="n">device</span><span class="o">.</span><span class="n">add_interface</span><span class="p">(</span><span class="n">interface_b</span><span class="p">)</span>
<span class="n">interface_a</span><span class="o">.</span><span class="n">link</span> <span class="o">=</span> <span class="n">link</span>
<span class="n">interface_b</span><span class="o">.</span><span class="n">link</span> <span class="o">=</span> <span class="n">link</span>
</pre></div>
</div>
<p>Note that in the example above, a very simple testbed of one device and two
interface connected in a loopback configuration is performed. We also gave it
some information w.r.t. how to connect to it, as well as interface ip and tftp
information. Before we bore you out - this didn’t even use up half the available
properties and arguments to creating each testbed object. The point is to show
you that it can be done, though a bit tedious.</p>
<p>Note also that the above approach chose to create all objects first, and then
connecting them together after. You can also choose to do it dynamically, for
example, creating <code class="docutils literal notranslate"><span class="pre">Device</span></code> objects and using its <code class="docutils literal notranslate"><span class="pre">interfaces</span></code> argument to
pass in its interface objects from the start. As well, all object properties,
such as <code class="docutils literal notranslate"><span class="pre">Testbed.tacacs</span></code>, can be updated/changed after object is created.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>testbed object creation should be automatable quite easily. you can write
your own loader classes to do the load of your own custom testbed files.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="concept.html" class="btn btn-neutral float-left" title="Everything is an Object" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usage.html" class="btn btn-neutral float-right" title="Using Topology Objects" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2024, Cisco Systems Inc..
      <span class="lastupdated">Last updated on Dec 27, 2024.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>