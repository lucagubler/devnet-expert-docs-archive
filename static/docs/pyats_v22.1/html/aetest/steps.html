<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Section Steps &mdash; pyATS Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Running TestScripts" href="run.html" />
    <link rel="prev" title="Section Results" href="results.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pyATS
          </a>
              <div class="version">
                24.11
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Main Components</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">AEtest - Test Infrastructure</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure.html">Script Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html">Object Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="behavior.html">Runtime Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html">Test Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="loop.html">Looping Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="results.html">Section Results</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Section Steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-steps">Defining Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-results">Step Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nesting-steps">Nesting Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#details-report">Details &amp; Report</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-debugging">Step Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-objects">Step Objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="run.html">Running TestScripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="processors.html">Section Processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="datafile.html">Datafile Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="control.html">Flow Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="reports.html">Report Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../easypy/index.html">Easypy - Runtime Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology/index.html">Testbed &amp; Topology Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kleenex/index.html">Testbed &amp; Device Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connections/index.html">Connection Meta</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../async/index.html">Asynchronous Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datastructures/index.html">Datastructures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tcl/index.html">Tcl Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../log/index.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results/index.html">Result Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporter/index.html">Reporter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robot/index.html">RobotFramework Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manifest/index.html">Manifest</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../terminology.html">Terminologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/index.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Doc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/index.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyATS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">AEtest - Test Infrastructure</a></li>
      <li class="breadcrumb-item active">Section Steps</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="section-steps">
<span id="aetest-steps"></span><h1>Section Steps<a class="headerlink" href="#section-steps" title="Permalink to this heading">¶</a></h1>
<aside class="sidebar">
<p class="sidebar-title">Helpful Reading</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3.4/reference/datamodel.html#context-managers">Context Manager</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3.4/reference/compound_stmts.html#the-with-statement">The with statement</a></p></li>
</ul>
</aside>
<p>In <code class="docutils literal notranslate"><span class="pre">aetest</span></code>, testscripts are naturally broken down into <code class="docutils literal notranslate"><span class="pre">TestContainers</span></code>
and <code class="docutils literal notranslate"><span class="pre">TestFunctions</span></code>, two-level segments defined in <a class="reference internal" href="objects.html#object-model"><span class="std std-ref">Object Model</span></a>. For
example:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CommonSetup</span></code>: <code class="docutils literal notranslate"><span class="pre">subsection</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Testcase</span></code>: <code class="docutils literal notranslate"><span class="pre">setup</span></code>/<code class="docutils literal notranslate"><span class="pre">test</span></code>/<code class="docutils literal notranslate"><span class="pre">cleanup</span></code></p></li>
</ul>
</div></blockquote>
<p>This two-level approach is mostly sufficient when sections can be kept short &amp;
independent. However, often times, there’s a need for larger, longer sections,
mostly due to nature of the tests being carried out. In these situations, users
can leverage the optional section <code class="docutils literal notranslate"><span class="pre">Steps</span></code> feature: slicing down large
sections into groups of smaller, more granular linear actions that sums up
towards the same testing goal.</p>
<section id="defining-steps">
<h2>Defining Steps<a class="headerlink" href="#defining-steps" title="Permalink to this heading">¶</a></h2>
<p>To divide sections into smaller steps, define section methods with the
<a class="reference internal" href="parameters.html#reserved-parameters"><span class="std std-ref">Reserved Parameters</span></a> <code class="docutils literal notranslate"><span class="pre">steps</span></code> in its function arguments. This enables
steps creation by bringing <code class="docutils literal notranslate"><span class="pre">Steps</span></code> class instance into the local method scope.</p>
<p>Each step is started by calling <code class="docutils literal notranslate"><span class="pre">steps.start()</span></code>, and providing it a short
descriptive name for that new step. A longer description can also be provided,
which will be included in the final report. The returned <a class="reference internal" href="#step-object"><span class="std std-ref">Step Objects</span></a> is a
python <a class="reference external" href="https://docs.python.org/3.4/reference/datamodel.html#context-managers">Context Manager</a>, intended to be consumed by the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   breaking a test section into smaller steps</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="c1"># using a testcase as example</span>
<span class="c1"># applies to all sections (subsection/setup/cleanup/test)</span>
<span class="k">class</span> <span class="nc">NeilArmstrong</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="c1"># define section method with &#39;steps&#39; reserved parameter argument</span>
    <span class="c1"># this enables the engine to pass steps object to the local scope</span>
    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">says</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="c1"># breaking down this test into two steps</span>
        <span class="c1"># using python &quot;with&quot; statement and steps parameter</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;first step&#39;</span><span class="p">,</span>
                         <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;this is the first step&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;one small step for [a] man&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;second step&#39;</span><span class="p">,</span>
                         <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;this is the second step&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;one giant leap for mankind&#39;</span><span class="p">)</span>

<span class="c1"># script output</span>
<span class="c1">#</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                            Starting section says                             |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   :                              STEP 1: first step                              :</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   one small step for [a] man</span>
<span class="c1">#   The result of STEP 1: first step is =&gt; PASSED</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   :                             STEP 2: second step                              :</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   one giant leap for mankind</span>
<span class="c1">#   The result of STEP 2: second step is =&gt; PASSED</span>
<span class="c1">#   +----------------------------------------------------------+</span>
<span class="c1">#   |                       STEPS Report                       |</span>
<span class="c1">#   +----------------------------------------------------------+</span>
<span class="c1">#   STEP 1 - first step                                   Passed</span>
<span class="c1">#   STEP 2 - second step                                  Passed</span>
<span class="c1">#   ------------------------------------------------------------</span>
<span class="c1">#   The result of section says is =&gt; PASSED</span>
</pre></div>
</div>
<p>The usage of <a class="reference external" href="https://docs.python.org/3.4/reference/datamodel.html#context-managers">Context Manager</a> allows each step’s code to properly nest under
its own indentation block, allows the test infrastructure to identify each
step’s boundaries, and allows independent error catching &amp; result handling etc.</p>
<p>In addition, this returned <a class="reference internal" href="#step-object"><span class="std std-ref">Step Objects</span></a> can be stored into variable using
<code class="docutils literal notranslate"><span class="pre">as</span></code> statement, allowing users to access/refer to current step information,
and make calls to result apis:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   referring to the step object</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="k">class</span> <span class="nc">Testcase</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="c1"># create step into &#39;step&#39; variable</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the first step&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">step</span><span class="p">:</span>
            <span class="c1"># eg, each step is automatically assigned a unique,</span>
            <span class="c1"># numeric index number, and can be accessed using the</span>
            <span class="c1"># &quot;index&quot; attribute.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Current step index: &#39;</span><span class="p">,</span> <span class="n">step</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="c1"># Current step index: 1</span>
</pre></div>
</div>
</section>
<section id="step-results">
<h2>Step Results<a class="headerlink" href="#step-results" title="Permalink to this heading">¶</a></h2>
<p>Each step comes with its own result, represented using <a class="reference internal" href="../results/index.html#result-objects"><span class="std std-ref">Result Objects</span></a>.
When a script section is segmented using steps feature, that section’s result is
calculated using the combined roll-up results of all its contained steps.</p>
<p>All other step result behaviors are identical to its parent
<a class="reference internal" href="results.html#aetest-section-results"><span class="std std-ref">Section Results</span></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p>the default result for all steps is <code class="docutils literal notranslate"><span class="pre">Passed</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AssertionError</span></code>: <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#AssertionError">AssertionError</a> exceptions corresponds to <code class="docutils literal notranslate"><span class="pre">Failed</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Exception</span></code>: <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html">Exceptions</a> corresponds to <code class="docutils literal notranslate"><span class="pre">Errored</span></code></p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   step results default</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="k">class</span> <span class="nc">Testcase</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="c1"># default step result -&gt; Passed</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the passed step&#39;</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="c1"># AssertionErrors -&gt; Failed</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the failed step&#39;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test_two</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="c1"># general Exceptions -&gt; Errored</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the errored step&#39;</span><span class="p">):</span>
            <span class="c1"># generate a python error</span>
            <span class="p">{}[</span><span class="s1">&#39;non existent key&#39;</span><span class="p">]</span>

<span class="c1"># script output</span>
<span class="c1">#   note that the result of each test section is the</span>
<span class="c1">#   combined roll-up of its steps. Eg:</span>
<span class="c1">#       test_one: Passed + Failed -&gt; Failed</span>
<span class="c1">#       test_two: Errored         -&gt; Errored</span>
<span class="c1">#</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                          Starting testcase Testcase                          |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                          Starting section test_one                           |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   :                       Starting STEP 1: the passed step                       :</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   The result of STEP 1: the passed step is =&gt; PASSED</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   :                       Starting STEP 2: the failed step                       :</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   An assertion error was caught during step:</span>
<span class="c1">#   Traceback (most recent call last):</span>
<span class="c1">#   File &quot;example.py&quot;, line 14, in test_one</span>
<span class="c1">#       assert 1 == 0</span>
<span class="c1">#   AssertionError</span>
<span class="c1">#   The result of STEP 2: the failed step is =&gt; FAILED</span>
<span class="c1">#   +----------------------------------------------------------+</span>
<span class="c1">#   |                       STEPS Report                       |</span>
<span class="c1">#   +----------------------------------------------------------+</span>
<span class="c1">#   STEP 1 - the passed step                              Passed</span>
<span class="c1">#   STEP 2 - the failed step                              Failed</span>
<span class="c1">#   ------------------------------------------------------------</span>
<span class="c1">#   The result of section test_one is =&gt; FAILED</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                          Starting section test_two                           |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   :                      Starting STEP 1: the errored step                       :</span>
<span class="c1">#   +..............................................................................+</span>
<span class="c1">#   The result of STEP 1: the errored step is =&gt; ERRORED</span>
<span class="c1">#   Caught exception during execution:</span>
<span class="c1">#   Traceback (most recent call last):</span>
<span class="c1">#   File &quot;example.py&quot;, line 22, in test_two</span>
<span class="c1">#       {}[&#39;non existent key&#39;]</span>
<span class="c1">#   KeyError: &#39;non existent key&#39;</span>
<span class="c1">#   +----------------------------------------------------------+</span>
<span class="c1">#   |                       STEPS Report                       |</span>
<span class="c1">#   +----------------------------------------------------------+</span>
<span class="c1">#   STEP 1 - the errored step                            Errored</span>
<span class="c1">#   ------------------------------------------------------------</span>
<span class="c1">#   The result of section test_two is =&gt; ERRORED</span>
<span class="c1">#   The result of testcase Testcase is =&gt; ERRORED</span>
<span class="c1">#   +----------------------------------------------------------------------+</span>
<span class="c1">#   |                            Detailed Results                          |</span>
<span class="c1">#   +----------------------------------------------------------------------+</span>
<span class="c1">#    SECTIONS/TESTCASES                                              RESULT</span>
<span class="c1">#   ------------------------------------------------------------------------</span>
<span class="c1">#    .</span>
<span class="c1">#    `-- Testcase                                                   ERRORED</span>
<span class="c1">#        |-- test_one                                                FAILED</span>
<span class="c1">#        |   |-- Step 1: the passed step                             PASSED</span>
<span class="c1">#        |   |-- Step 2: the failed step                             PASSED</span>
<span class="c1">#        `-- test_two                                               ERRORED</span>
<span class="c1">#            `-- Step 1: the errored step                           ERRORED</span>
</pre></div>
</div>
<p>In addition, the <a class="reference internal" href="#step-object"><span class="std std-ref">Step Objects</span></a> also offers result APIs to that enables
manual assignment of results to each step. Note that these APIs only affect the
current step’s result, and do not have <a class="reference internal" href="control.html#aetest-goto"><span class="std std-ref">Goto</span></a> support.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Step.passed(reason)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Step.failed(reason)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Step.errored(reason)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Step.skipped(reason)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Step.blocked(reason)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Step.aborted(reason)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Step.passx(reason)</span></code></p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   step result APIs</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="k">class</span> <span class="nc">Testcase</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the passed step&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">step</span><span class="p">:</span>
            <span class="c1"># manually provide Passed result</span>
            <span class="n">step</span><span class="o">.</span><span class="n">passed</span><span class="p">(</span><span class="s1">&#39;because i want to&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the failed step&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">step</span><span class="p">:</span>
            <span class="c1"># manually provide Failed result</span>
            <span class="n">step</span><span class="o">.</span><span class="n">failed</span><span class="p">(</span><span class="s1">&#39;because i had to&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, when a step’s result is not <code class="docutils literal notranslate"><span class="pre">Passed</span></code>, <code class="docutils literal notranslate"><span class="pre">Passx</span></code>, or <code class="docutils literal notranslate"><span class="pre">Skipped</span></code>,
all remaining steps are avoided and the engine terminates the current test
section immediately to achieve time-savings. This behavior can be avoided by
providing <code class="docutils literal notranslate"><span class="pre">continue_</span> <span class="pre">=</span> <span class="pre">True</span></code> to <code class="docutils literal notranslate"><span class="pre">steps.start()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   step continuation feature</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="k">class</span> <span class="nc">Testcase</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="c1"># test section that immediately returns after the first step failure</span>
    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test_stopped_due_to_step_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the failed first step&#39;</span><span class="p">):</span>
            <span class="c1"># intentionally cause a failure</span>
            <span class="k">assert</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the step after failed step&#39;</span><span class="p">):</span>
            <span class="c1"># do nothing - this would normally be Passed</span>
            <span class="k">pass</span>

    <span class="c1"># same test content/steps, but using continue_ = True</span>
    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test_continues_after_step_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the failed first step&#39;</span><span class="p">,</span> <span class="n">continue_</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
            <span class="c1"># intentionally cause a failure</span>
            <span class="k">assert</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;the step after failed step&#39;</span><span class="p">):</span>
            <span class="c1"># do nothing - this would normally be Passed</span>
            <span class="k">pass</span>

<span class="c1"># output of script:</span>
<span class="c1">#    note that even though both test failed, the 2nd test ran both steps</span>
<span class="c1">#    because we used continue_ = True to override the default quick-exit</span>
<span class="c1">#    behavior</span>
<span class="c1">#</span>
<span class="c1">#     +------------------------------------------------------------------------------+</span>
<span class="c1">#     |              Starting section test_stopped_due_to_step_failure               |</span>
<span class="c1">#     +------------------------------------------------------------------------------+</span>
<span class="c1">#     +..............................................................................+</span>
<span class="c1">#     :                    Starting STEP 1: the failed first step                    :</span>
<span class="c1">#     +..............................................................................+</span>
<span class="c1">#     An assertion error was caught during step:</span>
<span class="c1">#     Traceback (most recent call last):</span>
<span class="c1">#       File &quot;example.py&quot;, line 10, in test_stopped_due_to_step_failure</span>
<span class="c1">#         assert 1 == 0</span>
<span class="c1">#     AssertionError</span>
<span class="c1">#     The result of STEP 1: the failed first step is =&gt; FAILED</span>
<span class="c1">#     +----------------------------------------------------------+</span>
<span class="c1">#     |                       STEPS Report                       |</span>
<span class="c1">#     +----------------------------------------------------------+</span>
<span class="c1">#     STEP 1 - the failed first step                        Failed</span>
<span class="c1">#     ------------------------------------------------------------</span>
<span class="c1">#     The result of section test_stopped_due_to_step_failure is =&gt; FAILED</span>
<span class="c1">#     +------------------------------------------------------------------------------+</span>
<span class="c1">#     |              Starting section test_continues_after_step_failure              |</span>
<span class="c1">#     +------------------------------------------------------------------------------+</span>
<span class="c1">#     +..............................................................................+</span>
<span class="c1">#     :                    Starting STEP 1: the failed first step                    :</span>
<span class="c1">#     +..............................................................................+</span>
<span class="c1">#     An assertion error was caught during step:</span>
<span class="c1">#     Traceback (most recent call last):</span>
<span class="c1">#       File &quot;example.py&quot;, line 21, in test_continues_after_step_failure</span>
<span class="c1">#         assert 1 == 0</span>
<span class="c1">#     AssertionError</span>
<span class="c1">#     The result of STEP 1: the failed first step is =&gt; FAILED</span>
<span class="c1">#     +..............................................................................+</span>
<span class="c1">#     :                 Starting STEP 2: the step after failed step                  :</span>
<span class="c1">#     +..............................................................................+</span>
<span class="c1">#     The result of STEP 2: the step after failed step is =&gt; PASSED</span>
<span class="c1">#     +----------------------------------------------------------+</span>
<span class="c1">#     |                       STEPS Report                       |</span>
<span class="c1">#     +----------------------------------------------------------+</span>
<span class="c1">#     STEP 1 - the failed first step                        Failed</span>
<span class="c1">#     STEP 2 - the step after failed step                   Passed</span>
<span class="c1">#     ------------------------------------------------------------</span>
<span class="c1">#     The result of section test_continues_after_step_failure is =&gt; FAILED</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">continue</span></code> is a python reserved keyword. Following <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a>, the convention
is to add a trailing underscore: <code class="docutils literal notranslate"><span class="pre">continue_</span></code>.</p>
</div>
</section>
<section id="nesting-steps">
<h2>Nesting Steps<a class="headerlink" href="#nesting-steps" title="Permalink to this heading">¶</a></h2>
<p>Steps can be nested. If a new step is started before the current one finishes,
it is called a <em>child</em> step of the current step. The <code class="docutils literal notranslate"><span class="pre">.</span></code> separator separates
child indexes from the parent index. Nesting steps provides better visual
references &amp; finer granuarity to the steps breakdown.</p>
<p>Nested step results follow the standard rollup rule: each step’s result is the
combined roll-up result of its immediate child steps.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   step nesting example</span>
<span class="c1">#   (using a function for demonstration)</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="c1"># import Steps</span>
<span class="kn">from</span> <span class="nn">pyats.aetest.steps</span> <span class="kn">import</span> <span class="n">Steps</span>

<span class="c1"># defining a function that support child steps.</span>
<span class="c1"># use Steps() as default value for steps, in case the function is called</span>
<span class="c1"># outside the scope of a testscript.</span>
<span class="k">def</span> <span class="nf">myFunction</span><span class="p">(</span><span class="n">steps</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">()):</span>
    <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;function step one&#39;</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;function step two&#39;</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Testcase</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="c1"># demonstrating a step with multiple child steps</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">step</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">step</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1 substep a&#39;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">with</span> <span class="n">step</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1 substep a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">substep</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">substep</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1 sub-step a sub-substep i&#39;</span><span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">with</span> <span class="n">substep</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1 sub-step a sub-substep ii&#39;</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="c1"># demonstrating a step where a function is called, and</span>
        <span class="c1"># the function it self takes a few child steps to complete</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;call function step&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">step</span><span class="p">:</span>
            <span class="c1"># call the function, pass current step into it</span>
            <span class="n">myFunction</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>

<span class="c1"># example output:</span>
<span class="c1">#</span>
<span class="c1">#     +----------------------------------------------------------+</span>
<span class="c1">#     |                       STEPS Report                       |</span>
<span class="c1">#     +----------------------------------------------------------+</span>
<span class="c1">#     STEP 1 - test step 1                                  Passed</span>
<span class="c1">#     STEP 1.1 - test step 1 substep a                      Passed</span>
<span class="c1">#     STEP 1.2 - test step 1 substep a                      Passed</span>
<span class="c1">#     STEP 1.2.1 - test step 1 sub-step a sub-substep i     Passed</span>
<span class="c1">#     STEP 1.2.2 - test step 1 sub-step a sub-substep ii    Passed</span>
<span class="c1">#     STEP 2 - call function step                           Passed</span>
<span class="c1">#     STEP 2.1 - function step one                          Passed</span>
<span class="c1">#     STEP 2.2 - function step two                          Passed</span>
<span class="c1">#     ------------------------------------------------------------</span>
</pre></div>
</div>
</section>
<section id="details-report">
<h2>Details &amp; Report<a class="headerlink" href="#details-report" title="Permalink to this heading">¶</a></h2>
<p>When steps are created within script sections, a <em>STEPS Report</em> is always logged
at the end of that section. This provides visual details in the log file on
<strong>all</strong> steps taken during this section, their names and corresponding results.</p>
<p>This information can also be accessed during runtime using steps attributes:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">report()</span></code></dt><dd><p>generate the same steps report based on the current step and all of its
child steps. This allows users to generate a sliced view the whole picture.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">details</span></code></dt><dd><p><em>read-only</em> property, returns a list of <code class="docutils literal notranslate"><span class="pre">StepDetail</span></code> <a class="reference external" href="https://docs.python.org/3.4/library/collections.html#collections.namedtuple">namedtuple</a> objects,
listing out the current step and all of its child step information. Each
<code class="docutils literal notranslate"><span class="pre">StepDetail</span></code> contains the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> - step index string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - step name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">result</span></code> - step result</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   accessing step details &amp; localized reports</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="c1"># import Steps</span>
<span class="kn">from</span> <span class="nn">pyats.aetest.steps</span> <span class="kn">import</span> <span class="n">Steps</span>

<span class="k">class</span> <span class="nc">Testcase</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>

        <span class="c1"># creating a step monster</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">step</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">step</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1 substep a&#39;</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">with</span> <span class="n">step</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1 substep a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">substep</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">substep</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1 sub-step a sub-substep i&#39;</span><span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">with</span> <span class="n">substep</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;test step 1 sub-step a sub-substep ii&#39;</span><span class="p">):</span>
                    <span class="k">pass</span>

                <span class="c1"># access local step information/report</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">substep</span><span class="o">.</span><span class="n">details</span><span class="p">)</span>
                <span class="n">substep</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>

        <span class="c1"># access overall step details:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">steps</span><span class="o">.</span><span class="n">details</span><span class="p">)</span>

<span class="c1"># output of example</span>
<span class="c1">#    note the StepDetails printout, and the first STEPS Report (on substep)</span>
<span class="c1">#</span>
<span class="c1">#    +------------------------------------------------------------------------------+</span>
<span class="c1">#    |                            Starting section test                             |</span>
<span class="c1">#    +------------------------------------------------------------------------------+</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    :                         Starting STEP 1: test step 1                         :</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    :                   Starting STEP 1.1: test step 1 substep a                   :</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    The result of STEP 1.1: test step 1 substep a is =&gt; PASSED</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    :                   Starting STEP 1.2: test step 1 substep a                   :</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    :          Starting STEP 1.2.1: test step 1 sub-step a sub-substep i           :</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    The result of STEP 1.2.1: test step 1 sub-step a sub-substep i is =&gt; PASSED</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    :          Starting STEP 1.2.2: test step 1 sub-step a sub-substep ii          :</span>
<span class="c1">#    +..............................................................................+</span>
<span class="c1">#    The result of STEP 1.2.2: test step 1 sub-step a sub-substep ii is =&gt; PASSED</span>
<span class="c1"># -&gt; [StepDetail(index=&#39;1.2&#39;, name=&#39;test step 1 substep a&#39;, result=Passed),</span>
<span class="c1"># -&gt;  StepDetail(index=&#39;1.2.1&#39;, name=&#39;test step 1 sub-step a sub-substep i&#39;, result=Passed),</span>
<span class="c1"># -&gt;  StepDetail(index=&#39;1.2.2&#39;, name=&#39;test step 1 sub-step a sub-substep ii&#39;, result=Passed)]</span>
<span class="c1">#    +----------------------------------------------------------+</span>
<span class="c1">#    |                       STEPS Report                       |</span>
<span class="c1">#    +----------------------------------------------------------+</span>
<span class="c1">#    STEP 1.2 - test step 1 substep a                      Passed</span>
<span class="c1">#    STEP 1.2.1 - test step 1 sub-step a sub-substep i     Passed</span>
<span class="c1">#    STEP 1.2.2 - test step 1 sub-step a sub-substep ii    Passed</span>
<span class="c1">#    ------------------------------------------------------------</span>
<span class="c1">#    The result of STEP 1.2: test step 1 substep a is =&gt; PASSED</span>
<span class="c1">#    The result of STEP 1: test step 1 is =&gt; PASSED</span>
<span class="c1"># -&gt; [StepDetail(index=&#39;1&#39;, name=&#39;test step 1&#39;, result=Passed),</span>
<span class="c1"># -&gt;  StepDetail(index=&#39;1.1&#39;, name=&#39;test step 1 substep a&#39;, result=Passed),</span>
<span class="c1"># -&gt;  StepDetail(index=&#39;1.2&#39;, name=&#39;test step 1 substep a&#39;, result=Passed),</span>
<span class="c1"># -&gt;  StepDetail(index=&#39;1.2.1&#39;, name=&#39;test step 1 sub-step a sub-substep i&#39;, result=Passed),</span>
<span class="c1"># -&gt;  StepDetail(index=&#39;1.2.2&#39;, name=&#39;test step 1 sub-step a sub-substep ii&#39;, result=Passed)]</span>
<span class="c1">#    +----------------------------------------------------------+</span>
<span class="c1">#    |                       STEPS Report                       |</span>
<span class="c1">#    +----------------------------------------------------------+</span>
<span class="c1">#    STEP 1 - test step 1                                  Passed</span>
<span class="c1">#    STEP 1.1 - test step 1 substep a                      Passed</span>
<span class="c1">#    STEP 1.2 - test step 1 substep a                      Passed</span>
<span class="c1">#    STEP 1.2.1 - test step 1 sub-step a sub-substep i     Passed</span>
<span class="c1">#    STEP 1.2.2 - test step 1 sub-step a sub-substep ii    Passed</span>
<span class="c1">#    ------------------------------------------------------------</span>
</pre></div>
</div>
</section>
<section id="step-debugging">
<h2>Step Debugging<a class="headerlink" href="#step-debugging" title="Permalink to this heading">¶</a></h2>
<p>Step debugging is an optional value-add to steps. It allows the user to send
cli commands to currently connected testbed devices and/or run custom debugging
functions before and after each step, without modifying the testscript.</p>
<p>To use step debugging, a <em>step debug input file</em> (in <a class="reference external" href="http://www.yaml.org/spec/1.2/spec.html">YAML</a> format) needs to be
provided to <code class="docutils literal notranslate"><span class="pre">aetest</span></code>. The content of this file specifies where during script
execution &amp; what clis to send to which testbed devices and which functions to
run.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Schema</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1"># step debug input file</span>

<span class="nt">extends</span><span class="p">:</span><span class="w">    </span><span class="c1"># Step debug file(s) to extend/build on.</span>
<span class="w">            </span><span class="c1"># Use this field to extend an existing yaml step debug file,</span>
<span class="w">            </span><span class="c1"># allowing you to create an inheritance hierarchy.</span>
<span class="w">            </span><span class="c1"># Supports full path/names or name of file in the same dir.</span>
<span class="w">            </span><span class="c1"># The content of the last file on the list forms the base and</span>
<span class="w">            </span><span class="c1"># is updated with the preceding file, and so on,</span>
<span class="w">            </span><span class="c1"># until the existing file content is updated last.</span>
<span class="w">            </span><span class="c1"># (optional)</span>

<span class="nt">&lt;step_name&gt;</span><span class="p">:</span><span class="w">  </span><span class="c1"># A regular expression of the step name</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">when</span><span class="p">:</span><span class="w">   </span><span class="c1"># A list that is consist of &#39;start&#39;, &#39;end&#39; or any result type,</span>
<span class="w">              </span><span class="c1"># like &#39;passed&#39;</span>
<span class="w">              </span><span class="c1"># (mandatory)</span>
<span class="w">      </span><span class="nt">device</span><span class="p">:</span><span class="w"> </span><span class="c1"># List of devices that will be passed to the functions and</span>
<span class="w">              </span><span class="c1"># will run the commands.</span>
<span class="w">              </span><span class="c1"># (mandatory)</span>
<span class="w">      </span><span class="nt">cmd</span><span class="p">:</span><span class="w">    </span><span class="c1"># List of cli commands to be run on devices,</span>
<span class="w">              </span><span class="c1"># (optional)</span>
<span class="w">      </span><span class="nt">func</span><span class="p">:</span><span class="w">   </span><span class="c1"># Functions list,</span>
<span class="w">              </span><span class="c1"># (optional)</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1"># step debug input file</span>

<span class="nt">step.*</span><span class="p">:</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">when</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;start&#39;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;failed&#39;</span>

<span class="w">      </span><span class="nt">device</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;device.*&#39;</span>

<span class="w">      </span><span class="nt">cmd</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;mycommand1&#39;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;my_command2&#39;</span>

<span class="w">      </span><span class="nt">func</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;path.to.myscript.myfunction1&#39;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;path.to.myscript.myfunction2&#39;</span>


<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">when</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;end&#39;</span>

<span class="w">      </span><span class="nt">device</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;device1&#39;</span>

<span class="w">      </span><span class="nt">cmd</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;my_command&#39;</span>

<span class="w">      </span><span class="nt">func</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;path.to.myscript.myfunction1&#39;</span>
</pre></div>
</div>
<p>In essence, the step debug engine matches the following items:</p>
<blockquote>
<div><ul class="simple">
<li><p>the current step name as a regular expression</p></li>
<li><p>a particular action:</p>
<ul>
<li><p>when encountering a result type using keyword in <code class="docutils literal notranslate"><span class="pre">when</span></code>, for example:
<code class="docutils literal notranslate"><span class="pre">when('failed')</span></code></p></li>
<li><p>before/after the step using action keyword “start”, “end”
<code class="docutils literal notranslate"><span class="pre">when(&quot;start&quot;,</span> <span class="pre">&quot;end&quot;)</span></code></p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p>and sends a list of cli commands to the given devices. The output of each
command (regardless of error) is then logged to log file for debugging purposes.
Also, users can provide functions/callables to run with the <code class="docutils literal notranslate"><span class="pre">func</span></code> keyword.</p>
<p>The step debug YAML file is provided to <code class="docutils literal notranslate"><span class="pre">aetest</span></code> execution using the
<a class="reference internal" href="run.html#aetest-standard-arguments"><span class="std std-ref">Standard Arguments</span></a> <code class="docutils literal notranslate"><span class="pre">-step_debug</span></code>. Upon the start of execution,
the input file is loaded &amp; parsed. If there is a missing information in this
file that is mandatory, an exception is thrown. If there are some wrong
information in the file such as wrong device name or step name, it is just
ignored.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># standalone execution example
python my_testscript.py -step_debug /path/to/my/stepDebugInput.yaml
</pre></div>
</div>
<p>Due to the string matching nature of step debug engine, <a class="reference external" href="http://www.regular-expressions.info/tutorial.html">regular expressions</a>
are supported for step names and device names.</p>
<p>About the keys:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">when</span></code> and <code class="docutils literal notranslate"><span class="pre">device</span></code> keys are mandatory in the step debug file. <code class="docutils literal notranslate"><span class="pre">cmd</span></code>
and <code class="docutils literal notranslate"><span class="pre">func</span></code> are optional and can be provided together.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">cmd</span></code> and <code class="docutils literal notranslate"><span class="pre">func</span></code> are provided together, the cli commands are first
executed in turn on matching devices and only then are the functions are
called on each device in turn.</p></li>
<li><p>“func” parameter is not limited to just functions, it actually accepts any
kind of python callable object(such as classes).</p></li>
</ul>
</div></blockquote>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When a function is provided there are 3 keywords that step debug engine is
using. If function accepts “section” variable, engine sends the current
section object to the function, if “step” is defined then the current step
object will also be sent. All of the matching devices are passed to the
function one by one, if there is “device” within the function parameters.</p>
<p>If there is a kwargs in the parameters of the function then all of the 3
parameters above will be passed via kwargs.</p>
</div>
<hr class="docutils" />
</section>
<section id="step-objects">
<span id="step-object"></span><h2>Step Objects<a class="headerlink" href="#step-objects" title="Permalink to this heading">¶</a></h2>
<p>Step feature is internally implemented using two classes:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Steps</span></code></dt><dd><p>base container class, containing one or more <code class="docutils literal notranslate"><span class="pre">Step</span></code>. Allows the creation,
reporting and handling of more steps within. The <code class="docutils literal notranslate"><span class="pre">steps</span></code> parameter
passed to each section function is an instance of this class.</p>
</dd>
</dl>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+--------------------------------------------------------------------------+
| Steps                                                                    |
+==========================================================================+
| attribute       | description                                            |
|-----------------+--------------------------------------------------------|
| start           | starts a new step. returns Step instance               |
| result          | roll-up result of all steps contained                  |
| report          | reports current step details/results to log file       |
| steps           | list of Step objects representing each step taken      |
+==========================================================================+
| properties      | description                                            |
|-----------------+--------------------------------------------------------|
| details         | list of steps details using StepDetail namedtuple      |
+--------------------------------------------------------------------------+
</pre></div>
</div>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">Step</span></code></dt><dd><p>extends the base <code class="docutils literal notranslate"><span class="pre">Steps</span></code> class. <code class="docutils literal notranslate"><span class="pre">Step</span></code> is a <a class="reference external" href="https://docs.python.org/3.4/reference/datamodel.html#context-managers">Context Manager</a>, intended
to be used in conjunction with python <code class="docutils literal notranslate"><span class="pre">with</span></code> statement. This is the
workhorse class that offers:</p>
<blockquote>
<div><ul class="simple">
<li><p>result apis: manually providing results to each step</p></li>
<li><p>error/exception handling: assigns corresponding results to the current
step in case of abnormality.</p></li>
<li><p>continue on fail (<code class="docutils literal notranslate"><span class="pre">continue_</span></code>) feature</p></li>
<li><p>etc.</p></li>
</ul>
</div></blockquote>
<p>Inheriting base class <code class="docutils literal notranslate"><span class="pre">Steps</span></code> enables steps nesting.</p>
</dd>
</dl>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+--------------------------------------------------------------------------+
| Step  (basecls: Steps)                                                   |
+==========================================================================+
| attribute       | description                                            |
|-----------------+--------------------------------------------------------|
| start           | starts a new child step. returns Step instance         |
| result          | roll-up result of this step and all child steps ned    |
| report          | reports current step details/results to log file       |
| steps           | list of child Step objects                             |
| description     | description of this step instance                      |
+==========================================================================+
| properties      | description                                            |
|-----------------+--------------------------------------------------------|
| details         | list of steps details using StepDetail namedtuple      |
+==========================================================================+
| result apis     | description                                            |
|-----------------+--------------------------------------------------------|
| passed          | provides passed result to this step                    |
| failed          | provides failed result to this step                    |
| aborted         | provides aborted result to this step                   |
| blocked         | provides blocked result to this step                   |
| skipped         | provides skipped result to this step                   |
| errored         | provides errored result to this step                   |
| passx           | provides passx result to this step                     |
+==========================================================================+
| built-in        | description                                            |
|-----------------+--------------------------------------------------------|
| __enter__       | method called with starting step through with statement|
| __exit__        | method called with exiting step through with statement |
+--------------------------------------------------------------------------+
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the above is for reference only. Do not modify internals during runtime.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>intentionally modifying non-passing results to <code class="docutils literal notranslate"><span class="pre">Passed</span></code> is cheating. May
be considered a C.L.M.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="results.html" class="btn btn-neutral float-left" title="Section Results" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="run.html" class="btn btn-neutral float-right" title="Running TestScripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2024, Cisco Systems Inc..
      <span class="lastupdated">Last updated on Dec 27, 2024.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>