<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Debugging Resources &mdash; pyATS Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Report Details" href="reports.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pyATS
          </a>
              <div class="version">
                24.11
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Main Components</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">AEtest - Test Infrastructure</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure.html">Script Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html">Object Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="behavior.html">Runtime Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html">Test Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="loop.html">Looping Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="results.html">Section Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="steps.html">Section Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="run.html">Running TestScripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="processors.html">Section Processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="datafile.html">Datafile Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="control.html">Flow Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="reports.html">Report Details</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Debugging Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pdb-multiprocessing">PDB &amp; Multiprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pdb-on-failure">PDB on Failure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pause-on-phrase">Pause on Phrase</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../easypy/index.html">Easypy - Runtime Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology/index.html">Testbed &amp; Topology Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kleenex/index.html">Testbed &amp; Device Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connections/index.html">Connection Meta</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../async/index.html">Asynchronous Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datastructures/index.html">Datastructures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tcl/index.html">Tcl Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../log/index.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results/index.html">Result Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporter/index.html">Reporter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robot/index.html">RobotFramework Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manifest/index.html">Manifest</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../terminology.html">Terminologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/index.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Doc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/index.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyATS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">AEtest - Test Infrastructure</a></li>
      <li class="breadcrumb-item active">Debugging Resources</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="debugging-resources">
<h1>Debugging Resources<a class="headerlink" href="#debugging-resources" title="Permalink to this heading">¶</a></h1>
<aside class="sidebar">
<p class="sidebar-title">Helpful Reading</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/pdb.html">The Python Debugger</a></p></li>
<li><p><a class="reference internal" href="../resources/debugging.html#resources-debugging-python"><span class="std std-ref">Debugging Python</span></a></p></li>
<li><p><a class="reference internal" href="../resources/testbench.html#testbench"><span class="std std-ref">Test Bench Development</span></a></p></li>
</ul>
</aside>
<blockquote>
<div><p><em>If only we wrote perfect code from the get-go…</em></p>
</div></blockquote>
<p>This section describes in detail AEtest built-in tools that may be useful during
your quest on zapping those pesty bugs. Keep in mind that there may be more
than one way to debug something: the following are supplements to any existing
public ways of debugging python code.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>there is <strong>no magic</strong>: the AEtest engine is <strong>purely</strong> developed in python.</p>
</div>
<section id="pdb-multiprocessing">
<span id="mutiprocess-pdb"></span><h2>PDB &amp; Multiprocessing<a class="headerlink" href="#pdb-multiprocessing" title="Permalink to this heading">¶</a></h2>
<p>Python’s native interactive source code debugger <code class="docutils literal notranslate"><span class="pre">pdb</span></code> is quite powerful when
it comes to zapping bugs: setting breakpoints, stepping code, inspecting stack
frames &amp; such. This documentation is not going to cover the use of it: for all
intents and purposes, read the official documentation: <a class="reference external" href="https://docs.python.org/3/library/pdb.html">The Python Debugger</a>.</p>
<p>However, one thing to note is that <code class="docutils literal notranslate"><span class="pre">pdb</span></code> does not play well with python
<a class="reference external" href="https://docs.python.org/3.4/library/multiprocessing.html">Multiprocessing</a> module. When <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> forks a child process,
it closes the <code class="docutils literal notranslate"><span class="pre">stdin</span></code> as part of the default child process bootstrap. Thus,
as <code class="docutils literal notranslate"><span class="pre">pdb</span></code> relies on <code class="docutils literal notranslate"><span class="pre">stdin</span></code> to provide an interactive session, it crashes
with the following cryptic exception:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/auto/pysw/cel63/python/3.4.1/lib/python3.4/multiprocessing/process.py&quot;, line 254, in _bootstrap
    self.run()
  File &quot;/auto/pysw/cel63/python/3.4.1/lib/python3.4/multiprocessing/process.py&quot;, line 93, in run
    self._target(*self._args, **self._kwargs)
  File &quot;&lt;stdin&gt;&quot;, line 2, in func
  File &quot;/auto/pysw/cel63/python/3.4.1/lib/python3.4/bdb.py&quot;, line 52, in trace_dispatch
    return self.dispatch_return(frame, arg)
  File &quot;/auto/pysw/cel63/python/3.4.1/lib/python3.4/bdb.py&quot;, line 96, in dispatch_return
    if self.quitting: raise BdbQuit
bdb.BdbQuit
</pre></div>
</div>
<p>This error can be typically seen when trying to use <code class="docutils literal notranslate"><span class="pre">pdb</span></code> in your script while
it ran under <a class="reference internal" href="run.html#aetest-jobfile-execution"><span class="std std-ref">Easypy Execution</span></a> (as a Task/subprocess), forcing you
to <em>debug the debugger</em> for hours…</p>
<p>Luckily, there are a few known ways to workaround this problem:</p>
<ol class="arabic">
<li><p>Open <code class="docutils literal notranslate"><span class="pre">/dev/stdin</span></code> manually in child process before launching pdb, or use
the following <code class="docutils literal notranslate"><span class="pre">ForkedPdb</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pdb</span>

<span class="k">class</span> <span class="nc">ForkedPdb</span><span class="p">(</span><span class="n">pdb</span><span class="o">.</span><span class="n">Pdb</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;A Pdb subclass that may be used</span>
<span class="sd">    from a forked multiprocessing child</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">_stdin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/dev/stdin&#39;</span><span class="p">)</span>
            <span class="n">pdb</span><span class="o">.</span><span class="n">Pdb</span><span class="o">.</span><span class="n">interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="n">_stdin</span>

<span class="c1"># to use:</span>
<span class="n">ForkedPdb</span><span class="p">()</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Use Easypy Task argument <code class="docutils literal notranslate"><span class="pre">pdb</span> <span class="pre">=</span> <span class="pre">True</span></code>, which automatically opens
<code class="docutils literal notranslate"><span class="pre">/dev/stdin</span></code> in the given task process, and also turning on
<a class="reference internal" href="#aetest-pdb"><span class="std std-ref">PDB on Failure</span></a>.</p></li>
<li><p>Use a multiprocesss-aware debugger like <a class="reference external" href="http://manpages.ubuntu.com/manpages/bionic/man1/winpdb.1.html">Winpdb</a></p></li>
<li><p>Any other creative methods you may cook-up :-)</p></li>
</ol>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><strong>StackOverflow</strong> is your friend: <a class="reference external" href="http://stackoverflow.com/questions/4716533">http://stackoverflow.com/questions/4716533</a></p>
</div>
</section>
<section id="pdb-on-failure">
<span id="aetest-pdb"></span><h2>PDB on Failure<a class="headerlink" href="#pdb-on-failure" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">pdb</span></code> is golden, but putting <code class="docutils literal notranslate"><span class="pre">pdb</span></code> everywhere in your scripts and
libraries trying to catch a runaway bug is… not pretty. There are
times where you can’t seem to figure out what, where, and why an exception is
raised, why your script is failing, and where to put
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pdb;</span> <span class="pre">pdb.set_trace()</span></code>…</p>
<blockquote>
<div><p><em>PDB on Failure to the rescue!</em></p>
</div></blockquote>
<p>When AEtest scripts are run with the flag <code class="docutils literal notranslate"><span class="pre">pdb</span> <span class="pre">=</span> <span class="pre">True</span></code>, whenever an error,
failure, or exception is encountered during execution, the testing engine
pauses and starts an interactive <a class="reference external" href="https://docs.python.org/3.4/library/pdb.html#pdb.post_mortem">post_mortem</a> debugging session
at the stack frame of failure.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Additionally to <code class="docutils literal notranslate"><span class="pre">pdb</span> <span class="pre">=</span> <span class="pre">True</span></code>, pyATS debugging supports any debugger that
has post_mortem capabilities. Want to use <code class="docutils literal notranslate"><span class="pre">pudb</span></code>? Set <code class="docutils literal notranslate"><span class="pre">pdb</span> <span class="pre">=</span> <span class="pre">'pudb'</span></code>.
Want to use <code class="docutils literal notranslate"><span class="pre">web-pdb</span></code>? Set <code class="docutils literal notranslate"><span class="pre">pdb</span> <span class="pre">=</span> <span class="pre">'web_pdb'</span></code>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1"># PDB on Failure demonstration</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="k">class</span> <span class="nc">CommonSetup</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">CommonSetup</span><span class="p">):</span>
    <span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
    <span class="k">def</span> <span class="nf">subsection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">TestcaseOne</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">setup</span>
    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># raise an exception by calling something that doesn&#39;t exist</span>
        <span class="n">blablabla</span><span class="p">()</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">cleanup</span>
    <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">CommonCleanup</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">CommonCleanup</span><span class="p">):</span>
    <span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
    <span class="k">def</span> <span class="nf">subsection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="n">aetest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">pdb</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># output result:</span>
<span class="c1">#</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># |                            Starting common setup                             |</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># |                        Starting subsection subsection                        |</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># The result of subsection subsection is =&gt; PASSED</span>
<span class="c1"># The result of common setup is =&gt; PASSED</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># |                        Starting testcase TestcaseOne                         |</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># |                            Starting section setup                            |</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># The result of section setup is =&gt; PASSED</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># |                            Starting section test                             |</span>
<span class="c1"># +------------------------------------------------------------------------------+</span>
<span class="c1"># Caught exception during execution:</span>
<span class="c1"># Traceback (most recent call last):</span>
<span class="c1">#   File &quot;a.py&quot;, line 16, in test</span>
<span class="c1">#     blablabla()</span>
<span class="c1"># NameError: name &#39;blablabla&#39; is not defined</span>
<span class="c1"># &gt; example_pdb_on_failure.py(16)test()</span>
<span class="c1"># &gt; blablabla()</span>
<span class="c1"># (Pdb)</span>
<span class="c1">#</span>
</pre></div>
</div>
<p>The interactive debugging session starts with <code class="docutils literal notranslate"><span class="pre">(pdb)</span></code> prompt, and waits for
user input. Refer to <a class="reference external" href="https://docs.python.org/3.4/library/pdb.html#debugger-commands">Debugger Commands</a> for details on how to use the <code class="docutils literal notranslate"><span class="pre">pdb</span></code>
debugger.</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">pdb</span></code> from the command line by including <code class="docutils literal notranslate"><span class="pre">--pdb</span></code>. This will
drop you into the default Python pdb debugger. If you have a third-party debugger
installed that supports post_mortem you can specify it like so <code class="docutils literal notranslate"><span class="pre">--pdb</span> <span class="pre">&lt;debugger&gt;</span></code>.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyats</span> <span class="n">run</span> <span class="n">job</span> <span class="n">job</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">pdb</span>
<span class="n">pyats</span> <span class="n">run</span> <span class="n">job</span> <span class="n">job</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">pdb</span> <span class="n">pudb</span>
<span class="n">pyats</span> <span class="n">run</span> <span class="n">job</span> <span class="n">job</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">pdb</span> <span class="n">web_pdb</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>submitting a testscript to sanity/regression with <code class="docutils literal notranslate"><span class="pre">pdb</span> <span class="pre">=</span> <span class="pre">True</span></code> may be
career-limiting.</p>
</div>
</section>
<section id="pause-on-phrase">
<span id="aetest-pause-on-phase"></span><h2>Pause on Phrase<a class="headerlink" href="#pause-on-phrase" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">pdb;</span> <span class="pre">pdb.set_trace()</span></code> and <a class="reference internal" href="#aetest-pdb"><span class="std std-ref">PDB on Failure</span></a> features both have its
limitations: the first requires editing the script, and the second only pauses
when an exception or non-passing result occurs. What about cases where you just
want to pause the testscript execution somewhere &amp; check the current state
and/or configuration of your environment, logs, and testbed devices?</p>
<p>The <strong>pause on phrase</strong> feature allows you to pause on <strong>any</strong> log messages
generated by the current script run, without requiring any modifications to the
scripts and/or its libraries. When enabled, it actively filters all log messages
propagated to the <code class="docutils literal notranslate"><span class="pre">logging.root</span></code> logger, and pauses when a match is found.</p>
<p>Three distinct types of pause actions are supported:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">email</span></code></dt><dd><p>pauses, creates a <em>pause file</em> and notifies the user via email. Deleting
this file (or after a set timeout value is reached) resumes the script
execution.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pdb</span></code></dt><dd><p>pauses and opens a Python <a class="reference external" href="https://docs.python.org/3.4/library/pdb.html">Pdb Debugger</a> at the caller stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">code</span></code></dt><dd><p>pauses and opens a Python <a class="reference external" href="https://docs.python.org/3.4/tutorial/interpreter.html#interactive-mode">Interactive Shell</a> at the caller stack.</p>
</dd>
</dl>
<p>To enable this feature, provide the <code class="docutils literal notranslate"><span class="pre">pause_on</span></code> (see
<a class="reference internal" href="run.html#aetest-standard-arguments"><span class="std std-ref">Standard Arguments</span></a>) to your script run with one of the following
types of values:</p>
<blockquote>
<div><ul class="simple">
<li><p>full path &amp; name to a YAML input file, satisfying the schema described
below, <strong>or</strong></p></li>
<li><p>the content of said YAML file, in corresponding dictionary format, <strong>or</strong></p></li>
<li><p>a regex string for the engine to look and pause on.</p></li>
</ul>
</div></blockquote>
<p>The following schema describes the YAML pause file format:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pause On Phrase YAML Schema</span>
<span class="c1"># ---------------------------</span>

<span class="nt">timeout</span><span class="p">:</span><span class="w">    </span><span class="c1"># timeout value in seconds (int)</span>
<span class="w">            </span><span class="c1"># specifies the max pause time before the script resumes</span>
<span class="w">            </span><span class="c1"># execution automatically. Set to 0 to wait indefinitely.</span>
<span class="w">            </span><span class="c1"># (only applies to email action)</span>
<span class="w">            </span><span class="c1"># (default: 0)</span>
<span class="w">            </span><span class="c1"># (optional)</span>

<span class="nt">action</span><span class="p">:</span><span class="w">     </span><span class="c1"># action to be performed on pause (email/pdb/code)</span>
<span class="w">            </span><span class="c1"># choose to either send user a notification email, provide a</span>
<span class="w">            </span><span class="c1"># pdb debugger, or an interactive code shell on pause.</span>
<span class="w">            </span><span class="c1"># (disables timeout value when action is pdb or code)</span>
<span class="w">            </span><span class="c1"># (default: email)</span>
<span class="w">            </span><span class="c1"># (optional)</span>

<span class="nt">patterns</span><span class="p">:</span><span class="w">   </span><span class="c1"># patterns to search &amp; pause on (list)</span>
<span class="w">            </span><span class="c1"># each list item needs to follow a particular structure as below</span>
<span class="w">            </span><span class="c1"># (mandatory)</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w">      </span><span class="c1"># pattern to pause on (str)</span>
<span class="w">                    </span><span class="c1"># this is internally compiled into a regex pattern used</span>
<span class="w">                    </span><span class="c1"># to match log messages with</span>
<span class="w">                    </span><span class="c1"># (mandatory)</span>

<span class="w">      </span><span class="nt">section</span><span class="p">:</span><span class="w">      </span><span class="c1"># section/uid to enable pattern searching (str)</span>
<span class="w">                    </span><span class="c1"># this is internally compiled into regex, used</span>
<span class="w">                    </span><span class="c1"># to match the current executing section uid</span>
<span class="w">                    </span><span class="c1"># note that you can use Testcase.setup to denote setup</span>
<span class="w">                    </span><span class="c1"># section of a testcase, etc.</span>
<span class="w">                    </span><span class="c1"># (if not provided, the pattern is used globally)</span>
<span class="w">                    </span><span class="c1"># (optional)</span>
</pre></div>
</div>
<p>Normally, the default action is <code class="docutils literal notranslate"><span class="pre">email</span></code>: when the script is paused after
matching a log phrase, it sends a notification email to the current
executing user, including with it the instructions on how to resume execution
(eg, remove the pause file).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the execution is paused in <code class="docutils literal notranslate"><span class="pre">email</span></code> mode and the pause file is modified,
timer will be disabled and execution will be paused until the pause file is
deleted.</p>
</div>
<p>However, if the action is set to <code class="docutils literal notranslate"><span class="pre">pdb</span></code> or <code class="docutils literal notranslate"><span class="pre">code</span></code>, the script pauses
and provides an interactive python debugger/shell to the user, allowing for
look-arounds, debugs &amp; etc. <em>Be careful with what you do in these modes:</em>
modifications persist when the script continues.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>use <code class="docutils literal notranslate"><span class="pre">Ctrl-D</span></code> to resume from interactive shell, and <code class="docutils literal notranslate"><span class="pre">c</span></code> to resume from
pdb.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>timeout counter is not active/disregarded in pdb/interactive mode.</p>
</div>
<p>Here’s an example YAML pause file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   yaml input pause file</span>

<span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">600</span><span class="w">        </span><span class="c1"># pause a maximum of 10 minutes</span>

<span class="nt">patterns</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;.*pass.*&#39;</span><span class="w">           </span><span class="c1"># pause on all log messages including</span>
<span class="w">                                    </span><span class="c1"># .*pass.* in them globally</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;.*state:</span><span class="nv"> </span><span class="s">down.*&#39;</span><span class="w">    </span><span class="c1"># pause whenever  &#39;state: down&#39; is found</span>
<span class="w">      </span><span class="nt">section</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;^common_setup\..*$&#39;</span><span class="w"> </span><span class="c1"># enable for all common_setup sections</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;.*should</span><span class="nv"> </span><span class="s">pause.*&#39;</span><span class="w">      </span><span class="c1"># pause whenever &#39;should pause&#39; is found</span>
<span class="w">      </span><span class="nt">section</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;^TestcaseTwo\.setup$&#39;</span><span class="w">  </span><span class="c1"># pause on TestcaseTwo setup section</span>
</pre></div>
</div>
<p>Keep in mind that the content of YAML seamlessly translates to Python <code class="docutils literal notranslate"><span class="pre">dict</span></code>
types. Therefore, as a convenience feature, it is also possible to use the
content of a YAML file in its dict format as input to <code class="docutils literal notranslate"><span class="pre">pause_on</span></code> instead of
a file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   dict format corresponding to the above</span>

<span class="n">pause_on</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
            <span class="s1">&#39;patterns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;.*pass.*&#39;</span><span class="p">},</span>
                         <span class="p">{</span><span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;.*state: down.*&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;section&#39;</span><span class="p">:</span> <span class="s1">&#39;^common_setup\..*$&#39;</span><span class="p">},</span>
                         <span class="p">{</span><span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;.*should pause.*&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;section&#39;</span><span class="p">:</span> <span class="s1">&#39;^TestcaseTwo\.setup$&#39;</span><span class="p">}]}</span>

<span class="c1"># command-line call</span>
<span class="c1"># -----------------</span>
<span class="c1">#   python testscript.py -pause_on=&quot;{&#39;timeout&#39;: 600,\</span>
<span class="c1">#                                    &#39;patterns&#39;: [{&#39;pattern&#39;: &#39;.*pass.*&#39;},\</span>
<span class="c1">#                                                 {&#39;pattern&#39;: &#39;.*state: down.*&#39;,\</span>
<span class="c1">#                                                  &#39;section&#39;: &#39;^common_setup\..*$&#39;},\</span>
<span class="c1">#                                                 {&#39;pattern&#39;: &#39;.*should pause.*&#39;,\</span>
<span class="c1">#                                                  &#39;section&#39;: &#39;^TestcaseTwo\.setup$&#39;}]}&quot;</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>if your pause regex patterns are extremely generic, eg, <code class="docutils literal notranslate"><span class="pre">.*</span></code>, it
pauses … a <strong>lot</strong>. However, if multiple regex matches to the same log
message, the engine is pretty smart about only pausing once, and avoiding
duplicated pauses on this same message.</p>
</div>
<p>In addition, as a convenience measure, it is also possible to simply provide a
<em>string</em> to the <code class="docutils literal notranslate"><span class="pre">pause_on</span></code> argument. This <em>simplified</em> input mode is mostly intended
for local debugging sessions, avoiding the need to use a properly formatted
dictionary or YAML file. As this is solely intended for interactive debugging,
the default action with simplified input mode is <code class="docutils literal notranslate"><span class="pre">pdb</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Example
# -------
#
#   using simple string regex inputs

# pause on all instances of &#39;some phrase&#39;
bash$ python testscript.py -pause_on=&#39;.*some phrase.*&#39;
</pre></div>
</div>
<p>Below are some examples of the pause on phrase feature in action:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1</span>
<span class="c1"># ---------</span>
<span class="c1">#</span>
<span class="c1">#   pause on phrase with code action</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">CommonSetup</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">CommonSetup</span><span class="p">):</span>
    <span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
    <span class="k">def</span> <span class="nf">subsection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">tc_one</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">setup</span>
    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span>
    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;i should pause&#39;</span><span class="p">)</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">cleanup</span>
    <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">CommonCleanup</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">CommonCleanup</span><span class="p">):</span>
    <span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
    <span class="k">def</span> <span class="nf">subsection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">aetest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">pause_on</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">action</span> <span class="o">=</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span>
                                <span class="n">patterns</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;i should pause&#39;</span><span class="p">}]))</span>
<span class="c1"># output of the script:</span>
<span class="c1">#</span>
<span class="c1">#    Starting common setup</span>
<span class="c1">#    Starting subsection subsection</span>
<span class="c1">#    The result of subsection subsection is =&gt; PASSED</span>
<span class="c1">#    The result of common setup is =&gt; PASSED</span>
<span class="c1">#    Starting testcase tc_one</span>
<span class="c1">#    Starting section setup</span>
<span class="c1">#    The result of section setup is =&gt; PASSED</span>
<span class="c1">#    Starting section test</span>
<span class="c1">#    i should pause</span>
<span class="c1">#</span>
<span class="c1">#    --------------------------------------------------------------------------------</span>
<span class="c1">#    Pause On Phrase: Interactive Console</span>
<span class="c1">#    -&gt; /path/to/my/example/testscript.py[20] test()</span>
<span class="c1">#    (press Ctrl-D to resume execution)</span>
<span class="c1">#    &gt;&gt;&gt;</span>


<span class="c1"># Example 2</span>
<span class="c1"># ---------</span>
<span class="c1">#</span>
<span class="c1">#   pause on phrase with from command line, simplified mode</span>

<span class="c1"># output of the script:</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                            Starting common setup                             |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                        Starting subsection subsection                        |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   The result of subsection subsection is =&gt; PASSED</span>
<span class="c1">#   The result of common setup is =&gt; PASSED</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                           Starting testcase tc_one                           |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                            Starting section setup                            |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   The result of section setup is =&gt; PASSED</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   |                            Starting section test                             |</span>
<span class="c1">#   +------------------------------------------------------------------------------+</span>
<span class="c1">#   i should pause</span>
<span class="c1">#</span>
<span class="c1">#   --------------------------------------------------------------------------------</span>
<span class="c1">#   Pause On Phrase: Interactive Console</span>
<span class="c1">#   -&gt; /path/to/my/example/testscript.py[20] test()</span>
<span class="c1">#   (press Ctrl-D to resume execution)</span>
<span class="c1">#   &gt;&gt;&gt;</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reports.html" class="btn btn-neutral float-left" title="Report Details" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2024, Cisco Systems Inc..
      <span class="lastupdated">Last updated on Dec 27, 2024.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>