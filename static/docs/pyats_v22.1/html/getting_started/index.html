<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; pyATS Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Command Line Tools" href="../cli/index.html" />
    <link rel="prev" title="Overview" href="../overview/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pyATS
          </a>
              <div class="version">
                24.11
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#describe-your-testbed">Describe Your Testbed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connect-and-issue-commands">Connect and Issue Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-your-testscript">Design Your Testscript</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-testscript">Run the Testscript</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-job">Creating a Job</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scratching-the-surface">Scratching the Surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Main Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../aetest/index.html">AEtest - Test Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../easypy/index.html">Easypy - Runtime Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology/index.html">Testbed &amp; Topology Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kleenex/index.html">Testbed &amp; Device Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connections/index.html">Connection Meta</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../async/index.html">Asynchronous Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datastructures/index.html">Datastructures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tcl/index.html">Tcl Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../log/index.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results/index.html">Result Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporter/index.html">Reporter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robot/index.html">RobotFramework Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manifest/index.html">Manifest</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../terminology.html">Terminologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/index.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Doc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/index.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyATS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this heading">¶</a></h1>
<p>pyATS is a foundation-layer test framework. It is designed to provide a
reasonable end-to-end test environment for developers to write test cases in,
featuring multiple packages and modules making writing networking-related
tests a breeze.</p>
<p>The goal of this document is to provide an informal overview of how pyATS
works, and just enough technical specifics to get you started with your first
test project.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>pyATS currently supports Python <code class="docutils literal notranslate"><span class="pre">v3.6.x</span></code>, <code class="docutils literal notranslate"><span class="pre">v3.7.x</span></code> and  <code class="docutils literal notranslate"><span class="pre">v3.8.x</span></code>, and is
tested to work on the following platforms:</p>
<blockquote>
<div><ul class="simple">
<li><p>Linux (tested with CentOS, RHEL, Ubuntu, Alpine)</p></li>
<li><p>Mac OSX (10.13+)</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Cisco Internal Engineering</strong></p>
<p>For all Cisco engineering users (eg, if you are a Cisco employee), refer to
installation section of the pyATS Wiki for guidelines on how to install
pyATS correctly in your environment.</p>
</div>
<p>For all external users (Cisco DevNet users, customers, general public), you can
install pyATS from public PyPI directly using  <code class="xref py py-obj docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code>:</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyats</span></code></dt><dd><p><strong>core framework only</strong>: this installs just the core pyATS framework with
zero optional extras.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyats[library]</span></code></dt><dd><p><strong>pyATS + pyATS Library/Genie</strong>: this installs the core pyATS framework,
and the standard pyATS network automation library,
<a class="reference external" href="https://developer.cisco.com/docs/genie-docs/">Genie</a>.</p>
<p><em>This is the recommended option</em></p>
</dd>
</dl>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyats[robot]</span></code></dt><dd><p><strong>pyATS framework with RobotFramework support</strong>. This installs the optional
RobotFramework package, and <code class="docutils literal notranslate"><span class="pre">pyats.robot</span></code> package that features pyATS
specific keywords.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyats[template]</span></code></dt><dd><p>installs the cookiecutter dependency require for <code class="docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">create</span> <span class="pre">project</span></code>
command</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyats[full]</span></code></dt><dd><p>installs pyATS, along with <strong>all optional extras</strong>.</p>
</dd>
</dl>
</section>
<section id="describe-your-testbed">
<h2>Describe Your Testbed<a class="headerlink" href="#describe-your-testbed" title="Permalink to this heading">¶</a></h2>
<p>Because we are in the business of network test automation, pyATS is designed
around the concept of <a class="reference internal" href="../topology/concept.html#topology-concept"><span class="std std-ref">testbeds</span></a>: where you describe
your <em>devices under testing</em> in <a class="reference external" href="http://www.yaml.org/start.html">YAML</a> format.</p>
<p>This <a class="reference internal" href="../topology/creation.html#topology-testbed-file"><span class="std std-ref">testbed YAML file</span></a> provides many
<a class="reference internal" href="../topology/schema.html#schema"><span class="std std-ref">sections</span></a> for you to describe your physical devices, and how they
link together to form the topology.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   an example testbed file - ios_testbed.yaml</span>

<span class="nt">testbed</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS_Testbed</span>
<span class="w">    </span><span class="nt">credentials</span><span class="p">:</span>
<span class="w">        </span><span class="nt">default</span><span class="p">:</span>
<span class="w">            </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin</span>
<span class="w">            </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco</span>
<span class="w">        </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">            </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco</span>

<span class="nt">devices</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ios-1</span><span class="p">:</span><span class="w"> </span><span class="c1"># &lt;----- must match to your device hostname in the prompt</span>
<span class="w">        </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios</span>
<span class="w">        </span><span class="nt">connections</span><span class="p">:</span>
<span class="w">            </span><span class="nt">a</span><span class="p">:</span>
<span class="w">                </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">telnet</span>
<span class="w">                </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">11023</span>
<span class="w">    </span><span class="nt">ios-2</span><span class="p">:</span>
<span class="w">        </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios</span>
<span class="w">        </span><span class="nt">connections</span><span class="p">:</span>
<span class="w">            </span><span class="nt">a</span><span class="p">:</span>
<span class="w">                </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">telnet</span>
<span class="w">                </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.2</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">11024</span>
<span class="w">            </span><span class="nt">vty</span><span class="p">:</span>
<span class="w">                </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssh</span>
<span class="w">                </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5.5.5.5</span>
<span class="nt">topology</span><span class="p">:</span>
<span class="w">    </span><span class="nt">ios-1</span><span class="p">:</span>
<span class="w">        </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">GigabitEthernet0/0</span><span class="p">:</span>
<span class="w">                </span><span class="nt">ipv4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.10.10.1/24</span>
<span class="w">                </span><span class="nt">ipv6</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;10:10:10::1/64&#39;</span>
<span class="w">                </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">link-1</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ethernet</span>
<span class="w">            </span><span class="nt">Loopback0</span><span class="p">:</span>
<span class="w">                </span><span class="nt">ipv4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.1/32</span>
<span class="w">                </span><span class="nt">ipv6</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;192::1/128&#39;</span>
<span class="w">                </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios1_Loopback0</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">loopback</span>
<span class="w">    </span><span class="nt">ios-2</span><span class="p">:</span>
<span class="w">        </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">            </span><span class="nt">GigabitEthernet0/0</span><span class="p">:</span>
<span class="w">                </span><span class="nt">ipv4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.10.10.2/24</span>
<span class="w">                </span><span class="nt">ipv6</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;10:10:10::2/64&#39;</span>
<span class="w">                </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">link-1</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ethernet</span>
<span class="w">            </span><span class="nt">Loopback0</span><span class="p">:</span>
<span class="w">                </span><span class="nt">ipv4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.2/32</span>
<span class="w">                </span><span class="nt">ipv6</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;192::2/128&#39;</span>
<span class="w">                </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios2_Loopback0</span>
<span class="w">                </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">loopback</span>
</pre></div>
</div>
</section>
<section id="connect-and-issue-commands">
<h2>Connect and Issue Commands<a class="headerlink" href="#connect-and-issue-commands" title="Permalink to this heading">¶</a></h2>
<p>Once a testbed yaml file is written, you can load it, query your topology,
connect &amp; issue commands to your devices using <a class="reference internal" href="../topology/usage.html#topology-usage"><span class="std std-ref">the APIs</span></a>.</p>
<p>This is the best way to validate whether your topology file is well formed,
and your devices connectable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># loader our newly minted testbed file</span>
<span class="kn">from</span> <span class="nn">pyats.topology</span> <span class="kn">import</span> <span class="n">loader</span>
<span class="n">testbed</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;ios_testbed.yaml&#39;</span><span class="p">)</span>

<span class="c1"># access the devices</span>
<span class="n">testbed</span><span class="o">.</span><span class="n">devices</span>
<span class="c1"># AttrDict({&#39;ios-1&#39;: &lt;Device ott-tb1-n7k4 at 0xf77190cc&gt;,</span>
<span class="c1">#           &#39;ios-2&#39;: &lt;Device ott-tb1-n7k5 at 0xf744e16c&gt;})</span>
<span class="n">ios_1</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="s1">&#39;ios-1&#39;</span><span class="p">]</span>
<span class="n">ios_2</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="s1">&#39;ios-2&#39;</span><span class="p">]</span>

<span class="c1"># find links from one device to another</span>
<span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">ios_1</span><span class="o">.</span><span class="n">find_links</span><span class="p">(</span><span class="n">ios_2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">link</span><span class="p">))</span>
<span class="c1"># &lt;Link link-1 at 0xf744ef8c&gt;</span>

<span class="c1"># establish basic connectivity</span>
<span class="n">ios_1</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="c1"># issue commands</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ios_1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show version&#39;</span><span class="p">))</span>
<span class="n">ios_1</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    interface GigabitEthernet0/0</span>
<span class="s1">        ip address 10.10.10.1 255.255.255.0</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="c1"># establish multiple, simultaneous connections</span>
<span class="n">ios_2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">alias</span> <span class="o">=</span> <span class="s1">&#39;console&#39;</span><span class="p">,</span> <span class="n">via</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">ios_2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">alias</span> <span class="o">=</span> <span class="s1">&#39;vty_1&#39;</span><span class="p">,</span> <span class="n">via</span> <span class="o">=</span> <span class="s1">&#39;vty&#39;</span><span class="p">)</span>

<span class="c1"># issue commands through each connection separately</span>
<span class="n">ios_2</span><span class="o">.</span><span class="n">vty_1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show running&#39;</span><span class="p">)</span>
<span class="n">ios_2</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;reload&#39;</span><span class="p">)</span>

<span class="c1"># creating connection pools</span>
<span class="n">ios_2</span><span class="o">.</span><span class="n">start_pool</span><span class="p">(</span><span class="n">alias</span> <span class="o">=</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># use connection pool in multiprocessing paradigms</span>
<span class="c1"># each process will be allocated a connection - whenever one is available</span>
<span class="k">def</span> <span class="nf">sleep</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
    <span class="n">ios_2</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;sleep </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">seconds</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">sleep</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">))</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">sleep</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">))</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">sleep</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">))</span>
<span class="n">p1</span><span class="o">.</span><span class="n">start</span><span class="p">();</span> <span class="n">p2</span><span class="o">.</span><span class="n">start</span><span class="p">();</span> <span class="n">p3</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">p1</span><span class="o">.</span><span class="n">join</span><span class="p">();</span> <span class="n">p2</span><span class="o">.</span><span class="n">join</span><span class="p">();</span> <span class="n">p3</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="design-your-testscript">
<h2>Design Your Testscript<a class="headerlink" href="#design-your-testscript" title="Permalink to this heading">¶</a></h2>
<p>pyATS is all about testing; and the absolute cornerstone in testing is
the actual testscript. In pyATS, test scripts are written and executed through
<a class="reference internal" href="../aetest/index.html#aetest-index"><span class="std std-ref">AEtest Package</span></a>.</p>
<p>Testscripts are <a class="reference internal" href="../aetest/structure.html#aetest-script-structure"><span class="std std-ref">structured</span></a> Python files that
contains/describes the testing you want to do. A clean, elegant testscript
is scalable, and generates easy-to-read test results and logs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   connectivity_check.py</span>

<span class="kn">from</span> <span class="nn">pyats</span> <span class="kn">import</span> <span class="n">aetest</span>

<span class="k">class</span> <span class="nc">CommonSetup</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">CommonSetup</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
    <span class="k">def</span> <span class="nf">check_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">testbed</span><span class="p">,</span>
                       <span class="n">ios1_name</span> <span class="o">=</span> <span class="s1">&#39;ios-1&#39;</span><span class="p">,</span>
                       <span class="n">ios2_name</span> <span class="o">=</span> <span class="s1">&#39;ios-2&#39;</span><span class="p">):</span>
        <span class="n">ios1</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="n">ios1_name</span><span class="p">]</span>
        <span class="n">ios2</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="n">ios2_name</span><span class="p">]</span>

        <span class="c1"># add them to testscript parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ios1</span> <span class="o">=</span> <span class="n">ios1</span><span class="p">,</span> <span class="n">ios2</span> <span class="o">=</span> <span class="n">ios2</span><span class="p">)</span>

        <span class="c1"># get corresponding links</span>
        <span class="n">links</span> <span class="o">=</span> <span class="n">ios1</span><span class="o">.</span><span class="n">find_links</span><span class="p">(</span><span class="n">ios2</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;require one link between ios1 and ios2&#39;</span>


    <span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
    <span class="k">def</span> <span class="nf">establish_connections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">ios1</span><span class="p">,</span> <span class="n">ios2</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;Connecting to </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ios1</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">ios1</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;Connecting to </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ios2</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">ios2</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="nd">@aetest</span><span class="o">.</span><span class="n">loop</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ios1&#39;</span><span class="p">,</span> <span class="s1">&#39;ios2&#39;</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">PingTestcase</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">Testcase</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">loop</span><span class="p">(</span><span class="n">destination</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;10.10.10.1&#39;</span><span class="p">,</span> <span class="s1">&#39;10.10.10.2&#39;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">destination</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">device</span><span class="p">]</span><span class="o">.</span><span class="n">ping</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failed</span><span class="p">(</span><span class="s1">&#39;Ping </span><span class="si">{}</span><span class="s1"> from device </span><span class="si">{}</span><span class="s1"> failed with error: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="n">destination</span><span class="p">,</span>
                                <span class="n">device</span><span class="p">,</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="n">goto</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;exit&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Success rate is (?P&lt;rate&gt;\d+) percent&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
            <span class="n">success_rate</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Ping </span><span class="si">{}</span><span class="s1"> with success rate of </span><span class="si">{}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                        <span class="n">destination</span><span class="p">,</span>
                                        <span class="n">success_rate</span><span class="p">,</span>
                                    <span class="p">)</span>
                               <span class="p">)</span>

<span class="k">class</span> <span class="nc">CommonCleanup</span><span class="p">(</span><span class="n">aetest</span><span class="o">.</span><span class="n">CommonCleanup</span><span class="p">):</span>

    <span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">ios1</span><span class="p">,</span> <span class="n">ios2</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;Disconnecting from </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ios1</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">ios1</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">steps</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s1">&#39;Disconnecting from </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ios2</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">ios2</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">argparse</span>
    <span class="kn">from</span> <span class="nn">pyats.topology</span> <span class="kn">import</span> <span class="n">loader</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--testbed&#39;</span><span class="p">,</span> <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;testbed&#39;</span><span class="p">,</span>
                        <span class="nb">type</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">)</span>

    <span class="n">args</span><span class="p">,</span> <span class="n">unknown</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_known_args</span><span class="p">()</span>

    <span class="n">aetest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="o">**</span><span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
</pre></div>
</div>
<p>This example uses Python <a class="reference external" href="https://docs.python.org/3/library/argparse.html">argparse</a> to parse command line arguments for a
testbed file input, and passes it to the script as the <code class="docutils literal notranslate"><span class="pre">testbed</span></code>
<a class="reference internal" href="../aetest/parameters.html#test-parameters"><span class="std std-ref">script parameter</span></a>. This is a good practice to do -
take arguments from command line makes your script more dynamic.</p>
</section>
<section id="run-the-testscript">
<h2>Run the Testscript<a class="headerlink" href="#run-the-testscript" title="Permalink to this heading">¶</a></h2>
<p>With your script written &amp; saved, you can run it from the command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash$<span class="w"> </span>python<span class="w"> </span>connectivity_check.py<span class="w"> </span>--testbed<span class="w"> </span>ios_testbed.yaml
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__'</span></code> block in your testscript will invoke AEtest
to run the file’s content when called from the command line, and when finished,
displays testcase results:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+------------------------------------------------------------------------------+
|                               Detailed Results                               |
+------------------------------------------------------------------------------+
 SECTIONS/TESTCASES                                                      RESULT
--------------------------------------------------------------------------------
.
|-- common_setup                                                         PASSED
|   |-- check_topology                                                   PASSED
|   `-- establish_connections                                            PASSED
|       |-- Step 1: Connecting to ios-1                                  PASSED
|       `-- Step 2: Connecting to ios-2                                  PASSED
|-- PingTestcase[device=ios1]                                            PASSED
|   |-- ping[destination=10.10.10.1]                                     PASSED
|   `-- ping[destination=10.10.10.2]                                     PASSED
|-- PingTestcase[device=ios2]                                            PASSED
|   |-- ping[destination=10.10.10.1]                                     PASSED
|   `-- ping[destination=10.10.10.2]                                     PASSED
`-- common_cleanup                                                       PASSED
    `-- disconnect                                                       PASSED
        |-- Step 1: Disconnecting from ios-1                             PASSED
        `-- Step 2: Disconnecting from ios-2                             PASSED
+------------------------------------------------------------------------------+
|                                   Summary                                    |
+------------------------------------------------------------------------------+
 Number of ABORTED                                                            0
 Number of BLOCKED                                                            0
 Number of ERRORED                                                            0
 Number of FAILED                                                             0
 Number of PASSED                                                             4
 Number of PASSX                                                              0
 Number of SKIPPED                                                            0
--------------------------------------------------------------------------------
</pre></div>
</div>
<p>This is the quickest way to see your testscript in action: everything is printed
directly to screen, so you can edit, run, edit, and run again until your testing
is tuned to perfection.</p>
</section>
<section id="creating-a-job">
<h2>Creating a Job<a class="headerlink" href="#creating-a-job" title="Permalink to this heading">¶</a></h2>
<p>A <a class="reference internal" href="../easypy/jobfile.html#easypy-jobfile"><span class="std std-ref">job</span></a> is a step above simply running testscripts as
an executable and getting output in STDOUT. Job files enables the execution of
testscripts as <a class="reference internal" href="../easypy/jobfile.html#easypy-tasks"><span class="std std-ref">tasks</span></a> in standardized runtime environment,
allowing testscripts to run in series or in parallel, and aggregates their logs
and results together into a more manageable format.</p>
<p>In-effect, the engine around job files handle the typical boilerplate
environment-setup, such as loading testbed files, through the use of
<a class="reference internal" href="../easypy/plugins.html#easypy-plugin"><span class="std std-ref">plugins</span></a>.</p>
<p>A job must feature a <code class="docutils literal notranslate"><span class="pre">main()</span></code> method - this is entry point.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example: ios_job.py</span>
<span class="c1"># -------------------</span>
<span class="c1">#</span>
<span class="c1">#   a simple job file for the script above</span>

<span class="kn">from</span> <span class="nn">pyats.easypy</span> <span class="kn">import</span> <span class="n">run</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="c1"># run api launches a testscript as an individual task.</span>
    <span class="n">run</span><span class="p">(</span><span class="s1">&#39;connectivity_check.py&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To launch a job, use <code class="docutils literal notranslate"><span class="pre">pyats</span></code>. The built-in testbed file handling plugin
accepts a <code class="docutils literal notranslate"><span class="pre">--testbed-file</span></code> argument, which automatically loads and parses the
provided testbed file into <code class="docutils literal notranslate"><span class="pre">testbed</span></code> parameter, and provide it to the
testscript. When launched, each testscript called by <code class="docutils literal notranslate"><span class="pre">run()</span></code> api inside the
job runs as a child process, and the contents inside its
<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">'__main__'</span></code> block is ignored. Add the <code class="docutils literal notranslate"><span class="pre">--html-logs</span></code> argument
to enable generation of HTML log files - they are easier to read.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash$<span class="w"> </span>pyats<span class="w"> </span>run<span class="w"> </span>job<span class="w"> </span>ios_job.py<span class="w"> </span>--testbed-file<span class="w"> </span>ios_testbed.yaml<span class="w"> </span>--html-logs
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+------------------------------------------------------------------------------+
|                                Easypy Report                                 |
+------------------------------------------------------------------------------+
pyATS Instance   : /path/to/pyats
Tcl-ATS Tree     :
Python Version   : cpython-3.4.1 (32bit)
CLI Arguments    : pyats run job ios_job.py --testbed-file ios_testbed.yaml
User             : joe
Host Server      : automation
Host OS Version  : Red Hat Enterprise Linux Server 6.6 Santiago (x86_64)

Job Information
    Name         : ios_job
    Start time   : 2018-03-15 00:24:05.847263
    Stop time    : 2018-03-15 00:24:17.066042
    Elapsed time : 0:00:11.218779
    Archive      : archive/18-Mar/ios_job.2018Mar15_00:24:04.zip

Total Tasks    : 1

Overall Stats
    Passed     : 4
    Passx      : 0
    Failed     : 0
    Aborted    : 0
    Blocked    : 0
    Skipped    : 0
    Errored    : 0

    TOTAL      : 4

Success Rate   : 100.00 %

+------------------------------------------------------------------------------+
|                             Task Result Summary                              |
+------------------------------------------------------------------------------+
Task-1: connectivity_check.commonSetup                                    PASSED
Task-1: connectivity_check.PingTestcase[device=ios1]                      PASSED
Task-1: connectivity_check.PingTestcase[device=ios2]                      PASSED
Task-1: connectivity_check.commonCleanup                                  PASSED

+------------------------------------------------------------------------------+
|                             Task Result Details                              |
+------------------------------------------------------------------------------+
Task-1: connectivity_check
|-- common_setup                                                          PASSED
|   |-- check_topology                                                    PASSED
|   `-- establish_connections                                             PASSED
|       |-- Step 1: Connecting to ios-1                                   PASSED
|       `-- Step 2: Connecting to ios-2                                   PASSED
|-- PingTestcase[device=ios1]                                             PASSED
|   |-- ping[destination=10.10.10.1]                                      PASSED
|   `-- ping[destination=10.10.10.2]                                      PASSED
|-- PingTestcase[device=ios2]                                             PASSED
|   |-- ping[destination=10.10.10.1]                                      PASSED
|   `-- ping[destination=10.10.10.2]                                      PASSED
`-- common_cleanup                                                        PASSED
    `-- disconnect                                                        PASSED
        |-- Step 1: Disconnecting from ios-1                              PASSED
        `-- Step 2: Disconnecting from ios-2                              PASSED
</pre></div>
</div>
<p>By default, the results of a job file is an archive: a zipped folder containing
files describing the runtime environment, what was run, result XML files, and
log files - eg, everything that was generated in your job’s <a class="reference internal" href="../easypy/behavior.html#easypy-runinfo"><span class="std std-ref">runinfo folder</span></a>.</p>
</section>
<section id="scratching-the-surface">
<h2>Scratching the Surface<a class="headerlink" href="#scratching-the-surface" title="Permalink to this heading">¶</a></h2>
<p>Congratulation, you now understand the basic building blocks of pyATS: job,
script, and testbed files. Aside from the above, there are tons more features
in pyATS left for you to explore. Checkout the rest of the documentation for
all the other awesome features that can help you with your day-to-day testing!</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<p>Various pyATS script examples can be found in GitHub:</p>
<ul class="simple">
<li><p><strong>Feature Usage</strong>: <a class="reference external" href="https://github.com/CiscoTestAutomation/examples">https://github.com/CiscoTestAutomation/examples</a></p></li>
<li><p><strong>Solutions and Scripts</strong>: <a class="reference external" href="https://github.com/CiscoTestAutomation/solutions_examples">https://github.com/CiscoTestAutomation/solutions_examples</a></p></li>
</ul>
<p>Feel free to clone them into your workspace and run.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   launching pyats from the command line</span>

<span class="c1"># activating pyats instance</span>
<span class="c1"># (if you have not yet activated)</span>
<span class="o">[</span>tony@jarvis:~<span class="o">]</span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/ws/tony-stark/pyats
<span class="o">[</span>tony@jarvis:pyats<span class="o">]</span>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>env.sh

<span class="c1"># clone example folder</span>
<span class="o">(</span>pyats<span class="o">)</span><span class="w"> </span><span class="o">[</span>tony@jarvis:pyats<span class="o">]</span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/CiscoTestAutomation/examples
<span class="o">(</span>pyats<span class="o">)</span><span class="w"> </span><span class="o">[</span>tony@jarvis:pyats<span class="o">]</span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>examples

<span class="c1"># start with executing the basic examples jobfiles.</span>
<span class="c1"># this is a basic example demonstrating the usage of a jobfiles,</span>
<span class="c1"># and running through a single aetest testscript.</span>
<span class="o">(</span>pyats<span class="o">)</span><span class="w"> </span><span class="o">[</span>tony@jarvis:examples<span class="o">]</span>$<span class="w"> </span>pyats<span class="w"> </span>run<span class="w"> </span>job<span class="w"> </span>basic/basic_example_job.py
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../overview/index.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../cli/index.html" class="btn btn-neutral float-right" title="Command Line Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright (c) 2024, Cisco Systems Inc..
      <span class="lastupdated">Last updated on Dec 27, 2024.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>