

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Common Services &mdash; Unicon Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=82a976d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=1045b1b5" />

  
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ACI" href="aci.html" />
    <link rel="prev" title="What Are Services" href="what_are_services.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Unicon Plugins
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supported_platforms.html">Supported Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connection.html">Connection Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../passwords.html">Password Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../proxy.html">Connection Through Proxies</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API/Services</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="what_are_services.html">What Are Services</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Common Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#execute">execute</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure">configure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#send">send</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transmit">transmit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sendline">sendline</a></li>
<li class="toctree-l3"><a class="reference internal" href="#expect">expect</a></li>
<li class="toctree-l3"><a class="reference internal" href="#receive">receive</a></li>
<li class="toctree-l3"><a class="reference internal" href="#receive-buffer">receive_buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#expect-log">expect_log</a></li>
<li class="toctree-l3"><a class="reference internal" href="#log-user">log_user</a></li>
<li class="toctree-l3"><a class="reference internal" href="#log-file">log_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable">enable</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disable">disable</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ping">ping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#switchto">switchto</a></li>
<li class="toctree-l3"><a class="reference internal" href="#traceroute">traceroute</a></li>
<li class="toctree-l3"><a class="reference internal" href="#copy">copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reload">reload</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bash-console">bash_console</a></li>
<li class="toctree-l3"><a class="reference internal" href="#guestshell">guestshell</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dual-rp-services">Dual RP Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#get-mode">get_mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-rp-state">get_rp_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-config">get_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">guestshell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sync-state">sync_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="#switchover">switchover</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reset-standby-rp">reset_standby_rp</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stack-rp-services">Stack RP Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">get_rp_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">switchover</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">reload</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#quad-rp-services">Quad RP Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">get_rp_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">switchover</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">reload</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="aci.html">ACI</a></li>
<li class="toctree-l2"><a class="reference internal" href="asa_fp2k.html">ASA/FP2K</a></li>
<li class="toctree-l2"><a class="reference internal" href="cimc.html">CIMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="confd.html">ConfD</a></li>
<li class="toctree-l2"><a class="reference internal" href="ftd.html">FXOS/FTD</a></li>
<li class="toctree-l2"><a class="reference internal" href="fxos.html">FXOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="fxos_fp4k.html">FXOS/FP4K</a></li>
<li class="toctree-l2"><a class="reference internal" href="fxos_fp9k.html">FXOS/FP9K</a></li>
<li class="toctree-l2"><a class="reference internal" href="gaia.html">Check Point Gaia OS</a></li>
<li class="toctree-l2"><a class="reference internal" href="iosxe.html">IOSXE</a></li>
<li class="toctree-l2"><a class="reference internal" href="iosxe_c9800_ewc_ap.html">IOSXE/C9800/EWC_AP</a></li>
<li class="toctree-l2"><a class="reference internal" href="iosxr.html">IOSXR</a></li>
<li class="toctree-l2"><a class="reference internal" href="junos.html">Junos</a></li>
<li class="toctree-l2"><a class="reference internal" href="linux.html">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="nso.html">NSO</a></li>
<li class="toctree-l2"><a class="reference internal" href="nxos.html">NXOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="nxos_mds.html">NXOS/MDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="sdwan.html">SDWAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="sros.html">SROS</a></li>
<li class="toctree-l2"><a class="reference internal" href="staros.html">StarOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="vos.html">VOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows.html">Windows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="service_dialogs.html">Dialog Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robot/index.html">RobotFramework Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../playback/index.html">Playback</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide/plugins.html">Plugin Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide/service_framework.html">How to write  a new Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide/eal.html">Expect Abstraction Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide/statemachine.html">State Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide/unittests.html">Develop &amp; Run Unittests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">Unicon API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/index.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog_plugins/index.html">Plugins Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Unicon Plugins</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">API/Services</a></li>
      <li class="breadcrumb-item active">Common Services</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="common-services">
<h1>Common Services<a class="headerlink" href="#common-services" title="Link to this heading">¶</a></h1>
<p>Common services, as the name suggests, are applicable for all (most)
of the switch and router platforms. In this way we can cut down a lot
of document duplication across platforms. This section includes all
such services which are applicable on both HA and Non-HA platform.</p>
<p>There could be cases when a particular platform supports more services
than listed below or there could be some omissions as well. In that case
please refer to the platform specific service documentations. For example
NXOS supports <code class="xref py py-obj docutils literal notranslate"><span class="pre">vdc</span></code> handling APIs which are not relevant on other platforms
line XR or IOS etc. Also in case of linux we only have <code class="xref py py-obj docutils literal notranslate"><span class="pre">execute</span></code> service.</p>
<p id="controlled-settings"><strong>Error pattern handling</strong></p>
<p>If you want to execute services that could fail to execute properly and you want to verify
this automatically using a specific error pattern, you can specify the <code class="xref py py-obj docutils literal notranslate"><span class="pre">error_pattern</span></code>
option with a list of regular expressions to match on the output. This option is available
for the execute service.</p>
<p>The regex pattern is matched using the python multiline option (re.M) so you can use
the start of line (<code class="xref py py-obj docutils literal notranslate"><span class="pre">^</span></code>) character to match specific line output.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show interface invalid&#39;</span><span class="p">,</span> <span class="n">error_pattern</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;^% Invalid&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>If you want to avoid errors being detected with any command, you can set the settings object
<code class="xref py py-obj docutils literal notranslate"><span class="pre">ERROR_PATTERN</span></code> to an empty list. The current generic default is an empty list.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyats.topology</span> <span class="kn">import</span> <span class="n">loader</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;testbed.yaml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncs</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">devices</span><span class="o">.</span><span class="n">ncs</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncs</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">via</span><span class="o">=</span><span class="s1">&#39;cli&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncs</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">ERROR_PATTERN</span><span class="o">=</span><span class="p">[]</span>
</pre></div>
</div>
<p>The default error patterns can be seen by printing the settings.ERROR_PATTERN attribute.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncs</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">ERROR_PATTERN</span>
<span class="go">[&#39;Error:&#39;, &#39;syntax error&#39;, &#39;Aborted&#39;, &#39;result false&#39;]</span>
</pre></div>
</div>
<p>Alternatively, you can pass an empty list when executing a command to avoid error pattern checking.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show command error&#39;</span><span class="p">,</span> <span class="n">error_pattern</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<p>You can also append a pattern to the existing patterns defined in the settings when executing a command
(e.g. to add an error pattern for a specific command to execute).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show command error&#39;</span><span class="p">,</span> <span class="n">append_error_pattern</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;^specific error pattern&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>EOF Exception handling</strong></p>
<p>If device connection is closed/terminated unexpectedly during service calling, we can reconnect
to device. EOF exception is raised by Spawn when connection is not available.</p>
<p>Sample usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unicon.core.errors</span> <span class="kn">import</span> <span class="n">EOF</span><span class="p">,</span> <span class="n">SubCommandFailure</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span> <span class="c1"># or any service call.</span>
<span class="k">except</span> <span class="n">SubCommandFailure</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">__cause__</span><span class="p">,</span> <span class="n">EOF</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Connection closed, try reconnect&#39;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="n">d</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Printing matched patterns</strong></p>
<p>If you want to print the dialog statements matched patterns during the run,
you need to set the log level to logging.DEBUG or connect with debug=True.</p>
<p>Default value is False.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyats.topology</span> <span class="kn">import</span> <span class="n">loader</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;testbed.yaml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uut</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="s1">&#39;uut&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uut</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uut</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternative:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uut</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Environment variables</strong></p>
<p>If you want to set environment variables for the connection, you can set them
by adding key-value pairs to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">ENV</span></code> dictionary.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uut</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">ENV</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MYENV&#39;</span><span class="p">:</span> <span class="s1">&#39;mystring&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p><strong>Terminal size settings</strong></p>
<p>To set the terminal size (rows, cols) you can use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">ROWS</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">COLUMNS</span></code>
environment variables. The default terminal size is 24 x 80. Some plugins
like linux and nxos/aci have their own defaults.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uut</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">ENV</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ROWS&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;COLUMNS&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Settings can also be patched in the testbed yaml file as shown <a class="reference internal" href="../connection.html#settings-control"><span class="std std-ref">here</span></a>.</p>
</div>
<section id="execute">
<h2>execute<a class="headerlink" href="#execute" title="Link to this heading">¶</a></h2>
<p>This service is used to execute arbitrary commands on the device. Though
it is tailor made to handle command which do not <em>interact</em> but by providing
additional dialogs you can handle those minor interactions.</p>
<p>This works seamlessly across both HA and Non-HA devices, but on HA platforms
in case you need to send commands to standby, you can do so by using the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">target</span></code> argument in <code class="xref py py-obj docutils literal notranslate"><span class="pre">execute</span></code>. Please refer the code section below to check
that out.</p>
<p>Use <code class="xref py py-obj docutils literal notranslate"><span class="pre">prompt_recovery</span></code> argument for using <code class="xref py py-obj docutils literal notranslate"><span class="pre">prompt_recovery</span></code> feature.
Refer <a class="reference internal" href="../../developer_guide/eal.html#prompt-recovery-label"><span class="std std-ref">Prompt Recovery Feature</span></a>  for details on prompt_recovery feature.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all platforms allow command execution on the standby RP as it
may not be possible to unlock the standby RP.
Please check before using this option.</p>
</div>
<p>For commands which have very long runtime, e.g <code class="xref py py-obj docutils literal notranslate"><span class="pre">show</span> <span class="pre">run</span></code>, you can change
the timeout value using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">timeout</span></code> option. By default all the exec
commands have a timeout of 60 seconds.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Execute</span></code> service returns the output of the command in the string format
or it raises an exception. If you pass a list of commands or
a multiline string, a dictionary is returned. You can expect a SubCommandFailure
error in case anything goes wrong.</p>
<p>If you want to pass a multiline string as a single command, you should pass
a list where the list item as a multiline string, see example below.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int (default 60 sec)</p></td>
<td><p>timeout value for the command execution takes.</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialog</p></td>
</tr>
<tr class="row-even"><td><p>command</p></td>
<td><p>str</p></td>
<td><p>command to execute on device handle</p></td>
</tr>
<tr class="row-odd"><td><p>target</p></td>
<td><p>standby/active</p></td>
<td><p>by default commands will be executed on active,
use target=standby to execute command on standby.</p></td>
</tr>
<tr class="row-even"><td><p>prompt_recovery</p></td>
<td><p>bool (default False)</p></td>
<td><p>Enable/Disable prompt recovery feature</p></td>
</tr>
<tr class="row-odd"><td><p>error_pattern</p></td>
<td><p>list</p></td>
<td><p>List of regex strings to check output for errors.</p></td>
</tr>
<tr class="row-even"><td><p>append_error_pattern</p></td>
<td><p>list</p></td>
<td><p>List of regex strings append to error_pattern.</p></td>
</tr>
<tr class="row-odd"><td><p>search_size</p></td>
<td><p>int (default 8K bytes)</p></td>
<td><p>maximum size in bytes to search at the
end of the buffer</p></td>
</tr>
<tr class="row-even"><td><p>allow_state_change</p></td>
<td><p>bool (default False)</p></td>
<td><p>By default, end state should be same as start state.
If True, end state can be any valid state.</p></td>
</tr>
<tr class="row-odd"><td><p>service_dialog</p></td>
<td><p>Dialog</p></td>
<td><p>service_dialog overrides the execute service
dialog.</p></td>
</tr>
<tr class="row-even"><td><p>matched_retries</p></td>
<td><p>int (default 1)</p></td>
<td><p>retry times if statement pattern is matched</p></td>
</tr>
<tr class="row-odd"><td><p>matched_retry_sleep</p></td>
<td><p>float (default 0.05 sec)</p></td>
<td><p>sleep between matched_retries</p></td>
</tr>
</tbody>
</table>
<p>By default, device start state should be same as end state. For example, if we
use <code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code> service when device is at enable state then after running the command,
device should come back to enable state. If any state change occurs then <code class="xref py py-obj docutils literal notranslate"><span class="pre">StateMachineError</span></code>
exception is raised. This behavior can be change by using <code class="xref py py-obj docutils literal notranslate"><span class="pre">allow_state_change=True</span></code> argument.
With <code class="xref py py-obj docutils literal notranslate"><span class="pre">allow_state_change=True</span></code>, after running the command, it will be valid if device comes
to any valid state. Valid states are all defined states in the plugin specific statemachine.</p>
<p>The search size option specifies the maximum size at the end of the buffer
to search for the prompt and other patterns (e.g. from the reply Dialog).
Specify 0 to search the complete buffer. The search size option is used to
speed up pattern matching against the buffer. The default search size should
be sufficient for most needs and allows large outputs to be processed more efficiently.</p>
<p>A default set of statements is included in the dialog for the
execute service. You can find the default dialog patterns here: <a class="reference external" href="service_dialogs.html">Service dialogs</a>.
You can add additional dialogs to the services dialogs by using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">reply</span></code> parameter.</p>
<p>You can pass the <code class="xref py py-obj docutils literal notranslate"><span class="pre">service_dialog</span></code> option to the execute() service to override the execute service dialogs.
This is useful if the execute service patterns are causing problems, e.g. the <code class="docutils literal notranslate"><span class="pre">Username:</span></code> prompt
is responded to by default with the login credentials. In some cases this leads to false positive
pattern responses.</p>
<p>Example usage of the execute service:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="c1"># simple execute call</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;show clock&quot;</span><span class="p">)</span>

<span class="c1"># changing the timeout value</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;show logging&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># sending command to standby rp</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;show clock&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>

<span class="c1"># using the reply option.</span>
<span class="kn">from</span> <span class="nn">unicon.eal.dialogs</span> <span class="kn">import</span> <span class="n">Statement</span><span class="p">,</span> <span class="n">Dialog</span>
<span class="n">dialog</span> <span class="o">=</span> <span class="n">Dialog</span><span class="p">([</span>
    <span class="n">Statement</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;.*Do you wish to proceed anyway\? \(y/n\)\s*\[n\]&#39;</span><span class="p">,</span>
                        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;sendline(y)&#39;</span><span class="p">,</span>
                        <span class="n">loop_continue</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">continue_timer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;write erase&quot;</span><span class="p">,</span> <span class="n">reply</span><span class="o">=</span><span class="n">dialog</span><span class="p">)</span>

<span class="c1"># using prompt_recovery option</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;show clock&quot;</span><span class="p">,</span> <span class="n">prompt_recovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># clear command (default response of &#39;\r&#39; to confirm prompt)</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;clear logging&#39;</span><span class="p">)</span>

<span class="c1"># Check output for errors</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show interface TokenRing0/0&#39;</span><span class="p">,</span> <span class="n">error_pattern</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;^% Invalid&#39;</span><span class="p">])</span>

<span class="c1"># Execute multiline command by passing a list with a multiline string.</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">execute</span><span class="p">([</span><span class="s1">&#39;line1</span><span class="se">\n</span><span class="s1">line2</span><span class="se">\n</span><span class="s1">line3&#39;</span><span class="p">])</span>

<span class="c1"># Allowing state changes</span>
<span class="c1"># Below will work</span>
<span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;config term&#39;</span><span class="p">,</span> <span class="n">allow_state_change</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Below will raise exception</span>
<span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;config term&#39;</span><span class="p">)</span>

<span class="c1"># Override the execute service dialog</span>
<span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show wireless client mac-address 00-11-22-33-44-55 detail&#39;</span><span class="p">,</span> <span class="n">service_dialog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="configure">
<h2>configure<a class="headerlink" href="#configure" title="Link to this heading">¶</a></h2>
<p>Service to configure device with list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">commands</span></code>. Config without
config_command will take device to config mode. Commands Should be list,
if <code class="xref py py-obj docutils literal notranslate"><span class="pre">config_command</span></code> are more than one. reply option can be passed for the
interactive config command. Command will be executed on standby if target
is specified as standby. Use <code class="xref py py-obj docutils literal notranslate"><span class="pre">prompt_recovery</span></code> argument for using
<code class="xref py py-obj docutils literal notranslate"><span class="pre">prompt_recovery</span></code> feature. Refer <a class="reference internal" href="../../developer_guide/eal.html#prompt-recovery-label"><span class="std std-ref">Prompt Recovery Feature</span></a>  for details
on prompt_recovery feature.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout value for the command execution takes.</p></td>
</tr>
<tr class="row-odd"><td><p>error_pattern</p></td>
<td><p>list</p></td>
<td><p>List of regex strings to check output for errors.</p></td>
</tr>
<tr class="row-even"><td><p>append_error_pattern</p></td>
<td><p>list</p></td>
<td><p>List of regex strings append to error_pattern.</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialog</p></td>
</tr>
<tr class="row-even"><td><p>command</p></td>
<td><p>list</p></td>
<td><p>list of commands to configure</p></td>
</tr>
<tr class="row-odd"><td><p>prompt_recovery</p></td>
<td><p>bool (default False)</p></td>
<td><p>Enable/Disable prompt recovery feature</p></td>
</tr>
<tr class="row-even"><td><p>force</p></td>
<td><p>bool (default False)</p></td>
<td><p>For XR, run commit force at end of config.</p></td>
</tr>
<tr class="row-odd"><td><p>replace</p></td>
<td><p>bool (default False)</p></td>
<td><p>For XR, run commit replace at end of config.</p></td>
</tr>
<tr class="row-even"><td><p>lock_retries</p></td>
<td><p>int (default 0)</p></td>
<td><p>retry times if config mode is locked</p></td>
</tr>
<tr class="row-odd"><td><p>lock_retry_sleep</p></td>
<td><p>int (default 2 sec)</p></td>
<td><p>sleep between lock_retries</p></td>
</tr>
<tr class="row-even"><td><p>target</p></td>
<td><p>str (default “active”)</p></td>
<td><p>Target RP where to execute service, for DualRp only</p></td>
</tr>
<tr class="row-odd"><td><p>bulk</p></td>
<td><p>bool (default False)</p></td>
<td><p>If False, send all commands in one sendline. If True, send commands in chunked mode</p></td>
</tr>
<tr class="row-even"><td><p>bulk_chunk_lines</p></td>
<td><p>int (default 50)</p></td>
<td><p>maximum number of commands to send per chunk, 0 means to send all commands in a single chunk</p></td>
</tr>
<tr class="row-odd"><td><p>bulk_chunk_sleep</p></td>
<td><p>float (default 0.5 sec)</p></td>
<td><p>sleep between sending command chunks</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;no logging console&quot;</span><span class="p">)</span>
<span class="n">cmd</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;hostname si-tvt-7200-28-41&quot;</span><span class="p">,</span> <span class="s2">&quot;no logging console&quot;</span><span class="p">]</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>

<span class="c1">#For XR:</span>
<span class="o">-------</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>For <code class="xref py py-obj docutils literal notranslate"><span class="pre">(os='iosxe',</span> <span class="pre">platform='sdwan')</span></code> plugin, <code class="xref py py-obj docutils literal notranslate"><span class="pre">configure()</span></code> service issue <code class="xref py py-obj docutils literal notranslate"><span class="pre">config-transaction</span></code>
command in place of <code class="xref py py-obj docutils literal notranslate"><span class="pre">'config</span> <span class="pre">term</span></code> and run <code class="xref py py-obj docutils literal notranslate"><span class="pre">commit</span></code> command before moving out of config mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#configure() service on iosxe/sdwan plugin.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">&#39;no logging console&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2019</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">22</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">58</span><span class="p">,</span><span class="mi">981</span><span class="p">]</span> <span class="o">+++</span> <span class="n">Router</span><span class="p">:</span> <span class="n">config</span> <span class="o">+++</span>
<span class="n">config</span><span class="o">-</span><span class="n">transaction</span>
<span class="n">admin</span> <span class="n">connected</span> <span class="kn">from</span> <span class="mf">127.0.0.1</span> <span class="n">using</span> <span class="n">console</span> <span class="n">on</span> <span class="n">Router</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#no logging console</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#commit</span>
<span class="o">%</span> <span class="n">No</span> <span class="n">modifications</span> <span class="n">to</span> <span class="n">commit</span><span class="o">.</span>
<span class="n">Router</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="c1">#end</span>
<span class="n">Router</span><span class="c1">#</span>
<span class="s1">&#39;no logging console</span><span class="se">\r\n</span><span class="s1">commit</span><span class="se">\r\n</span><span class="s1">% No modifications to commit.</span><span class="se">\r\n</span><span class="s1">&#39;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
</section>
<section id="send">
<h2>send<a class="headerlink" href="#send" title="Link to this heading">¶</a></h2>
<p>Service to  send the <strong>‘command/string’</strong> with “r” to spawned channel. If
target is passed as standby, command will be sent to standby spawn .</p>
<blockquote>
<div><dl class="simple">
<dt>arg  :</dt><dd><ul class="simple">
<li><p>command = &lt;Command to be sent&gt;”r”</p></li>
<li><p>target=’standby’</p></li>
</ul>
</dd>
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success, raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

    <span class="n">rtr</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;show clock</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">rtr</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;show clock</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="transmit">
<h2>transmit<a class="headerlink" href="#transmit" title="Link to this heading">¶</a></h2>
<p>Service similar to <code class="xref py py-obj docutils literal notranslate"><span class="pre">send()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

    <span class="n">rtr</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="s2">&quot;show clock</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">rtr</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="s2">&quot;show clock</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sendline">
<h2>sendline<a class="headerlink" href="#sendline" title="Link to this heading">¶</a></h2>
<p>Service to  send the <strong>‘command/string’</strong> to spawned channel, “r” will be
appended to command by sendline. If  target is passed as standby, command will
be sent to standby spawn .</p>
<dl class="simple">
<dt>arg  :</dt><dd><ul class="simple">
<li><p>command = &lt;Command to be sent&gt;</p></li>
<li><p>target=’standby’</p></li>
</ul>
</dd>
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success, raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

    <span class="n">rtr</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;show clock&quot;</span><span class="p">)</span>
    <span class="n">rtr</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;show clock&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="expect">
<h2>expect<a class="headerlink" href="#expect" title="Link to this heading">¶</a></h2>
<p>Match a list of patterns against the buffer. If target is passed as standby,
patterns matches against the buffer on standby spawn channel.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>patterns</p></td>
<td><p>list</p></td>
<td><p>list of patterns</p></td>
</tr>
<tr class="row-odd"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout in sec (default 10 seconds).</p></td>
</tr>
<tr class="row-even"><td><p>size</p></td>
<td><p>int</p></td>
<td><p>read size in bytes for reading the buffer</p></td>
</tr>
<tr class="row-odd"><td><p>target</p></td>
<td><p>str</p></td>
<td><p>‘standby’ to match a list of patterns against
the buffer on standby spawn channel.</p></td>
</tr>
<tr class="row-even"><td><p>trim_buffer</p></td>
<td><p>bool</p></td>
<td><p>trim the buffer after a successful match or not</p></td>
</tr>
<tr class="row-odd"><td><p>search_size</p></td>
<td><p>int</p></td>
<td><p>maximum size in bytes to search at the
end of the buffer (default 8K bytes)</p></td>
</tr>
</tbody>
</table>
<p>Default search size is 8K, use 0 to search the complete buffer.</p>
<blockquote>
<div><p>return :</p>
<blockquote>
<div><dl class="simple">
<dt>ExpectMatch instance.</dt><dd><ul class="simple">
<li><p>It contains the index of the pattern that matched.</p></li>
<li><p>matched string.</p></li>
<li><p>re match object.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>raises:</dt><dd><dl class="simple">
<dt>TimeoutError: In case no match is found within the timeout period</dt><dd><p>or raise SubCommandFailure on failure.</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

  <span class="n">rtr</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;a command&quot;</span><span class="p">)</span>
  <span class="n">rtr</span><span class="o">.</span><span class="n">expect</span><span class="p">([</span><span class="sa">r</span><span class="s1">&#39;^pat1&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;pat2&#39;</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="receive">
<h2>receive<a class="headerlink" href="#receive" title="Link to this heading">¶</a></h2>
<p>Service for matching a pattern from buffer. If target is passed as standby,
patterns matches against the buffer on standby spawn channel.</p>
<p>If provided pattern is <code class="xref py py-obj docutils literal notranslate"><span class="pre">r'nopattern^'</span></code> then all data till timeout period will
be matched and can be retrieved using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">receive_buffer()</span></code> service.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>pattern</p></td>
<td><p>str</p></td>
<td><p>regular expression patterns</p></td>
</tr>
<tr class="row-odd"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout in sec (default 10 seconds).</p></td>
</tr>
<tr class="row-even"><td><p>size</p></td>
<td><p>int</p></td>
<td><p>read size in bytes for reading the buffer</p></td>
</tr>
<tr class="row-odd"><td><p>target</p></td>
<td><p>str</p></td>
<td><p>‘standby’ to match a list of patterns against
the buffer on standby spawn channel.</p></td>
</tr>
<tr class="row-even"><td><p>trim_buffer</p></td>
<td><p>bool</p></td>
<td><p>trim the buffer after a successful match or not</p></td>
</tr>
<tr class="row-odd"><td><p>search_size</p></td>
<td><p>int</p></td>
<td><p>maximum size in bytes to search at the
end of the buffer (default 8K bytes)</p></td>
</tr>
</tbody>
</table>
<p>Default search size is 8K, use 0 to search the complete buffer.</p>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>Bool: True or False</p></li>
<li><p>True: If data is matched by provided pattern.</p></li>
<li><p>False: If nothing is matched by pattern or if <code class="xref py py-obj docutils literal notranslate"><span class="pre">r'nopattern^'</span></code> pattern is used.</p></li>
<li><p>Data matched by pattern is can be retrieved by using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">receive_buffer()</span></code> service.</p></li>
</ul>
</dd>
<dt>raises:</dt><dd><ul class="simple">
<li><p>No Exception is raised if pattern does not get matched or timeout happens.</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SubCommandFailure</span></code> will be raised if any Exception is raised apart from <a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#TimeoutError" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TimeoutError</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

  <span class="n">rtr</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="s2">&quot;a command&quot;</span><span class="p">)</span>
  <span class="n">rtr</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^pat1&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="receive-buffer">
<h2>receive_buffer<a class="headerlink" href="#receive-buffer" title="Link to this heading">¶</a></h2>
<p>Service to get data match by <code class="xref py py-obj docutils literal notranslate"><span class="pre">receive()</span></code> service pattern. This service should be invoked only
after calling <code class="xref py py-obj docutils literal notranslate"><span class="pre">receive()</span></code> service, else <code class="xref py py-obj docutils literal notranslate"><span class="pre">SubCommandFailure</span></code> exception will be raised.</p>
<p>This service takes no arguments.</p>
<blockquote>
<div><dl class="simple">
<dt>Returns:</dt><dd><p>String: Data matched by <code class="xref py py-obj docutils literal notranslate"><span class="pre">receive()</span></code> service pattern.</p>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

  <span class="n">rtr</span><span class="o">.</span><span class="n">transmit</span><span class="p">(</span><span class="s2">&quot;a command&quot;</span><span class="p">)</span>
  <span class="n">rtr</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^pat1&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
  <span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">receive_buffer</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="expect-log">
<h2>expect_log<a class="headerlink" href="#expect-log" title="Link to this heading">¶</a></h2>
<p>This service is removed. Please use Connection logger setLevel API
to enable/disable internal debug logging.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

  <span class="n">rtr</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
  <span class="n">rtr</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="log-user">
<h2>log_user<a class="headerlink" href="#log-user" title="Link to this heading">¶</a></h2>
<p>Service to enable or disable a device logs on screen.</p>
<blockquote>
<div><p>args</p>
<blockquote>
<div><ul class="simple">
<li><p>enable = True/False</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

  <span class="n">rtr</span><span class="o">.</span><span class="n">log_user</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">rtr</span><span class="o">.</span><span class="n">log_user</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="log-file">
<h2>log_file<a class="headerlink" href="#log-file" title="Link to this heading">¶</a></h2>
<p>Service to get or change Device <code class="xref py py-obj docutils literal notranslate"><span class="pre">FileHandler</span></code> file.
If no argument passed then it return current filename of <code class="xref py py-obj docutils literal notranslate"><span class="pre">FileHandler</span></code>.
Return <a class="reference external" href="https://docs.python.org/3.6/library/constants.html#True" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, if file handler updated with new filename.</p>
<blockquote>
<div><p>args</p>
<blockquote>
<div><ul class="simple">
<li><p>filename: file name in which device logs to dump.</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

  <span class="n">rtr</span><span class="o">.</span><span class="n">log_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;/some/path/uut.log&#39;</span><span class="p">)</span>
  <span class="n">rtr</span><span class="o">.</span><span class="n">log_file</span><span class="p">()</span> <span class="c1"># Returns current FileHandler filename</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="enable">
<h2>enable<a class="headerlink" href="#enable" title="Link to this heading">¶</a></h2>
<p>Service to change the device mode to enable from any state. Brings the standby
handle to enable state, if standby is passed as input.
If command is given, it will be issued on the device to become in enable mode.</p>
<blockquote>
<div><dl class="simple">
<dt>arg :</dt><dd><ul class="simple">
<li><p>target=’standby’</p></li>
<li><p>command=’enable 7’</p></li>
</ul>
</dd>
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success, raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s1">&#39;enable 7&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="disable">
<h2>disable<a class="headerlink" href="#disable" title="Link to this heading">¶</a></h2>
<p>Service to change the device to disable mode from any state. Brings the standby
handle to disable state, if standby is passed as input.</p>
<blockquote>
<div><dl class="simple">
<dt>arg :</dt><dd><ul class="simple">
<li><p>target=’standby’</p></li>
</ul>
</dd>
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success, raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ping">
<h2>ping<a class="headerlink" href="#ping" title="Link to this heading">¶</a></h2>
<p>Service to issue ping response request to another network from device.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>addr</p></td>
<td><p>Destination address</p></td>
</tr>
<tr class="row-odd"><td><p>proto</p></td>
<td><p>protocol(ip/ipv6)</p></td>
</tr>
<tr class="row-even"><td><p>count</p></td>
<td><p>Number of pings to transmit</p></td>
</tr>
<tr class="row-odd"><td><p>source</p></td>
<td><p>Source address or interface</p></td>
</tr>
<tr class="row-even"><td><p>data_pat</p></td>
<td><p>data pattern that would be used to perform ping.</p></td>
</tr>
<tr class="row-odd"><td><p>dest_end</p></td>
<td><p>ending network 127 address</p></td>
</tr>
<tr class="row-even"><td><p>dest_start</p></td>
<td><p>beginning network 127 address</p></td>
</tr>
<tr class="row-odd"><td><p>df_bit</p></td>
<td><p>(y/n) y sets the DF bit in the IP header.</p></td>
</tr>
<tr class="row-even"><td><p>dscp</p></td>
<td><p>field DSCP in the IPv6 header.</p></td>
</tr>
<tr class="row-odd"><td><p>vrf</p></td>
<td><p>vrf interface name</p></td>
</tr>
<tr class="row-even"><td><p>mask</p></td>
<td><p>Number of bits in the network mask of the target address.</p></td>
</tr>
<tr class="row-odd"><td><p>exp</p></td>
<td><p>Experimental (EXP) bits bits in MPLS header</p></td>
</tr>
<tr class="row-even"><td><p>pad</p></td>
<td><p>Pad pattern for MPLS echo request</p></td>
</tr>
<tr class="row-odd"><td><p>transport</p></td>
<td><p>destination type as an MPLS traffic engineering (TE) tunnel</p></td>
</tr>
<tr class="row-even"><td><p>oif</p></td>
<td><p>output interface</p></td>
</tr>
<tr class="row-odd"><td><p>reply_mode</p></td>
<td><p>reply mode for the echo request packet</p></td>
</tr>
<tr class="row-even"><td><p>size</p></td>
<td><p>ping packet size to transmit</p></td>
</tr>
<tr class="row-odd"><td><p>ttl</p></td>
<td><p>time-to-live (TTL) value</p></td>
</tr>
<tr class="row-even"><td><p>tunnel</p></td>
<td><p>Tunnel interface number</p></td>
</tr>
<tr class="row-odd"><td><p>tos</p></td>
<td><p>TOS field value</p></td>
</tr>
<tr class="row-even"><td><p>multicast</p></td>
<td><p>multicast addr</p></td>
</tr>
<tr class="row-odd"><td><p>udp</p></td>
<td><p>(y/n) enable/disable UDP transmission for ipv6.</p></td>
</tr>
<tr class="row-even"><td><p>interface</p></td>
<td><p>Interface</p></td>
</tr>
<tr class="row-odd"><td><p>vcid</p></td>
<td><p>VC Identifier</p></td>
</tr>
<tr class="row-even"><td><p>topo</p></td>
<td><p>topology nam</p></td>
</tr>
<tr class="row-odd"><td><p>verbose</p></td>
<td><p>(y/n) enable/disable verbose mode</p></td>
</tr>
<tr class="row-even"><td><p>extended_verbose</p></td>
<td><p>Enables extended verbose mode</p></td>
</tr>
<tr class="row-odd"><td><p>src_route_type</p></td>
<td><p>source type strict/loose</p></td>
</tr>
<tr class="row-even"><td><p>src_route_addr</p></td>
<td><p>source route ip</p></td>
</tr>
<tr class="row-odd"><td><p>validate_reply_data</p></td>
<td><p>(y/n) validate reply data or not</p></td>
</tr>
<tr class="row-even"><td><p>force_exp_null_label</p></td>
<td><p>(y/n) Force explicit null label.</p></td>
</tr>
<tr class="row-odd"><td><p>lsp_ping_trace_rev</p></td>
<td><p>LSP ping/trace revision</p></td>
</tr>
<tr class="row-even"><td><p>precedence</p></td>
<td><p>precedence in the IPv6 header</p></td>
</tr>
<tr class="row-odd"><td><p>novell_type</p></td>
<td><p>(y/n) To use the Novell Standard Echo type instead of the Cisco ping echo type.</p></td>
</tr>
<tr class="row-even"><td><p>ping_packet_timeout</p></td>
<td><p>ping packet timeout in seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sweep_ping</p></td>
<td><p>sweep ping command</p></td>
</tr>
<tr class="row-even"><td><p>sweep_interval</p></td>
<td><p>sweep interval</p></td>
</tr>
<tr class="row-odd"><td><p>sweep_min</p></td>
<td><p>min packet size</p></td>
</tr>
<tr class="row-even"><td><p>sweep_max</p></td>
<td><p>max packet size</p></td>
</tr>
<tr class="row-odd"><td><p>extd_ping</p></td>
<td><p>(y/n) enable/disable extended ping.</p></td>
</tr>
<tr class="row-even"><td><p>ipv6_ext_headers</p></td>
<td><p>(y/n) include extension header or not</p></td>
</tr>
<tr class="row-odd"><td><p>ipv6_hbh_headers</p></td>
<td><p>(y/n) include hop by hop option or not.</p></td>
</tr>
<tr class="row-even"><td><p>ipv6_dst_headers</p></td>
<td><p>(y/n) include destination option or not.</p></td>
</tr>
<tr class="row-odd"><td><p>timestamp_count</p></td>
<td><p>number of timestamps</p></td>
</tr>
<tr class="row-even"><td><p>record_hops</p></td>
<td><p>Number of hops</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>ping command response on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">ping</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="s2">&quot;9.33.11.41&quot;</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">ping</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="s2">&quot;10.2.1.1&quot;</span><span class="p">,</span> <span class="n">extd_ping</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="switchto">
<h2>switchto<a class="headerlink" href="#switchto" title="Link to this heading">¶</a></h2>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">switchto</span></code> service is a helper method to switch between CLI states. This can be used to switch
to known states in the statemachine, e.g. ‘enable’ or ‘rommon’ (if supported by the plugin).</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>to_state</p></td>
<td><p>str or list</p></td>
<td><p>target state(s) to switch to</p></td>
</tr>
<tr class="row-odd"><td><p>timeout</p></td>
<td><p>int (default 60 sec)</p></td>
<td><p>timeout value for the command execution takes.</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">dev</span><span class="o">.</span><span class="n">state_machine</span><span class="o">.</span><span class="n">states</span>
<span class="p">[</span><span class="n">disable</span><span class="p">,</span> <span class="n">enable</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">rommon</span><span class="p">,</span> <span class="n">shell</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dev</span><span class="o">.</span><span class="n">switchto</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">)</span>

<span class="o">%</span><span class="n">UNICON</span><span class="o">-</span><span class="n">INFO</span><span class="p">:</span> <span class="o">+++</span> <span class="n">switchto</span><span class="p">:</span> <span class="n">config</span> <span class="o">+++</span>
<span class="n">config</span> <span class="n">term</span>
<span class="n">R1</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span><span class="c1">#</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>
</div>
</section>
<section id="traceroute">
<h2>traceroute<a class="headerlink" href="#traceroute" title="Link to this heading">¶</a></h2>
<p>Service to issue traceroute.</p>
<blockquote>
<div><dl class="simple">
<dt>traceroute_options = [‘proto’, ‘ingress’, ‘source’, ‘dscp’, ‘numeric’,</dt><dd><p>‘timeout’, ‘probe’, ‘minimum_ttl’, ‘maximum_ttl’,
‘port’, ‘style’ ]</p>
</dd>
</dl>
</div></blockquote>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>addr</p></td>
<td><p>Destination address</p></td>
</tr>
<tr class="row-odd"><td><p>proto</p></td>
<td><p>protocol(ip/ipv6)</p></td>
</tr>
<tr class="row-even"><td><p>ingress</p></td>
<td><p>Ingress traceroute</p></td>
</tr>
<tr class="row-odd"><td><p>source</p></td>
<td><p>Source address or interface</p></td>
</tr>
<tr class="row-even"><td><p>dscp</p></td>
<td><p>DSCP Value</p></td>
</tr>
<tr class="row-odd"><td><p>numeric</p></td>
<td><p>Numeric display</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>Timeout in seconds</p></td>
</tr>
<tr class="row-odd"><td><p>probe</p></td>
<td><p>Probe count</p></td>
</tr>
<tr class="row-even"><td><p>minimum_ttl</p></td>
<td><p>Minimum Time to Live</p></td>
</tr>
<tr class="row-odd"><td><p>maximum_ttl</p></td>
<td><p>Maximum Time to Live</p></td>
</tr>
<tr class="row-even"><td><p>port</p></td>
<td><p>Port Number</p></td>
</tr>
<tr class="row-odd"><td><p>style</p></td>
<td><p>Loose, Strict, Record, Timestamp, Verbose</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>traceroute command response on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">traceroute</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="s2">&quot;9.33.11.41&quot;</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">traceroute</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="s2">&quot;10.2.1.1&quot;</span><span class="p">,</span> <span class="n">maximum_ttl</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="copy">
<h2>copy<a class="headerlink" href="#copy" title="Link to this heading">¶</a></h2>
<p>Service to support variants of the IOS copy command, which basically
copies images and configs into and out of router Flash memory.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>source</p></td>
<td><p>filename/device partition/remote type ( i.e image.bin/disk0:/scp:)</p></td>
</tr>
<tr class="row-odd"><td><p>source_file</p></td>
<td><p>source file name in device disk/tftp (file name with path)</p></td>
</tr>
<tr class="row-even"><td><p>dest</p></td>
<td><p>destination filename/device partition/remote type( i.e startup-config/disk0:/scp:)</p></td>
</tr>
<tr class="row-odd"><td><p>dest_file</p></td>
<td><p>destination file name on device disk / tftp (file name with path)</p></td>
</tr>
<tr class="row-even"><td><p>dest_directory</p></td>
<td><p>destination directory for wildcard copy</p></td>
</tr>
<tr class="row-odd"><td><p>server</p></td>
<td><p>tftp/ftp server address or a name known to DNS</p></td>
</tr>
<tr class="row-even"><td><p>user</p></td>
<td><p>tftp/ftp/scp username for image copy</p></td>
</tr>
<tr class="row-odd"><td><p>password</p></td>
<td><p>tftp/ftp/scp password for image copy.  May be specified as a <span class="xref std std-ref">secret string</span> device credential.</p></td>
</tr>
<tr class="row-even"><td><p>vrf</p></td>
<td><p>VRF interface name</p></td>
</tr>
<tr class="row-odd"><td><p>erase</p></td>
<td><p>(yn) whether or not to erase Flash memory before copying. default value is n.</p></td>
</tr>
<tr class="row-even"><td><p>partition</p></td>
<td><p>used for dual-Flash routers. Specifies the Flash partition number to copy the router image to. If this option is not specified, the default partition provided is 0.</p></td>
</tr>
<tr class="row-odd"><td><p>overwrite</p></td>
<td><p>overwrite the file if exists. Default value is True</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>Copy timeout in sec</p></td>
</tr>
<tr class="row-odd"><td><p>net_type</p></td>
<td><p>host|network type of remote server</p></td>
</tr>
<tr class="row-even"><td><p>max_attempts</p></td>
<td><p>Copy at most this many times if a copy fails for any reason.</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Additional Dialog which are not handled by default.</p></td>
</tr>
<tr class="row-even"><td><p>extra_options</p></td>
<td><p>Additional platform dependent options to append to the copy command.</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>Copy command response on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;running-conf&#39;</span><span class="p">,</span>
               <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;startup-config&#39;</span><span class="p">)</span>

<span class="n">copy_input</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span> <span class="p">:</span><span class="s1">&#39;tftp:&#39;</span><span class="p">,</span>
              <span class="s1">&#39;dest&#39;</span><span class="p">:</span><span class="s1">&#39;disk0:&#39;</span><span class="p">,</span>
              <span class="s1">&#39;source_file&#39;</span> <span class="p">:</span> <span class="s1">&#39;copy-test&#39;</span><span class="p">,</span>
              <span class="s1">&#39;dest_file&#39;</span><span class="p">:</span><span class="s1">&#39;copy-test&#39;</span><span class="p">,</span>
              <span class="s1">&#39;erase&#39;</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">,}</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">copy_input</span><span class="p">)</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;tftp:&#39;</span><span class="p">,</span>
               <span class="n">dest</span> <span class="o">=</span> <span class="s1">&#39;bootflash:&#39;</span><span class="p">,</span>
               <span class="n">source_file</span>  <span class="o">=</span> <span class="s1">&#39;copy-test&#39;</span><span class="p">,</span>
               <span class="n">dest_file</span> <span class="o">=</span> <span class="s1">&#39;copy-test&#39;</span><span class="p">,</span>
               <span class="n">server</span><span class="o">=</span><span class="s1">&#39;10.105.33.158&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="reload">
<h2>reload<a class="headerlink" href="#reload" title="Link to this heading">¶</a></h2>
<p>Service to reload the device.</p>
<p>Sometimes reload fails because device prompt is unable to match
due to console messages over terminal and this results in reload timeout.
In such a case <code class="xref py py-obj docutils literal notranslate"><span class="pre">prompt_recovery</span></code> can be used to recover the device.
Refer <a class="reference internal" href="../../developer_guide/eal.html#prompt-recovery-label"><span class="std std-ref">Prompt Recovery Feature</span></a> for details on prompt_recovery feature.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>reload_command</p></td>
<td><p>str</p></td>
<td><p>reload command to be issued on device.
default reload_command is “reload”</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialogs/new dialogs which are not handled by default.</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout value in sec, Default Value is 300 sec</p></td>
</tr>
<tr class="row-odd"><td><p>reload_creds</p></td>
<td><p>list or str (‘default’)</p></td>
<td><p>Credentials to use if device prompts for user/pw.</p></td>
</tr>
<tr class="row-even"><td><p>prompt_recovery</p></td>
<td><p>bool (default False)</p></td>
<td><p>Enable/Disable prompt recovery feature</p></td>
</tr>
<tr class="row-odd"><td><p>return_output</p></td>
<td><p>bool (default False)</p></td>
<td><p>Return namedtuple with result and reload command output
This option is available for generic, nxos and iosxe/cat3k (single rp) plugin.</p></td>
</tr>
<tr class="row-even"><td><p>image_to_boot</p></td>
<td><p>str</p></td>
<td><p>Image to boot from rommon. Available for iosxe/cat3k and iosxe/cat9k</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
<li><p>If return_output is True, return a namedtuple with result and reload command output</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
<span class="c1"># If reload command is other than &#39;reload&#39;</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">reload_command</span><span class="o">=</span><span class="s2">&quot;reload location all&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

<span class="c1"># using prompt_recovery option</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">prompt_recovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># using return_output</span>
<span class="n">result</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">return_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default reload timeout values are</p>
<blockquote>
<div><p>single-rp generic = 300 sec</p>
<p>single-rp nxos    = 400 sec</p>
<p>dual-rp generic   = 500 sec</p>
<p>dual-rp nxos      = 600 sec</p>
</div></blockquote>
</div>
</section>
<section id="bash-console">
<h2>bash_console<a class="headerlink" href="#bash-console" title="Link to this heading">¶</a></h2>
<p>Service to execute commands in the router Bash. <code class="docutils literal notranslate"><span class="pre">bash_console</span></code>
gives you a router-like object to execute commands on using python context
managers.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int (default 60 sec)</p></td>
<td><p>timeout in sec for executing commands</p></td>
</tr>
<tr class="row-odd"><td><p>target</p></td>
<td><p>str</p></td>
<td><p>‘standby’ to bring standby console to bash.</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">device</span><span class="o">.</span><span class="n">bash_console</span><span class="p">()</span> <span class="k">as</span> <span class="n">bash</span><span class="p">:</span>
    <span class="n">output1</span> <span class="o">=</span> <span class="n">bash</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">)</span>
    <span class="n">output2</span> <span class="o">=</span> <span class="n">bash</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;pwd&#39;</span><span class="p">)</span>

<span class="c1"># To run bash on standby console.</span>
<span class="k">with</span> <span class="n">device</span><span class="o">.</span><span class="n">bash_console</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bash</span><span class="p">:</span>
    <span class="n">output1</span> <span class="o">=</span> <span class="n">bash</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;ls&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
    <span class="n">output2</span> <span class="o">=</span> <span class="n">bash</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;pwd&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="guestshell">
<h2>guestshell<a class="headerlink" href="#guestshell" title="Link to this heading">¶</a></h2>
<p>Service to execute commands in the Linux “guest shell” available on certain
NXOS and IOSXE platforms. <code class="docutils literal notranslate"><span class="pre">guestshell</span></code> gives you a router-like object to execute
commands on using a Python context manager.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>enable_guestshell</p></td>
<td><p>boolean</p></td>
<td><p>Explicitly enable the guestshell before attempting to enter.</p></td>
</tr>
<tr class="row-odd"><td><p>timeout</p></td>
<td><p>int (10)</p></td>
<td><p>Timeout for “guestshell enable”, “guestshell”, and “exit” commands.</p></td>
</tr>
<tr class="row-even"><td><p>retries</p></td>
<td><p>int (20)</p></td>
<td><p>Number of retries (x 5 second interval) to attempt to enable guestshell.</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">device</span><span class="o">.</span><span class="n">guestshell</span><span class="p">(</span><span class="n">enable_guestshell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span> <span class="k">as</span> <span class="n">gs</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ifconfig&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">device</span><span class="o">.</span><span class="n">guestshell</span><span class="p">()</span> <span class="k">as</span> <span class="n">gs</span><span class="p">:</span>
    <span class="n">output1</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;pwd&#39;</span><span class="p">)</span>
    <span class="n">output2</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;ls -al&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="dual-rp-services">
<h1>Dual RP Services<a class="headerlink" href="#dual-rp-services" title="Link to this heading">¶</a></h1>
<p>In addition to the common services, following are applicable only for only
<em>dual-rp</em> or <em>ha</em> platforms.</p>
<section id="get-mode">
<h2>get_mode<a class="headerlink" href="#get-mode" title="Link to this heading">¶</a></h2>
<p>Service to get the redundancy mode of the device.</p>
<blockquote>
<div><dl class="simple">
<dt>arg :</dt><dd><ul class="simple">
<li><p>None</p></li>
</ul>
</dd>
<dt>return :</dt><dd><ul class="simple">
<li><p>‘sso’, ‘rpr’, ‘’(‘if  not able to identify the mode’)</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">mode</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">get_mode</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="get-rp-state">
<h2>get_rp_state<a class="headerlink" href="#get-rp-state" title="Link to this heading">¶</a></h2>
<p>Service to get the redundancy state of the device rp. Returns  standby rp
state if standby is passed as input.</p>
<blockquote>
<div><dl class="simple">
<dt>arg :</dt><dd><ul class="simple">
<li><p>target=standby</p></li>
</ul>
</dd>
<dt>return :</dt><dd><ul class="simple">
<li><p>Expected return values are ACTIVE, STANDBY COLD, STANDBY HOT</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">get_rp_state</span><span class="p">()</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">get_rp_state</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="get-config">
<h2>get_config<a class="headerlink" href="#get-config" title="Link to this heading">¶</a></h2>
<dl>
<dt>Service return running configuration of the device.</dt><dd><p>Returns  standby running configuration if standby is passed as input.</p>
<dl class="simple">
<dt>arg :</dt><dd><ul class="simple">
<li><p>target=’standby’</p></li>
</ul>
</dd>
<dt>return :</dt><dd><ul class="simple">
<li><p>running configuration on Success ,</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id1">
<h2>guestshell<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>Service to execute commands in the Linux “guest shell” available on certain
NXOS and IOSXE platforms. <code class="docutils literal notranslate"><span class="pre">guestshell</span></code> gives you a router-like object to execute
commands on using a Python context manager.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>enable_guestshell</p></td>
<td><p>boolean</p></td>
<td><p>Explicitly enable the guestshell before attempting to enter.</p></td>
</tr>
<tr class="row-odd"><td><p>timeout</p></td>
<td><p>int (10)</p></td>
<td><p>Timeout for “guestshell enable”, “guestshell”, and “exit” commands.</p></td>
</tr>
<tr class="row-even"><td><p>retries</p></td>
<td><p>int (20)</p></td>
<td><p>Number of retries (x 5 second interval) to attempt to enable guestshell.</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">device</span><span class="o">.</span><span class="n">guestshell</span><span class="p">(</span><span class="n">enable_guestshell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span> <span class="k">as</span> <span class="n">gs</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ifconfig&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">device</span><span class="o">.</span><span class="n">guestshell</span><span class="p">()</span> <span class="k">as</span> <span class="n">gs</span><span class="p">:</span>
    <span class="n">output1</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;pwd&#39;</span><span class="p">)</span>
    <span class="n">output2</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;ls -al&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sync-state">
<h2>sync_state<a class="headerlink" href="#sync-state" title="Link to this heading">¶</a></h2>
<p>Service to bring the device to stable and re-designate the handles role.</p>
<blockquote>
<div><dl class="simple">
<dt>arg :</dt><dd><ul class="simple">
<li><p>None</p></li>
</ul>
</dd>
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success,</p></li>
<li><p>Raises SubcommandFailure exception on failure</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>
        <span class="n">rtr</span><span class="o">.</span><span class="n">sync_state</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="switchover">
<h2>switchover<a class="headerlink" href="#switchover" title="Link to this heading">¶</a></h2>
<p>Service to switchover the device.</p>
<p>Refer <a class="reference internal" href="../../developer_guide/eal.html#prompt-recovery-label"><span class="std std-ref">Prompt Recovery Feature</span></a> for details on <code class="xref py py-obj docutils literal notranslate"><span class="pre">prompt_recovery</span></code> argument.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>command</p></td>
<td><p>str</p></td>
<td><p>switchover command to be issued on device.
default command is “redundancy force-switchover”</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialogs/new dialogs which are not handled by default.</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout value in sec, Default Value is 500 sec</p></td>
</tr>
<tr class="row-odd"><td><p>sync_standby</p></td>
<td><p>boolean</p></td>
<td><p>Flag to decide whether to wait for standby to be UP or Not. default: True</p></td>
</tr>
<tr class="row-even"><td><p>prompt_recovery</p></td>
<td><p>boolean</p></td>
<td><p>Enable/Disable prompt recovery feature. Default is False.</p></td>
</tr>
<tr class="row-odd"><td><p>switchover_creds</p></td>
<td><p>list or str (‘default’)</p></td>
<td><p>Credentials to use if device prompts for user/pw.</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">()</span>

<span class="c1"># If switchover command is other than &#39;redundancy force-switchover&#39;</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s2">&quot;command which invoke switchover&quot;</span><span class="p">,</span>
               <span class="n">timeout</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
<span class="c1"># Switchover and not wait for standby to</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">(</span><span class="n">sync_standby</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># using prompt_recovery option</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">(</span><span class="n">prompt_recovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="reset-standby-rp">
<h2>reset_standby_rp<a class="headerlink" href="#reset-standby-rp" title="Link to this heading">¶</a></h2>
<p>Service to reset the standby rp.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>command</p></td>
<td><p>str</p></td>
<td><p>command to be issued on device.
default command is “redundancy reload peer”</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialogs/new dialogs which are not handled by default.</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout value in sec, Default Value is 500 sec</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>return :</p>
<blockquote>
<div><ul class="simple">
<li><p>True on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

  <span class="n">rtr</span><span class="o">.</span><span class="n">reset_standby_rp</span><span class="p">()</span>

  <span class="c1"># If command is other than &#39;redundancy reload peer&#39;</span>
  <span class="n">rtr</span><span class="o">.</span><span class="n">reset_standby_rp</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s2">&quot;command which invoke reload on standby-rp&quot;</span><span class="p">,</span>
                       <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="stack-rp-services">
<h1>Stack RP Services<a class="headerlink" href="#stack-rp-services" title="Link to this heading">¶</a></h1>
<p>In addition to the common services, following are applicable only for
<em>ha</em> platforms with <em>stack</em> RP.</p>
<section id="id2">
<h2>get_rp_state<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>Service to get the redundancy state of the device rp. Returns peer rp
state if peer rp alias is passed as input.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>target</p></td>
<td><p>str</p></td>
<td><p>target rp to check rp state. Default value is <code class="xref py py-obj docutils literal notranslate"><span class="pre">active</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>timeout</p></td>
<td><p>int (default 60 sec)</p></td>
<td><p>timeout in sec for executing commands</p></td>
</tr>
</tbody>
</table>
<p>return :</p>
<blockquote>
<div><ul class="simple">
<li><p>Target rp state on Success. Possible states ACTIVE, STANDBY, MEMBER</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">get_rp_state</span><span class="p">()</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">get_rp_state</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id3">
<h2>switchover<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<p>Service to switchover the stack device.</p>
<p>Refer <a class="reference internal" href="../../developer_guide/eal.html#prompt-recovery-label"><span class="std std-ref">Prompt Recovery Feature</span></a> for details on <code class="xref py py-obj docutils literal notranslate"><span class="pre">prompt_recovery</span></code> argument.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>command</p></td>
<td><p>str</p></td>
<td><p>switchover command to be issued on device.
default command is “redundancy force-switchover”</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialogs/new dialogs which are not handled by default.</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout value in sec, Default Value is 600 sec</p></td>
</tr>
<tr class="row-odd"><td><p>prompt_recovery</p></td>
<td><p>boolean</p></td>
<td><p>Enable/Disable prompt recovery feature. Default is False.</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">()</span>

<span class="c1"># If switchover command is other than &#39;redundancy force-switchover&#39;</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s2">&quot;command which invoke switchover&quot;</span><span class="p">,</span>
               <span class="n">timeout</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>

<span class="c1"># using prompt_recovery option</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">(</span><span class="n">prompt_recovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id4">
<h2>reload<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h2>
<p>Service to reload the stack device.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>reload_command</p></td>
<td><p>str</p></td>
<td><p>reload command to be issued on device.
default reload_command is “redundancy reload shelf”</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialogs/new dialogs which are not handled by default.</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout value in sec, Default Value is 900 sec</p></td>
</tr>
<tr class="row-odd"><td><p>image_to_boot</p></td>
<td><p>str</p></td>
<td><p>image to boot from rommon state</p></td>
</tr>
<tr class="row-even"><td><p>prompt_recovery</p></td>
<td><p>bool (default False)</p></td>
<td><p>Enable/Disable prompt recovery feature</p></td>
</tr>
<tr class="row-odd"><td><p>return_output</p></td>
<td><p>bool (default False)</p></td>
<td><p>Return namedtuple with result and reload command output</p></td>
</tr>
<tr class="row-even"><td><p>raise_on_error</p></td>
<td><p>bool (default: True)</p></td>
<td><p>Raise exception on error</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
<li><p>If return_output is True, return a namedtuple with result and reload command output</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
<span class="c1"># If reload command is other than &#39;redundancy reload shelf&#39;</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">reload_command</span><span class="o">=</span><span class="s2">&quot;reload location all&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

<span class="c1"># using prompt_recovery option</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">prompt_recovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># using return_output</span>
<span class="n">result</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">return_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="quad-rp-services">
<h1>Quad RP Services<a class="headerlink" href="#quad-rp-services" title="Link to this heading">¶</a></h1>
<p>In addition to the common services, following are applicable only for
<em>ha</em> platforms with <em>quad</em> RP.</p>
<section id="id5">
<h2>get_rp_state<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h2>
<p>Service to get the redundancy state for the quad rp device. Returns target rp
state if target is passed as input.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>target</p></td>
<td><p>str</p></td>
<td><p>target rp to check rp state. Default value is <code class="xref py py-obj docutils literal notranslate"><span class="pre">active</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>timeout</p></td>
<td><p>int (default 60 sec)</p></td>
<td><p>timeout in sec for executing commands</p></td>
</tr>
</tbody>
</table>
<p>return :</p>
<blockquote>
<div><ul class="simple">
<li><p>Target rp state on Success. Possible states ACTIVE, STANDBY, MEMBER, IN_CHASSIS_STANDBY</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">get_rp_state</span><span class="p">()</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">get_rp_state</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s1">&#39;standby&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id6">
<h2>switchover<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h2>
<p>Service to switchover the quad rp device.</p>
<p>Refer <a class="reference internal" href="../../developer_guide/eal.html#prompt-recovery-label"><span class="std std-ref">Prompt Recovery Feature</span></a> for details on <code class="xref py py-obj docutils literal notranslate"><span class="pre">prompt_recovery</span></code> argument.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>command</p></td>
<td><p>str</p></td>
<td><p>switchover command to be issued on device.
default command is “redundancy force-switchover”</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialogs/new dialogs which are not handled by default.</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout value in sec, Default Value is 600 sec</p></td>
</tr>
<tr class="row-odd"><td><p>sync_standby</p></td>
<td><p>boolean</p></td>
<td><p>Flag to decide whether to wait for standby to be UP or Not. default: True</p></td>
</tr>
<tr class="row-even"><td><p>prompt_recovery</p></td>
<td><p>boolean</p></td>
<td><p>Enable/Disable prompt recovery feature. Default is False.</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Example</span> <span class="p">::</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">()</span>

<span class="c1"># If switchover command is other than &#39;redundancy force-switchover&#39;</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s2">&quot;command which invoke switchover&quot;</span><span class="p">,</span>
               <span class="n">timeout</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>

<span class="c1"># Switchover and not wait for standby to</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">(</span><span class="n">sync_standby</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># using prompt_recovery option</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">switchover</span><span class="p">(</span><span class="n">prompt_recovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id7">
<h2>reload<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h2>
<p>Service to reload the quad rp device.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>reload_command</p></td>
<td><p>str</p></td>
<td><p>reload command to be issued on device.
default reload_command is “reload”</p></td>
</tr>
<tr class="row-odd"><td><p>reply</p></td>
<td><p>Dialog</p></td>
<td><p>additional dialogs/new dialogs which are not handled by default.</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>int</p></td>
<td><p>timeout value in sec, Default Value is 900 sec</p></td>
</tr>
<tr class="row-odd"><td><p>prompt_recovery</p></td>
<td><p>bool (default False)</p></td>
<td><p>Enable/Disable prompt recovery feature</p></td>
</tr>
<tr class="row-even"><td><p>return_output</p></td>
<td><p>bool (default False)</p></td>
<td><p>Return namedtuple with result and reload command output</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><dl class="simple">
<dt>return :</dt><dd><ul class="simple">
<li><p>True on Success</p></li>
<li><p>raise SubCommandFailure on failure.</p></li>
<li><p>If return_output is True, return a namedtuple with result and reload command output</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Example</span>
<span class="o">--------</span>

<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
<span class="c1"># If reload command is other than &#39;reload&#39;</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">reload_command</span><span class="o">=</span><span class="s2">&quot;reload location all&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="c1"># using prompt_recovery option</span>
<span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">prompt_recovery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># using return_output</span>
<span class="n">result</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">rtr</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">return_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="what_are_services.html" class="btn btn-neutral float-left" title="What Are Services" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="aci.html" class="btn btn-neutral float-right" title="ACI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014-2020, Cisco Systems Inc..
      <span class="lastupdated">Last updated on Dec 27, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>