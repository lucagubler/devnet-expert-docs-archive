{"pageProps":{"currentPath":"operations/mount-filter","frontMatter":{"layout":"guides","page_title":"Vault Mount Filter - Guides","description":"This guide demonstrates how to selectively filter out secret mounts for\nPerformance Replication."},"githubFileUrl":"https://github.com/hashicorp/vault/blob/main/website/content/guides/operations/mount-filter.mdx","mdxSource":{"compiledSource":"var c=Object.defineProperty;var r=Object.prototype.hasOwnProperty;var p=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable;var o=(a,n,t)=>n in a?c(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=>{for(var t in n||(n={}))r.call(n,t)&&o(a,t,n[t]);if(p)for(var t of p(n))l.call(n,t)&&o(a,t,n[t]);return a};var m=(a,n)=>{var t={};for(var s in a)r.call(a,s)&&n.indexOf(s)<0&&(t[s]=a[s]);if(a!=null&&p)for(var s of p(a))n.indexOf(s)<0&&l.call(a,s)&&(t[s]=a[s]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,e(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"h1\",e({},{className:\"g-type-display-2\"}),mdx(\"a\",e({parentName:\"h1\"},{className:\"__permalink-h\",href:\"#vault-mount-filter\",\"aria-label\":\"vault mount filter permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h1\"},{className:\"__target-h\",id:\"vault-mount-filter\",\"aria-hidden\":\"\"})),\"Vault Mount Filter\"),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Enterprise Only:\"),\" Mount filter feature is a part of \",mdx(\"em\",{parentName:\"p\"},\"Vault Enterprise Premium\"),\".\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Mount filters are a new way of controlling which secrets are moved across\nclusters and physical regions as a result of replication. With mount filters,\nusers can select which secret engines will be replicated as part of a\nperformance replication relationship.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`By default, all non-local secret engines and associated data are replicated as\npart of replication. The mount filter feature allows users to whitelist or\nblacklist which secret engines are replicated, thereby allowing users to further\ncontrol the movement of secrets across their infrastructure.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-2.png\",alt:\"Performance Replication\"}))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#reference-materials\",\"aria-label\":\"reference materials permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"reference-materials\",\"aria-hidden\":\"\"})),\"Reference Materials\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Preparing for GDPR Compliance with HashiCorp Vault \",mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.hashicorp.com/resources/preparing-for-gdpr-compliance-with-hashicorp-vault\"}),\"webinar\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Preparing for GDPR Compliance with HashiCorp Vault \",mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.hashicorp.com/blog/preparing-for-gdpr-compliance-with-hashicorp-vault\"}),\"blog post\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/api/system/replication/replication-performance#create-mounts-filter-deprecated\"}),\"Create Mounts Filter (API)\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/docs/enterprise/replication#performance-replication-and-disaster-recovery-dr-replication\"}),\"Performance Replication and Disaster Recovery (DR) Replication\"))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#estimated-time-to-complete\",\"aria-label\":\"estimated time to complete permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"estimated-time-to-complete\",\"aria-hidden\":\"\"})),\"Estimated Time to Complete\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"10 minutes\"),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#challenge\",\"aria-label\":\"challenge permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"challenge\",\"aria-hidden\":\"\"})),\"Challenge\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.eugdpr.org/\"}),mdx(\"strong\",{parentName:\"a\"},\"General Data Protection Regulation (GDPR)\")),` is designed\nto strengthen data protection and privacy for all individuals within the\nEuropean Union. It requires that personally identifiable data not be physically\ntransferred to locations outside the European Union unless the region or country\nhas an equal rigor of data protection regulation as the EU.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Failure to abide by GDPR will result in fines as high as 20 million EUR or 4% of\nthe global annual revenue (whichever greater).`),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#solution\",\"aria-label\":\"solution permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"solution\",\"aria-hidden\":\"\"})),\"Solution\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Leverage Vault's \",mdx(\"strong\",{parentName:\"p\"},\"mount filter\"),` feature to abide by data movements and\nsovereignty regulations while ensuring performance access across geographically\ndistributed regions.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.hashicorp.com/resources/preparing-for-gdpr-compliance-with-hashicorp-vault\"}),mdx(\"strong\",{parentName:\"a\"},mdx(\"em\",{parentName:\"strong\"},`Preparing for GDPR Compliance with HashiCorp\nVault`))),`\nwebinar discusses the GDPR compliance further in details.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"p\"},{href:\"https://youtu.be/hmf6sN4W8pE\"}),mdx(\"img\",e({parentName:\"a\"},{src:\"/img/vault-mount-filter.png\",alt:\"YouTube\"})))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#prerequisites\",\"aria-label\":\"prerequisites permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"prerequisites\",\"aria-hidden\":\"\"})),\"Prerequisites\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`This intermediate Vault operations guide assumes that you have some working\nknowledge of Vault.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`You need two Vault Enterprise clusters: one representing the EU cluster, and\nanother representing the US cluster both backed by Consul for storage.`),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#steps\",\"aria-label\":\"steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"steps\",\"aria-hidden\":\"\"})),\"Steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Scenario:\"),` You have a Vault cluster in EU and wish to span across the United\nStates by setting up a secondary cluster and enable the performance\nreplication. However, some data must remain in EU and should `,mdx(\"strong\",{parentName:\"p\"},mdx(\"em\",{parentName:\"strong\"},\"not\")),` be\nreplicated to the US cluster.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-0.png\",alt:\"Guide Scenario\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Leverage the mount filter feature to blacklist the secrets, that are subject to\nGDPR, from being replicated across the regions.`),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step1\"}),\"Segment GDPR and non-GDPR secret engines\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step2\"}),\"Enable performance replication with mount filter\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step3\"}),\"Verify the replication mount filter\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step4\"}),\"Enable a local secret engine\"))),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` Ensure that GDPR data is segmented by secret mount and blacklist\nthe movement of those secret mounts to non-GDPR territories.`)),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step1\",\"aria-label\":\"step 1 segment gdpr and non gdpr secret engines permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step1\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-1-segment-gdpr-and-non-gdpr-secret-engines\",\"aria-hidden\":\"\"})),\"Step 1: Segment GDPR and non-GDPR secret engines\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"In the EU cluster (primary cluster), enable key/value secret engines:\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"At \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"EU_GDPR_data\")),\" for GDPR data\"),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"At \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"US_NON_GDPR_data\")),\" for non-GDPR data localized for US\")),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# For GDPR data\"),`\n`,\"$ vault secrets \",mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\"enable\"),\" -path\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\"EU_GDPR_data kv-v2\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# For non-GDPR data accessible in US\"),`\n`,\"$ vault secrets \",mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\"enable\"),\" -path\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\"US_NON_GDPR_data kv-v2\",`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# For GDPR data\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --request POST \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --data \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),`'{\"type\":\"kv-v2\"}'`),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       https://eu-west-1.compute.com:8200/v1/sys/mounts/EU_GDPR_data\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# For non-GDPR data accessible in US\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"      --request POST \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"      --data \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),`'{\"type\":\"kv-v2\"}'`),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"      https://eu-west-1.compute.com:8200/v1/sys/mounts/US_NON_GDPR_data\",`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Open a web browser and launch the Vault UI (e.g.\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"https://eu-west-1.compute.com:8200/ui\"}),\"https://eu-west-1.compute.com:8200/ui\"),\") and then login.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Enable new engine\"),\" and enter corresponding parameter values:\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-3.png\",alt:\"GDPR KV\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-4.png\",alt:\"Non-GDPR KV\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Enable Engine\"),\" to complete.\"),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step2\",\"aria-label\":\"step 2 enable performance replication with mount filter permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step2\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-2-enable-performance-replication-with-mount-filter\",\"aria-hidden\":\"\"})),\"Step 2: Enable performance replication with mount filter\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-1\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-1\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enable performance replication on the \",mdx(\"strong\",{parentName:\"p\"},\"primary\"),\" cluster.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault write -f sys/replication/performance/primary/enable\",`\n`,\"WARNING! The following warnings were returned from Vault:\",`\n`,`\n`,\"* This cluster is being enabled as a primary for replication. Vault will be\",`\n`,\"unavailable for a brief period and will resume service shortly.\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate a secondary token.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ vault write sys/replication/performance/primary/secondary-token id=\"secondary\"',`\n`,\"Key                              Value\",`\n`,\"---                              -----\",`\n`,\"wrapping_token:                  eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJhZGRyIjoiaHR0cDovLzE3Mi4zMS4yMC4xODA6ODIwMyIsImV4cCI6MTUyNTg0ODAxMywiaWF0IjoxNTI1ODQ2MjEzLCJqdGkiOiJlNTFiMjUxZi01ZTg2LTg4OWEtNGZmMy03NTQzMjRkNTdlMGQiLCJ0eXBlIjoid3JhcHBpbmcifQ.MIGGAkE2dDj3nmaoLHg7oldQ1iZPD0U8doyj3x3mQUVfTl8W99QYG8GM6VGVzhRPGvKctGriuo2oXN_8euWQb01M1y6n7gJBSu-qdXw-v2RieOyopAHls1bWhw4sO9Nlds8IDFA15vqkLXnq2g4_5lvlhxpP7B8dEOHvWXkHG4kJ_mKvrgR0dU0\",`\n`,\"wrapping_accessor:               6ded4fb0-5e8c-2a37-1b3e-823673220348\",`\n`,\"wrapping_token_ttl:              30m\",`\n`,\"wrapping_token_creation_time:    2018-05-09 06:10:13.437421436 +0000 UTC\",`\n`,\"wrapping_token_creation_path:    sys/replication/performance/primary/secondary-token\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Create a \",mdx(\"strong\",{parentName:\"p\"},\"mount filter\"),\" to blacklist \",mdx(\"inlineCode\",{parentName:\"p\"},\"EU_GDPR_data\"),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault write sys/replication/performance/primary/mount-filter/secondary  \\\\\",`\n`,'       mode=\"blacklist\" paths=\"EU_GDPR_data/\"',`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enable performance replication on the \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" cluster.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ vault write sys/replication/performance/secondary/enable token=\"...\"',`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Where the \",mdx(\"inlineCode\",{parentName:\"p\"},\"token\"),\" is the \",mdx(\"inlineCode\",{parentName:\"p\"},\"wrapping_token\"),\" obtained from the primary cluster.\"),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-danger g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" This will immediately clear all data in the secondary cluster.\")))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-1\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-1\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enable performance replication on the \",mdx(\"strong\",{parentName:\"p\"},\"primary\"),\" cluster.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,`       --data '{\"primary_cluster_addr\":\"https://eu-west-1.compute.com:8200\"}' \\\\`,`\n`,\"       https://eu-west-1.compute.com:8200/v1/sys/replication/performance/primary/enable\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate a secondary token.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,`       --data '{ \"id\": \"secondary\"}' \\\\`,`\n`,\"       https://eu-west-1.compute.com:8200/v1/sys/replication/performance/primary/secondary-token | jq\",`\n`,\"  {\",`\n`,'   \"request_id\": \"\",',`\n`,'   \"lease_id\": \"\",',`\n`,'   \"renewable\": false,',`\n`,'   \"lease_duration\": 0,',`\n`,'   \"data\": null,',`\n`,'   \"wrap_info\": {',`\n`,'     \"token\": \"eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJhZGRyIjoiaHR0cDovLzEyNy4wLjAuMTo4MjAzIiwiZXhwIjoxNTI1ODI5Njc2LCJpYXQiOjE1MjU4Mjc4NzYsImp0aSI6IjAwNmVkMDdjLWQ0MzYtZWViYy01OWYwLTdiMTU0ZGFmMDNiMCIsInR5cGUiOiJ3cmFwcGluZyJ9.MIGHAkF6saWWL-oRQMJIoUnaUOHNkcoHZCBwQs6mSMjPBopMi8DkGCJGBrh4jgV2mSzwFY1r5Ne7O66HmuMpm40MsYqjAQJCANSco_Sx5q6FmQSfoY-HtsVO1_YKWF4O6B7gYCvPKYkODMIwe5orCSgmIDyXHZt-REPm0sfdk4ZNyRCIRK5hDWyQ\",',`\n`,'     \"accessor\": \"6ea2a4e2-2926-120f-f288-c2348c78fb3e\",',`\n`,'     \"ttl\": 1800,',`\n`,'     \"creation_time\": \"2018-05-09T01:04:36.514715311Z\",',`\n`,'     \"creation_path\": \"sys/replication/performance/primary/secondary-token\"',`\n`,\"   },\",`\n`,'   \"warnings\": null,',`\n`,'   \"auth\": null',`\n`,\" }\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Create a \",mdx(\"strong\",{parentName:\"p\"},\"mount filter\"),\" to blacklist \",mdx(\"inlineCode\",{parentName:\"p\"},\"EU_GDPR_data\"),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload.json <<EOF\",`\n`,\"{\",`\n`,'  \"mode\": \"blacklist\",',`\n`,'  \"paths\": [ \"EU_GDPR_data/\" ]',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,\"       --data @payload.json \\\\\",`\n`,\"       https://eu-west-1.compute.com:8200/v1/sys/replication/performance/primary/mount-filter/secondary\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enable performance replication on the \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" cluster.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload.json <<EOF\",`\n`,\"{\",`\n`,'  \"token\": \"...\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,\"       --data @payload.json \\\\\",`\n`,\"       https://us-central.compute.com:8201/v1/sys/replication/performance/secondary/enable\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Where the \",mdx(\"inlineCode\",{parentName:\"p\"},\"token\"),\" in \",mdx(\"inlineCode\",{parentName:\"p\"},\"payload.json\"),` is the token obtained from the primary\ncluster.`),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-danger g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" This will immediately clear all data in the secondary cluster.\")))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-1\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-1\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Replication\"),\" and check the \",mdx(\"strong\",{parentName:\"p\"},\"Performance\"),` radio button.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-5.png\",alt:\"Performance Replication - primary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Enable replication\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select the \",mdx(\"strong\",{parentName:\"p\"},\"Secondaries\"),\" tab, and then click \",mdx(\"strong\",{parentName:\"p\"},\"Add\"),`.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-6.png\",alt:\"Performance Replication - primary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Populate the \",mdx(\"strong\",{parentName:\"p\"},\"Secondary ID\"),\" field, and then select \",mdx(\"strong\",{parentName:\"p\"},`Configure performance\nmount filtering`),` to set your mount filter options. You can filter by\nwhitelisting or blacklisting. For this example, select `,mdx(\"strong\",{parentName:\"p\"},\"Blacklist\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Check \",mdx(\"strong\",{parentName:\"p\"},\"EU_GDPR_data\"),` to prevent it from being replicated to the secondary\ncluster.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-7.png\",alt:\"Performance Replication - primary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Generate token\"),`.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-8.png\",alt:\"Performance Replication - primary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Copy\"),\" to copy the token.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Now, launch the Vault UI for the secondary cluster (e.g. \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://us-central.compute.com:8201/ui\"}),\"https://us-central.compute.com:8201/ui\"),\"), and then click \",mdx(\"strong\",{parentName:\"p\"},\"Replication\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Check the \",mdx(\"strong\",{parentName:\"p\"},\"Performance\"),\" radio button, and then select \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" under the \",mdx(\"strong\",{parentName:\"p\"},\"Cluster mode\"),`. Paste the token you copied from the primary.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-9.png\",alt:\"Performance Replication - secondary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Enable replication\"),\".\"))),mdx(\"br\",null),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` At this point, the secondary cluster must be unsealed using the\n`,mdx(\"strong\",{parentName:\"p\"},\"primary cluster's unseal key\"),`. If the secondary is in an HA cluster, ensure\nthat each standby is sealed and unsealed with the primary\\u2019s unseal keys. The\nsecondary cluster mirrors the configuration of its primary cluster's backends\nsuch as auth methods, secret engines, audit devices, etc. It uses the primary as\nthe `,mdx(\"em\",{parentName:\"p\"},\"source of truth\"),\" and passes token requests to the primary.\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Restart the secondary vault server (e.g. \",mdx(\"inlineCode\",{parentName:\"p\"},\"https://us-central.compute.com:8201\"),`)\nand unseal it with the primary cluster's unseal key.`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault operator unseal\")),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"Unseal Key (will be hidden): <primary_cluster_unseal_key>\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`The initial root token on the secondary no longer works. Use the auth methods\nconfigured on the primary cluster to log into the secondary.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Enable and configure the userpass auth method on the \",mdx(\"strong\",{parentName:\"p\"},\"primary\"),` cluster and\ncreate a new username and password.`),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Enable the userpass auth method on the primary\"),`\n`,\"$ vault auth \",mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\"enable\"),\" userpass\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create a user with admin policy\"),`\n`,\"$ vault \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"write\"),\" auth/userpass/users/james \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"password\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"passw0rd\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"policy\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"admin\"'),`\n`)),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"Alternatively, you can \",mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/operations/generate-root\"}),\"generate a new root token\"),`\nusing the primary cluster's unseal key. However, it is recommended that root\ntokens are only used for just enough initial setup or in emergencies.`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Log into the \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" cluster using the enabled auth method.\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault login -method\",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"userpass \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"username\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"james \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"password\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"passw0rd\"'))),`\n`)),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step3\",\"aria-label\":\"step 3 verify the replication mount filter permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step3\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-3-verify-the-replication-mount-filter\",\"aria-hidden\":\"\"})),\"Step 3: Verify the replication mount filter\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Once the replication completes, verify that the secrets stored in the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"EU_GDPR_data\"),\" never get replicated to the US cluster.\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-2\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-2\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"On the \",mdx(\"strong\",{parentName:\"p\"},\"EU\"),\" cluster, write some secrets:\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Write some secret at EU_GDPR_data/secret\"),`\n`,\"$ vault kv put EU_GDPR_data/secret \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"pswd\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"password\"'),`\n`,\"Key              Value\",`\n`,\"---              -----\",`\n`,\"created_time     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2018\"),\"-05-10T18:00:38.912587665Z\",`\n`,\"deletion_time    n/a\",`\n`,\"destroyed        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),`\n`,\"version          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"1\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Write some secret at US_NON_GDPR_data/secret\"),`\n`,\"$ vault kv put US_NON_GDPR_data/secret \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"apikey\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"my-api-key\"'),`\n`,\"Key              Value\",`\n`,\"---              -----\",`\n`,\"created_time     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2018\"),\"-05-10T18:04:37.554665851Z\",`\n`,\"deletion_time    n/a\",`\n`,\"destroyed        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),`\n`,\"version          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"1\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"From the \",mdx(\"strong\",{parentName:\"p\"},\"US\"),\" cluster, read the secrets:\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Read the secrets at EU_GDPR_data/secret\"),`\n`,\"$ vault kv get EU_GDPR_data/secret\",`\n`,\"No value found at EU_GDPR_data/secret\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Read the secrets at US_NON_GDPR_data/secret\"),`\n`,\"$ vault kv get US_NON_GDPR_data/secret\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),\" Metadata \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),`\n`,\"Key              Value\",`\n`,\"---              -----\",`\n`,\"created_time     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2018\"),\"-05-10T18:09:07.717250408Z\",`\n`,\"deletion_time    n/a\",`\n`,\"destroyed        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"false\"),`\n`,\"version          \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"1\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" Data \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),`\n`,\"Key       Value\",`\n`,\"---       -----\",`\n`,\"apikey    my-api-key\",`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-2\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-2\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"On the \",mdx(\"strong\",{parentName:\"p\"},\"EU\"),\" cluster, write some secret:\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create the request payload\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"tee\"),\" payload.json \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"<<\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"EOF\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'  \"data\": {'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'    \"pswd\": \"password\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"  }\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"EOF\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Write some secret at EU_GDPR_data/secret\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --request POST \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --data @payload.json \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       https://eu-west-1.compute.com:8200/v1/EU_GDPR_data/data/secret\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create the request payload\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"tee\"),\" payload-us.json \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"<<\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"EOF\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),' \"data\": {'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'   \"apikey\": \"my-api-key\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\" }\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"EOF\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Write some secret at US_NON_GDPR_data/secret\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --request POST \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --data @payload-us.json \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       https://eu-west-1.compute.com:8200/v1/US_NON_GDPR_data/data/secret\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"From the \",mdx(\"strong\",{parentName:\"p\"},\"US\"),\" cluster, read the secrets:\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Read the secrets at EU_GDPR_data/secret\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       https://us-central.compute.com:8201/v1/EU_GDPR_data/data/secret \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"|\"),\" jq\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"errors\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Read the secrets at US_NON_GDPR_data/secret\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       https://us-central.compute.com:8201/v1/US_NON_GDPR_data/data/secret \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"|\"),\" jq\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"request_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"f5eedb5b-9406-c519-f5a5-070336c10205\"'),\",\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"lease_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),\",\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"renewable\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" false,\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"lease_duration\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"0\"),\",\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"data\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" null,\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"wrap_info\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" null,\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"warnings\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),`\"Invalid path for a versioned K/V secrets engine. See the API docs for the appropriate API endpoints to use. If using the Vault CLI, use 'vault kv get' for this operation.\"`),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\",\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"auth\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" null\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-2\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-2\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"On the \",mdx(\"strong\",{parentName:\"p\"},\"EU\"),\" cluster, select \",mdx(\"strong\",{parentName:\"p\"},\"EU_GDPR_data\"),\" > \",mdx(\"strong\",{parentName:\"p\"},\"Create secret\"),\":\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-12.png\",alt:\"Secrets\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Enter the values and click \",mdx(\"strong\",{parentName:\"p\"},\"Save\"),`. Repeat the step to write some secrets at\nthe `,mdx(\"strong\",{parentName:\"p\"},\"US_NON_GDPR_data\"),\" path as well.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"On the \",mdx(\"strong\",{parentName:\"p\"},\"US\"),\" cluster, select \",mdx(\"strong\",{parentName:\"p\"},\"US_NON_GDPR_data\"),`. You should be able to see\nthe `,mdx(\"inlineCode\",{parentName:\"p\"},\"apikey\"),\" under \",mdx(\"inlineCode\",{parentName:\"p\"},\"US_NON_GDPR_data/secret\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-13.png\",alt:\"Secrets\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The \",mdx(\"strong\",{parentName:\"p\"},\"EU_GDPR_data\"),` data is not replicated, so you won't be able to see the\nsecrets.`),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step4\",\"aria-label\":\"step 4 enable a local secret engine permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step4\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-4-enable-a-local-secret-engine\",\"aria-hidden\":\"\"})),\"Step 4: Enable a local secret engine\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`When replication is enabled, you can mark the secrets engine local only. Local\nsecret engines are not replicated or removed by replication.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Login to the \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),` cluster and enable key/value secret engine at\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"US_ONLY_data\"),\" to store secrets only valid for the US region.\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-3\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-3\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Pass the \",mdx(\"inlineCode\",{parentName:\"p\"},\"-local\"),\" flag:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault secrets \",mdx(\"span\",e({parentName:\"span\"},{className:\"token builtin class-name\"}),\"enable\"),\" -local -path\",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"US_ONLY_data kv-v2\")),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-3\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-3\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Pass the \",mdx(\"inlineCode\",{parentName:\"p\"},\"local\"),\" parameter in the API request:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"tee\"),\" payload.json \",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"<<\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),\"EOF\"))),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),\"{\"))),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'  \"type\": \"kv-v2\",'))),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'  \"local\": true'))),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),\"}\"))),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),\"EOF\"))),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --request POST \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --data @payload.json \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       https://us-central.compute.com:8201/v1/sys/mounts/US_ONLY_data\"),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-3\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-3\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Be sure to select the check box for \",mdx(\"strong\",{parentName:\"p\"},\"Local\"),` to keep it mounted locally within\nthe cluster.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-mount-filter-10.png\",alt:\"Local Secret\"}))),mdx(\"br\",null),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" \",mdx(\"inlineCode\",{parentName:\"p\"},\"US_ONLY_data\"),` only exists locally in the secondary cluster that\nyou won't be able to see it from the primary cluster.`)),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#next-steps\",\"aria-label\":\"next steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"next-steps\",\"aria-hidden\":\"\"})),\"Next steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Read \",mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/operations/reference-architecture\"}),`Vault Deployment Reference\nArchitecture`),` to learn more\nabout the recommended deployment practices.`))}MDXContent.isMDXComponent=!0;\n","scope":{}},"navData":[{"title":"Getting Started","path":"getting-started","filePath":"content/guides/getting-started.mdx"},{"title":"Vault Operations","routes":[{"title":"Overview","path":"operations","filePath":"content/guides/operations/index.mdx"},{"title":"Reference Architecture","path":"operations/reference-architecture","filePath":"content/guides/operations/reference-architecture.mdx"},{"title":"Vault HA with Consul","path":"operations/vault-ha-consul","filePath":"content/guides/operations/vault-ha-consul.mdx"},{"title":"Production Hardening","path":"operations/production","filePath":"content/guides/operations/production.mdx"},{"title":"Root Token Generation","path":"operations/generate-root","filePath":"content/guides/operations/generate-root.mdx"},{"title":"Rekeying & Rotating","path":"operations/rekeying-and-rotating","filePath":"content/guides/operations/rekeying-and-rotating.mdx"},{"title":"Building Plugin Backends","path":"operations/plugin-backends","filePath":"content/guides/operations/plugin-backends.mdx"},{"divider":true},{"title":"Replication Setup & Guidance","path":"operations/replication","filePath":"content/guides/operations/replication.mdx"},{"title":"Disaster Recovery Setup","path":"operations/disaster-recovery","filePath":"content/guides/operations/disaster-recovery.mdx"},{"title":"Mount Filter","path":"operations/mount-filter","filePath":"content/guides/operations/mount-filter.mdx"},{"title":"Multi-Tenant: Namespaces","path":"operations/multi-tenant","filePath":"content/guides/operations/multi-tenant.mdx"},{"title":"Vault Auto-unseal with AWS KMS","path":"operations/autounseal-aws-kms","filePath":"content/guides/operations/autounseal-aws-kms.mdx"},{"title":"Seal Wrap / FIPS 140-2","path":"operations/seal-wrap","filePath":"content/guides/operations/seal-wrap.mdx"},{"title":"Vault Cluster Monitoring","path":"operations/monitoring","filePath":"content/guides/operations/monitoring.mdx"},{"title":"Vault Deployment Guide","path":"operations/deployment-guide","filePath":"content/guides/operations/deployment-guide.mdx"},{"title":"Performance Standby Nodes","path":"operations/performance-nodes","filePath":"content/guides/operations/performance-nodes.mdx"}]},{"title":"Identity and Access Management","routes":[{"title":"Overview","path":"identity","filePath":"content/guides/identity/index.mdx"},{"title":"Secure Introduction of Vault Clients","path":"identity/secure-intro","filePath":"content/guides/identity/secure-intro.mdx"},{"title":"Policies","path":"identity/policies","filePath":"content/guides/identity/policies.mdx"},{"title":"ACL Policy Path Templating","path":"identity/policy-templating","filePath":"content/guides/identity/policy-templating.mdx"},{"title":"AppRole Pull Authentication","path":"identity/authentication","filePath":"content/guides/identity/authentication.mdx"},{"title":"AppRole with Terraform and Chef","path":"identity/approle-trusted-entities","filePath":"content/guides/identity/approle-trusted-entities.mdx"},{"title":"Tokens and Leases","path":"identity/lease","filePath":"content/guides/identity/lease.mdx"},{"title":"Identity - Entities & Groups","path":"identity/identity","filePath":"content/guides/identity/identity.mdx"},{"divider":true},{"title":"Sentinel Policies","path":"identity/sentinel","filePath":"content/guides/identity/sentinel.mdx"},{"title":"Control Groups","path":"identity/control-groups","filePath":"content/guides/identity/control-groups.mdx"}]},{"title":"Secrets Management","routes":[{"title":"Overview","path":"secret-mgmt","filePath":"content/guides/secret-mgmt/index.mdx"},{"title":"Static Secrets","path":"secret-mgmt/static-secrets","filePath":"content/guides/secret-mgmt/static-secrets.mdx"},{"title":"Versioned KV Secret Engine","path":"secret-mgmt/versioned-kv","filePath":"content/guides/secret-mgmt/versioned-kv.mdx"},{"title":"Secret as a Service","path":"secret-mgmt/dynamic-secrets","filePath":"content/guides/secret-mgmt/dynamic-secrets.mdx"},{"title":"DB Root Credential Rotation","path":"secret-mgmt/db-root-rotation","filePath":"content/guides/secret-mgmt/db-root-rotation.mdx"},{"title":"Cubbyhole Response Wrapping","path":"secret-mgmt/cubbyhole","filePath":"content/guides/secret-mgmt/cubbyhole.mdx"},{"title":"One-Time SSH Password","path":"secret-mgmt/ssh-otp","filePath":"content/guides/secret-mgmt/ssh-otp.mdx"},{"title":"Build Your Own CA","path":"secret-mgmt/pki-engine","filePath":"content/guides/secret-mgmt/pki-engine.mdx"},{"title":"Direct Application Integration","path":"secret-mgmt/app-integration","filePath":"content/guides/secret-mgmt/app-integration.mdx"}]},{"title":"Encryption as a Service","routes":[{"title":"Overview","path":"encryption","filePath":"content/guides/encryption/index.mdx"},{"title":"Encryption as a Service","path":"encryption/transit","filePath":"content/guides/encryption/transit.mdx"},{"title":"Java Application Demo","path":"encryption/spring-demo","filePath":"content/guides/encryption/spring-demo.mdx"},{"title":"Transit Secrets Re-wrapping","path":"encryption/transit-rewrap","filePath":"content/guides/encryption/transit-rewrap.mdx"}]}],"versions":[]},"__N_SSG":true}