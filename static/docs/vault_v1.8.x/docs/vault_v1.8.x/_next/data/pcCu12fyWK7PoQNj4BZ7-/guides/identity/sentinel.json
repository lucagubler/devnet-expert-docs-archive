{"pageProps":{"currentPath":"identity/sentinel","frontMatter":{"layout":"guides","page_title":"Sentinel - Guides","description":"Vault Enterprise supports Sentinel to provide a rich set of access control\nfunctionality. This guide walks through the creation and usage of role\ngoverning policies (RGPs) and endpoint governing policies (EGPs)."},"githubFileUrl":"https://github.com/hashicorp/vault/blob/main/website/content/guides/identity/sentinel.mdx","mdxSource":{"compiledSource":"var m=Object.defineProperty;var o=Object.prototype.hasOwnProperty;var p=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable;var r=(a,n,t)=>n in a?m(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=>{for(var t in n||(n={}))o.call(n,t)&&r(a,t,n[t]);if(p)for(var t of p(n))l.call(n,t)&&r(a,t,n[t]);return a};var i=(a,n)=>{var t={};for(var s in a)o.call(a,s)&&n.indexOf(s)<0&&(t[s]=a[s]);if(a!=null&&p)for(var s of p(a))n.indexOf(s)<0&&l.call(a,s)&&(t[s]=a[s]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=i(s,[\"components\"]);return mdx(MDXLayout,e(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"h1\",e({},{className:\"g-type-display-2\"}),mdx(\"a\",e({parentName:\"h1\"},{className:\"__permalink-h\",href:\"#sentinel-policies\",\"aria-label\":\"sentinel policies permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h1\"},{className:\"__target-h\",id:\"sentinel-policies\",\"aria-hidden\":\"\"})),\"Sentinel Policies\"),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Enterprise Only:\"),\" Sentinel is a part of \",mdx(\"em\",{parentName:\"p\"},\"Vault Enterprise Premium\"),\".\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"em\",{parentName:\"p\"},\"Sentinel\"),` is a language framework for policy build to be embedded in Vault\nEnterprise to enable fine-grained, logic-based policy decisions which cannot be\nfully handled by the ACL policies.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Role Governing Policies (RGPs)\"),\" and \",mdx(\"strong\",{parentName:\"p\"},`Endpoint Governing\nPolicies (EGPs)`),\" can be defined using Sentinel:\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"RGPs are tied to particular tokens, identity entities, or identity groups\"),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"EGPs are tied to particular paths (e.g. \",mdx(\"inlineCode\",{parentName:\"li\"},\"aws/creds/\"),\")\")),mdx(\"blockquote\",null,mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),`This guide walks you through the authoring of Sentinel policies in Vault. For\nACL policy authoring, refer to the `,mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/identity/policies\"}),\"Policies\"),`\nguide.`)),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#reference-material\",\"aria-label\":\"reference material permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"reference-material\",\"aria-hidden\":\"\"})),\"Reference Material\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"https://docs.hashicorp.com/sentinel/intro/getting-started/first-policy\"}),\"Sentinel Getting Started Guide\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"https://docs.hashicorp.com/sentinel/\"}),\"Sentinel\"),\" documentation\"),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/docs/enterprise/sentinel\"}),\"Vault Sentinel\"),\" documentation\"),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.youtube.com/watch?time_continue=121&v=yiPbKICFkvQ\"}),\"Security and Fundamentals at Scale with Vault\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/guides/identity/identity\"}),\"Identity - Entities and Groups\"),\" guide\")),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#estimated-time-to-complete\",\"aria-label\":\"estimated time to complete permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"estimated-time-to-complete\",\"aria-hidden\":\"\"})),\"Estimated Time to Complete\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"5 - 10 minutes\"),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#challenge\",\"aria-label\":\"challenge permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"challenge\",\"aria-hidden\":\"\"})),\"Challenge\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"ACL policies are \",mdx(\"strong\",{parentName:\"p\"},mdx(\"em\",{parentName:\"strong\"},\"path-based\")),\" that it has the following challenges:\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Cannot grant permissions based on logics other than paths\"),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),`Paths are merged in ACL policies which could potentially cause a conflict as\nthe number of policies grows`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"What if the policy requirement was to grant read permission on \",mdx(\"inlineCode\",{parentName:\"p\"},\"secret/orders\"),`\npath `,mdx(\"strong\",{parentName:\"p\"},mdx(\"em\",{parentName:\"strong\"},\"only if\")),\" the request came from an IP address within a certain CIDR?\"),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#solution\",\"aria-label\":\"solution permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"solution\",\"aria-hidden\":\"\"})),\"Solution\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Use Sentinel policies (RGPs and/or EGPs) to fulfill more complex policy\nrequirements.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Sentinel can access properties of the incoming requests and make a decision\nbased on a certain set of conditions. Available properties include:`),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"li\"},\"request\"),` - Information about the request itself (path, operation type,\nparameters, etc.)`),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"li\"},\"token\"),` - Information about the token being used (creation time, attached\npolicies, etc.)`),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"li\"},\"identity\"),\" - Identity entities and all related data\"),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"li\"},\"mfa\"),\" - Information about successful MFA validations\")),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#prerequisites\",\"aria-label\":\"prerequisites permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"prerequisites\",\"aria-hidden\":\"\"})),\"Prerequisites\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"To perform the tasks described in this guide, you need to have a \",mdx(\"strong\",{parentName:\"p\"},mdx(\"em\",{parentName:\"strong\"},`Vault\nEnterprise`)),\" environment.\"),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#policy-requirements\",\"aria-label\":\"policy requirements permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"policy-requirements\",\"aria-hidden\":\"\"})),\"Policy requirements\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Since this guide demonstrates the creation of policies, log in with highly\nprivileged token such as `,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"root\")),\". Required permissions are:\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# To list policies\"),`\n`,\"path \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"sys/policies/*\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  capabilities \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"list\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create and manage EGPs\"),`\n`,\"path \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"sys/policies/egp/*\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  capabilities \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"create\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"read\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"update\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"delete\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"list\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#steps\",\"aria-label\":\"steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"steps\",\"aria-hidden\":\"\"})),\"Steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"This guide demonstrates basic Sentinel policy authoring and management tasks.\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step1\"}),\"Write Sentinel Policies\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step2\"}),\"Test the Sentinel Policies\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step3\"}),\"Deploy your EGP policies\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step4\"}),\"Delete Sentinel Policies\"))),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step1\",\"aria-label\":\"step 1 write sentinel policies permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step1\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-1-write-sentinel-policies\",\"aria-hidden\":\"\"})),\"Step 1: Write Sentinel Policies\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#anatomy-of-sentinel-policies\",\"aria-label\":\"anatomy of sentinel policies permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"anatomy-of-sentinel-policies\",\"aria-hidden\":\"\"})),\"Anatomy of Sentinel Policies\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),\"import \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"<library>\"'),`\n`,`\n`,\"<variable> \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" <value>\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"main\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"rule\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"     <conditions_to_evaluate>\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"import\")),` - Enables your policy to access reusable libraries. There are a\nset of built-in `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.hashicorp.com/sentinel/imports/\"}),\"imports\"),`\navailable to help define your policy rules.`)),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"main\")),\" (required) - Every Sentinel policy must have a \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"main\")),` rule\nwhich is evaluated to determine the result of a policy.`)),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"rule\")),` - A first-class construct in Sentinel. It describes a set of\nconditions resulting in either true or false. (NOTE: Refer to the `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.hashicorp.com/sentinel/language/boolexpr\"}),`Boolean\nExpressions`),` for the full\nlist of available operators in writing rules.)`)),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"<variable>\")),` - Variables are dynamically typed in Sentinel. You can define\nits value explicitly or implicitly by the host system or `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.hashicorp.com/sentinel/language/functions\"}),\"function\"),\".\"))),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` The Sentinel language supports many features such as functions,\nloops, slices, etc. You can learn about all of this in the `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.hashicorp.com/sentinel/language/\"}),`complete language\nguide`),\".\")),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#policy-requirements-1\",\"aria-label\":\"policy requirements permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"policy-requirements-1\",\"aria-hidden\":\"\"})),\"Policy requirements\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`In this guide, you are going to write Sentinel policies that fulfill the\nfollowing requirements:`),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),'Any incoming request against the \"',mdx(\"inlineCode\",{parentName:\"p\"},\"secret/accounting/*\"),`\" to be performed\nduring the business hours (7:00 am to 6:00 pm during the work days).`)),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Any \",mdx(\"inlineCode\",{parentName:\"p\"},\"create\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"update\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"delete\"),` operations against Key/Value secret\nengine (mounted at \"`,mdx(\"inlineCode\",{parentName:\"p\"},\"secret\"),'\") ',mdx(\"strong\",{parentName:\"p\"},\"must\"),` come from an internal IP of\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"122.22.3.4/32\"),\" CIDR.\"))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#sentinel-policies-1\",\"aria-label\":\"sentinel policies permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"sentinel-policies-1\",\"aria-hidden\":\"\"})),\"Sentinel Policies\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Requirement #1: \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"business-hrs.sentinel\"))),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"time\"'),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Expect requests to only happen during work days (Monday through Friday)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# 0 for Sunday and 6 for Saturday\"),`\n`,\"workdays \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" rule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    time.now.weekday \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\">\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"0\"),\" and time.now.weekday \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"<\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"6\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Expect requests to only happen during work hours (7:00 am - 6:00 pm)\"),`\n`,\"workhours \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" rule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    time.now.hour \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\">\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"7\"),\" and time.now.hour \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"<\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"18\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"main \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" rule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    workdays and workhours\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Requirement #2: \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"cidr-check.sentinel\"))),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"sockaddr\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"strings\"'),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Only care about create, update, and delete operations against secret path\"),`\n`,\"precond \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" rule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    request.operation \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"in\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"create\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"update\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"delete\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\" and\",`\n`,\"    strings.has_prefix\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"request.path, \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"secret/\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Requests to come only from our private IP range\"),`\n`,\"cidrcheck \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" rule \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    sockaddr.is_contained\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"request.connection.remote_addr, \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"122.22.3.4/32\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Check the precondition before execute the cidrcheck\"),`\n`,\"main \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" rule when precond \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    cidrcheck\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"blockquote\",null,mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" The \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"main\")),\" has conditional rule (\",mdx(\"inlineCode\",{parentName:\"p\"},\"when precond\"),`) to ensure that\nthe rule gets evaluated only if the request is relevant.`)),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"Refer to the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/docs/enterprise/sentinel/properties\"}),\"Sentinel Properties\"),`\ndocumentation for available properties which Vault injects to Sentinel to allow\nfine-grained controls.`)),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step2\",\"aria-label\":\"step 2 test the sentinel policies permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step2\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-2-test-the-sentinel-policies\",\"aria-hidden\":\"\"})),\"Step 2: Test the Sentinel Policies\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`You can test the Sentinel policies prior to deployment in orders to validate\nsyntax and to document expected behavior.`),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"First, you need to download the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.hashicorp.com/sentinel/downloads\"}),\"Sentinel simulator\"),\".\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ wget https://releases.hashicorp.com/sentinel/0.3.1/sentinel_0.3.1_darwin_amd64.zip\",`\n`,\"$ unzip sentinel_0.3.1_darwin_amd64.zip -d /usr/local/bin\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Create a sub-folder named, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"test\")),\" where \",mdx(\"inlineCode\",{parentName:\"p\"},\"cidr-check.sentinel\"),` and\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"business-hrs.sentinel\"),\" policies are located. Under the \",mdx(\"inlineCode\",{parentName:\"p\"},\"test\"),` folder, you want\nto create a sub-folder for each policy: `,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"cidr-check\")),\" and \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"business-hrs\")),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ mkdir -p test/business-hrs\",`\n`,\"$ mkdir -p test/cidr-check\",`\n`)),mdx(\"blockquote\",{parentName:\"li\"},mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" The test should be created under \",mdx(\"inlineCode\",{parentName:\"p\"},\"/test/<policy_name>\"),\" folder.\"))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Write a passing test case in a file named, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"success.json\")),` under\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"test/business-hrs\"),\" directory.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"{\",`\n`,'    \"global\": {',`\n`,'        \"timespace\": {',`\n`,'            \"weekday\": 1,',`\n`,'            \"hour\": 12',`\n`,\"        }\",`\n`,\"    }\",`\n`,\"}\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Under \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"global\")),`, you specify the mock test data. In this example, the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"weekday\"),\" is set to \",mdx(\"inlineCode\",{parentName:\"p\"},\"1\"),\" which is \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"Monday\")),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"hour\"),\" is set to \",mdx(\"inlineCode\",{parentName:\"p\"},\"12\"),`\nwhich is `,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"noon\")),\". Therefore, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"main\"),\" should return \",mdx(\"inlineCode\",{parentName:\"p\"},\"true\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Write a failing test in a file named, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"fail.json\")),\" under \",mdx(\"inlineCode\",{parentName:\"p\"},\"test/business-hrs\"),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"{\",`\n`,'    \"global\": {',`\n`,'        \"timespace\": {',`\n`,'            \"weekday\": 0,',`\n`,'            \"hour\": 12',`\n`,\"        }\",`\n`,\"    }\",`\n`,\"}\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"The mock data is set to \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"Sunday\")),\" at \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"noon\")),\"; therefore, Therefore, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"main\"),\" should return \",mdx(\"inlineCode\",{parentName:\"p\"},\"false\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Similarly, write a passing test case for \",mdx(\"inlineCode\",{parentName:\"p\"},\"cidr-check\"),\" policy, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"test/cidr-check/success.json\")),\":\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"{\",`\n`,'  \"global\": {',`\n`,'    \"request\": {',`\n`,'      \"connection\": {',`\n`,'          \"remote_addr\": \"122.22.3.4\"',`\n`,\"      },\",`\n`,'      \"operation\": \"create\",',`\n`,'      \"path\": \"secret/orders\"',`\n`,\"    }\",`\n`,\"  }\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"In this example, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"global\"),\" specifies the \",mdx(\"inlineCode\",{parentName:\"p\"},\"create\"),` operation is invoked on\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"secret/orders\"),\" endpoint which initiated from an IP address \",mdx(\"inlineCode\",{parentName:\"p\"},\"122.22.3.4\"),`.\nTherefore, the `,mdx(\"inlineCode\",{parentName:\"p\"},\"main\"),\" should return \",mdx(\"inlineCode\",{parentName:\"p\"},\"true\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Write a failing test for \",mdx(\"inlineCode\",{parentName:\"p\"},\"cidr-check\"),\" policy, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"test/cidr-check/fail.json\")),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"{\",`\n`,'  \"global\": {',`\n`,'    \"request\": {',`\n`,'      \"connection\": {',`\n`,'        \"remote_addr\": \"122.22.3.10\"',`\n`,\"      },\",`\n`,'      \"operation\": \"create\",',`\n`,'      \"path\": \"secret/orders\"',`\n`,\"    }\",`\n`,\"  },\",`\n`,'  \"test\": {',`\n`,'    \"precond\": true,',`\n`,'    \"main\": false',`\n`,\"  }\",`\n`,\"}\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`This test will fail because of the IP address mismatch. However, the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"precond\"),\" should pass since the requested operation is \",mdx(\"inlineCode\",{parentName:\"p\"},\"create\"),` and the\ntargeted endpoint is `,mdx(\"inlineCode\",{parentName:\"p\"},\"secret/orders\"),\".\"),mdx(\"blockquote\",{parentName:\"li\"},mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),\"The optional \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"test\")),` definition adds more context to why the test\nshould fail. The expected behavior is that the test fails because `,mdx(\"inlineCode\",{parentName:\"p\"},\"main\"),`\nreturns `,mdx(\"inlineCode\",{parentName:\"p\"},\"false\"),\" but \",mdx(\"inlineCode\",{parentName:\"p\"},\"precond\"),\" should return \",mdx(\"inlineCode\",{parentName:\"p\"},\"true\"),\".\"))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Now, you have written both success and failure tests:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"\\u251C\\u2500\\u2500 business-hrs.sentinel\",`\n`,\"\\u251C\\u2500\\u2500 cidr-check.sentinel\",`\n`,\"\\u2514\\u2500\\u2500 test\",`\n`,\"    \\u251C\\u2500\\u2500 business-hrs\",`\n`,\"    \\u2502\\xA0\\xA0 \\u251C\\u2500\\u2500 fail.json\",`\n`,\"    \\u2502\\xA0\\xA0 \\u2514\\u2500\\u2500 success.json\",`\n`,\"    \\u2514\\u2500\\u2500 cidr-check\",`\n`,\"        \\u251C\\u2500\\u2500 fail.json\",`\n`,\"        \\u2514\\u2500\\u2500 success.json\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Execute the test:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ sentinel test\",`\n`,`\n`,\"PASS - business-hrs.sentinel\",`\n`,\"  PASS - test/business-hrs/success.json  PASS - test/business-hrs/fail.json\",`\n`,\"PASS - cidr-check.sentinel\",`\n`,\"  PASS - test/cidr-check/success.json  PASS - test/cidr-check/fail.json\",`\n`)),mdx(\"blockquote\",{parentName:\"li\"},mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` If you want to see the tracing and log output for those tests,\nrun the command with `,mdx(\"inlineCode\",{parentName:\"p\"},\"-verbose\"),\" flag.\")))),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step3\",\"aria-label\":\"step 3 deploy your egp policies permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step3\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-3-deploy-your-egp-policies\",\"aria-hidden\":\"\"})),\"Step 3: Deploy your EGP policies\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Sentinel policies has three \",mdx(\"strong\",{parentName:\"p\"},\"enforcement levels\"),\":\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Level\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Description\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"advisory\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The policy is allowed to fail. Can be used as a tool to educate new users.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"soft-mandatory\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The policy must pass unless an override is specified.\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"hard-mandatory\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"The policy must pass no matter what!\")))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Since both policies are tied to specific paths, the policy type that you are\ngoing to create is Endpoint Governing Policies (EGPs).`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Store the Base64 encoded \",mdx(\"inlineCode\",{parentName:\"p\"},\"cidr-check.sentinel\"),` policy in an environment\nvariable named `,mdx(\"inlineCode\",{parentName:\"p\"},\"POLICY\"),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ POLICY=$(base64 cidr-check.sentinel)\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Create a policy \",mdx(\"inlineCode\",{parentName:\"p\"},\"cidr-check\"),\" with enforcement level of \",mdx(\"strong\",{parentName:\"p\"},\"hard-mandatory\"),` to\nreject all requests coming from IP addressed that are not internal.`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault write sys/policies/egp/cidr-check \\\\\",`\n`,'        policy=\"${POLICY}\" \\\\',`\n`,'        paths=\"secret/*\" \\\\',`\n`,'        enforcement_level=\"hard-mandatory\"',`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"You can read the policy by executing the following command:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault read sys/policies/egp/cidr-check\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Repeat the steps to create a policy named \",mdx(\"inlineCode\",{parentName:\"p\"},\"business-hrs\"),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Encode the business-hrs policy\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"POLICY2\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token variable\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token variable\"}),\"$(\"),\"base64 business-hrs.sentinel\",mdx(\"span\",e({parentName:\"span\"},{className:\"token variable\"}),\")\")),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create a policy with soft-mandatory enforcement-level\"),`\n`,\"$ vault \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"write\"),\" sys/policies/egp/business-hrs \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"policy\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token variable\"}),\"${POLICY2}\"),'\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"paths\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"secret/accounting/*\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"        \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"enforcement_level\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"soft-mandatory\"'),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# To read the policy you just created\"),`\n`,\"$ vault \",mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\"read\"),\" sys/policies/egp/business-hrs\",`\n`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"To create EGP policies, use the \",mdx(\"inlineCode\",{parentName:\"p\"},\"/sys/policies/egp\"),\" endpoint:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"X-Vault-Token: <TOKEN>\"'),\" \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --request PUT \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --data <PAYLOAD> \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       <VAULT_ADDRESS>/v1/sys/policies/egp/<POLICY_NAME>\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Where \",mdx(\"inlineCode\",{parentName:\"p\"},\"<TOKEN>\"),\" is your valid token, and \",mdx(\"inlineCode\",{parentName:\"p\"},\"<PAYLOAD>\"),` includes the Base64 encoded\npolicy, endpoint paths, and enforcement level.`),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Store the Base64 encoded \",mdx(\"inlineCode\",{parentName:\"p\"},\"cidr-check.sentinel\"),` policy in an environment\nvariable named `,mdx(\"inlineCode\",{parentName:\"p\"},\"POLICY\"),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ POLICY=$(base64 cidr-check.sentinel)\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Create API request payload.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee cidr-payload.json <<EOF\",`\n`,\"{\",`\n`,'  \"policy\": \"${POLICY}\",',`\n`,'  \"paths\": [\"secret/*\"],',`\n`,'  \"enforcement_level\": \"hard-mandatory\"',`\n`,\"}\",`\n`,\"EOF\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Create a policy \",mdx(\"inlineCode\",{parentName:\"p\"},\"cidr-check\"),\" with enforcement level of \",mdx(\"strong\",{parentName:\"p\"},\"hard-mandatory\"),` to\nreject all requests coming from IP addressed that are not internal.`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"        --request PUT \\\\\",`\n`,\"        --data @cidr-payload.json \\\\\",`\n`,\"        http://127.0.0.1:8200/v1/sys/policies/egp/cidr-check\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Repeat the steps to create a policy named \",mdx(\"inlineCode\",{parentName:\"p\"},\"business-hrs\"),` with enforcement\nlevel of soft-mandatory.`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Encode the business-hrs policy\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token assign-left variable\"}),\"POLICY2\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token variable\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token variable\"}),\"$(\"),\"base64 business-hrs.sentinel\",mdx(\"span\",e({parentName:\"span\"},{className:\"token variable\"}),\")\")),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create the request payload\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"tee\"),\" buz-hrs-payload.json \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"<<\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"EOF\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'  \"policy\": \"',mdx(\"span\",e({parentName:\"span\"},{className:\"token variable\"}),\"${POLICY2}\"),'\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'  \"paths\": [\"secret/accounting/*\"],'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'  \"enforcement_level\": \"soft-mandatory\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"EOF\"),`\n`,`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"        --request PUT \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"        --data @buz-hrs-payload.json \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"        http://127.0.0.1:8200/v1/sys/policies/egp/business-hrs\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"You can list the EGPs that were created.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request LIST \\\\\",`\n`,\"       http://127.0.0.1:8200/v1/sys/policies/egp | jq\",`\n`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Open a web browser and launch the Vault UI (e.g. \",mdx(\"a\",e({parentName:\"p\"},{href:\"http://127.0.0.1:8200/ui\"}),\"http://127.0.0.1:8200/ui\"),`) and\nthen login.`),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Policies\"),\" and select the \",mdx(\"strong\",{parentName:\"p\"},\"Endpoint Governing Policies\"),\" tab.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Create EGP policy\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"business-hrs\")),\" in the \",mdx(\"strong\",{parentName:\"p\"},\"Name\"),\" field.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enter the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#sentinel-policies-1\"}),mdx(\"strong\",{parentName:\"a\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"business-hrs.sentinel\")),\" policy\"),` in the\n`,mdx(\"strong\",{parentName:\"p\"},\"Policy\"),\" editor.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"soft-mandatory\"),\" from the \",mdx(\"strong\",{parentName:\"p\"},\"Enforcement level\"),\" drop-down list.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"secret/accounting/*\")),\" in the \",mdx(\"strong\",{parentName:\"p\"},\"Paths\"),` field, and then click\n`,mdx(\"strong\",{parentName:\"p\"},\"Create Policy\"),\".\"))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-sentinel-1.png\",alt:\"EGP\"}))),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Endpoint Governing Policies\"),\" again, and then \",mdx(\"strong\",{parentName:\"p\"},\"Create EGP policy\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"cidr-check\")),\" in the \",mdx(\"strong\",{parentName:\"p\"},\"Name\"),\" field.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enter the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#sentinel-policies-1\"}),mdx(\"strong\",{parentName:\"a\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"cidr-check.sentinel\")),\" policy\"),` in the\n`,mdx(\"strong\",{parentName:\"p\"},\"Policy\"),\" editor.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Leave the \",mdx(\"strong\",{parentName:\"p\"},\"Enforcement level\"),\" as hard-mandatory, and enter \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"secret/*\")),`\nin the `,mdx(\"strong\",{parentName:\"p\"},\"Paths\"),\" field.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Create Policy\"),\".\"))),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" Unlike ACL policies, EGPs are a \",mdx(\"em\",{parentName:\"p\"},\"prefix walk\"),` which allows policies\nto be applied at various points at Vault API. If you have EGPs tied to\n\"`,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"secret/orders\")),'\", \"',mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"secret/*\")),'\" and \"',mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"*\")),`\", all EGPs will be\nevaluated for a request on \"`,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"secret/orders\")),'\".')),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#verification\",\"aria-label\":\"verification permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"verification\",\"aria-hidden\":\"\"})),\"Verification\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Once the policies were deployed, \",mdx(\"inlineCode\",{parentName:\"p\"},\"create\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"update\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"delete\"),` operations\ncoming from an IP address other than `,mdx(\"inlineCode\",{parentName:\"p\"},\"122.22.3.4\"),\" will be denied.\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault kv put secret/accounting/test \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"acct_no\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"293472309423\"'))),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"Error writing data to secret/accounting/test: Error making API request.\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"URL: PUT http://127.0.0.1:8200/v1/secret/accounting/test\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"Code: 400. Errors:\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"* 1 error occurred:\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'* egp standard policy \"cidr-check\" evaluation resulted in denial.'),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"The specific error was:\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"<nil>\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'A trace of the execution for policy \"cidr-check\" is available:'),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"Result: false\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"Description: Check the precondition before execute the cidrcheck\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'Rule \"main\" (byte offset 442) = false'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"  false (offset 314): sockaddr.is_contained\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'Rule \"cidrcheck\" (byte offset 291) = false'),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'Rule \"precond\" (byte offset 113) = true'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  true (offset 134): request.operation in [\"create\", \"update\", \"delete\"]'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"  true (offset 194): strings.has_prefix\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Similarly, you will get an error if any request is made outside of the business\nhours defined by the `,mdx(\"inlineCode\",{parentName:\"p\"},\"business-hrs\"),\" policy.\"),mdx(\"div\",e({},{className:\"alert alert-danger g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" Like with ACL policies, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"root\")),\" tokens are \",mdx(\"strong\",{parentName:\"p\"},mdx(\"em\",{parentName:\"strong\"},\"NOT\")),` subject to\nSentinel policy checks.`)),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step4\",\"aria-label\":\"step 4 delete sentinel policies permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step4\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-4-delete-sentinel-policies\",\"aria-hidden\":\"\"})),\"Step 4: Delete Sentinel Policies\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-1\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-1\",\"aria-hidden\":\"\"})),\"CLI Command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"To delete EGPs:\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Delete the business-hrs EGP\"),`\n`,\"$ vault delete sys/policies/egp/business-hrs\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Delete the cidr-check EGP\"),`\n`,\"$ vault delete sys/policies/egp/cidr-check\",`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-1\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-1\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"To delete EGPs:\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Delete the business-hrs EGP\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --request DELETE \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       http://127.0.0.1:8200/v1/sys/policies/egp/business-hrs\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Delete the cidr-check EGP\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"      --request DELETE \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"      http://127.0.0.1:8200/v1/sys/policies/egp/cidr-check\",`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-1\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-1\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Policies\"),\" and select the \",mdx(\"strong\",{parentName:\"p\"},\"Endpoint Governing Policies\"),\" tab.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Delete\"),\" from the policy menu for \",mdx(\"inlineCode\",{parentName:\"p\"},\"business-hrs\"),\".\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-sentinel-2.png\",alt:\"Delete EGP\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"When prompted, click \",mdx(\"strong\",{parentName:\"p\"},\"Delete\"),\" again to confirm.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Repeat the steps to delete \",mdx(\"inlineCode\",{parentName:\"p\"},\"cidr-check\"),\" policy.\"))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#next-steps\",\"aria-label\":\"next steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"next-steps\",\"aria-hidden\":\"\"})),\"Next steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Refer to the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/docs/enterprise/sentinel/properties\"}),\"Sentinel Properties\"),`\ndocumentation for the full list of properties available in Vault to write\nfine-grained policies to meet your organizational policy requirements.`))}MDXContent.isMDXComponent=!0;\n","scope":{}},"navData":[{"title":"Getting Started","path":"getting-started","filePath":"content/guides/getting-started.mdx"},{"title":"Vault Operations","routes":[{"title":"Overview","path":"operations","filePath":"content/guides/operations/index.mdx"},{"title":"Reference Architecture","path":"operations/reference-architecture","filePath":"content/guides/operations/reference-architecture.mdx"},{"title":"Vault HA with Consul","path":"operations/vault-ha-consul","filePath":"content/guides/operations/vault-ha-consul.mdx"},{"title":"Production Hardening","path":"operations/production","filePath":"content/guides/operations/production.mdx"},{"title":"Root Token Generation","path":"operations/generate-root","filePath":"content/guides/operations/generate-root.mdx"},{"title":"Rekeying & Rotating","path":"operations/rekeying-and-rotating","filePath":"content/guides/operations/rekeying-and-rotating.mdx"},{"title":"Building Plugin Backends","path":"operations/plugin-backends","filePath":"content/guides/operations/plugin-backends.mdx"},{"divider":true},{"title":"Replication Setup & Guidance","path":"operations/replication","filePath":"content/guides/operations/replication.mdx"},{"title":"Disaster Recovery Setup","path":"operations/disaster-recovery","filePath":"content/guides/operations/disaster-recovery.mdx"},{"title":"Mount Filter","path":"operations/mount-filter","filePath":"content/guides/operations/mount-filter.mdx"},{"title":"Multi-Tenant: Namespaces","path":"operations/multi-tenant","filePath":"content/guides/operations/multi-tenant.mdx"},{"title":"Vault Auto-unseal with AWS KMS","path":"operations/autounseal-aws-kms","filePath":"content/guides/operations/autounseal-aws-kms.mdx"},{"title":"Seal Wrap / FIPS 140-2","path":"operations/seal-wrap","filePath":"content/guides/operations/seal-wrap.mdx"},{"title":"Vault Cluster Monitoring","path":"operations/monitoring","filePath":"content/guides/operations/monitoring.mdx"},{"title":"Vault Deployment Guide","path":"operations/deployment-guide","filePath":"content/guides/operations/deployment-guide.mdx"},{"title":"Performance Standby Nodes","path":"operations/performance-nodes","filePath":"content/guides/operations/performance-nodes.mdx"}]},{"title":"Identity and Access Management","routes":[{"title":"Overview","path":"identity","filePath":"content/guides/identity/index.mdx"},{"title":"Secure Introduction of Vault Clients","path":"identity/secure-intro","filePath":"content/guides/identity/secure-intro.mdx"},{"title":"Policies","path":"identity/policies","filePath":"content/guides/identity/policies.mdx"},{"title":"ACL Policy Path Templating","path":"identity/policy-templating","filePath":"content/guides/identity/policy-templating.mdx"},{"title":"AppRole Pull Authentication","path":"identity/authentication","filePath":"content/guides/identity/authentication.mdx"},{"title":"AppRole with Terraform and Chef","path":"identity/approle-trusted-entities","filePath":"content/guides/identity/approle-trusted-entities.mdx"},{"title":"Tokens and Leases","path":"identity/lease","filePath":"content/guides/identity/lease.mdx"},{"title":"Identity - Entities & Groups","path":"identity/identity","filePath":"content/guides/identity/identity.mdx"},{"divider":true},{"title":"Sentinel Policies","path":"identity/sentinel","filePath":"content/guides/identity/sentinel.mdx"},{"title":"Control Groups","path":"identity/control-groups","filePath":"content/guides/identity/control-groups.mdx"}]},{"title":"Secrets Management","routes":[{"title":"Overview","path":"secret-mgmt","filePath":"content/guides/secret-mgmt/index.mdx"},{"title":"Static Secrets","path":"secret-mgmt/static-secrets","filePath":"content/guides/secret-mgmt/static-secrets.mdx"},{"title":"Versioned KV Secret Engine","path":"secret-mgmt/versioned-kv","filePath":"content/guides/secret-mgmt/versioned-kv.mdx"},{"title":"Secret as a Service","path":"secret-mgmt/dynamic-secrets","filePath":"content/guides/secret-mgmt/dynamic-secrets.mdx"},{"title":"DB Root Credential Rotation","path":"secret-mgmt/db-root-rotation","filePath":"content/guides/secret-mgmt/db-root-rotation.mdx"},{"title":"Cubbyhole Response Wrapping","path":"secret-mgmt/cubbyhole","filePath":"content/guides/secret-mgmt/cubbyhole.mdx"},{"title":"One-Time SSH Password","path":"secret-mgmt/ssh-otp","filePath":"content/guides/secret-mgmt/ssh-otp.mdx"},{"title":"Build Your Own CA","path":"secret-mgmt/pki-engine","filePath":"content/guides/secret-mgmt/pki-engine.mdx"},{"title":"Direct Application Integration","path":"secret-mgmt/app-integration","filePath":"content/guides/secret-mgmt/app-integration.mdx"}]},{"title":"Encryption as a Service","routes":[{"title":"Overview","path":"encryption","filePath":"content/guides/encryption/index.mdx"},{"title":"Encryption as a Service","path":"encryption/transit","filePath":"content/guides/encryption/transit.mdx"},{"title":"Java Application Demo","path":"encryption/spring-demo","filePath":"content/guides/encryption/spring-demo.mdx"},{"title":"Transit Secrets Re-wrapping","path":"encryption/transit-rewrap","filePath":"content/guides/encryption/transit-rewrap.mdx"}]}],"versions":[]},"__N_SSG":true}