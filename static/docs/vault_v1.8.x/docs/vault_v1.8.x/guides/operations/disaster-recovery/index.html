<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta property="og:image" content="https://www.vaultproject.io/img/og-image.png"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=16&amp;w=16" type="image/png" sizes="16x16" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=32&amp;w=32" type="image/png" sizes="32x32" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=96&amp;w=96" type="image/png" sizes="96x96" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=192&amp;w=192" type="image/png" sizes="192x192" rel="icon"/><title>Vault Disaster Recovery Replication Setup - Guides | Vault by HashiCorp</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="This guide demonstrates step-by-step instruction of setting up a disaster
recovery (DR) replications."/><meta property="og:site_name" content="Vault by HashiCorp"/><meta name="next-head-count" content="17"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/css/7246d51e322c1bb7fa92.css" as="style"/><link rel="stylesheet" href="/docs/vault_v1.8.x/_next/static/css/7246d51e322c1bb7fa92.css" data-n-g=""/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/css/fbe3b6b5804634e8fb99.css" as="style"/><link rel="stylesheet" href="/docs/vault_v1.8.x/_next/static/css/fbe3b6b5804634e8fb99.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/framework.3519294afa6a9ab53973.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/2bc72d9a08d5bd816ae6b580871df9fb671d43bb.52fd5ef7a8ab7d8fc0dd.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/9a5be27b89b50ff891e514a88cd42f143404f9a6.033857d62f5a01edf3b3.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/main-b0f1f3f8bd3bddd4e6cd.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/b49b08e2da573413c730dfc51ae423f080a0c275.00ac32ee45240d5b343f.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/b1542cc239bf56c8a14913c0a930efe682b5cf86.32bb900ad80311488529.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/pages/_app-d714c55ad24af91621ba.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/7dbdcaca29374b13a0799a901e26613767d72de2.d088888a4a1113f2bb24.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/92f0085e0e6c1f10382de10b8861ce89d7c192a2.e5495ede8461fc33ed98.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b.5052eda5c7f43583669b.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b_CSS.f6584926f1188e1b5b3e.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/pages/guides/%5B%5B...page%5D%5D-72f9db6e509b49c776de.js" as="script"/></head><body><div id="__next"><div class="g-alert-banner style_vault__1OYha show themed"><a href="https://hashiconf.com/europe" class="link"><span class="g-grid-container has-large-tag"><span class="tag g-type-body-small-x-strong">Thank you</span><span class="text g-type-body-small has-large-tag">HashiConf Europe is a wrap. Watch this year’s sessions on-demand.<!-- --> <span class="link-text g-type-body-small-x-strong">Watch Now</span></span></span></a><button class="close"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 5L5 15M5 5l10 10" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div><span class="visually-hidden">Dismiss alert</span></button></div><header class="hashi-stack-menu_hashiStackMenu__2dCgY"><nav class="hashi-stack-menu_nav__3DnqS g-grid-container" aria-label="Primary HashiCorp website navigation"><a aria-label="To main HashiCorp website" href="https://www.hashicorp.com/" class="hashi-stack-menu_logoLink__2cbDW"><div data-testid="root"><svg width="317" height="88" viewBox="0 0 317 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M107.692 64.421V47.4h-14.97v17.02h-7.623V24.06h7.622v16.602h14.971V24.06h7.622v40.36h-7.622zm35.567-.001h-6.053l-.548-1.996a16.137 16.137 0 01-8.789 2.607c-5.397 0-7.699-3.697-7.699-8.79 0-5.998 2.607-8.3 8.606-8.3h7.089v-3.095c0-3.27-.907-4.421-5.633-4.421a41.255 41.255 0 00-8.179.877l-.907-5.634a38.496 38.496 0 0110.122-1.395c9.269 0 11.998 3.27 11.998 10.672l-.007 19.476zm-7.394-11.151h-5.45c-2.424 0-3.087.663-3.087 2.912 0 2.058.663 2.973 2.972 2.973a11.629 11.629 0 005.572-1.525l-.007-4.36zm21.701 11.754a34.776 34.776 0 01-10.183-1.7l1.029-5.633a33.038 33.038 0 008.788 1.273c3.271 0 3.758-.762 3.758-2.973 0-1.814-.366-2.729-5.152-3.88-7.211-1.76-8.058-3.575-8.058-9.269 0-5.938 2.607-8.545 11.03-8.545 2.98.003 5.949.348 8.85 1.03l-.762 5.876a51.98 51.98 0 00-8.118-.846c-3.209 0-3.758.763-3.758 2.546 0 2.363.183 2.546 4.185 3.575 8.263 2.188 9.055 3.278 9.055 9.307 0 5.725-1.761 9.239-10.664 9.239zm32.663-.602V43.84c0-1.578-.663-2.363-2.363-2.363-1.814 0-5.031 1.09-7.699 2.485v20.459h-7.394V22.847l7.394-1.029v15.33a26.045 26.045 0 0110.786-2.852c4.909 0 6.662 3.453 6.662 8.728v21.397h-7.386zm12.844-33.692v-8.545h7.394v8.545h-7.394zm0 33.692V34.906h7.394v29.515h-7.394zM215.62 35.15c0-7.394 4.299-11.693 14.361-11.693 3.697 0 7.38.447 10.969 1.334l-.839 6.601a59.517 59.517 0 00-9.909-1.029c-5.275 0-6.967 1.822-6.967 6.098v15.512c0 4.3 1.7 6.098 6.967 6.098a59.506 59.506 0 009.909-1.029l.846 6.609a45.672 45.672 0 01-10.968 1.334c-10.062 0-14.361-4.3-14.361-11.693l-.008-18.142zm40.499 29.873c-10.123 0-12.844-5.572-12.844-11.632v-7.455c0-6.06 2.728-11.632 12.844-11.632 10.115 0 12.844 5.572 12.844 11.632v7.455c-.023 6.06-2.744 11.632-12.844 11.632zm0-24.392c-3.941 0-5.45 1.76-5.45 5.092v7.912c0 3.331 1.524 5.092 5.45 5.092 3.925 0 5.45-1.76 5.45-5.092v-7.943c-.015-3.33-1.532-5.092-5.45-5.092v.03zm32.457.457a57.835 57.835 0 00-7.821 4.3v19.056h-7.394V34.906h6.243l.488 3.27a33.064 33.064 0 017.76-3.88l.724 6.792zm28.035 13.515c0 6.548-2.911 10.42-9.756 10.42a40.76 40.76 0 01-7.882-.853v12.196l-7.394 1.029V34.906h5.877l.762 2.485a15.535 15.535 0 019.33-3.087c5.938 0 9.086 3.514 9.086 10.245l-.023 10.054zm-17.631 3.331c2.152.474 4.346.73 6.548.763 2.668 0 3.697-1.274 3.697-3.941V44.35c0-2.424-.907-3.758-3.636-3.758a10.46 10.46 0 00-6.609 2.668v14.673zM29.134 7L0 23.808v40.361l10.946 6.32V30.127l18.188-10.504V7z" fill="#000"/><path d="M40.758 7v32.144H29.133V27.147l-10.945 6.319V74.65l10.946 6.335V48.932h11.624v11.914l10.946-6.312V13.32L40.758 7z" fill="#000"/><path d="M40.758 81L69.89 64.192V23.831l-10.946-6.32v40.362L40.758 68.377V81z" fill="#000"/></svg></div></a><ul class="hashi-stack-menu_menu__33a9r"><li class="nav-item_navItem__KPnS0"><button type="button" class="nav-item_buttonReset__WeJA7 nav-item_link__1827H g-type-body-small-strong ">Browse Products<span class="nav-item_visuallyHidden__20aYI">Open this menu</span><img class="nav-item_dropdownCarat__2xha-" alt="" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iNyIgdmlld0JveD0iMCAwIDEwIDciIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTguMDUzIDJsLTMgMy4wMDYtMy0zLjAwNiIgc3Ryb2tlPSJ2YXIoLS1ncmF5LTMpIiBzdHJva2Utd2lkdGg9IjEuMjUiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiLz48L3N2Zz4="/></button><section class="browse-panel_browsePanel__1AT8q "><menu class="stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Infrastructure</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.terraform.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M55.522 32.97l32.96 19.02v38.06l-32.96-19.03V32.97zM92.09 51.99v38.06l32.95-19.03V32.97L92.09 51.99zM18.96 11.73v38.05l32.95 19.03V30.76L18.96 11.73zm36.562 101.51l32.95 19.03V94.22l-32.95-19.03v38.05z" fill="#7B42BC"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">terraform</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.packer.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M35.09 26.38L74.22 49v83.38l-39.13-22.62V26.38z" fill="#02A8EF"/><path d="M93.6 36.13L51.06 11.62v17L80 45.34v51.05l13.61 7.82c8.421 4.86 15.311 2 15.311-6.47V60.28c-.01-8.42-6.92-19.28-15.32-24.15z" fill="#02A8EF"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">packer</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.vagrantup.com" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M110.77 17.55L86.68 31.46V40L72 74.52 57.32 40v-8.54L33.23 17.55l-14.65 8.47v9.83l32.63 79.92 20.79 12 20.79-12 32.63-79.92v-9.83l-14.65-8.47z" fill="#0E67ED"/><path d="M125.42 26.02l-24.09 13.9v8.55L81.77 92.19 72 97.83v29.94l20.79-12 32.63-79.92v-9.83zM57.32 40v-8.54l-14.66 8.46v8.55l19.57 43.72L72 86.55V74.52L57.32 40z" fill="#0850C5"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vagrant</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Networking</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.consul.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72.53 128.7a54.787 54.787 0 01-45.258-23.85 54.784 54.784 0 019.368-72.355 54.78 54.78 0 0172.95 1.125l-13 13.6a36 36 0 100 53.43l13 13.6a54.638 54.638 0 01-37.06 14.45zm44.081-27.401a4.49 4.49 0 114.49-4.49 4.5 4.5 0 01-4.49 4.49z" fill="#E03875"/><path d="M72.18 85.79A11.87 11.87 0 1184 73.93a11.88 11.88 0 01-11.82 11.86zm49.58.21a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.495 4.495 0 012.772 4.148 4.503 4.503 0 01-4.49 4.49zm-13.35-.56a4.488 4.488 0 01-4.4-5.385 4.487 4.487 0 013.555-3.515 4.49 4.49 0 11.845 8.9zm13.35-14.57a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.496 4.496 0 012.772 4.149 4.503 4.503 0 01-4.49 4.49zm-13.35.51a4.493 4.493 0 01-4.148-2.772 4.491 4.491 0 114.148 2.771zm8.461-15.61a4.49 4.49 0 11-.02-8.981 4.49 4.49 0 01.02 8.981z" fill="#E03875"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">consul</span></a></li></ul></li></menu><menu class="stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Security</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.vaultproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.88 21.15L71.8 131.4l55.321-110.25H16.881zm61.46 22.12h6.39v6.4h-6.39v-6.4zM65.61 68.84h-6.39v-6.39h6.39v6.39zm0-9.59h-6.39v-6.39h6.39v6.39zm0-9.58h-6.39v-6.4h6.39v6.4zm9.59 28.76h-6.4V72h6.4v6.43zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.58h-6.4v-6.4h6.4v6.4zm3.14 3.19h6.39v6.39h-6.39v-6.39zm0 16v-6.41h6.39v6.39l-6.39.02z" fill="#000"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vault</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.boundaryproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M44.83 125.83v-8.27h17.18v-5.11h-8.33v-8.32h39.33L74.74 72.49l18.27-31.65H52.7v43.89H31V19.15h74.67l12.46 21.58L99.8 72.49l18.7 32.4-12.09 20.94H44.83z" fill="#F24C53"/><path d="M48.17 104.131h-8.32v8.32h8.32v-8.32zM39.32 117.5H31v8.32h8.32v-8.32z" fill="#F24C53"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">boundary</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Applications</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.nomadproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72 14L21.77 43v58L72 130l50.23-29V43L72 14zm22.38 63.78L81 85.51l-16.17-8.8v18.48l-15.2 9.64V66.19l12.06-7.38 16.73 8.82V48.76l16-9.59-.04 38.61z" fill="#00CA8E"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">nomad</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.waypointproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M143.228 27.66l-17.79 30.81-17.79-30.81h35.58zM48.26 48.23H36.39l29.67 51.4-11.87 20.56L.77 27.66h59.36l29.68 51.41 5.93-10.28L72 27.66h23.74l11.88 20.57 11.87 20.56-29.68 51.4-41.55-71.96z" fill="#14C6CB"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">waypoint</span></a></li></ul></li></menu><menu class="stack-menu-section_stackMenuSectionPlusDivider__1BPy6 stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">HashiCorp Cloud Platform</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://cloud.hashicorp.com/" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72.53 128.7a54.787 54.787 0 01-45.258-23.85 54.784 54.784 0 019.368-72.355 54.78 54.78 0 0172.95 1.125l-13 13.6a36 36 0 100 53.43l13 13.6a54.638 54.638 0 01-37.06 14.45zm44.081-27.401a4.49 4.49 0 114.49-4.49 4.5 4.5 0 01-4.49 4.49z" fill="#E03875"/><path d="M72.18 85.79A11.87 11.87 0 1184 73.93a11.88 11.88 0 01-11.82 11.86zm49.58.21a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.495 4.495 0 012.772 4.148 4.503 4.503 0 01-4.49 4.49zm-13.35-.56a4.488 4.488 0 01-4.4-5.385 4.487 4.487 0 013.555-3.515 4.49 4.49 0 11.845 8.9zm13.35-14.57a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.496 4.496 0 012.772 4.149 4.503 4.503 0 01-4.49 4.49zm-13.35.51a4.493 4.493 0 01-4.148-2.772 4.491 4.491 0 114.148 2.771zm8.461-15.61a4.49 4.49 0 11-.02-8.981 4.49 4.49 0 01.02 8.981z" fill="#E03875"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">consul</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://app.terraform.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M55.522 32.97l32.96 19.02v38.06l-32.96-19.03V32.97zM92.09 51.99v38.06l32.95-19.03V32.97L92.09 51.99zM18.96 11.73v38.05l32.95 19.03V30.76L18.96 11.73zm36.562 101.51l32.95 19.03V94.22l-32.95-19.03v38.05z" fill="#7B42BC"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">terraform</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://cloud.hashicorp.com/" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.88 21.15L71.8 131.4l55.321-110.25H16.881zm61.46 22.12h6.39v6.4h-6.39v-6.4zM65.61 68.84h-6.39v-6.39h6.39v6.39zm0-9.59h-6.39v-6.39h6.39v6.39zm0-9.58h-6.39v-6.4h6.39v6.4zm9.59 28.76h-6.4V72h6.4v6.43zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.58h-6.4v-6.4h6.4v6.4zm3.14 3.19h6.39v6.39h-6.39v-6.39zm0 16v-6.41h6.39v6.39l-6.39.02z" fill="#000"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vault</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Partner Services</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a class="stack-item_itemLink__G2Qmk" href="https://www.hashicorp.com/products/consul/service-on-azure"><span class="stack-item_itemName__1cUxR g-type-body-small-strong">HashiCorp Consul Service (HCS) on Azure</span></a></li></ul></li></menu></section></li></ul></nav></header><nav class="g-subnav" aria-label="vault website navigation"><div class="constrain-width-wrapper  g-grid-container"><div class="g-subnav-inner style_vault__1OYha is-constrained" data-overflow-target="true"><a href="/" data-testid="a-raw" class="title-link brand-vault " title="vault"><div data-testid="root"><svg width="208" height="88" viewBox="0 0 208 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M114.849 23.69h7.92L110.699 64h-11.25l-12-40.28h7.92l9.74 33.57 9.74-33.6zM144.75 64h-6l-.55-2a16.12 16.12 0 01-8.77 2.6c-5.38 0-7.68-3.69-7.68-8.77 0-6 2.6-8.29 8.59-8.29h7.08v-3.1c0-3.27-.91-4.42-5.63-4.42a40.71 40.71 0 00-8.16.91l-.91-5.63a38.678 38.678 0 0110.1-1.39c9.25 0 12 3.27 12 10.65L144.75 64zm-7.37-11.13h-5.45c-2.42 0-3.08.67-3.08 2.91 0 2 .66 3 3 3a11.72 11.72 0 005.57-1.51l-.04-4.4zm18.992-18.35v20.56c0 1.57.66 2.36 2.36 2.36 1.7 0 5-1.09 7.68-2.48V34.52h7.38V64h-5.63l-.72-2.48a29.437 29.437 0 01-11.8 3.09c-4.9 0-6.65-3.45-6.65-8.71V34.52h7.38zM177.719 64V22.48l7.38-1V64h-7.38zm29.388-.57a20.618 20.618 0 01-6.47 1.15c-5.38 0-8.11-2.54-8.11-7.8v-16.4h-4.41v-5.86h4.41V27.2l7.38-1v8.35h7.56l-.48 5.86h-7.08v15.4a2.323 2.323 0 001.596 2.514c.344.11.708.14 1.064.085a13.919 13.919 0 003.69-.61l.85 5.63zM0 12.6l31.85 63.92L63.92 12.6H0zm35.63 12.83h3.71v3.71h-3.71v-3.71zm-7.38 14.82h-3.7v-3.7h3.7v3.7zm0-5.56h-3.7V31h3.7v3.69zm0-5.55h-3.7v-3.71h3.7v3.71zm5.6 16.67h-3.7V42.1h3.7v3.71zm0-5.56h-3.7v-3.7h3.7v3.7zm0-5.56h-3.7V31h3.7v3.69zm0-5.55h-3.7v-3.71h3.7v3.71zM35.63 31h3.71v3.7h-3.71V31zm0 9.26v-3.7h3.71v3.7h-3.71z" fill="#000"/></svg></div></a><ul class="menu-items-default menu-items-align-right"><li><a href="/" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Overview</span></a></li><li><button class="dropdown-trigger g-type-body-small-strong brand-vault style-menu-item is-collapsed"><span class="text brand-vault">Use Cases</span><div data-testid="root"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 9l6 6 6-6" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></button><ul class="submenu-modal style-dropdown is-collapsed"><li><a href="/use-cases/secrets-management" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Secrets Management</span></a></li><li><a href="/use-cases/data-encryption" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Data Encryption</span></a></li><li><a href="/use-cases/identity-based-access" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Identity-based Access</span></a></li></ul></li><li><a href="https://www.hashicorp.com/products/vault/enterprise" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Enterprise</span></a></li><li><span class="vertical-divider"></span></li><li><a href="https://learn.hashicorp.com/vault" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Tutorials</span></a></li><li><a href="/docs" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Docs</span></a></li><li><a href="/api-docs" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">API</span></a></li><li><a href="/community" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Community</span></a></li></ul><div class="cta-links "><a href="https://www.github.com/hashicorp/vault" class="github-button"><span class="github"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg><span class="hidden-text">GitHub</span></span></a><a class="g-btn size-small variant-secondary style_vault__1OYha background-light" data-ga-button="try-cloud" href="https://portal.cloud.hashicorp.com/sign-up?utm_source=vault_io&amp;utm_content=top_nav_vault"><span class="text g-type-buttons-and-standalone-links">Try Cloud</span></a><a class="g-btn size-small variant-primary style_vault__1OYha background-light" data-ga-button="download" href="/downloads"><span class="icon at-left is-animated" data-animation="download"><div data-testid="root"><svg role="img" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Download icon</title><path d="M3 17v3a2 2 0 002 2h14a2 2 0 002-2v-3" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path data-animation-target="true" d="M8 12l4 4m0 0l4-4m-4 4V2" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></span><span class="text g-type-buttons-and-standalone-links">Download</span></a></div></div></div></nav><div id="p-docs"><div class="content-wrap g-grid-container"><div id="sidebar" role="complementary"><div class="nav docs-nav"><div class="g-docs-sidenav style_root__-H22M style_vault__1OYha"><button class="style_mobileMenuToggle__2iMJX g-type-body-small-strong"><span><div><svg width="20" height="20" fill="none"><path fill="#000" fill-rule="evenodd" d="M3.083 14.411a.847.847 0 00-.267-.183.863.863 0 00-.483-.042c-.05.008-.109.025-.159.042a1.245 1.245 0 00-.266.183 1.01 1.01 0 00-.184.267.864.864 0 00-.058.325c0 .05 0 .108.017.158a.88.88 0 00.041.159c.025.05.05.1.084.141.025.05.066.092.1.125.041.042.082.075.125.108.05.025.091.059.141.075.05.017.109.034.159.05.058.009.107.017.166.017a.829.829 0 00.584-.25.534.534 0 00.108-.125c.025-.042.058-.091.075-.142.025-.05.042-.1.05-.158a1.06 1.06 0 00.017-.158.872.872 0 00-.067-.325.729.729 0 00-.183-.267zm0-5a.846.846 0 00-.267-.183.863.863 0 00-.483-.042 1.11 1.11 0 00-.159.042 1.252 1.252 0 00-.266.183.821.821 0 00-.242.592c0 .108.017.216.058.316a1.01 1.01 0 00.309.375c.05.025.091.05.141.075.05.017.109.034.159.05.058.009.107.017.166.017a.829.829 0 00.584-.25.83.83 0 00.25-.583.871.871 0 00-.067-.325.729.729 0 00-.183-.267zm0-5a.795.795 0 00-.75-.225 1.11 1.11 0 00-.159.042 1.255 1.255 0 00-.266.183.835.835 0 00-.242.592c0 .108.017.217.058.317a1.01 1.01 0 00.309.375c.05.025.091.05.141.075.05.016.109.033.159.05.058.008.107.016.166.016a.83.83 0 00.584-.25.83.83 0 00.25-.583.906.906 0 00-.067-.325.729.729 0 00-.183-.267zm14.414 9.756H6.663a.833.833 0 100 1.667h10.834a.833.833 0 100-1.667zm0-5H6.663a.833.833 0 100 1.667h10.834a.833.833 0 100-1.667zM18.33 5c0 .46-.372.834-.833.834H6.663a.833.833 0 110-1.667h10.834c.46 0 .833.372.833.833z" clip-rule="evenodd"/></svg></div> Documentation Menu</span></button><button type="button" aria-label="Show Search Bar" class="style_searchToggle__226HK"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M8.75 15a6.25 6.25 0 100-12.5 6.25 6.25 0 000 12.5z" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.5 17.5l-4.333-4.333" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></button><ul class="style_rootList__1pfEP" data-is-mobile-hidden="true" data-is-mobile-open="false"><button class="style_mobileClose__3BcsD">×</button><input class="style_filterInput__4ecGq" placeholder="Filter..." value=""/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/getting-started/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Getting Started</span></a></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Vault Operations</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/reference-architecture/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Reference Architecture</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/vault-ha-consul/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault HA with Consul</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/production/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Production Hardening</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/generate-root/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Root Token Generation</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/rekeying-and-rotating/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Rekeying & Rotating</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/plugin-backends/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Building Plugin Backends</span></a></li><hr class="style_divider__3H9xA"/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/replication/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Replication Setup & Guidance</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/disaster-recovery/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Disaster Recovery Setup</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/mount-filter/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Mount Filter</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/multi-tenant/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Multi-Tenant: Namespaces</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/autounseal-aws-kms/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Auto-unseal with AWS KMS</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/seal-wrap/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Seal Wrap / FIPS 140-2</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/monitoring/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Cluster Monitoring</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/deployment-guide/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Deployment Guide</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/performance-nodes/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Performance Standby Nodes</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Identity and Access Management</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/secure-intro/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Secure Introduction of Vault Clients</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/policies/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Policies</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/policy-templating/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>ACL Policy Path Templating</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/authentication/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>AppRole Pull Authentication</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/approle-trusted-entities/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>AppRole with Terraform and Chef</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/lease/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Tokens and Leases</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/identity/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Identity - Entities & Groups</span></a></li><hr class="style_divider__3H9xA"/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/sentinel/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Sentinel Policies</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/control-groups/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Control Groups</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Secrets Management</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/static-secrets/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Static Secrets</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/versioned-kv/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Versioned KV Secret Engine</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/dynamic-secrets/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Secret as a Service</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/db-root-rotation/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>DB Root Credential Rotation</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/cubbyhole/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Cubbyhole Response Wrapping</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/ssh-otp/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>One-Time SSH Password</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/pki-engine/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Build Your Own CA</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/app-integration/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Direct Application Integration</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Encryption as a Service</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/transit/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Encryption as a Service</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/spring-demo/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Java Application Demo</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/transit-rewrap/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Transit Secrets Re-wrapping</span></a></li></ul></li></ul></div></div></div><div id="inner" role="main" class=""><article class="g-content g-type-long-body style_vault__1OYha"><div class="g-search"><label id="search-box-label" for="search-box" class="visually-hidden">Search Vault documentation</label><div class="c-search-box"><form novalidate="" action="" role="search"><input type="search" id="search-box" class="g-type-body-strong" placeholder="Search Vault documentation" autoComplete="off" autoCorrect="off" autoCapitalize="off" spellcheck="false" maxLength="512" required="" value="" aria-autocomplete="list" aria-controls="search-results" aria-activedescendant="" data-heap-track="SearchBox"/><button type="submit" title="Submit your search query." class="btn-submit"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M8.75 15a6.25 6.25 0 100-12.5 6.25 6.25 0 000 12.5z" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.5 17.5l-4.333-4.333" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button><button type="reset" title="Clear the search query." class="btn-reset"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.915 1.077h13.684v13.684H1.915z"/><path d="M1.915 1.077l13.683 13.684M1.915 14.76L15.598 1.078" stroke="var(--gray-3)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button><div class="icon-loading"><svg width="18" height="18" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#444"><g fill="none" fill-rule="evenodd"><g transform="translate(1 1)" stroke-width="2"><circle stroke-opacity=".5" cx="18" cy="18" r="18"></circle><path d="M36 18c0-9.94-8.06-18-18-18" transform="rotate(296.263 18 18)"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="1s" repeatCount="indefinite"></animateTransform></path></g></g></svg></div><svg class="icon-slash" width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img"><title>Type &#x27;/&#x27; to Search</title><rect x=".5" y=".5" width="23" height="23" rx=".5" stroke="var(--gray-3)"></rect><path d="M9 18l6-12" stroke="var(--gray-3)" stroke-width="1.5"></path></svg></form></div></div><h1 class="g-type-display-2"><a class="__permalink-h" href="#vault-disaster-recovery-replication" aria-label="vault disaster recovery replication permalink">»</a><a class="__target-h" id="vault-disaster-recovery-replication" aria-hidden=""></a>Vault Disaster Recovery Replication</h1><div class="alert alert-warning g-type-body" role="alert"><p class="g-type-long-body"><strong>Enterprise Only:</strong> Disaster Recovery Replication is a part of <em>Vault Enterprise Pro</em>.</p></div><p class="g-type-long-body">It is inevitable for organizations to have a disaster recovery (DR) strategy to
protect their Vault deployment against catastrophic failure of an entire
cluster. Vault Enterprise supports multi-datacenter deployment where you can
replicate data across datacenters for performance as well as disaster recovery.</p><p class="g-type-long-body">A cluster is the basic unit of Vault Enterprise replication which follows the
leader-follower model. A leader cluster is referred to as the <strong>primary</strong>
cluster and is considered the <em>system of record</em>. Data is streamed from the
primary cluster to all <strong>secondary</strong> (follower) clusters.</p><p class="g-type-long-body"><img src="/img/vault-ref-arch-8.png" alt="Replication Pattern"/></p><div class="alert alert-warning g-type-body" role="alert"><p class="g-type-long-body"><strong>Important:</strong> In DR replication, secondary clusters <strong><em>do not forward</em></strong>
service read or write requests until they are promoted and become a new primary</p></div><ul><li class="g-type-long-body">they essentially act as a warm standby cluster.</li></ul><p class="g-type-long-body">The <a href="/guides/operations/mount-filter">Mount Filter</a> guide provides step-by-step
instructions on setting up performance replication. This guide focuses on DR
replication setup.</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#reference-materials" aria-label="reference materials permalink">»</a><a class="__target-h" id="reference-materials" aria-hidden=""></a>Reference Materials</h2><ul><li class="g-type-long-body"><a href="/docs/enterprise/replication#performance-replication-and-disaster-recovery-dr-replication">Performance Replication and Disaster Recovery (DR) Replication</a></li><li class="g-type-long-body"><a href="/api/system/replication/replication-dr">DR Replication API</a></li><li class="g-type-long-body"><a href="/guides/operations/replication">Replication Setup &amp; Guidance</a></li><li class="g-type-long-body"><a href="/guides/operations/vault-ha-consul">Vault HA guide</a></li></ul><h2 class="g-type-display-3"><a class="__permalink-h" href="#estimated-time-to-complete" aria-label="estimated time to complete permalink">»</a><a class="__target-h" id="estimated-time-to-complete" aria-hidden=""></a>Estimated Time to Complete</h2><p class="g-type-long-body">10 minutes</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#prerequisites" aria-label="prerequisites permalink">»</a><a class="__target-h" id="prerequisites" aria-hidden=""></a>Prerequisites</h2><p class="g-type-long-body">This intermediate Vault operations guide assumes that you have some working
knowledge of Vault.</p><p class="g-type-long-body">You need two Vault Enterprise clusters: one behaves as the <strong>primary cluster</strong>,
and another becomes the <strong>secondary</strong>.</p><p class="g-type-long-body"><img src="/img/vault-dr-0.png" alt="DR Prerequisites"/></p><h2 class="g-type-display-3"><a class="__permalink-h" href="#steps" aria-label="steps permalink">»</a><a class="__target-h" id="steps" aria-hidden=""></a>Steps</h2><p class="g-type-long-body">This guide walk through the following operations:</p><ol><li class="g-type-long-body"><a href="#step1">Enable DR Primary Replication</a></li><li class="g-type-long-body"><a href="#step2">Enable DR Secondary Replication</a></li><li class="g-type-long-body"><a href="#step3">Promote DR Secondary to Primary</a></li><li class="g-type-long-body"><a href="#step4">Demote DR Primary to Secondary</a></li><li class="g-type-long-body"><a href="#step5">Disable DR Primary</a></li></ol><h3 class="g-type-display-4"><a class="__permalink-h" href="#step1" aria-label="step 1 enable dr primary replication permalink">»</a><a class="__target-h __compat" id="step1" aria-hidden=""></a><a class="__target-h" id="step-1-enable-dr-primary-replication" aria-hidden=""></a>Step 1: Enable DR Primary Replication</h3><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command" aria-label="cli command permalink">»</a><a class="__target-h" id="cli-command" aria-hidden=""></a>CLI command</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">Enable DR replication on the <strong>primary</strong> cluster.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault write -f sys/replication/dr/primary/enable<!-- -->
<!-- -->WARNING! The following warnings were returned from Vault:<!-- -->
<!-- -->
<!-- -->* This cluster is being enabled as a primary for replication. Vault will be<!-- -->
<!-- -->unavailable for a brief period and will resume service shortly.<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault write -f sys/replication/dr/primary/enable</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">WARNING! The following warnings were returned from Vault:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">* This cluster is being enabled as a primary for replication. Vault will be</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">unavailable for a brief period and will resume service shortly.</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Generate a secondary token.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault write sys/replication/dr/primary/secondary-token id=&quot;secondary&quot;<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault write sys/replication/dr/primary/secondary-token id=&quot;secondary&quot;</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The output should look similar to:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">Key                              Value<!-- -->
<!-- -->---                              -----<!-- -->
<!-- -->wrapping_token:                  eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJhZGRyIjoiaHR0cDovLzEzLjU3LjIwLjQxOjgyMDAiLCJleHAiOjE1MjkzMzkzMzEsImlhdCI6MTUyOTMzNzUzMSwianRpIjoiZDZmMmMzZTItMTZjNS1mNTU0LWYxMzAtNzMzZDE0OWNiNTIzIiwidHlwZSI6IndyYXBwaW5nIn0.MIGIAkIArsC3s1x7GYnEbaYwAbYUj-Wgp4B3Q3kVXL0BbaKvsECySV4Pwtm--i24OSQfI9zAlsG8ZypOWJdngRa59wlhWdQCQgG22-I-aNWPehjsqmwwEADU-u37LUrR6O0MsUCqtfWYwIM9o7PFP1wMZ4JwDGftQXUH6hIrkXZDxnnGsSCJ1Vl75w<!-- -->
<!-- -->wrapping_accessor:               bab0ea36-23f6-d21d-4ca6-a9c3673766a3<!-- -->
<!-- -->wrapping_token_ttl:              30m<!-- -->
<!-- -->wrapping_token_creation_time:    2018-06-18 15:58:51.645117216 +0000 UTC<!-- -->
<!-- -->wrapping_token_creation_path:    sys/replication/dr/primary/secondary-token<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">Key                              Value</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">---                              -----</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">wrapping_token:                  eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJhZGRyIjoiaHR0cDovLzEzLjU3LjIwLjQxOjgyMDAiLCJleHAiOjE1MjkzMzkzMzEsImlhdCI6MTUyOTMzNzUzMSwianRpIjoiZDZmMmMzZTItMTZjNS1mNTU0LWYxMzAtNzMzZDE0OWNiNTIzIiwidHlwZSI6IndyYXBwaW5nIn0.MIGIAkIArsC3s1x7GYnEbaYwAbYUj-Wgp4B3Q3kVXL0BbaKvsECySV4Pwtm--i24OSQfI9zAlsG8ZypOWJdngRa59wlhWdQCQgG22-I-aNWPehjsqmwwEADU-u37LUrR6O0MsUCqtfWYwIM9o7PFP1wMZ4JwDGftQXUH6hIrkXZDxnnGsSCJ1Vl75w</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">wrapping_accessor:               bab0ea36-23f6-d21d-4ca6-a9c3673766a3</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">wrapping_token_ttl:              30m</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">wrapping_token_creation_time:    2018-06-18 15:58:51.645117216 +0000 UTC</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">wrapping_token_creation_path:    sys/replication/dr/primary/secondary-token</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body">Copy the generated <strong><code>wrapping_token</code></strong> which you will need to enable the DR
secondary cluster.</p></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl" aria-label="api call using curl permalink">»</a><a class="__target-h" id="api-call-using-curl" aria-hidden=""></a>API call using cURL</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">Enable DR replication on the <strong>primary</strong> cluster by invoking <strong><code>/sys/replication/dr/primary/enable</code></strong> endpoint.</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->       --request POST \<!-- -->
<!-- -->       --data &#x27;{}&#x27; \<!-- -->
<!-- -->       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/enable<!-- -->
<!-- --> {<!-- -->
<!-- -->   &quot;request_id&quot;: &quot;ef38af20-9c1f-138a-2d03-bbb6410fb0fc&quot;,<!-- -->
<!-- -->   &quot;lease_id&quot;: &quot;&quot;,<!-- -->
<!-- -->   &quot;renewable&quot;: false,<!-- -->
<!-- -->   &quot;lease_duration&quot;: 0,<!-- -->
<!-- -->   &quot;data&quot;: null,<!-- -->
<!-- -->   &quot;wrap_info&quot;: null,<!-- -->
<!-- -->   &quot;warnings&quot;: [<!-- -->
<!-- -->     &quot;This cluster is being enabled as a primary for replication. Vault will be<!-- -->
<!-- -->     unavailable for a brief period and will resume service shortly.&quot;<!-- -->
<!-- -->   ],<!-- -->
<!-- -->   &quot;auth&quot;: null<!-- -->
<!-- --> }<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --data &#x27;{}&#x27; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/enable</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;request_id&quot;: &quot;ef38af20-9c1f-138a-2d03-bbb6410fb0fc&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;lease_id&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;renewable&quot;: false,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;lease_duration&quot;: 0,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;data&quot;: null,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;wrap_info&quot;: null,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;warnings&quot;: [</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     &quot;This cluster is being enabled as a primary for replication. Vault will be</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     unavailable for a brief period and will resume service shortly.&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   ],</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;auth&quot;: null</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> }</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Generate a secondary token by invoking <strong><code>/sys/replication/dr/primary/secondary-token</code></strong> endpoint.</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->       --request POST \<!-- -->
<!-- -->       --data &#x27;{ &quot;id&quot;: &quot;secondary&quot;}&#x27; \<!-- -->
<!-- -->       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/secondary-token | jq<!-- -->
<!-- --> {<!-- -->
<!-- -->   &quot;request_id&quot;: &quot;&quot;,<!-- -->
<!-- -->   &quot;lease_id&quot;: &quot;&quot;,<!-- -->
<!-- -->   &quot;renewable&quot;: false,<!-- -->
<!-- -->   &quot;lease_duration&quot;: 0,<!-- -->
<!-- -->   &quot;data&quot;: null,<!-- -->
<!-- -->   &quot;wrap_info&quot;: {<!-- -->
<!-- -->     &quot;token&quot;: &quot;eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJhZGRyIjoiaHR0cDovLzEzLjU3LjIwLjQxOjgyMDAiLCJleHAiOjE1MjkzNDQzMjcsImlhdCI6MTUyOTM0MjUyNywianRpIjoiYmRiZTJiNzEtODgwMS05YjZjLTNjMTQtMzVkNDI3NDQ3MjEzIiwidHlwZSI6IndyYXBwaW5nIn0.MIGIAkIBmESVVq_83l9hixTN7Ot0v5XQMsQfi1zV9APooZWkLvbS2olBWSQnskykQQH6GskMOi-ypOlAabqxWmfoCLA8-TICQgHRdkbJGgAQtWmjc8Z-ZEgymMv8YZq6qQxbUtPXloyM-cf_1Y1qmdGDYWtjPqoF5m1Bt_WkAJl9MguVb04QMWSotw&quot;,<!-- -->
<!-- -->     &quot;accessor&quot;: &quot;7e56e9da-178c-119d-1d01-807a203fa0b3&quot;,<!-- -->
<!-- -->     &quot;ttl&quot;: 1800,<!-- -->
<!-- -->     &quot;creation_time&quot;: &quot;2018-06-18T17:22:07.129747708Z&quot;,<!-- -->
<!-- -->     &quot;creation_path&quot;: &quot;sys/replication/dr/primary/secondary-token&quot;<!-- -->
<!-- -->   },<!-- -->
<!-- -->   &quot;warnings&quot;: null,<!-- -->
<!-- -->   &quot;auth&quot;: null<!-- -->
<!-- --> }<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --data &#x27;{ &quot;id&quot;: &quot;secondary&quot;}&#x27; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/secondary-token | jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;request_id&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;lease_id&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;renewable&quot;: false,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;lease_duration&quot;: 0,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;data&quot;: null,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;wrap_info&quot;: {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     &quot;token&quot;: &quot;eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJhZGRyIjoiaHR0cDovLzEzLjU3LjIwLjQxOjgyMDAiLCJleHAiOjE1MjkzNDQzMjcsImlhdCI6MTUyOTM0MjUyNywianRpIjoiYmRiZTJiNzEtODgwMS05YjZjLTNjMTQtMzVkNDI3NDQ3MjEzIiwidHlwZSI6IndyYXBwaW5nIn0.MIGIAkIBmESVVq_83l9hixTN7Ot0v5XQMsQfi1zV9APooZWkLvbS2olBWSQnskykQQH6GskMOi-ypOlAabqxWmfoCLA8-TICQgHRdkbJGgAQtWmjc8Z-ZEgymMv8YZq6qQxbUtPXloyM-cf_1Y1qmdGDYWtjPqoF5m1Bt_WkAJl9MguVb04QMWSotw&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     &quot;accessor&quot;: &quot;7e56e9da-178c-119d-1d01-807a203fa0b3&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     &quot;ttl&quot;: 1800,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     &quot;creation_time&quot;: &quot;2018-06-18T17:22:07.129747708Z&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     &quot;creation_path&quot;: &quot;sys/replication/dr/primary/secondary-token&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   },</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;warnings&quot;: null,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;auth&quot;: null</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> }</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body">Copy the generated <strong><code>token</code></strong> which you will need to enable the DR
secondary cluster.</p></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui" aria-label="web ui permalink">»</a><a class="__target-h" id="web-ui" aria-hidden=""></a>Web UI</h4><p class="g-type-long-body">Open a web browser and launch the Vault UI (e.g.
<a href="https://cluster-A.example.com:8200/ui">https://cluster-A.example.com:8200/ui</a>) and then login.</p><ol><li class="g-type-long-body"><p class="g-type-long-body">Select <strong>Replication</strong> and check the <strong>Disaster Recovery (DR)</strong> radio button.
<img src="/img/vault-dr-1.png" alt="DR Replication - primary"/></p></li><li class="g-type-long-body"><p class="g-type-long-body">Click <strong>Enable replication</strong>.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Select the <strong>Secondaries</strong> tab, and then click <strong>Add</strong>.
<img src="/img/vault-dr-2.png" alt="DR Replication - primary"/></p></li><li class="g-type-long-body"><p class="g-type-long-body">Populate the <strong>Secondary ID</strong> field, and click <strong>Generate token</strong>.
<img src="/img/vault-dr-3.png" alt="DR Replication - primary"/></p></li><li class="g-type-long-body"><p class="g-type-long-body">Click <strong>Copy</strong> to copy the token which you will need to enable the DR secondary cluster.
<img src="/img/vault-dr-4.png" alt="DR Replication - primary"/></p></li></ol><h3 class="g-type-display-4"><a class="__permalink-h" href="#step2" aria-label="step 2 enable dr secondary replication permalink">»</a><a class="__target-h __compat" id="step2" aria-hidden=""></a><a class="__target-h" id="step-2-enable-dr-secondary-replication" aria-hidden=""></a>Step 2: Enable DR Secondary Replication</h3><p class="g-type-long-body">The following operations must be performed on the DR secondary cluster.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command-1" aria-label="cli command permalink">»</a><a class="__target-h" id="cli-command-1" aria-hidden=""></a>CLI command</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">Enable DR replication on the <strong>secondary</strong> cluster.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault write sys/replication/dr/secondary/enable token=&quot;...&quot;<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault write sys/replication/dr/secondary/enable token=&quot;...&quot;</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Where the <code>token</code> is the <code>wrapping_token</code> obtained from the primary cluster.</p><p class="g-type-long-body">Expected output:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">WARNING! The following warnings were returned from Vault:<!-- -->
<!-- -->
<!-- -->* Vault has successfully found secondary information; it may take a while to<!-- -->
<!-- -->perform setup tasks. Vault will be unavailable until these tasks and initial<!-- -->
<!-- -->sync complete.<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">WARNING! The following warnings were returned from Vault:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">* Vault has successfully found secondary information; it may take a while to</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">perform setup tasks. Vault will be unavailable until these tasks and initial</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">sync complete.</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><div class="alert alert-danger g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> This will immediately clear all data in the secondary cluster.</p></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl-1" aria-label="api call using curl permalink">»</a><a class="__target-h" id="api-call-using-curl-1" aria-hidden=""></a>API call using cURL</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">Enable DR replication on the <strong>secondary</strong> cluster.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;token&quot;: &quot;...&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->       --request POST \<!-- -->
<!-- -->       --data @payload.json \<!-- -->
<!-- -->       https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/enable | jq<!-- -->
<!-- -->{<!-- -->
<!-- -->   &quot;request_id&quot;: &quot;7a9730c1-b6fc-6557-5c0a-081e1f89ed2d&quot;,<!-- -->
<!-- -->   &quot;lease_id&quot;: &quot;&quot;,<!-- -->
<!-- -->   &quot;renewable&quot;: false,<!-- -->
<!-- -->   &quot;lease_duration&quot;: 0,<!-- -->
<!-- -->   &quot;data&quot;: null,<!-- -->
<!-- -->   &quot;wrap_info&quot;: null,<!-- -->
<!-- -->   &quot;warnings&quot;: [<!-- -->
<!-- -->     &quot;Vault has successfully found secondary information; it may take a while<!-- -->
<!-- -->     to perform setup tasks. Vault will be unavailable until these tasks and<!-- -->
<!-- -->     initial sync complete.&quot;<!-- -->
<!-- -->   ],<!-- -->
<!-- -->   &quot;auth&quot;: null<!-- -->
<!-- --> }<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;token&quot;: &quot;...&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --data @payload.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/enable | jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;request_id&quot;: &quot;7a9730c1-b6fc-6557-5c0a-081e1f89ed2d&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;lease_id&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;renewable&quot;: false,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;lease_duration&quot;: 0,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;data&quot;: null,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;wrap_info&quot;: null,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;warnings&quot;: [</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     &quot;Vault has successfully found secondary information; it may take a while</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     to perform setup tasks. Vault will be unavailable until these tasks and</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     initial sync complete.&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   ],</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;auth&quot;: null</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> }</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Where the <code>token</code> in <code>payload.json</code> is the token obtained from the primary
cluster.</p><div class="alert alert-danger g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> This will immediately clear all data in the secondary cluster.</p></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-1" aria-label="web ui permalink">»</a><a class="__target-h" id="web-ui-1" aria-hidden=""></a>Web UI</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">Now, launch the Vault UI for the <strong>secondary</strong> cluster (e.g. <a href="https://cluster-B.example.com:8200/ui">https://cluster-B.example.com:8200/ui</a>) and click <strong>Replication</strong>.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Check the <strong>Disaster Recovery (DR)</strong> radio button and select <strong>secondary</strong> under the <strong>Cluster mode</strong>. Paste the token you copied from the primary in the <strong>Secondary activation token</strong> field.
<img src="/img/vault-dr-5.png" alt="DR Replication - secondary"/></p></li><li class="g-type-long-body"><p class="g-type-long-body">Click <strong>Enable replication</strong>.
<img src="/img/vault-dr-5.2.png" alt="DR Replication - secondary"/></p></li></ol><div class="alert alert-danger g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> This will immediately clear all data in the secondary cluster.</p></div><h3 class="g-type-display-4"><a class="__permalink-h" href="#step3" aria-label="step 3 promote dr secondary to primary permalink">»</a><a class="__target-h __compat" id="step3" aria-hidden=""></a><a class="__target-h" id="step-3-promote-dr-secondary-to-primary" aria-hidden=""></a>Step 3: Promote DR Secondary to Primary</h3><p class="g-type-long-body">This step walks you through the promotion of the secondary cluster to become the
new primary when a catastrophic failure causes the primary cluster to be
inoperable. Refer to the <a href="#important"><em>Important Note about Automated DR
Failover</em></a> section for more background information.</p><p class="g-type-long-body">First, you must generate a <strong>DR operation token</strong> which you need to promote the
secondary cluster. The process, outlined below using API calls, is the similar to <a href="/guides/operations/generate-root"><em>Generating a Root Token (via CLI)</em></a>.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#from-terminal" aria-label="from terminal permalink">»</a><a class="__target-h" id="from-terminal" aria-hidden=""></a>From Terminal</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">Generate an one time password (OTP) to use:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault operator generate-root -dr-token -generate-otp<!-- -->
<!-- -->HenFLWmt0AgrjWJp/RECzQ==<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault operator generate-root -dr-token -generate-otp</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">HenFLWmt0AgrjWJp/RECzQ==</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Start the DR operation token generation process by invoking <strong><code>/sys/replication/dr/secondary/generate-operation-token/attempt</code></strong> endpoint.</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;otp&quot;: &quot;HenFLWmt0AgrjWJp/RECzQ==&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --request PUT \<!-- -->
<!-- -->     --data @payload.json \<!-- -->
<!-- -->     https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/attempt | jq<!-- -->
<!-- --> {<!-- -->
<!-- -->   &quot;nonce&quot;: &quot;455bf989-6575-1262-c0d0-a94eaf60bdd0&quot;,<!-- -->
<!-- -->   &quot;started&quot;: true,<!-- -->
<!-- -->   &quot;progress&quot;: 0,<!-- -->
<!-- -->   &quot;required&quot;: 3,<!-- -->
<!-- -->   &quot;complete&quot;: false,<!-- -->
<!-- -->   &quot;encoded_token&quot;: &quot;&quot;,<!-- -->
<!-- -->   &quot;encoded_root_token&quot;: &quot;&quot;,<!-- -->
<!-- -->   &quot;pgp_fingerprint&quot;: &quot;&quot;<!-- -->
<!-- --> }<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;otp&quot;: &quot;HenFLWmt0AgrjWJp/RECzQ==&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --request PUT \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     --data @payload.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">     https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/attempt | jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;nonce&quot;: &quot;455bf989-6575-1262-c0d0-a94eaf60bdd0&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;started&quot;: true,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;progress&quot;: 0,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;required&quot;: 3,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;complete&quot;: false,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;encoded_token&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;encoded_root_token&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;pgp_fingerprint&quot;: &quot;&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> }</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body">Distribute the generated <strong><code>nonce</code></strong> to each unseal key holder.</p></div></li><li class="g-type-long-body"><p class="g-type-long-body">In order to generate a DR operation token, a quorum of unseal keys must be
entered by each key holder via <strong><code>/sys/replication/dr/secondary/generate-operation-token/update</code></strong> endpoint.</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload_key1.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;key&quot;: &quot;&lt;primary_unseal_key_1&gt;&quot;,<!-- -->
<!-- -->  &quot;nonce&quot;: &quot;455bf989-6575-1262-c0d0-a94eaf60bdd0&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --request PUT \<!-- -->
<!-- -->        --data @payload_key1.json \<!-- -->
<!-- -->        https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/update | jq<!-- -->
<!-- -->  {<!-- -->
<!-- -->    &quot;nonce&quot;: &quot;455bf989-6575-1262-c0d0-a94eaf60bdd0&quot;,<!-- -->
<!-- -->    &quot;started&quot;: true,<!-- -->
<!-- -->    &quot;progress&quot;: 1,<!-- -->
<!-- -->    &quot;required&quot;: 3,<!-- -->
<!-- -->    &quot;complete&quot;: false,<!-- -->
<!-- -->    &quot;encoded_token&quot;: &quot;&quot;,<!-- -->
<!-- -->    &quot;encoded_root_token&quot;: &quot;&quot;,<!-- -->
<!-- -->    &quot;pgp_fingerprint&quot;: &quot;&quot;<!-- -->
<!-- -->  }<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload_key1.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;key&quot;: &quot;&lt;primary_unseal_key_1&gt;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;nonce&quot;: &quot;455bf989-6575-1262-c0d0-a94eaf60bdd0&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --request PUT \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --data @payload_key1.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/update | jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;nonce&quot;: &quot;455bf989-6575-1262-c0d0-a94eaf60bdd0&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;started&quot;: true,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;progress&quot;: 1,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;required&quot;: 3,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;complete&quot;: false,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;encoded_token&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;encoded_root_token&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;pgp_fingerprint&quot;: &quot;&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  }</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">This operation must be executed by each unseal key holder. Once the quorum
has been reached, the output contains the encoded DR operation token
(<code>encoded_token</code>).</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ curl --request PUT \<!-- -->
<!-- -->      --data @payload_key3.json \<!-- -->
<!-- -->      https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/update | jq<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;nonce&quot;: &quot;455bf989-6575-1262-c0d0-a94eaf60bdd0&quot;,<!-- -->
<!-- -->  &quot;started&quot;: true,<!-- -->
<!-- -->  &quot;progress&quot;: 3,<!-- -->
<!-- -->  &quot;required&quot;: 3,<!-- -->
<!-- -->  &quot;complete&quot;: true,<!-- -->
<!-- -->  &quot;encoded_token&quot;: &quot;dKNQqNmh3JfJcSZdGlkttQ==&quot;,<!-- -->
<!-- -->  &quot;encoded_root_token&quot;: &quot;&quot;,<!-- -->
<!-- -->  &quot;pgp_fingerprint&quot;: &quot;&quot;<!-- -->
<!-- -->}<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --request PUT \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">      --data @payload_key3.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">      https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/update | jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;nonce&quot;: &quot;455bf989-6575-1262-c0d0-a94eaf60bdd0&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;started&quot;: true,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;progress&quot;: 3,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;required&quot;: 3,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;complete&quot;: true,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;encoded_token&quot;: &quot;dKNQqNmh3JfJcSZdGlkttQ==&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;encoded_root_token&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;pgp_fingerprint&quot;: &quot;&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Decode the generated DR operation token (<code>encoded_token</code>).</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault operator generate-root -dr-token \<!-- -->
<!-- -->        -decode=&quot;dKNQqNmh3JfJcSZdGlkttQ==&quot; \<!-- -->
<!-- -->        -otp=&quot;HenFLWmt0AgrjWJp/RECzQ==&quot;<!-- -->
<!-- -->
<!-- -->23e02f22-2ae6-94cc-d93f-5ee295e03e9d<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault operator generate-root -dr-token \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        -decode=&quot;dKNQqNmh3JfJcSZdGlkttQ==&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        -otp=&quot;HenFLWmt0AgrjWJp/RECzQ==&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">23e02f22-2ae6-94cc-d93f-5ee295e03e9d</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Finally, promote the DR secondary to become the primary by invoking the
<strong><code>sys/replication/dr/secondary/promote</code></strong> endpoint. The request payload must
contains the DR operation token.</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->      &quot;dr_operation_token&quot;: &quot;23e02f22-2ae6-94cc-d93f-5ee295e03e9d&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->          --request POST \<!-- -->
<!-- -->          --data @payload.json \<!-- -->
<!-- -->          https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/promote | jq<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;request_id&quot;: &quot;3879546b-1dc7-8490-521b-80104ad761b5&quot;,<!-- -->
<!-- -->  &quot;lease_id&quot;: &quot;&quot;,<!-- -->
<!-- -->  &quot;renewable&quot;: false,<!-- -->
<!-- -->  &quot;lease_duration&quot;: 0,<!-- -->
<!-- -->  &quot;data&quot;: null,<!-- -->
<!-- -->  &quot;wrap_info&quot;: null,<!-- -->
<!-- -->  &quot;warnings&quot;: [<!-- -->
<!-- -->    &quot;This cluster is being promoted to a replication primary. Vault will be unavailable<!-- -->
<!-- -->    for a brief period and will resume service shortly.&quot;<!-- -->
<!-- -->  ],<!-- -->
<!-- -->  &quot;auth&quot;: null<!-- -->
<!-- -->}<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">      &quot;dr_operation_token&quot;: &quot;23e02f22-2ae6-94cc-d93f-5ee295e03e9d&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">          --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">          --data @payload.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">          https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/promote | jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;request_id&quot;: &quot;3879546b-1dc7-8490-521b-80104ad761b5&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;lease_id&quot;: &quot;&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;renewable&quot;: false,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;lease_duration&quot;: 0,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;data&quot;: null,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;wrap_info&quot;: null,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;warnings&quot;: [</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;This cluster is being promoted to a replication primary. Vault will be unavailable</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    for a brief period and will resume service shortly.&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  ],</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;auth&quot;: null</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-2" aria-label="web ui permalink">»</a><a class="__target-h" id="web-ui-2" aria-hidden=""></a>Web UI</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">Click on <strong>Generate OTP</strong> to generate an OTP. Then click <strong>Copy OTP</strong>.
<img src="/img/vault-dr-6.png" alt="DR Replication - secondary"/></p></li><li class="g-type-long-body"><p class="g-type-long-body">Click <strong>Generate Operation Token</strong>.</p></li><li class="g-type-long-body"><p class="g-type-long-body">A quorum of unseal keys must be entered to create a new operation token for
the DR secondary.</p><p class="g-type-long-body"><img src="/img/vault-dr-7.png" alt="DR Replication - secondary"/></p><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body">This operation must be performed by each unseal-key holder.</p></div></li><li class="g-type-long-body"><p class="g-type-long-body">Once the quorum has been reached, the output displays the encoded DR operation token. Click <strong>Copy CLI command</strong>.</p><p class="g-type-long-body"><img src="/img/vault-dr-8.png" alt="DR Replication - secondary"/></p></li><li class="g-type-long-body"><p class="g-type-long-body">Execute the CLI command from a terminal to generate a DR operation token
using the OTP generated earlier. (Be sure to enter your OTP in the command.)</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault operator generate-root -dr-token \<!-- -->
<!-- -->        -otp=&quot;vZpZZf5UI1nvB3A5/7Xq9A==&quot; \<!-- -->
<!-- -->        -decode=&quot;cuplaFGYduDEY6ZVC5IfaA==&quot;<!-- -->
<!-- -->
<!-- -->cf703c0d-afcc-55b9-2b64-d66cf427f59c<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-undefined"><code class="style_code__2AMYw language-undefined"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault operator generate-root -dr-token \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        -otp=&quot;vZpZZf5UI1nvB3A5/7Xq9A==&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        -decode=&quot;cuplaFGYduDEY6ZVC5IfaA==&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">cf703c0d-afcc-55b9-2b64-d66cf427f59c</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Now, click <strong>Promote</strong> tab, and then enter the generated DR operation token.</p><p class="g-type-long-body"><img src="/img/vault-dr-9-1.png" alt="DR Replication - secondary"/></p></li><li class="g-type-long-body"><p class="g-type-long-body">Click <strong>Promote cluster</strong>.</p><p class="g-type-long-body">When you prompted, &quot;<em>Are you sure you want to promote this cluster?</em>&quot;, click <strong>Promote cluster</strong> again to complete.</p><p class="g-type-long-body"><img src="/img/vault-dr-9.png" alt="DR Replication - secondary"/></p></li></ol><blockquote><p class="g-type-long-body">Once the secondary cluster was successfully promoted, you should be able to
log in using the original primary cluster&#x27;s root token or via configured
authentication method. If desired, generate a <a href="/guides/operations/generate-root">new root
token</a>.</p></blockquote><h3 class="g-type-display-4"><a class="__permalink-h" href="#step4" aria-label="step 4 demote dr primary to secondary permalink">»</a><a class="__target-h __compat" id="step4" aria-hidden=""></a><a class="__target-h" id="step-4-demote-dr-primary-to-secondary" aria-hidden=""></a>Step 4: Demote DR Primary to Secondary</h3><p class="g-type-long-body">If the <em>original</em> DR primary cluster becomes operational again, you may want to
utilize the cluster by making it a DR secondary cluster. This step explains how
to demote the original DR primary cluster to a secondary.</p><div class="alert alert-warning g-type-body" role="alert"><p class="g-type-long-body">Remember that there is only <strong>one</strong> primary cluster available to the clients
in DR replication.</p></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command-2" aria-label="cli command permalink">»</a><a class="__target-h" id="cli-command-2" aria-hidden=""></a>CLI command</h4><p class="g-type-long-body">Execute the following command to demote the original DR primary cluster to a
secondary.</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> -f sys/replication/dr/primary/demote</span></span>
<!-- -->
<span class="token output">WARNING! The following warnings were returned from Vault:</span>
<!-- -->
<span class="token output">  * This cluster is being demoted to a replication secondary. Vault will be</span>
<span class="token output">  unavailable for a brief period and will resume service shortly.</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> -f sys/replication/dr/primary/demote</span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">WARNING! The following warnings were returned from Vault:</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  * This cluster is being demoted to a replication secondary. Vault will be</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  unavailable for a brief period and will resume service shortly.</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">This secondary cluster will not attempt to connect to a primary (see the
update-primary call), but will maintain knowledge of its cluster ID and can be
reconnected to the same DR replication set without wiping local storage.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl-2" aria-label="api call using curl permalink">»</a><a class="__target-h" id="api-call-using-curl-2" aria-hidden=""></a>API call using cURL</h4><p class="g-type-long-body">Invoke the <strong><code>sys/replication/dr/secondary/enable</code></strong> endpoint to demote the
original DR primary cluster to a secondary.</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span>
<span class="token output">       --request POST \</span>
<span class="token output">       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/demote | jq</span>
<span class="token output">{</span>
<span class="token output">   &quot;request_id&quot;: &quot;8a40adac-6eb7-c798-48d0-f7cdd25fdd6f&quot;,</span>
<span class="token output">   &quot;lease_id&quot;: &quot;&quot;,</span>
<span class="token output">   &quot;renewable&quot;: false,</span>
<span class="token output">   &quot;lease_duration&quot;: 0,</span>
<span class="token output">   &quot;data&quot;: null,</span>
<span class="token output">   &quot;wrap_info&quot;: null,</span>
<span class="token output">   &quot;warnings&quot;: [</span>
<span class="token output">     &quot;This cluster is being demoted to a replication secondary. Vault will be unavailable for a brief period and will resume service shortly.&quot;</span>
<span class="token output">   ],</span>
<span class="token output">   &quot;auth&quot;: null</span>
<span class="token output">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --request POST \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/demote | jq</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;request_id&quot;: &quot;8a40adac-6eb7-c798-48d0-f7cdd25fdd6f&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;lease_id&quot;: &quot;&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;renewable&quot;: false,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;lease_duration&quot;: 0,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;data&quot;: null,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;wrap_info&quot;: null,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;warnings&quot;: [</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">     &quot;This cluster is being demoted to a replication secondary. Vault will be unavailable for a brief period and will resume service shortly.&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   ],</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;auth&quot;: null</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">This secondary cluster will not attempt to connect to a primary (see the
update-primary call), but will maintain knowledge of its cluster ID and can be
reconnected to the same DR replication set without wiping local storage.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-3" aria-label="web ui permalink">»</a><a class="__target-h" id="web-ui-3" aria-hidden=""></a>Web UI</h4><p class="g-type-long-body">Select <strong>Replication</strong> and click <strong>Demote cluster</strong>.</p><p class="g-type-long-body"><img src="/img/vault-dr-10.png" alt="DR Replication - demotion"/></p><p class="g-type-long-body">When you prompted, &quot;<em>Are you sure you want to demote this cluster?</em>&quot;, click
<strong>Demote cluster</strong> again to complete.</p><p class="g-type-long-body"><img src="/img/vault-dr-12.png" alt="DR Replication - demotion"/></p><h3 class="g-type-display-4"><a class="__permalink-h" href="#step5" aria-label="step 5 disable dr primary permalink">»</a><a class="__target-h __compat" id="step5" aria-hidden=""></a><a class="__target-h" id="step-5-disable-dr-primary" aria-hidden=""></a>Step 5: Disable DR Primary</h3><p class="g-type-long-body">Once the DR secondary cluster was promoted to be the <strong>new primary</strong>, you may
want to disable the DR replication on the <em>original</em> primary when it becomes
operational again.</p><div class="alert alert-warning g-type-body" role="alert"><p class="g-type-long-body">Remember that there is only <strong>one</strong> primary cluster available to the clients
in DR replication.</p></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command-3" aria-label="cli command permalink">»</a><a class="__target-h" id="cli-command-3" aria-hidden=""></a>CLI command</h4><p class="g-type-long-body">Execute the following command to disable DR replication.</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> -f sys/replication/dr/primary/disable</span></span>
<!-- -->
<span class="token output">WARNING! The following warnings were returned from Vault:</span>
<!-- -->
<span class="token output">  * This cluster is having replication disabled. Vault will be unavailable for</span>
<span class="token output">    a brief period and will resume service shortly.</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> -f sys/replication/dr/primary/disable</span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">WARNING! The following warnings were returned from Vault:</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  * This cluster is having replication disabled. Vault will be unavailable for</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">    a brief period and will resume service shortly.</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Any secondaries will no longer be able to connect.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl-3" aria-label="api call using curl permalink">»</a><a class="__target-h" id="api-call-using-curl-3" aria-hidden=""></a>API call using cURL</h4><p class="g-type-long-body">Invoke the <strong><code>sys/replication/dr/primary/disable</code></strong> endpoint to disable DR
replication.</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span>
<span class="token output">       --request POST \</span>
<span class="token output">       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/disable | jq</span>
<span class="token output">{</span>
<span class="token output">   &quot;request_id&quot;: &quot;92a5f57a-2f7b-11be-b9dd-0f028396fba8&quot;,</span>
<span class="token output">   &quot;lease_id&quot;: &quot;&quot;,</span>
<span class="token output">   &quot;renewable&quot;: false,</span>
<span class="token output">   &quot;lease_duration&quot;: 0,</span>
<span class="token output">   &quot;data&quot;: null,</span>
<span class="token output">   &quot;wrap_info&quot;: null,</span>
<span class="token output">   &quot;warnings&quot;: [</span>
<span class="token output">     &quot;This cluster is having replication disabled. Vault will be unavailable for a brief period and will resume service shortly.&quot;</span>
<span class="token output">   ],</span>
<span class="token output">   &quot;auth&quot;: null</span>
<span class="token output">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --request POST \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/disable | jq</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;request_id&quot;: &quot;92a5f57a-2f7b-11be-b9dd-0f028396fba8&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;lease_id&quot;: &quot;&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;renewable&quot;: false,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;lease_duration&quot;: 0,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;data&quot;: null,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;wrap_info&quot;: null,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;warnings&quot;: [</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">     &quot;This cluster is having replication disabled. Vault will be unavailable for a brief period and will resume service shortly.&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   ],</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;auth&quot;: null</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Any secondaries will no longer be able to connect.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-4" aria-label="web ui permalink">»</a><a class="__target-h" id="web-ui-4" aria-hidden=""></a>Web UI</h4><p class="g-type-long-body">Select <strong>Replication</strong> and click <strong>Disable replication</strong>.</p><p class="g-type-long-body"><img src="/img/vault-dr-11.png" alt="DR Replication - demotion"/></p><p class="g-type-long-body">When you prompted, &quot;<em>Are you sure you want to disable replication on this
cluster?</em>&quot;, click <strong>Disable</strong> again to complete.</p><p class="g-type-long-body"><img src="/img/vault-dr-13.png" alt="DR Replication - demotion"/></p><p class="g-type-long-body">Any secondaries will no longer be able to connect.</p><div class="alert alert-danger g-type-body" role="alert"><p class="g-type-long-body"><strong>Caution:</strong> Once this is done, re-enabling the DR replication as a primary
will change the cluster&#x27;s ID. Its connecting secondaries will require a wipe of
the underlying storage even if they have connected before. If re-enabling DR
replication as a secondary, its underlying storage will be wiped when connected
to a primary.</p></div><h2 class="g-type-display-3"><a class="__permalink-h" href="#important" aria-label="important note about automated dr failover permalink">»</a><a class="__target-h __compat" id="important" aria-hidden=""></a><a class="__target-h" id="important-note-about-automated-dr-failover" aria-hidden=""></a>Important Note about Automated DR Failover</h2><p class="g-type-long-body">Vault does not support an automatic failover/promotion of a DR secondary
cluster, and this is a deliberate choice due to the difficulty in accurately
evaluating why a failover should or shouldn&#x27;t happen. For example, imagine a
DR secondary loses its connection to the primary. Is it because the primary is
down, or is it because networking between the two has failed?</p><p class="g-type-long-body">If the DR secondary promotes itself and clients start connecting to it, you now
have two active clusters whose data sets will immediately start diverging.
There&#x27;s no way to understand simply from one perspective or the other which one
of them is right.</p><p class="g-type-long-body">Vault&#x27;s API supports programmatically performing various replication operations
which allows the customer to write their own logic about automating some of
these operations based on experience within their own environments. You can
review the available replication APIs at the following links:</p><ul><li class="g-type-long-body"><a href="/api/system/replication">Vault Replication API</a></li><li class="g-type-long-body"><a href="/api/system/replication/replication-dr">DR Replication API</a></li><li class="g-type-long-body"><a href="/api/system/replication/replication-performance">Performance Replication API</a></li></ul><h2 class="g-type-display-3"><a class="__permalink-h" href="#next-steps" aria-label="next steps permalink">»</a><a class="__target-h" id="next-steps" aria-hidden=""></a>Next steps</h2><p class="g-type-long-body">Read <a href="/guides/operations/production">Production Hardening</a> to learn more
about the guidance on hardening the production deployments of Vault.</p></article></div></div><div id="edit-this-page" class="g-container"><a href="https://github.com/hashicorp/vault/blob/main/website/content/guides/operations/disaster-recovery.mdx"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMiIGhlaWdodD0iMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTExLjYwOC4zNDJDNS41MzUuMzQyLjYxIDUuMTYyLjYxIDExLjEwOGMwIDQuNzU3IDMuMTUyIDguNzkyIDcuNTIzIDEwLjIxNS41NS4xLjc1MS0uMjMzLjc1MS0uNTE4IDAtLjI1Ni0uMDEtLjkzMy0uMDE1LTEuODMxLTMuMDYuNjUtMy43MDUtMS40NDQtMy43MDUtMS40NDQtLjUtMS4yNDMtMS4yMjItMS41NzQtMS4yMjItMS41NzQtLjk5OC0uNjY4LjA3Ni0uNjU1LjA3Ni0uNjU1IDEuMTA0LjA3NiAxLjY4NSAxLjExIDEuNjg1IDEuMTEuOTgxIDEuNjQ1IDIuNTc1IDEuMTcgMy4yMDEuODk0LjEtLjY5NS4zODUtMS4xNy42OTktMS40MzktMi40NDMtLjI3MS01LjAxMS0xLjE5NS01LjAxMS01LjMyIDAtMS4xNzYuNDI5LTIuMTM3IDEuMTMyLTIuODktLjExMy0uMjcyLS40OS0xLjM2Ny4xMDgtMi44NDkgMCAwIC45MjQtLjI4OSAzLjAyNSAxLjEwNC44NzctLjI0IDEuODE5LS4zNTggMi43NTQtLjM2My45MzQuMDA1IDEuODc1LjEyNCAyLjc1NC4zNjMgMi4xLTEuMzkzIDMuMDIyLTEuMTA0IDMuMDIyLTEuMTA0LjYgMS40ODIuMjIyIDIuNTc3LjExIDIuODUuNzA1Ljc1MiAxLjEzIDEuNzEzIDEuMTMgMi44ODggMCA0LjEzNi0yLjU3MiA1LjA0Ni01LjAyMiA1LjMxMy4zOTQuMzMyLjc0Ni45OS43NDYgMS45OTQgMCAxLjQzOC0uMDEzIDIuNi0uMDEzIDIuOTUzIDAgLjI4OC4xOTguNjIzLjc1Ni41MTggNC4zNjgtMS40MjcgNy41MTYtNS40NiA3LjUxNi0xMC4yMTUgMC01Ljk0Ni00LjkyNS0xMC43NjYtMTEtMTAuNzY2IiBmaWxsPSIjMTYxNTE0IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=" alt="github logo"/><span>Edit this page</span></a></div></div><footer class="g-footer"><div class="g-container"><div class="left"><a href="/docs/vault_v1.8.x/docs/">Docs</a><a href="/docs/vault_v1.8.x/api/">API</a><a href="https://learn.hashicorp.com/vault">Learn</a><a href="/docs/vault_v1.8.x/community/">Community</a><a href="https://hashicorp.com/privacy">Privacy</a><a href="/docs/vault_v1.8.x/security/">Security</a><a href="/docs/vault_v1.8.x/files/press-kit.zip">Press Kit</a><a>Consent Manager</a></div></div></footer><div id="g-consent-manager"></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"currentPath":"operations/disaster-recovery","frontMatter":{"layout":"guides","page_title":"Vault Disaster Recovery Replication Setup - Guides","description":"This guide demonstrates step-by-step instruction of setting up a disaster\nrecovery (DR) replications."},"githubFileUrl":"https://github.com/hashicorp/vault/blob/main/website/content/guides/operations/disaster-recovery.mdx","mdxSource":{"compiledSource":"var m=Object.defineProperty;var o=Object.prototype.hasOwnProperty;var l=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable;var p=(a,t,n)=\u003et in a?m(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,e=(a,t)=\u003e{for(var n in t||(t={}))o.call(t,n)\u0026\u0026p(a,n,t[n]);if(l)for(var n of l(t))s.call(t,n)\u0026\u0026p(a,n,t[n]);return a};var i=(a,t)=\u003e{var n={};for(var r in a)o.call(a,r)\u0026\u0026t.indexOf(r)\u003c0\u0026\u0026(n[r]=a[r]);if(a!=null\u0026\u0026l)for(var r of l(a))t.indexOf(r)\u003c0\u0026\u0026s.call(a,r)\u0026\u0026(n[r]=a[r]);return n};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var r=n,{components:a}=r,t=i(r,[\"components\"]);return mdx(MDXLayout,e(e(e({},layoutProps),t),{components:a,mdxType:\"MDXLayout\"}),mdx(\"h1\",e({},{className:\"g-type-display-2\"}),mdx(\"a\",e({parentName:\"h1\"},{className:\"__permalink-h\",href:\"#vault-disaster-recovery-replication\",\"aria-label\":\"vault disaster recovery replication permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h1\"},{className:\"__target-h\",id:\"vault-disaster-recovery-replication\",\"aria-hidden\":\"\"})),\"Vault Disaster Recovery Replication\"),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Enterprise Only:\"),\" Disaster Recovery Replication is a part of \",mdx(\"em\",{parentName:\"p\"},\"Vault Enterprise Pro\"),\".\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`It is inevitable for organizations to have a disaster recovery (DR) strategy to\nprotect their Vault deployment against catastrophic failure of an entire\ncluster. Vault Enterprise supports multi-datacenter deployment where you can\nreplicate data across datacenters for performance as well as disaster recovery.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`A cluster is the basic unit of Vault Enterprise replication which follows the\nleader-follower model. A leader cluster is referred to as the `,mdx(\"strong\",{parentName:\"p\"},\"primary\"),`\ncluster and is considered the `,mdx(\"em\",{parentName:\"p\"},\"system of record\"),`. Data is streamed from the\nprimary cluster to all `,mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" (follower) clusters.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-ref-arch-8.png\",alt:\"Replication Pattern\"}))),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Important:\"),\" In DR replication, secondary clusters \",mdx(\"strong\",{parentName:\"p\"},mdx(\"em\",{parentName:\"strong\"},\"do not forward\")),`\nservice read or write requests until they are promoted and become a new primary`)),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"they essentially act as a warm standby cluster.\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The \",mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/operations/mount-filter\"}),\"Mount Filter\"),` guide provides step-by-step\ninstructions on setting up performance replication. This guide focuses on DR\nreplication setup.`),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#reference-materials\",\"aria-label\":\"reference materials permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"reference-materials\",\"aria-hidden\":\"\"})),\"Reference Materials\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/docs/enterprise/replication#performance-replication-and-disaster-recovery-dr-replication\"}),\"Performance Replication and Disaster Recovery (DR) Replication\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/api/system/replication/replication-dr\"}),\"DR Replication API\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/guides/operations/replication\"}),\"Replication Setup \u0026 Guidance\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/guides/operations/vault-ha-consul\"}),\"Vault HA guide\"))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#estimated-time-to-complete\",\"aria-label\":\"estimated time to complete permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"estimated-time-to-complete\",\"aria-hidden\":\"\"})),\"Estimated Time to Complete\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"10 minutes\"),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#prerequisites\",\"aria-label\":\"prerequisites permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"prerequisites\",\"aria-hidden\":\"\"})),\"Prerequisites\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`This intermediate Vault operations guide assumes that you have some working\nknowledge of Vault.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"You need two Vault Enterprise clusters: one behaves as the \",mdx(\"strong\",{parentName:\"p\"},\"primary cluster\"),`,\nand another becomes the `,mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-0.png\",alt:\"DR Prerequisites\"}))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#steps\",\"aria-label\":\"steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"steps\",\"aria-hidden\":\"\"})),\"Steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"This guide walk through the following operations:\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step1\"}),\"Enable DR Primary Replication\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step2\"}),\"Enable DR Secondary Replication\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step3\"}),\"Promote DR Secondary to Primary\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step4\"}),\"Demote DR Primary to Secondary\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step5\"}),\"Disable DR Primary\"))),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step1\",\"aria-label\":\"step 1 enable dr primary replication permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step1\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-1-enable-dr-primary-replication\",\"aria-hidden\":\"\"})),\"Step 1: Enable DR Primary Replication\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enable DR replication on the \",mdx(\"strong\",{parentName:\"p\"},\"primary\"),\" cluster.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault write -f sys/replication/dr/primary/enable\",`\n`,\"WARNING! The following warnings were returned from Vault:\",`\n`,`\n`,\"* This cluster is being enabled as a primary for replication. Vault will be\",`\n`,\"unavailable for a brief period and will resume service shortly.\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate a secondary token.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ vault write sys/replication/dr/primary/secondary-token id=\"secondary\"',`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"The output should look similar to:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"Key                              Value\",`\n`,\"---                              -----\",`\n`,\"wrapping_token:                  eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJhZGRyIjoiaHR0cDovLzEzLjU3LjIwLjQxOjgyMDAiLCJleHAiOjE1MjkzMzkzMzEsImlhdCI6MTUyOTMzNzUzMSwianRpIjoiZDZmMmMzZTItMTZjNS1mNTU0LWYxMzAtNzMzZDE0OWNiNTIzIiwidHlwZSI6IndyYXBwaW5nIn0.MIGIAkIArsC3s1x7GYnEbaYwAbYUj-Wgp4B3Q3kVXL0BbaKvsECySV4Pwtm--i24OSQfI9zAlsG8ZypOWJdngRa59wlhWdQCQgG22-I-aNWPehjsqmwwEADU-u37LUrR6O0MsUCqtfWYwIM9o7PFP1wMZ4JwDGftQXUH6hIrkXZDxnnGsSCJ1Vl75w\",`\n`,\"wrapping_accessor:               bab0ea36-23f6-d21d-4ca6-a9c3673766a3\",`\n`,\"wrapping_token_ttl:              30m\",`\n`,\"wrapping_token_creation_time:    2018-06-18 15:58:51.645117216 +0000 UTC\",`\n`,\"wrapping_token_creation_path:    sys/replication/dr/primary/secondary-token\",`\n`)),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"Copy the generated \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"wrapping_token\")),` which you will need to enable the DR\nsecondary cluster.`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enable DR replication on the \",mdx(\"strong\",{parentName:\"p\"},\"primary\"),\" cluster by invoking \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"/sys/replication/dr/primary/enable\")),\" endpoint.\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,\"       --data '{}' \\\\\",`\n`,\"       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/enable\",`\n`,\" {\",`\n`,'   \"request_id\": \"ef38af20-9c1f-138a-2d03-bbb6410fb0fc\",',`\n`,'   \"lease_id\": \"\",',`\n`,'   \"renewable\": false,',`\n`,'   \"lease_duration\": 0,',`\n`,'   \"data\": null,',`\n`,'   \"wrap_info\": null,',`\n`,'   \"warnings\": [',`\n`,'     \"This cluster is being enabled as a primary for replication. Vault will be',`\n`,'     unavailable for a brief period and will resume service shortly.\"',`\n`,\"   ],\",`\n`,'   \"auth\": null',`\n`,\" }\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate a secondary token by invoking \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"/sys/replication/dr/primary/secondary-token\")),\" endpoint.\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,`       --data '{ \"id\": \"secondary\"}' \\\\`,`\n`,\"       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/secondary-token | jq\",`\n`,\" {\",`\n`,'   \"request_id\": \"\",',`\n`,'   \"lease_id\": \"\",',`\n`,'   \"renewable\": false,',`\n`,'   \"lease_duration\": 0,',`\n`,'   \"data\": null,',`\n`,'   \"wrap_info\": {',`\n`,'     \"token\": \"eyJhbGciOiJFUzUxMiIsInR5cCI6IkpXVCJ9.eyJhZGRyIjoiaHR0cDovLzEzLjU3LjIwLjQxOjgyMDAiLCJleHAiOjE1MjkzNDQzMjcsImlhdCI6MTUyOTM0MjUyNywianRpIjoiYmRiZTJiNzEtODgwMS05YjZjLTNjMTQtMzVkNDI3NDQ3MjEzIiwidHlwZSI6IndyYXBwaW5nIn0.MIGIAkIBmESVVq_83l9hixTN7Ot0v5XQMsQfi1zV9APooZWkLvbS2olBWSQnskykQQH6GskMOi-ypOlAabqxWmfoCLA8-TICQgHRdkbJGgAQtWmjc8Z-ZEgymMv8YZq6qQxbUtPXloyM-cf_1Y1qmdGDYWtjPqoF5m1Bt_WkAJl9MguVb04QMWSotw\",',`\n`,'     \"accessor\": \"7e56e9da-178c-119d-1d01-807a203fa0b3\",',`\n`,'     \"ttl\": 1800,',`\n`,'     \"creation_time\": \"2018-06-18T17:22:07.129747708Z\",',`\n`,'     \"creation_path\": \"sys/replication/dr/primary/secondary-token\"',`\n`,\"   },\",`\n`,'   \"warnings\": null,',`\n`,'   \"auth\": null',`\n`,\" }\",`\n`)),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"Copy the generated \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"token\")),` which you will need to enable the DR\nsecondary cluster.`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Open a web browser and launch the Vault UI (e.g.\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"https://cluster-A.example.com:8200/ui\"}),\"https://cluster-A.example.com:8200/ui\"),\") and then login.\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Replication\"),\" and check the \",mdx(\"strong\",{parentName:\"p\"},\"Disaster Recovery (DR)\"),` radio button.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-1.png\",alt:\"DR Replication - primary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Enable replication\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select the \",mdx(\"strong\",{parentName:\"p\"},\"Secondaries\"),\" tab, and then click \",mdx(\"strong\",{parentName:\"p\"},\"Add\"),`.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-2.png\",alt:\"DR Replication - primary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Populate the \",mdx(\"strong\",{parentName:\"p\"},\"Secondary ID\"),\" field, and click \",mdx(\"strong\",{parentName:\"p\"},\"Generate token\"),`.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-3.png\",alt:\"DR Replication - primary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Copy\"),` to copy the token which you will need to enable the DR secondary cluster.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-4.png\",alt:\"DR Replication - primary\"}))))),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step2\",\"aria-label\":\"step 2 enable dr secondary replication permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step2\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-2-enable-dr-secondary-replication\",\"aria-hidden\":\"\"})),\"Step 2: Enable DR Secondary Replication\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The following operations must be performed on the DR secondary cluster.\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-1\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-1\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enable DR replication on the \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" cluster.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ vault write sys/replication/dr/secondary/enable token=\"...\"',`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Where the \",mdx(\"inlineCode\",{parentName:\"p\"},\"token\"),\" is the \",mdx(\"inlineCode\",{parentName:\"p\"},\"wrapping_token\"),\" obtained from the primary cluster.\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Expected output:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"WARNING! The following warnings were returned from Vault:\",`\n`,`\n`,\"* Vault has successfully found secondary information; it may take a while to\",`\n`,\"perform setup tasks. Vault will be unavailable until these tasks and initial\",`\n`,\"sync complete.\",`\n`)),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-danger g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" This will immediately clear all data in the secondary cluster.\")))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-1\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-1\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enable DR replication on the \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" cluster.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'  \"token\": \"...\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,\"       --data @payload.json \\\\\",`\n`,\"       https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/enable | jq\",`\n`,\"{\",`\n`,'   \"request_id\": \"7a9730c1-b6fc-6557-5c0a-081e1f89ed2d\",',`\n`,'   \"lease_id\": \"\",',`\n`,'   \"renewable\": false,',`\n`,'   \"lease_duration\": 0,',`\n`,'   \"data\": null,',`\n`,'   \"wrap_info\": null,',`\n`,'   \"warnings\": [',`\n`,'     \"Vault has successfully found secondary information; it may take a while',`\n`,\"     to perform setup tasks. Vault will be unavailable until these tasks and\",`\n`,'     initial sync complete.\"',`\n`,\"   ],\",`\n`,'   \"auth\": null',`\n`,\" }\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Where the \",mdx(\"inlineCode\",{parentName:\"p\"},\"token\"),\" in \",mdx(\"inlineCode\",{parentName:\"p\"},\"payload.json\"),` is the token obtained from the primary\ncluster.`),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-danger g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" This will immediately clear all data in the secondary cluster.\")))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-1\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-1\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Now, launch the Vault UI for the \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" cluster (e.g. \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cluster-B.example.com:8200/ui\"}),\"https://cluster-B.example.com:8200/ui\"),\") and click \",mdx(\"strong\",{parentName:\"p\"},\"Replication\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Check the \",mdx(\"strong\",{parentName:\"p\"},\"Disaster Recovery (DR)\"),\" radio button and select \",mdx(\"strong\",{parentName:\"p\"},\"secondary\"),\" under the \",mdx(\"strong\",{parentName:\"p\"},\"Cluster mode\"),\". Paste the token you copied from the primary in the \",mdx(\"strong\",{parentName:\"p\"},\"Secondary activation token\"),` field.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-5.png\",alt:\"DR Replication - secondary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Enable replication\"),`.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-5.2.png\",alt:\"DR Replication - secondary\"}))))),mdx(\"div\",e({},{className:\"alert alert-danger g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" This will immediately clear all data in the secondary cluster.\")),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step3\",\"aria-label\":\"step 3 promote dr secondary to primary permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step3\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-3-promote-dr-secondary-to-primary\",\"aria-hidden\":\"\"})),\"Step 3: Promote DR Secondary to Primary\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`This step walks you through the promotion of the secondary cluster to become the\nnew primary when a catastrophic failure causes the primary cluster to be\ninoperable. Refer to the `,mdx(\"a\",e({parentName:\"p\"},{href:\"#important\"}),mdx(\"em\",{parentName:\"a\"},`Important Note about Automated DR\nFailover`)),\" section for more background information.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"First, you must generate a \",mdx(\"strong\",{parentName:\"p\"},\"DR operation token\"),` which you need to promote the\nsecondary cluster. The process, outlined below using API calls, is the similar to `,mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/operations/generate-root\"}),mdx(\"em\",{parentName:\"a\"},\"Generating a Root Token (via CLI)\")),\".\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#from-terminal\",\"aria-label\":\"from terminal permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"from-terminal\",\"aria-hidden\":\"\"})),\"From Terminal\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate an one time password (OTP) to use:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault operator generate-root -dr-token -generate-otp\",`\n`,\"HenFLWmt0AgrjWJp/RECzQ==\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Start the DR operation token generation process by invoking \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"/sys/replication/dr/secondary/generate-operation-token/attempt\")),\" endpoint.\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'  \"otp\": \"HenFLWmt0AgrjWJp/RECzQ==\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,\"$ curl --request PUT \\\\\",`\n`,\"     --data @payload.json \\\\\",`\n`,\"     https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/attempt | jq\",`\n`,\" {\",`\n`,'   \"nonce\": \"455bf989-6575-1262-c0d0-a94eaf60bdd0\",',`\n`,'   \"started\": true,',`\n`,'   \"progress\": 0,',`\n`,'   \"required\": 3,',`\n`,'   \"complete\": false,',`\n`,'   \"encoded_token\": \"\",',`\n`,'   \"encoded_root_token\": \"\",',`\n`,'   \"pgp_fingerprint\": \"\"',`\n`,\" }\",`\n`)),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"Distribute the generated \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"nonce\")),\" to each unseal key holder.\"))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`In order to generate a DR operation token, a quorum of unseal keys must be\nentered by each key holder via `,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"/sys/replication/dr/secondary/generate-operation-token/update\")),\" endpoint.\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload_key1.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'  \"key\": \"\u003cprimary_unseal_key_1\u003e\",',`\n`,'  \"nonce\": \"455bf989-6575-1262-c0d0-a94eaf60bdd0\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,\"$ curl --request PUT \\\\\",`\n`,\"        --data @payload_key1.json \\\\\",`\n`,\"        https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/update | jq\",`\n`,\"  {\",`\n`,'    \"nonce\": \"455bf989-6575-1262-c0d0-a94eaf60bdd0\",',`\n`,'    \"started\": true,',`\n`,'    \"progress\": 1,',`\n`,'    \"required\": 3,',`\n`,'    \"complete\": false,',`\n`,'    \"encoded_token\": \"\",',`\n`,'    \"encoded_root_token\": \"\",',`\n`,'    \"pgp_fingerprint\": \"\"',`\n`,\"  }\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`This operation must be executed by each unseal key holder. Once the quorum\nhas been reached, the output contains the encoded DR operation token\n(`,mdx(\"inlineCode\",{parentName:\"p\"},\"encoded_token\"),\").\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ curl --request PUT \\\\\",`\n`,\"      --data @payload_key3.json \\\\\",`\n`,\"      https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/generate-operation-token/update | jq\",`\n`,\"{\",`\n`,'  \"nonce\": \"455bf989-6575-1262-c0d0-a94eaf60bdd0\",',`\n`,'  \"started\": true,',`\n`,'  \"progress\": 3,',`\n`,'  \"required\": 3,',`\n`,'  \"complete\": true,',`\n`,'  \"encoded_token\": \"dKNQqNmh3JfJcSZdGlkttQ==\",',`\n`,'  \"encoded_root_token\": \"\",',`\n`,'  \"pgp_fingerprint\": \"\"',`\n`,\"}\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Decode the generated DR operation token (\",mdx(\"inlineCode\",{parentName:\"p\"},\"encoded_token\"),\").\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault operator generate-root -dr-token \\\\\",`\n`,'        -decode=\"dKNQqNmh3JfJcSZdGlkttQ==\" \\\\',`\n`,'        -otp=\"HenFLWmt0AgrjWJp/RECzQ==\"',`\n`,`\n`,\"23e02f22-2ae6-94cc-d93f-5ee295e03e9d\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`Finally, promote the DR secondary to become the primary by invoking the\n`,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"sys/replication/dr/secondary/promote\")),` endpoint. The request payload must\ncontains the DR operation token.`),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'      \"dr_operation_token\": \"23e02f22-2ae6-94cc-d93f-5ee295e03e9d\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"          --request POST \\\\\",`\n`,\"          --data @payload.json \\\\\",`\n`,\"          https://cluster-B.example.com:8200/v1/sys/replication/dr/secondary/promote | jq\",`\n`,\"{\",`\n`,'  \"request_id\": \"3879546b-1dc7-8490-521b-80104ad761b5\",',`\n`,'  \"lease_id\": \"\",',`\n`,'  \"renewable\": false,',`\n`,'  \"lease_duration\": 0,',`\n`,'  \"data\": null,',`\n`,'  \"wrap_info\": null,',`\n`,'  \"warnings\": [',`\n`,'    \"This cluster is being promoted to a replication primary. Vault will be unavailable',`\n`,'    for a brief period and will resume service shortly.\"',`\n`,\"  ],\",`\n`,'  \"auth\": null',`\n`,\"}\",`\n`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-2\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-2\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click on \",mdx(\"strong\",{parentName:\"p\"},\"Generate OTP\"),\" to generate an OTP. Then click \",mdx(\"strong\",{parentName:\"p\"},\"Copy OTP\"),`.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-6.png\",alt:\"DR Replication - secondary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Generate Operation Token\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`A quorum of unseal keys must be entered to create a new operation token for\nthe DR secondary.`),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-7.png\",alt:\"DR Replication - secondary\"}))),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"This operation must be performed by each unseal-key holder.\"))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Once the quorum has been reached, the output displays the encoded DR operation token. Click \",mdx(\"strong\",{parentName:\"p\"},\"Copy CLI command\"),\".\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-8.png\",alt:\"DR Replication - secondary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`Execute the CLI command from a terminal to generate a DR operation token\nusing the OTP generated earlier. (Be sure to enter your OTP in the command.)`),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",{parentName:\"li\"},mdx(\"code\",e({parentName:\"pre\"},{}),\"$ vault operator generate-root -dr-token \\\\\",`\n`,'        -otp=\"vZpZZf5UI1nvB3A5/7Xq9A==\" \\\\',`\n`,'        -decode=\"cuplaFGYduDEY6ZVC5IfaA==\"',`\n`,`\n`,\"cf703c0d-afcc-55b9-2b64-d66cf427f59c\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Now, click \",mdx(\"strong\",{parentName:\"p\"},\"Promote\"),\" tab, and then enter the generated DR operation token.\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-9-1.png\",alt:\"DR Replication - secondary\"})))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Promote cluster\"),\".\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),'When you prompted, \"',mdx(\"em\",{parentName:\"p\"},\"Are you sure you want to promote this cluster?\"),'\", click ',mdx(\"strong\",{parentName:\"p\"},\"Promote cluster\"),\" again to complete.\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-9.png\",alt:\"DR Replication - secondary\"}))))),mdx(\"blockquote\",null,mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),`Once the secondary cluster was successfully promoted, you should be able to\nlog in using the original primary cluster's root token or via configured\nauthentication method. If desired, generate a `,mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/operations/generate-root\"}),`new root\ntoken`),\".\")),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step4\",\"aria-label\":\"step 4 demote dr primary to secondary permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step4\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-4-demote-dr-primary-to-secondary\",\"aria-hidden\":\"\"})),\"Step 4: Demote DR Primary to Secondary\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"If the \",mdx(\"em\",{parentName:\"p\"},\"original\"),` DR primary cluster becomes operational again, you may want to\nutilize the cluster by making it a DR secondary cluster. This step explains how\nto demote the original DR primary cluster to a secondary.`),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"Remember that there is only \",mdx(\"strong\",{parentName:\"p\"},\"one\"),` primary cluster available to the clients\nin DR replication.`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-2\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-2\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Execute the following command to demote the original DR primary cluster to a\nsecondary.`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault \",mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"write\"),\" -f sys/replication/dr/primary/demote\")),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"WARNING! The following warnings were returned from Vault:\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"  * This cluster is being demoted to a replication secondary. Vault will be\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"  unavailable for a brief period and will resume service shortly.\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`This secondary cluster will not attempt to connect to a primary (see the\nupdate-primary call), but will maintain knowledge of its cluster ID and can be\nreconnected to the same DR replication set without wiping local storage.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-2\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-2\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Invoke the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"sys/replication/dr/secondary/enable\")),` endpoint to demote the\noriginal DR primary cluster to a secondary.`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --request POST \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/demote | jq\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"request_id\": \"8a40adac-6eb7-c798-48d0-f7cdd25fdd6f\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"lease_id\": \"\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"renewable\": false,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"lease_duration\": 0,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"data\": null,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"wrap_info\": null,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"warnings\": ['),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'     \"This cluster is being demoted to a replication secondary. Vault will be unavailable for a brief period and will resume service shortly.\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"   ],\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"auth\": null'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`This secondary cluster will not attempt to connect to a primary (see the\nupdate-primary call), but will maintain knowledge of its cluster ID and can be\nreconnected to the same DR replication set without wiping local storage.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-3\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-3\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Replication\"),\" and click \",mdx(\"strong\",{parentName:\"p\"},\"Demote cluster\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-10.png\",alt:\"DR Replication - demotion\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),'When you prompted, \"',mdx(\"em\",{parentName:\"p\"},\"Are you sure you want to demote this cluster?\"),`\", click\n`,mdx(\"strong\",{parentName:\"p\"},\"Demote cluster\"),\" again to complete.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-12.png\",alt:\"DR Replication - demotion\"}))),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step5\",\"aria-label\":\"step 5 disable dr primary permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step5\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-5-disable-dr-primary\",\"aria-hidden\":\"\"})),\"Step 5: Disable DR Primary\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Once the DR secondary cluster was promoted to be the \",mdx(\"strong\",{parentName:\"p\"},\"new primary\"),`, you may\nwant to disable the DR replication on the `,mdx(\"em\",{parentName:\"p\"},\"original\"),` primary when it becomes\noperational again.`),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"Remember that there is only \",mdx(\"strong\",{parentName:\"p\"},\"one\"),` primary cluster available to the clients\nin DR replication.`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-3\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-3\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Execute the following command to disable DR replication.\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault \",mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"write\"),\" -f sys/replication/dr/primary/disable\")),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"WARNING! The following warnings were returned from Vault:\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"  * This cluster is having replication disabled. Vault will be unavailable for\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"    a brief period and will resume service shortly.\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Any secondaries will no longer be able to connect.\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-3\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-3\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Invoke the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"sys/replication/dr/primary/disable\")),` endpoint to disable DR\nreplication.`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --request POST \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       https://cluster-A.example.com:8200/v1/sys/replication/dr/primary/disable | jq\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"request_id\": \"92a5f57a-2f7b-11be-b9dd-0f028396fba8\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"lease_id\": \"\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"renewable\": false,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"lease_duration\": 0,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"data\": null,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"wrap_info\": null,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"warnings\": ['),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'     \"This cluster is having replication disabled. Vault will be unavailable for a brief period and will resume service shortly.\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"   ],\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"auth\": null'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Any secondaries will no longer be able to connect.\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-4\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-4\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Replication\"),\" and click \",mdx(\"strong\",{parentName:\"p\"},\"Disable replication\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-11.png\",alt:\"DR Replication - demotion\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),'When you prompted, \"',mdx(\"em\",{parentName:\"p\"},`Are you sure you want to disable replication on this\ncluster?`),'\", click ',mdx(\"strong\",{parentName:\"p\"},\"Disable\"),\" again to complete.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-dr-13.png\",alt:\"DR Replication - demotion\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Any secondaries will no longer be able to connect.\"),mdx(\"div\",e({},{className:\"alert alert-danger g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"Caution:\"),` Once this is done, re-enabling the DR replication as a primary\nwill change the cluster's ID. Its connecting secondaries will require a wipe of\nthe underlying storage even if they have connected before. If re-enabling DR\nreplication as a secondary, its underlying storage will be wiped when connected\nto a primary.`)),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#important\",\"aria-label\":\"important note about automated dr failover permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h __compat\",id:\"important\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"important-note-about-automated-dr-failover\",\"aria-hidden\":\"\"})),\"Important Note about Automated DR Failover\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Vault does not support an automatic failover/promotion of a DR secondary\ncluster, and this is a deliberate choice due to the difficulty in accurately\nevaluating why a failover should or shouldn't happen. For example, imagine a\nDR secondary loses its connection to the primary. Is it because the primary is\ndown, or is it because networking between the two has failed?`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`If the DR secondary promotes itself and clients start connecting to it, you now\nhave two active clusters whose data sets will immediately start diverging.\nThere's no way to understand simply from one perspective or the other which one\nof them is right.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Vault's API supports programmatically performing various replication operations\nwhich allows the customer to write their own logic about automating some of\nthese operations based on experience within their own environments. You can\nreview the available replication APIs at the following links:`),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/api/system/replication\"}),\"Vault Replication API\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/api/system/replication/replication-dr\"}),\"DR Replication API\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/api/system/replication/replication-performance\"}),\"Performance Replication API\"))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#next-steps\",\"aria-label\":\"next steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"next-steps\",\"aria-hidden\":\"\"})),\"Next steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Read \",mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/operations/production\"}),\"Production Hardening\"),` to learn more\nabout the guidance on hardening the production deployments of Vault.`))}MDXContent.isMDXComponent=!0;\n","scope":{}},"navData":[{"title":"Getting Started","path":"getting-started","filePath":"content/guides/getting-started.mdx"},{"title":"Vault Operations","routes":[{"title":"Overview","path":"operations","filePath":"content/guides/operations/index.mdx"},{"title":"Reference Architecture","path":"operations/reference-architecture","filePath":"content/guides/operations/reference-architecture.mdx"},{"title":"Vault HA with Consul","path":"operations/vault-ha-consul","filePath":"content/guides/operations/vault-ha-consul.mdx"},{"title":"Production Hardening","path":"operations/production","filePath":"content/guides/operations/production.mdx"},{"title":"Root Token Generation","path":"operations/generate-root","filePath":"content/guides/operations/generate-root.mdx"},{"title":"Rekeying \u0026 Rotating","path":"operations/rekeying-and-rotating","filePath":"content/guides/operations/rekeying-and-rotating.mdx"},{"title":"Building Plugin Backends","path":"operations/plugin-backends","filePath":"content/guides/operations/plugin-backends.mdx"},{"divider":true},{"title":"Replication Setup \u0026 Guidance","path":"operations/replication","filePath":"content/guides/operations/replication.mdx"},{"title":"Disaster Recovery Setup","path":"operations/disaster-recovery","filePath":"content/guides/operations/disaster-recovery.mdx"},{"title":"Mount Filter","path":"operations/mount-filter","filePath":"content/guides/operations/mount-filter.mdx"},{"title":"Multi-Tenant: Namespaces","path":"operations/multi-tenant","filePath":"content/guides/operations/multi-tenant.mdx"},{"title":"Vault Auto-unseal with AWS KMS","path":"operations/autounseal-aws-kms","filePath":"content/guides/operations/autounseal-aws-kms.mdx"},{"title":"Seal Wrap / FIPS 140-2","path":"operations/seal-wrap","filePath":"content/guides/operations/seal-wrap.mdx"},{"title":"Vault Cluster Monitoring","path":"operations/monitoring","filePath":"content/guides/operations/monitoring.mdx"},{"title":"Vault Deployment Guide","path":"operations/deployment-guide","filePath":"content/guides/operations/deployment-guide.mdx"},{"title":"Performance Standby Nodes","path":"operations/performance-nodes","filePath":"content/guides/operations/performance-nodes.mdx"}]},{"title":"Identity and Access Management","routes":[{"title":"Overview","path":"identity","filePath":"content/guides/identity/index.mdx"},{"title":"Secure Introduction of Vault Clients","path":"identity/secure-intro","filePath":"content/guides/identity/secure-intro.mdx"},{"title":"Policies","path":"identity/policies","filePath":"content/guides/identity/policies.mdx"},{"title":"ACL Policy Path Templating","path":"identity/policy-templating","filePath":"content/guides/identity/policy-templating.mdx"},{"title":"AppRole Pull Authentication","path":"identity/authentication","filePath":"content/guides/identity/authentication.mdx"},{"title":"AppRole with Terraform and Chef","path":"identity/approle-trusted-entities","filePath":"content/guides/identity/approle-trusted-entities.mdx"},{"title":"Tokens and Leases","path":"identity/lease","filePath":"content/guides/identity/lease.mdx"},{"title":"Identity - Entities \u0026 Groups","path":"identity/identity","filePath":"content/guides/identity/identity.mdx"},{"divider":true},{"title":"Sentinel Policies","path":"identity/sentinel","filePath":"content/guides/identity/sentinel.mdx"},{"title":"Control Groups","path":"identity/control-groups","filePath":"content/guides/identity/control-groups.mdx"}]},{"title":"Secrets Management","routes":[{"title":"Overview","path":"secret-mgmt","filePath":"content/guides/secret-mgmt/index.mdx"},{"title":"Static Secrets","path":"secret-mgmt/static-secrets","filePath":"content/guides/secret-mgmt/static-secrets.mdx"},{"title":"Versioned KV Secret Engine","path":"secret-mgmt/versioned-kv","filePath":"content/guides/secret-mgmt/versioned-kv.mdx"},{"title":"Secret as a Service","path":"secret-mgmt/dynamic-secrets","filePath":"content/guides/secret-mgmt/dynamic-secrets.mdx"},{"title":"DB Root Credential Rotation","path":"secret-mgmt/db-root-rotation","filePath":"content/guides/secret-mgmt/db-root-rotation.mdx"},{"title":"Cubbyhole Response Wrapping","path":"secret-mgmt/cubbyhole","filePath":"content/guides/secret-mgmt/cubbyhole.mdx"},{"title":"One-Time SSH Password","path":"secret-mgmt/ssh-otp","filePath":"content/guides/secret-mgmt/ssh-otp.mdx"},{"title":"Build Your Own CA","path":"secret-mgmt/pki-engine","filePath":"content/guides/secret-mgmt/pki-engine.mdx"},{"title":"Direct Application Integration","path":"secret-mgmt/app-integration","filePath":"content/guides/secret-mgmt/app-integration.mdx"}]},{"title":"Encryption as a Service","routes":[{"title":"Overview","path":"encryption","filePath":"content/guides/encryption/index.mdx"},{"title":"Encryption as a Service","path":"encryption/transit","filePath":"content/guides/encryption/transit.mdx"},{"title":"Java Application Demo","path":"encryption/spring-demo","filePath":"content/guides/encryption/spring-demo.mdx"},{"title":"Transit Secrets Re-wrapping","path":"encryption/transit-rewrap","filePath":"content/guides/encryption/transit-rewrap.mdx"}]}],"versions":[]},"__N_SSG":true},"page":"/guides/[[...page]]","query":{"page":["operations","disaster-recovery"]},"buildId":"pcCu12fyWK7PoQNj4BZ7-","assetPrefix":"/docs/vault_v1.8.x","isFallback":false,"gsp":true}</script><script nomodule="" src="/docs/vault_v1.8.x/_next/static/chunks/polyfills-e4c38ea28892f36667af.js"></script><script src="/docs/vault_v1.8.x/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/framework.3519294afa6a9ab53973.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/2bc72d9a08d5bd816ae6b580871df9fb671d43bb.52fd5ef7a8ab7d8fc0dd.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/9a5be27b89b50ff891e514a88cd42f143404f9a6.033857d62f5a01edf3b3.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/main-b0f1f3f8bd3bddd4e6cd.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/b49b08e2da573413c730dfc51ae423f080a0c275.00ac32ee45240d5b343f.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/b1542cc239bf56c8a14913c0a930efe682b5cf86.32bb900ad80311488529.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/pages/_app-d714c55ad24af91621ba.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/7dbdcaca29374b13a0799a901e26613767d72de2.d088888a4a1113f2bb24.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/92f0085e0e6c1f10382de10b8861ce89d7c192a2.e5495ede8461fc33ed98.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b.5052eda5c7f43583669b.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b_CSS.f6584926f1188e1b5b3e.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/pages/guides/%5B%5B...page%5D%5D-72f9db6e509b49c776de.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/pcCu12fyWK7PoQNj4BZ7-/_buildManifest.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/pcCu12fyWK7PoQNj4BZ7-/_ssgManifest.js" async=""></script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-custom-properties.js"><\x2fscript>');</script></body></html>