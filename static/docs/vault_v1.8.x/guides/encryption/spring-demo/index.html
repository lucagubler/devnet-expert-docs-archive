<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta property="og:image" content="https://www.vaultproject.io/img/og-image.png"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=16&amp;w=16" type="image/png" sizes="16x16" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=32&amp;w=32" type="image/png" sizes="32x32" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=96&amp;w=96" type="image/png" sizes="96x96" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=192&amp;w=192" type="image/png" sizes="192x192" rel="icon"/><title>Java Application Demo - Guides | Vault by HashiCorp</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="This guide discusses the concepts necessary to help users
understand Vault&#x27;s AppRole authentication pattern and how to use it to
securely introduce a Vault authentication token to a target server,
application, container, etc. in a Java environment."/><meta property="og:site_name" content="Vault by HashiCorp"/><meta name="next-head-count" content="17"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/css/7246d51e322c1bb7fa92.css" as="style"/><link rel="stylesheet" href="/docs/vault_v1.8.x/_next/static/css/7246d51e322c1bb7fa92.css" data-n-g=""/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/css/fbe3b6b5804634e8fb99.css" as="style"/><link rel="stylesheet" href="/docs/vault_v1.8.x/_next/static/css/fbe3b6b5804634e8fb99.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/framework.3519294afa6a9ab53973.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/2bc72d9a08d5bd816ae6b580871df9fb671d43bb.52fd5ef7a8ab7d8fc0dd.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/9a5be27b89b50ff891e514a88cd42f143404f9a6.033857d62f5a01edf3b3.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/main-b0f1f3f8bd3bddd4e6cd.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/b49b08e2da573413c730dfc51ae423f080a0c275.00ac32ee45240d5b343f.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/b1542cc239bf56c8a14913c0a930efe682b5cf86.32bb900ad80311488529.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/pages/_app-d714c55ad24af91621ba.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/7dbdcaca29374b13a0799a901e26613767d72de2.d088888a4a1113f2bb24.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/92f0085e0e6c1f10382de10b8861ce89d7c192a2.e5495ede8461fc33ed98.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b.5052eda5c7f43583669b.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b_CSS.f6584926f1188e1b5b3e.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/pages/guides/%5B%5B...page%5D%5D-72f9db6e509b49c776de.js" as="script"/></head><body><div id="__next"><div class="g-alert-banner style_vault__1OYha show themed"><a href="https://hashiconf.com/europe" class="link"><span class="g-grid-container has-large-tag"><span class="tag g-type-body-small-x-strong">Thank you</span><span class="text g-type-body-small has-large-tag">HashiConf Europe is a wrap. Watch this yearâ€™s sessions on-demand.<!-- --> <span class="link-text g-type-body-small-x-strong">Watch Now</span></span></span></a><button class="close"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 5L5 15M5 5l10 10" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div><span class="visually-hidden">Dismiss alert</span></button></div><header class="hashi-stack-menu_hashiStackMenu__2dCgY"><nav class="hashi-stack-menu_nav__3DnqS g-grid-container" aria-label="Primary HashiCorp website navigation"><a aria-label="To main HashiCorp website" href="https://www.hashicorp.com/" class="hashi-stack-menu_logoLink__2cbDW"><div data-testid="root"><svg width="317" height="88" viewBox="0 0 317 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M107.692 64.421V47.4h-14.97v17.02h-7.623V24.06h7.622v16.602h14.971V24.06h7.622v40.36h-7.622zm35.567-.001h-6.053l-.548-1.996a16.137 16.137 0 01-8.789 2.607c-5.397 0-7.699-3.697-7.699-8.79 0-5.998 2.607-8.3 8.606-8.3h7.089v-3.095c0-3.27-.907-4.421-5.633-4.421a41.255 41.255 0 00-8.179.877l-.907-5.634a38.496 38.496 0 0110.122-1.395c9.269 0 11.998 3.27 11.998 10.672l-.007 19.476zm-7.394-11.151h-5.45c-2.424 0-3.087.663-3.087 2.912 0 2.058.663 2.973 2.972 2.973a11.629 11.629 0 005.572-1.525l-.007-4.36zm21.701 11.754a34.776 34.776 0 01-10.183-1.7l1.029-5.633a33.038 33.038 0 008.788 1.273c3.271 0 3.758-.762 3.758-2.973 0-1.814-.366-2.729-5.152-3.88-7.211-1.76-8.058-3.575-8.058-9.269 0-5.938 2.607-8.545 11.03-8.545 2.98.003 5.949.348 8.85 1.03l-.762 5.876a51.98 51.98 0 00-8.118-.846c-3.209 0-3.758.763-3.758 2.546 0 2.363.183 2.546 4.185 3.575 8.263 2.188 9.055 3.278 9.055 9.307 0 5.725-1.761 9.239-10.664 9.239zm32.663-.602V43.84c0-1.578-.663-2.363-2.363-2.363-1.814 0-5.031 1.09-7.699 2.485v20.459h-7.394V22.847l7.394-1.029v15.33a26.045 26.045 0 0110.786-2.852c4.909 0 6.662 3.453 6.662 8.728v21.397h-7.386zm12.844-33.692v-8.545h7.394v8.545h-7.394zm0 33.692V34.906h7.394v29.515h-7.394zM215.62 35.15c0-7.394 4.299-11.693 14.361-11.693 3.697 0 7.38.447 10.969 1.334l-.839 6.601a59.517 59.517 0 00-9.909-1.029c-5.275 0-6.967 1.822-6.967 6.098v15.512c0 4.3 1.7 6.098 6.967 6.098a59.506 59.506 0 009.909-1.029l.846 6.609a45.672 45.672 0 01-10.968 1.334c-10.062 0-14.361-4.3-14.361-11.693l-.008-18.142zm40.499 29.873c-10.123 0-12.844-5.572-12.844-11.632v-7.455c0-6.06 2.728-11.632 12.844-11.632 10.115 0 12.844 5.572 12.844 11.632v7.455c-.023 6.06-2.744 11.632-12.844 11.632zm0-24.392c-3.941 0-5.45 1.76-5.45 5.092v7.912c0 3.331 1.524 5.092 5.45 5.092 3.925 0 5.45-1.76 5.45-5.092v-7.943c-.015-3.33-1.532-5.092-5.45-5.092v.03zm32.457.457a57.835 57.835 0 00-7.821 4.3v19.056h-7.394V34.906h6.243l.488 3.27a33.064 33.064 0 017.76-3.88l.724 6.792zm28.035 13.515c0 6.548-2.911 10.42-9.756 10.42a40.76 40.76 0 01-7.882-.853v12.196l-7.394 1.029V34.906h5.877l.762 2.485a15.535 15.535 0 019.33-3.087c5.938 0 9.086 3.514 9.086 10.245l-.023 10.054zm-17.631 3.331c2.152.474 4.346.73 6.548.763 2.668 0 3.697-1.274 3.697-3.941V44.35c0-2.424-.907-3.758-3.636-3.758a10.46 10.46 0 00-6.609 2.668v14.673zM29.134 7L0 23.808v40.361l10.946 6.32V30.127l18.188-10.504V7z" fill="#000"/><path d="M40.758 7v32.144H29.133V27.147l-10.945 6.319V74.65l10.946 6.335V48.932h11.624v11.914l10.946-6.312V13.32L40.758 7z" fill="#000"/><path d="M40.758 81L69.89 64.192V23.831l-10.946-6.32v40.362L40.758 68.377V81z" fill="#000"/></svg></div></a><ul class="hashi-stack-menu_menu__33a9r"><li class="nav-item_navItem__KPnS0"><button type="button" class="nav-item_buttonReset__WeJA7 nav-item_link__1827H g-type-body-small-strong ">Browse Products<span class="nav-item_visuallyHidden__20aYI">Open this menu</span><img class="nav-item_dropdownCarat__2xha-" alt="" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iNyIgdmlld0JveD0iMCAwIDEwIDciIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTguMDUzIDJsLTMgMy4wMDYtMy0zLjAwNiIgc3Ryb2tlPSJ2YXIoLS1ncmF5LTMpIiBzdHJva2Utd2lkdGg9IjEuMjUiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiLz48L3N2Zz4="/></button><section class="browse-panel_browsePanel__1AT8q "><menu class="stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Infrastructure</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.terraform.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M55.522 32.97l32.96 19.02v38.06l-32.96-19.03V32.97zM92.09 51.99v38.06l32.95-19.03V32.97L92.09 51.99zM18.96 11.73v38.05l32.95 19.03V30.76L18.96 11.73zm36.562 101.51l32.95 19.03V94.22l-32.95-19.03v38.05z" fill="#7B42BC"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">terraform</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.packer.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M35.09 26.38L74.22 49v83.38l-39.13-22.62V26.38z" fill="#02A8EF"/><path d="M93.6 36.13L51.06 11.62v17L80 45.34v51.05l13.61 7.82c8.421 4.86 15.311 2 15.311-6.47V60.28c-.01-8.42-6.92-19.28-15.32-24.15z" fill="#02A8EF"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">packer</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.vagrantup.com" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M110.77 17.55L86.68 31.46V40L72 74.52 57.32 40v-8.54L33.23 17.55l-14.65 8.47v9.83l32.63 79.92 20.79 12 20.79-12 32.63-79.92v-9.83l-14.65-8.47z" fill="#0E67ED"/><path d="M125.42 26.02l-24.09 13.9v8.55L81.77 92.19 72 97.83v29.94l20.79-12 32.63-79.92v-9.83zM57.32 40v-8.54l-14.66 8.46v8.55l19.57 43.72L72 86.55V74.52L57.32 40z" fill="#0850C5"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vagrant</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Networking</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.consul.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72.53 128.7a54.787 54.787 0 01-45.258-23.85 54.784 54.784 0 019.368-72.355 54.78 54.78 0 0172.95 1.125l-13 13.6a36 36 0 100 53.43l13 13.6a54.638 54.638 0 01-37.06 14.45zm44.081-27.401a4.49 4.49 0 114.49-4.49 4.5 4.5 0 01-4.49 4.49z" fill="#E03875"/><path d="M72.18 85.79A11.87 11.87 0 1184 73.93a11.88 11.88 0 01-11.82 11.86zm49.58.21a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.495 4.495 0 012.772 4.148 4.503 4.503 0 01-4.49 4.49zm-13.35-.56a4.488 4.488 0 01-4.4-5.385 4.487 4.487 0 013.555-3.515 4.49 4.49 0 11.845 8.9zm13.35-14.57a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.496 4.496 0 012.772 4.149 4.503 4.503 0 01-4.49 4.49zm-13.35.51a4.493 4.493 0 01-4.148-2.772 4.491 4.491 0 114.148 2.771zm8.461-15.61a4.49 4.49 0 11-.02-8.981 4.49 4.49 0 01.02 8.981z" fill="#E03875"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">consul</span></a></li></ul></li></menu><menu class="stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Security</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.vaultproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.88 21.15L71.8 131.4l55.321-110.25H16.881zm61.46 22.12h6.39v6.4h-6.39v-6.4zM65.61 68.84h-6.39v-6.39h6.39v6.39zm0-9.59h-6.39v-6.39h6.39v6.39zm0-9.58h-6.39v-6.4h6.39v6.4zm9.59 28.76h-6.4V72h6.4v6.43zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.58h-6.4v-6.4h6.4v6.4zm3.14 3.19h6.39v6.39h-6.39v-6.39zm0 16v-6.41h6.39v6.39l-6.39.02z" fill="#000"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vault</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.boundaryproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M44.83 125.83v-8.27h17.18v-5.11h-8.33v-8.32h39.33L74.74 72.49l18.27-31.65H52.7v43.89H31V19.15h74.67l12.46 21.58L99.8 72.49l18.7 32.4-12.09 20.94H44.83z" fill="#F24C53"/><path d="M48.17 104.131h-8.32v8.32h8.32v-8.32zM39.32 117.5H31v8.32h8.32v-8.32z" fill="#F24C53"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">boundary</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Applications</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.nomadproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72 14L21.77 43v58L72 130l50.23-29V43L72 14zm22.38 63.78L81 85.51l-16.17-8.8v18.48l-15.2 9.64V66.19l12.06-7.38 16.73 8.82V48.76l16-9.59-.04 38.61z" fill="#00CA8E"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">nomad</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.waypointproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M143.228 27.66l-17.79 30.81-17.79-30.81h35.58zM48.26 48.23H36.39l29.67 51.4-11.87 20.56L.77 27.66h59.36l29.68 51.41 5.93-10.28L72 27.66h23.74l11.88 20.57 11.87 20.56-29.68 51.4-41.55-71.96z" fill="#14C6CB"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">waypoint</span></a></li></ul></li></menu><menu class="stack-menu-section_stackMenuSectionPlusDivider__1BPy6 stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">HashiCorp Cloud Platform</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://cloud.hashicorp.com/" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72.53 128.7a54.787 54.787 0 01-45.258-23.85 54.784 54.784 0 019.368-72.355 54.78 54.78 0 0172.95 1.125l-13 13.6a36 36 0 100 53.43l13 13.6a54.638 54.638 0 01-37.06 14.45zm44.081-27.401a4.49 4.49 0 114.49-4.49 4.5 4.5 0 01-4.49 4.49z" fill="#E03875"/><path d="M72.18 85.79A11.87 11.87 0 1184 73.93a11.88 11.88 0 01-11.82 11.86zm49.58.21a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.495 4.495 0 012.772 4.148 4.503 4.503 0 01-4.49 4.49zm-13.35-.56a4.488 4.488 0 01-4.4-5.385 4.487 4.487 0 013.555-3.515 4.49 4.49 0 11.845 8.9zm13.35-14.57a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.496 4.496 0 012.772 4.149 4.503 4.503 0 01-4.49 4.49zm-13.35.51a4.493 4.493 0 01-4.148-2.772 4.491 4.491 0 114.148 2.771zm8.461-15.61a4.49 4.49 0 11-.02-8.981 4.49 4.49 0 01.02 8.981z" fill="#E03875"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">consul</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://app.terraform.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M55.522 32.97l32.96 19.02v38.06l-32.96-19.03V32.97zM92.09 51.99v38.06l32.95-19.03V32.97L92.09 51.99zM18.96 11.73v38.05l32.95 19.03V30.76L18.96 11.73zm36.562 101.51l32.95 19.03V94.22l-32.95-19.03v38.05z" fill="#7B42BC"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">terraform</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://cloud.hashicorp.com/" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.88 21.15L71.8 131.4l55.321-110.25H16.881zm61.46 22.12h6.39v6.4h-6.39v-6.4zM65.61 68.84h-6.39v-6.39h6.39v6.39zm0-9.59h-6.39v-6.39h6.39v6.39zm0-9.58h-6.39v-6.4h6.39v6.4zm9.59 28.76h-6.4V72h6.4v6.43zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.58h-6.4v-6.4h6.4v6.4zm3.14 3.19h6.39v6.39h-6.39v-6.39zm0 16v-6.41h6.39v6.39l-6.39.02z" fill="#000"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vault</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Partner Services</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a class="stack-item_itemLink__G2Qmk" href="https://www.hashicorp.com/products/consul/service-on-azure"><span class="stack-item_itemName__1cUxR g-type-body-small-strong">HashiCorp Consul Service (HCS) on Azure</span></a></li></ul></li></menu></section></li></ul></nav></header><nav class="g-subnav" aria-label="vault website navigation"><div class="constrain-width-wrapper  g-grid-container"><div class="g-subnav-inner style_vault__1OYha is-constrained" data-overflow-target="true"><a href="/" data-testid="a-raw" class="title-link brand-vault " title="vault"><div data-testid="root"><svg width="208" height="88" viewBox="0 0 208 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M114.849 23.69h7.92L110.699 64h-11.25l-12-40.28h7.92l9.74 33.57 9.74-33.6zM144.75 64h-6l-.55-2a16.12 16.12 0 01-8.77 2.6c-5.38 0-7.68-3.69-7.68-8.77 0-6 2.6-8.29 8.59-8.29h7.08v-3.1c0-3.27-.91-4.42-5.63-4.42a40.71 40.71 0 00-8.16.91l-.91-5.63a38.678 38.678 0 0110.1-1.39c9.25 0 12 3.27 12 10.65L144.75 64zm-7.37-11.13h-5.45c-2.42 0-3.08.67-3.08 2.91 0 2 .66 3 3 3a11.72 11.72 0 005.57-1.51l-.04-4.4zm18.992-18.35v20.56c0 1.57.66 2.36 2.36 2.36 1.7 0 5-1.09 7.68-2.48V34.52h7.38V64h-5.63l-.72-2.48a29.437 29.437 0 01-11.8 3.09c-4.9 0-6.65-3.45-6.65-8.71V34.52h7.38zM177.719 64V22.48l7.38-1V64h-7.38zm29.388-.57a20.618 20.618 0 01-6.47 1.15c-5.38 0-8.11-2.54-8.11-7.8v-16.4h-4.41v-5.86h4.41V27.2l7.38-1v8.35h7.56l-.48 5.86h-7.08v15.4a2.323 2.323 0 001.596 2.514c.344.11.708.14 1.064.085a13.919 13.919 0 003.69-.61l.85 5.63zM0 12.6l31.85 63.92L63.92 12.6H0zm35.63 12.83h3.71v3.71h-3.71v-3.71zm-7.38 14.82h-3.7v-3.7h3.7v3.7zm0-5.56h-3.7V31h3.7v3.69zm0-5.55h-3.7v-3.71h3.7v3.71zm5.6 16.67h-3.7V42.1h3.7v3.71zm0-5.56h-3.7v-3.7h3.7v3.7zm0-5.56h-3.7V31h3.7v3.69zm0-5.55h-3.7v-3.71h3.7v3.71zM35.63 31h3.71v3.7h-3.71V31zm0 9.26v-3.7h3.71v3.7h-3.71z" fill="#000"/></svg></div></a><ul class="menu-items-default menu-items-align-right"><li><a href="/" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Overview</span></a></li><li><button class="dropdown-trigger g-type-body-small-strong brand-vault style-menu-item is-collapsed"><span class="text brand-vault">Use Cases</span><div data-testid="root"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 9l6 6 6-6" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></button><ul class="submenu-modal style-dropdown is-collapsed"><li><a href="/use-cases/secrets-management" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Secrets Management</span></a></li><li><a href="/use-cases/data-encryption" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Data Encryption</span></a></li><li><a href="/use-cases/identity-based-access" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Identity-based Access</span></a></li></ul></li><li><a href="https://www.hashicorp.com/products/vault/enterprise" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Enterprise</span></a></li><li><span class="vertical-divider"></span></li><li><a href="https://learn.hashicorp.com/vault" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Tutorials</span></a></li><li><a href="/docs" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Docs</span></a></li><li><a href="/api-docs" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">API</span></a></li><li><a href="/community" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Community</span></a></li></ul><div class="cta-links "><a href="https://www.github.com/hashicorp/vault" class="github-button"><span class="github"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg><span class="hidden-text">GitHub</span></span></a><a class="g-btn size-small variant-secondary style_vault__1OYha background-light" data-ga-button="try-cloud" href="https://portal.cloud.hashicorp.com/sign-up?utm_source=vault_io&amp;utm_content=top_nav_vault"><span class="text g-type-buttons-and-standalone-links">Try Cloud</span></a><a class="g-btn size-small variant-primary style_vault__1OYha background-light" data-ga-button="download" href="/downloads"><span class="icon at-left is-animated" data-animation="download"><div data-testid="root"><svg role="img" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Download icon</title><path d="M3 17v3a2 2 0 002 2h14a2 2 0 002-2v-3" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path data-animation-target="true" d="M8 12l4 4m0 0l4-4m-4 4V2" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></span><span class="text g-type-buttons-and-standalone-links">Download</span></a></div></div></div></nav><div id="p-docs"><div class="content-wrap g-grid-container"><div id="sidebar" role="complementary"><div class="nav docs-nav"><div class="g-docs-sidenav style_root__-H22M style_vault__1OYha"><button class="style_mobileMenuToggle__2iMJX g-type-body-small-strong"><span><div><svg width="20" height="20" fill="none"><path fill="#000" fill-rule="evenodd" d="M3.083 14.411a.847.847 0 00-.267-.183.863.863 0 00-.483-.042c-.05.008-.109.025-.159.042a1.245 1.245 0 00-.266.183 1.01 1.01 0 00-.184.267.864.864 0 00-.058.325c0 .05 0 .108.017.158a.88.88 0 00.041.159c.025.05.05.1.084.141.025.05.066.092.1.125.041.042.082.075.125.108.05.025.091.059.141.075.05.017.109.034.159.05.058.009.107.017.166.017a.829.829 0 00.584-.25.534.534 0 00.108-.125c.025-.042.058-.091.075-.142.025-.05.042-.1.05-.158a1.06 1.06 0 00.017-.158.872.872 0 00-.067-.325.729.729 0 00-.183-.267zm0-5a.846.846 0 00-.267-.183.863.863 0 00-.483-.042 1.11 1.11 0 00-.159.042 1.252 1.252 0 00-.266.183.821.821 0 00-.242.592c0 .108.017.216.058.316a1.01 1.01 0 00.309.375c.05.025.091.05.141.075.05.017.109.034.159.05.058.009.107.017.166.017a.829.829 0 00.584-.25.83.83 0 00.25-.583.871.871 0 00-.067-.325.729.729 0 00-.183-.267zm0-5a.795.795 0 00-.75-.225 1.11 1.11 0 00-.159.042 1.255 1.255 0 00-.266.183.835.835 0 00-.242.592c0 .108.017.217.058.317a1.01 1.01 0 00.309.375c.05.025.091.05.141.075.05.016.109.033.159.05.058.008.107.016.166.016a.83.83 0 00.584-.25.83.83 0 00.25-.583.906.906 0 00-.067-.325.729.729 0 00-.183-.267zm14.414 9.756H6.663a.833.833 0 100 1.667h10.834a.833.833 0 100-1.667zm0-5H6.663a.833.833 0 100 1.667h10.834a.833.833 0 100-1.667zM18.33 5c0 .46-.372.834-.833.834H6.663a.833.833 0 110-1.667h10.834c.46 0 .833.372.833.833z" clip-rule="evenodd"/></svg></div> Documentation Menu</span></button><button type="button" aria-label="Show Search Bar" class="style_searchToggle__226HK"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M8.75 15a6.25 6.25 0 100-12.5 6.25 6.25 0 000 12.5z" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.5 17.5l-4.333-4.333" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></button><ul class="style_rootList__1pfEP" data-is-mobile-hidden="true" data-is-mobile-open="false"><button class="style_mobileClose__3BcsD">Ã—</button><input class="style_filterInput__4ecGq" placeholder="Filter..." value=""/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/getting-started/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Getting Started</span></a></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Vault Operations</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/reference-architecture/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Reference Architecture</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/vault-ha-consul/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault HA with Consul</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/production/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Production Hardening</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/generate-root/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Root Token Generation</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/rekeying-and-rotating/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Rekeying & Rotating</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/plugin-backends/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Building Plugin Backends</span></a></li><hr class="style_divider__3H9xA"/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/replication/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Replication Setup & Guidance</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/disaster-recovery/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Disaster Recovery Setup</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/mount-filter/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Mount Filter</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/multi-tenant/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Multi-Tenant: Namespaces</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/autounseal-aws-kms/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Auto-unseal with AWS KMS</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/seal-wrap/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Seal Wrap / FIPS 140-2</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/monitoring/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Cluster Monitoring</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/deployment-guide/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Deployment Guide</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/performance-nodes/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Performance Standby Nodes</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Identity and Access Management</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/secure-intro/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Secure Introduction of Vault Clients</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/policies/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Policies</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/policy-templating/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>ACL Policy Path Templating</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/authentication/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>AppRole Pull Authentication</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/approle-trusted-entities/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>AppRole with Terraform and Chef</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/lease/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Tokens and Leases</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/identity/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Identity - Entities & Groups</span></a></li><hr class="style_divider__3H9xA"/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/sentinel/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Sentinel Policies</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/control-groups/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Control Groups</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Secrets Management</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/static-secrets/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Static Secrets</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/versioned-kv/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Versioned KV Secret Engine</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/dynamic-secrets/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Secret as a Service</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/db-root-rotation/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>DB Root Credential Rotation</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/cubbyhole/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Cubbyhole Response Wrapping</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/ssh-otp/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>One-Time SSH Password</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/pki-engine/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Build Your Own CA</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/app-integration/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Direct Application Integration</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Encryption as a Service</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/transit/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Encryption as a Service</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/spring-demo/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Java Application Demo</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/transit-rewrap/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Transit Secrets Re-wrapping</span></a></li></ul></li></ul></div></div></div><div id="inner" role="main" class=""><article class="g-content g-type-long-body style_vault__1OYha"><div class="g-search"><label id="search-box-label" for="search-box" class="visually-hidden">Search Vault documentation</label><div class="c-search-box"><form novalidate="" action="" role="search"><input type="search" id="search-box" class="g-type-body-strong" placeholder="Search Vault documentation" autoComplete="off" autoCorrect="off" autoCapitalize="off" spellcheck="false" maxLength="512" required="" value="" aria-autocomplete="list" aria-controls="search-results" aria-activedescendant="" data-heap-track="SearchBox"/><button type="submit" title="Submit your search query." class="btn-submit"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M8.75 15a6.25 6.25 0 100-12.5 6.25 6.25 0 000 12.5z" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.5 17.5l-4.333-4.333" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button><button type="reset" title="Clear the search query." class="btn-reset"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.915 1.077h13.684v13.684H1.915z"/><path d="M1.915 1.077l13.683 13.684M1.915 14.76L15.598 1.078" stroke="var(--gray-3)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button><div class="icon-loading"><svg width="18" height="18" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#444"><g fill="none" fill-rule="evenodd"><g transform="translate(1 1)" stroke-width="2"><circle stroke-opacity=".5" cx="18" cy="18" r="18"></circle><path d="M36 18c0-9.94-8.06-18-18-18" transform="rotate(296.263 18 18)"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="1s" repeatCount="indefinite"></animateTransform></path></g></g></svg></div><svg class="icon-slash" width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img"><title>Type &#x27;/&#x27; to Search</title><rect x=".5" y=".5" width="23" height="23" rx=".5" stroke="var(--gray-3)"></rect><path d="M9 18l6-12" stroke="var(--gray-3)" stroke-width="1.5"></path></svg></form></div></div><h1 class="g-type-display-2"><a class="__permalink-h" href="#java-sample-app-using-spring-cloud-vault" aria-label="java sample app using spring cloud vault permalink">Â»</a><a class="__target-h" id="java-sample-app-using-spring-cloud-vault" aria-hidden=""></a>Java Sample App using Spring Cloud Vault</h1><p class="g-type-long-body">Once you have learned the fundamentals of Vault, the next step is to start
integrating your system with Vault to secure your organization&#x27;s secrets.</p><p class="g-type-long-body">The purpose of this guide is to go through the working implementation demo
introduced in the <a href="https://www.hashicorp.com/resources/solutions-engineering-webinar-series-episode-2-vault">Manage secrets, access, and encryption in the public cloud
with
Vault</a>
webinar.</p><p class="g-type-long-body"><a href="https://youtu.be/NxL2-XuZ3kc"><img src="/img/vault-java-demo-1.png" alt="YouTube"/></a></p><p class="g-type-long-body">The Java application in this demo leverages the <a href="https://cloud.spring.io/spring-cloud-vault/"><em>Spring Cloud
Vault</em></a> library which provides
lightweight client-side support for connecting to Vault in a distributed
environment.</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#reference-material" aria-label="reference material permalink">Â»</a><a class="__target-h" id="reference-material" aria-hidden=""></a>Reference Material</h2><ul><li class="g-type-long-body"><a href="/guides/encryption/transit">Encryption as a Service</a></li><li class="g-type-long-body"><a href="https://www.hashicorp.com/resources/solutions-engineering-webinar-series-episode-2-vault">Manage secrets, access, and encryption in
the public cloud with
Vault</a></li><li class="g-type-long-body"><a href="https://cloud.spring.io/spring-cloud-vault/">Spring Cloud Vault</a></li><li class="g-type-long-body"><a href="/docs/secrets/transit">Transit Secrets Engine</a></li><li class="g-type-long-body"><a href="/guides/secret-mgmt/dynamic-secrets">Secrets as a Service: Dynamic Secrets</a></li></ul><h2 class="g-type-display-3"><a class="__permalink-h" href="#estimated-time-to-complete" aria-label="estimated time to complete permalink">Â»</a><a class="__target-h" id="estimated-time-to-complete" aria-hidden=""></a>Estimated Time to Complete</h2><p class="g-type-long-body">15 minutes</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#challenge" aria-label="challenge permalink">Â»</a><a class="__target-h" id="challenge" aria-hidden=""></a>Challenge</h2><p class="g-type-long-body">Incidents of data breaches which expose sensitive information make headlines more
often than we like to hear. It becomes more and more important to protect data
by encrypting it whether the data is in-transit or at-rest. However, creating
a highly secure and sophisticated solution by yourself requires time and resources
which are in demand when an organization is facing a constant threat.</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#solution" aria-label="solution permalink">Â»</a><a class="__target-h" id="solution" aria-hidden=""></a>Solution</h2><p class="g-type-long-body">Vault centralizes management of cryptographic services used to protect your
data. Your system can communicate with Vault easily through the Vault API to
encrypt and decrypt your data, and the encryption keys never have to leave the
Vault.</p><p class="g-type-long-body"><img src="/img/vault-eaas.png" alt="Encryption as a Service"/></p><h2 class="g-type-display-3"><a class="__permalink-h" href="#prerequisites" aria-label="prerequisites permalink">Â»</a><a class="__target-h" id="prerequisites" aria-hidden=""></a>Prerequisites</h2><p class="g-type-long-body">To perform the tasks described in this guide:</p><ul><li class="g-type-long-body">Install <a href="https://www.vagrantup.com/intro/getting-started/install">HashiCorp Vagrant</a></li><li class="g-type-long-body">Clone or download the demo assets from the <a href="https://github.com/hashicorp/vault-guides/tree/master/secrets/spring-cloud-vault">hashicorp/vault-guides</a>
GitHub repository</li></ul><h2 class="g-type-display-3"><a class="__permalink-h" href="#steps" aria-label="steps permalink">Â»</a><a class="__target-h" id="steps" aria-hidden=""></a>Steps</h2><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body">For the purposes of this guide, you are going to provision a Linux machine
locally using Vagrant. However, the GitHub repository provides supporting files
to provision the environment demonstrated in the webinar.</p></div><p class="g-type-long-body">After downloading the <a href="#prerequisites">demo assets</a> from the GitHub repository,
you should find the following folders:</p><table><thead><tr><th>Folder</th><th>Description</th></tr></thead><tbody><tr><td><code>aws</code></td><td>Supporting files to deploy the demo app to AWS</td></tr><tr><td><code>kubernetes</code></td><td>Supporting files to deploy the demo app to Kubernetes</td></tr><tr><td><code>nomad</code></td><td>Supporting files to deploy the demo app to Nomad</td></tr><tr><td><code>scripts</code></td><td>Scripts to setup PostgreSQL and Vault</td></tr><tr><td><code>src/main</code></td><td>Sample app source code</td></tr><tr><td><code>vagrant-local</code></td><td>Vagrant file to deploy the demo locally</td></tr></tbody></table><p class="g-type-long-body">In this guide, you will perform the following:</p><ol><li class="g-type-long-body"><a href="#step1">Review the demo application implementation</a></li><li class="g-type-long-body"><a href="#step2">Deploy and review the demo environment</a></li><li class="g-type-long-body"><a href="#step3">Run the demo application</a></li><li class="g-type-long-body"><a href="#step4">Reload the Static Secrets</a></li></ol><p class="g-type-long-body"><img src="/img/vault-java-demo-10.png" alt="Encryption as a Service"/></p><h3 class="g-type-display-4"><a class="__permalink-h" href="#step1" aria-label="step 1 review the demo application implementation permalink">Â»</a><a class="__target-h __compat" id="step1" aria-hidden=""></a><a class="__target-h" id="step-1-review-the-demo-application-implementation" aria-hidden=""></a>Step 1: Review the demo application implementation</h3><p class="g-type-long-body">The source code can be found under the <code>src/main</code> directory.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">â”œâ”€â”€ java<!-- -->
<!-- -->â”‚Â Â  â””â”€â”€ com<!-- -->
<!-- -->â”‚Â Â      â””â”€â”€ hashicorp<!-- -->
<!-- -->â”‚Â Â          â””â”€â”€ vault<!-- -->
<!-- -->â”‚Â Â              â””â”€â”€ spring<!-- -->
<!-- -->â”‚Â Â                  â””â”€â”€ demo<!-- -->
<!-- -->â”‚Â Â                      â”œâ”€â”€ BeanUtil.java<!-- -->
<!-- -->â”‚Â Â                      â”œâ”€â”€ Order.java<!-- -->
<!-- -->â”‚Â Â                      â”œâ”€â”€ OrderAPIController.java<!-- -->
<!-- -->â”‚Â Â                      â”œâ”€â”€ OrderRepository.java<!-- -->
<!-- -->â”‚Â Â                      â”œâ”€â”€ Secret.java<!-- -->
<!-- -->â”‚Â Â                      â”œâ”€â”€ SecretController.java<!-- -->
<!-- -->â”‚Â Â                      â”œâ”€â”€ TransitConverter.java<!-- -->
<!-- -->â”‚Â Â                      â””â”€â”€ VaultDemoOrderServiceApplication.java<!-- -->
<!-- -->â””â”€â”€ resources<!-- -->
<!-- -->    â””â”€â”€ application.yaml<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”œâ”€â”€ java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â  â””â”€â”€ com</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â      â””â”€â”€ hashicorp</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â          â””â”€â”€ vault</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â              â””â”€â”€ spring</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                  â””â”€â”€ demo</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                      â”œâ”€â”€ BeanUtil.java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                      â”œâ”€â”€ Order.java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                      â”œâ”€â”€ OrderAPIController.java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                      â”œâ”€â”€ OrderRepository.java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                      â”œâ”€â”€ Secret.java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                      â”œâ”€â”€ SecretController.java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                      â”œâ”€â”€ TransitConverter.java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â”‚Â Â                      â””â”€â”€ VaultDemoOrderServiceApplication.java</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">â””â”€â”€ resources</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    â””â”€â”€ application.yaml</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The demo Java application leverages the Spring Cloud Vault library to
communicate with Vault.</p><p class="g-type-long-body">In the <code>TransitConverter</code> class, the <code>convertToDatabaseColumn</code> method invokes a
Vault operation to encrypt the <code>order</code>. Similarly, the
<code>convertToEntityAttribute</code> method decrypts the <code>order</code> data.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">...<!-- -->
<!-- -->    @Override<!-- -->
<!-- -->    public String convertToDatabaseColumn(String customer) {<!-- -->
<!-- -->        VaultOperations vaultOps = BeanUtil.getBean(VaultOperations.class);<!-- -->
<!-- -->        Plaintext plaintext = Plaintext.of(customer);<!-- -->
<!-- -->        String cipherText = vaultOps.opsForTransit().encrypt(&quot;order&quot;, plaintext).getCiphertext();<!-- -->
<!-- -->        return cipherText;<!-- -->
<!-- -->    }<!-- -->
<!-- -->
<!-- -->    @Override<!-- -->
<!-- -->    public String convertToEntityAttribute(String customer) {<!-- -->
<!-- -->        VaultOperations vaultOps = BeanUtil.getBean(VaultOperations.class);<!-- -->
<!-- -->        Ciphertext ciphertext = Ciphertext.of(customer);<!-- -->
<!-- -->        String plaintext = vaultOps.opsForTransit().decrypt(&quot;order&quot;, ciphertext).asString();<!-- -->
<!-- -->        return plaintext;<!-- -->
<!-- -->...<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    @Override</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    public String convertToDatabaseColumn(String customer) {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        VaultOperations vaultOps = BeanUtil.getBean(VaultOperations.class);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        Plaintext plaintext = Plaintext.of(customer);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        String cipherText = vaultOps.opsForTransit().encrypt(&quot;order&quot;, plaintext).getCiphertext();</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        return cipherText;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    }</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    @Override</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    public String convertToEntityAttribute(String customer) {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        VaultOperations vaultOps = BeanUtil.getBean(VaultOperations.class);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        Ciphertext ciphertext = Ciphertext.of(customer);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        String plaintext = vaultOps.opsForTransit().decrypt(&quot;order&quot;, ciphertext).asString();</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        return plaintext;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The <code>VaultDemoOrderServiceApplication</code> class defines the <code>main</code> method.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">public class VaultDemoOrderServiceApplication  {<!-- -->
<!-- -->
<!-- -->    private static final Logger logger = LoggerFactory.getLogger(VaultDemoOrderServiceApplication.class);<!-- -->
<!-- -->
<!-- -->    @Autowired<!-- -->
<!-- -->        private SessionManager sessionManager;<!-- -->
<!-- -->
<!-- -->    @Value(&quot;${spring.datasource.username}&quot;)<!-- -->
<!-- -->    private String dbUser;<!-- -->
<!-- -->
<!-- -->    @Value(&quot;${spring.datasource.password}&quot;)<!-- -->
<!-- -->    private String dbPass;<!-- -->
<!-- -->
<!-- -->    public static void main(String[] args) {<!-- -->
<!-- -->        SpringApplication.run(VaultDemoOrderServiceApplication.class, args);<!-- -->
<!-- -->    }<!-- -->
<!-- -->
<!-- -->    @PostConstruct<!-- -->
<!-- -->    public void initIt() throws Exception {<!-- -->
<!-- -->        logger.info(&quot;Got Vault Token: &quot; + sessionManager.getSessionToken().getToken());<!-- -->
<!-- -->        logger.info(&quot;Got DB User: &quot; + dbUser);<!-- -->
<!-- -->    }<!-- -->
<!-- -->}<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">public class VaultDemoOrderServiceApplication  {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    private static final Logger logger = LoggerFactory.getLogger(VaultDemoOrderServiceApplication.class);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    @Autowired</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        private SessionManager sessionManager;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    @Value(&quot;${spring.datasource.username}&quot;)</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    private String dbUser;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    @Value(&quot;${spring.datasource.password}&quot;)</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    private String dbPass;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    public static void main(String[] args) {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        SpringApplication.run(VaultDemoOrderServiceApplication.class, args);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    }</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    @PostConstruct</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    public void initIt() throws Exception {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        logger.info(&quot;Got Vault Token: &quot; + sessionManager.getSessionToken().getToken());</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        logger.info(&quot;Got DB User: &quot; + dbUser);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    }</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The <code>OrderAPIController</code> class defines the API endpoint (<code>api/orders</code>).</p><h3 class="g-type-display-4"><a class="__permalink-h" href="#step2" aria-label="step 2 deploy and review the demo environment permalink">Â»</a><a class="__target-h __compat" id="step2" aria-hidden=""></a><a class="__target-h" id="step-2-deploy-and-review-the-demo-environment" aria-hidden=""></a>Step 2: Deploy and review the demo environment</h3><p class="g-type-long-body">Now let&#x27;s run the demo app and examine how it behaves.</p><div class="alert alert-warning g-type-body" role="alert"><p class="g-type-long-body">To keep it simple and lightweight, you are going to run a Linux virtual
machine locally using Vagrant.</p></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#task-1-run-vagrant" aria-label="task 1 run vagrant permalink">Â»</a><a class="__target-h" id="task-1-run-vagrant" aria-hidden=""></a>Task 1: Run Vagrant</h4><p class="g-type-long-body">In the <strong><code>vault-guides/secrets/spring-cloud-vault/vagrant-local</code></strong> folder,
a <code>Vagrantfile</code> is provided which spins up a Linux machine where the demo
components are installed and configured.</p><div class="g-code-block style_root__3eDLf language-shell style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token comment"># Change the working directory to vagrant-local</span>
<!-- -->$ <span class="token builtin class-name">cd</span> /vault-guides/secrets/spring-cloud-vault/vagrant-local<!-- -->
<!-- -->
<span class="token comment"># Create and configure a Linux machine. This takes about 3 minutes</span>
<!-- -->$ vagrant up<!-- -->
<span class="token punctuation">..</span>.<!-- -->
<!-- -->demo: Success<span class="token operator">!</span> Data written to: database/roles/order<!-- -->
<!-- -->demo: Success<span class="token operator">!</span> Enabled the transit secrets engine at: transit/<!-- -->
<!-- -->demo: Success<span class="token operator">!</span> Data written to: transit/keys/order<!-- -->
<!-- -->demo: Success<span class="token operator">!</span> Data written to: secret/spring-vault-demo<!-- -->
<!-- -->
<span class="token comment"># Verify that the virtual machine was successfully created and running</span>
<!-- -->$ vagrant status<!-- -->
<!-- -->Current machine states:<!-- -->
<!-- -->demo                      running <span class="token punctuation">(</span>virtualbox<span class="token punctuation">)</span>
<span class="token punctuation">..</span>.<!-- -->
<!-- -->
<span class="token comment"># Connect to the demo machine</span>
<!-- -->$ vagrant <span class="token function">ssh</span> demo<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell"><code class="style_code__2AMYw language-shell"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Change the working directory to vagrant-local</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ <span class="token builtin class-name">cd</span> /vault-guides/secrets/spring-cloud-vault/vagrant-local</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Create and configure a Linux machine. This takes about 3 minutes</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vagrant up</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">..</span>.</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">demo: Success<span class="token operator">!</span> Data written to: database/roles/order</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">demo: Success<span class="token operator">!</span> Enabled the transit secrets engine at: transit/</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">demo: Success<span class="token operator">!</span> Data written to: transit/keys/order</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">demo: Success<span class="token operator">!</span> Data written to: secret/spring-vault-demo</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Verify that the virtual machine was successfully created and running</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vagrant status</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">Current machine states:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">demo                      running <span class="token punctuation">(</span>virtualbox<span class="token punctuation">)</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">..</span>.</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Connect to the demo machine</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vagrant <span class="token function">ssh</span> demo</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">There are 3 Docker containers running on the machine: <code>spring</code>, <code>vault</code>, and <code>postgres</code>.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">[vagrant@demo ~]$ docker ps<!-- -->
<!-- -->CONTAINER ID     IMAGE            COMMAND                  CREATED           STATUS           NAMES<!-- -->
<!-- -->684d8fb23ae5     spring           &quot;java -Djava.secur...&quot;   7 minutes ago     Up 7 minutes     spring<!-- -->
<!-- -->dc6a3454b323     vault:0.10.0     &quot;docker-entrypoint...&quot;   7 minutes ago     Up 7 minutes     vault<!-- -->
<!-- -->4093a45c209f     postgres         &quot;docker-entrypoint...&quot;   7 minutes ago     Up 7 minutes     postgres<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">[vagrant@demo ~]$ docker ps</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">CONTAINER ID     IMAGE            COMMAND                  CREATED           STATUS           NAMES</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">684d8fb23ae5     spring           &quot;java -Djava.secur...&quot;   7 minutes ago     Up 7 minutes     spring</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">dc6a3454b323     vault:0.10.0     &quot;docker-entrypoint...&quot;   7 minutes ago     Up 7 minutes     vault</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">4093a45c209f     postgres         &quot;docker-entrypoint...&quot;   7 minutes ago     Up 7 minutes     postgres</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#task-2-examine-the-vault-environment" aria-label="task 2 examine the vault environment permalink">Â»</a><a class="__target-h" id="task-2-examine-the-vault-environment" aria-hidden=""></a>Task 2: Examine the Vault environment</h4><p class="g-type-long-body">During the demo machine provisioning, the <code>/scripts/vault.sh</code> script was
executed to perform the following:</p><ul><li class="g-type-long-body">Created a policy named, <strong><code>order</code></strong></li><li class="g-type-long-body">Enabled the <code>transit</code> secret engine and created an encryption key named, <strong><code>order</code></strong></li><li class="g-type-long-body">Enabled the <code>database</code> secret engine and created a role named, <strong><code>order</code></strong></li></ul><p class="g-type-long-body">View the <code>vault</code> log:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">[vagrant@demo ~]$  docker logs vault<!-- -->
<!-- -->...<!-- -->
<!-- -->==&gt; Vault shutdown triggered<!-- -->
<!-- -->==&gt; Vault server configuration:<!-- -->
<!-- -->             Api Address: http://0.0.0.0:8200<!-- -->
<!-- -->                     Cgo: disabled<!-- -->
<!-- -->         Cluster Address: https://0.0.0.0:8201<!-- -->
<!-- -->              Listener 1: tcp (addr: &quot;0.0.0.0:8200&quot;, cluster address: &quot;0.0.0.0:8201&quot;, tls: &quot;disabled&quot;)<!-- -->
<!-- -->               Log Level: info<!-- -->
<!-- -->                   Mlock: supported: true, enabled: false<!-- -->
<!-- -->                 Storage: inmem<!-- -->
<!-- -->                 Version: Vault v0.10.0<!-- -->
<!-- -->             Version Sha: 5dd7f25f5c4b541f2da62d70075b6f82771a650d<!-- -->
<!-- -->WARNING! dev mode is enabled! In this mode, Vault runs entirely in-memory<!-- -->
<!-- -->and starts unsealed with a single unseal key. The root token is already<!-- -->
<!-- -->authenticated to the CLI, so you can immediately begin using Vault.<!-- -->
<!-- -->You may need to set the following environment variable:<!-- -->
<!-- -->    $ export VAULT_ADDR=&#x27;http://0.0.0.0:8200&#x27;<!-- -->
<!-- -->The unseal key and root token are displayed below in case you want to<!-- -->
<!-- -->seal/unseal the Vault or re-authenticate.<!-- -->
<!-- -->Unseal Key: 2QIPWPDykRG/xWWl0quSHiXq8u+pFg3yEq0sgJPhMbA=<!-- -->
<!-- -->Root Token: root<!-- -->
<!-- -->...<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">[vagrant@demo ~]$  docker logs vault</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">==&gt; Vault shutdown triggered</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">==&gt; Vault server configuration:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">             Api Address: http://0.0.0.0:8200</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                     Cgo: disabled</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">         Cluster Address: https://0.0.0.0:8201</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">              Listener 1: tcp (addr: &quot;0.0.0.0:8200&quot;, cluster address: &quot;0.0.0.0:8201&quot;, tls: &quot;disabled&quot;)</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">               Log Level: info</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                   Mlock: supported: true, enabled: false</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                 Storage: inmem</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                 Version: Vault v0.10.0</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">             Version Sha: 5dd7f25f5c4b541f2da62d70075b6f82771a650d</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">WARNING! dev mode is enabled! In this mode, Vault runs entirely in-memory</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">and starts unsealed with a single unseal key. The root token is already</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">authenticated to the CLI, so you can immediately begin using Vault.</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">You may need to set the following environment variable:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    $ export VAULT_ADDR=&#x27;http://0.0.0.0:8200&#x27;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">The unseal key and root token are displayed below in case you want to</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">seal/unseal the Vault or re-authenticate.</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">Unseal Key: 2QIPWPDykRG/xWWl0quSHiXq8u+pFg3yEq0sgJPhMbA=</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">Root Token: root</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Notice that the log indicates that the Vault server is running in the <code>dev</code>
mode, and the root token is <code>root</code>.</p><p class="g-type-long-body">You can visit the Vault UI at http://localhost:8200/ui. Enter <strong><code>root</code></strong> and
click <strong>Sign In</strong>.</p><p class="g-type-long-body">Select the <strong><code>transit/</code></strong> secrets engine, and you should find an encryption key
named, &quot;<code>order</code>&quot;.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-2.png" alt="Vault UI"/></p><p class="g-type-long-body">Under the <strong>Policies</strong>, verify that the <code>order</code> policy exists.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-3.png" alt="Vault UI"/></p><p class="g-type-long-body">This <code>order</code> policy is for the application. It permits <code>read</code> on the
<code>database/creds/order</code> path so that the demo app can get a dynamically generated
database credential from Vault. Therefore, the PostgreSQL credentials are not
hard-coded anywhere.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">path &quot;database/creds/order&quot;<!-- -->
<!-- -->{<!-- -->
<!-- -->  capabilities = [&quot;read&quot;]<!-- -->
<!-- -->}<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">path &quot;database/creds/order&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  capabilities = [&quot;read&quot;]</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">An <code>update</code> permission allows the app to request data encryption and decryption
using the <code>order</code> encryption key in Vault.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">...<!-- -->
<!-- -->path &quot;transit/decrypt/order&quot; {<!-- -->
<!-- -->  capabilities = [&quot;update&quot;]<!-- -->
<!-- -->}<!-- -->
<!-- -->
<!-- -->path &quot;transit/encrypt/order&quot; {<!-- -->
<!-- -->  capabilities = [&quot;update&quot;]<!-- -->
<!-- -->}<!-- -->
<!-- -->...<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">path &quot;transit/decrypt/order&quot; {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  capabilities = [&quot;update&quot;]</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">path &quot;transit/encrypt/order&quot; {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  capabilities = [&quot;update&quot;]</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#task-3-examine-the-spring-container" aria-label="task 3 examine the spring container permalink">Â»</a><a class="__target-h" id="task-3-examine-the-spring-container" aria-hidden=""></a>Task 3: Examine the Spring container</h4><p class="g-type-long-body">Remember that the <code>VaultDemoOrderServiceApplication</code> class logs messages during
the successful execution of <code>initIt()</code>:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">...<!-- -->
<!-- -->  @PostConstruct<!-- -->
<!-- -->    public void initIt() throws Exception {<!-- -->
<!-- -->        logger.info(&quot;Got Vault Token: &quot; + sessionManager.getSessionToken().getToken());<!-- -->
<!-- -->        logger.info(&quot;Got DB User: &quot; + dbUser);<!-- -->
<!-- -->...<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  @PostConstruct</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    public void initIt() throws Exception {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        logger.info(&quot;Got Vault Token: &quot; + sessionManager.getSessionToken().getToken());</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        logger.info(&quot;Got DB User: &quot; + dbUser);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Verify that the log indicates that the demo app obtained a database
credentials from Vault successfully:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">[vagrant@demo ~]$  docker logs spring | grep Got<!-- -->
<!-- -->...VaultDemoOrderServiceApplication : Got Vault Token: root<!-- -->
<!-- -->...VaultDemoOrderServiceApplication : Got DB User: v-token-order-rywqz61432yyx2x27w8r-1524067226<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">[vagrant@demo ~]$  docker logs spring | grep Got</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...VaultDemoOrderServiceApplication : Got Vault Token: root</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...VaultDemoOrderServiceApplication : Got DB User: v-token-order-rywqz61432yyx2x27w8r-1524067226</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Create a new shell session in the <code>spring</code> container.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">[vagrant@demo ~]$  docker exec -it spring sh<!-- -->
<!-- -->/ #<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">[vagrant@demo ~]$  docker exec -it spring sh</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">/ #</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Find the <code>bootstrap.yaml</code> file:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">/ #  ls -al<!-- -->
<!-- -->total 36720<!-- -->
<!-- -->drwxr-xr-x    1 root     root            51 Apr 18 16:00 .<!-- -->
<!-- -->drwxr-xr-x    1 root     root            51 Apr 18 16:00 ..<!-- -->
<!-- -->-rwxr-xr-x    1 root     root             0 Apr 18 16:00 .dockerenv<!-- -->
<!-- -->-rwxr--r--    1 root     root      37587245 Apr 18 15:59 app.jar<!-- -->
<!-- -->drwxr-xr-x    2 root     root          4096 Jan  9 19:37 bin<!-- -->
<!-- -->-rw-r--r--    1 1000     1000           426 Apr 17 17:58 bootstrap.yaml<!-- -->
<!-- -->...<!-- -->
<!-- -->
<!-- -->/ # cat bootstrap.yaml<!-- -->
<!-- -->spring.application.name: spring-vault-demo<!-- -->
<!-- -->spring.cloud.vault:<!-- -->
<!-- -->    authentication: TOKEN<!-- -->
<!-- -->    token: ${VAULT_TOKEN}<!-- -->
<!-- -->    host: localhost<!-- -->
<!-- -->    port: 8200<!-- -->
<!-- -->    scheme: http<!-- -->
<!-- -->    fail-fast: true<!-- -->
<!-- -->    config.lifecycle.enabled: true<!-- -->
<!-- -->    generic:<!-- -->
<!-- -->      enabled: true<!-- -->
<!-- -->      backend: secret<!-- -->
<!-- -->    database:<!-- -->
<!-- -->        enabled: true<!-- -->
<!-- -->        role: order<!-- -->
<!-- -->        backend: database<!-- -->
<!-- -->spring.datasource:<!-- -->
<!-- -->  url: jdbc:postgresql://localhost:5432/postgres<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">/ #  ls -al</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">total 36720</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">drwxr-xr-x    1 root     root            51 Apr 18 16:00 .</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">drwxr-xr-x    1 root     root            51 Apr 18 16:00 ..</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">-rwxr-xr-x    1 root     root             0 Apr 18 16:00 .dockerenv</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">-rwxr--r--    1 root     root      37587245 Apr 18 15:59 app.jar</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">drwxr-xr-x    2 root     root          4096 Jan  9 19:37 bin</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">-rw-r--r--    1 1000     1000           426 Apr 17 17:58 bootstrap.yaml</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">/ # cat bootstrap.yaml</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">spring.application.name: spring-vault-demo</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">spring.cloud.vault:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    authentication: TOKEN</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    token: ${VAULT_TOKEN}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    host: localhost</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    port: 8200</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    scheme: http</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    fail-fast: true</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    config.lifecycle.enabled: true</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    generic:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">      enabled: true</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">      backend: secret</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    database:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        enabled: true</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        role: order</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        backend: database</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">spring.datasource:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  url: jdbc:postgresql://localhost:5432/postgres</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The client token was injected into the <code>spring</code> container as an environment
variable (<code>VAULT_TOKEN</code>) by Vagrant.</p><p class="g-type-long-body">Enter <code>exit</code> to close the shell session in the <code>spring</code> container.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#task-4-examine-the-postgresql-database" aria-label="task 4 examine the postgresql database permalink">Â»</a><a class="__target-h" id="task-4-examine-the-postgresql-database" aria-hidden=""></a>Task 4: Examine the PostgreSQL database</h4><p class="g-type-long-body">Connect to the PostgreSQL database running in the <code>postgres</code> container:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">[vagrant@demo ~]$ docker exec -it postgres psql -U postgres -d postgres<!-- -->
<!-- -->psql (10.3 (Debian 10.3-1.pgdg90+1))<!-- -->
<!-- -->Type &quot;help&quot; for help.<!-- -->
<!-- -->
<!-- -->
<!-- -->postgres=# \d orders<!-- -->
<!-- -->                                          Table &quot;public.orders&quot;<!-- -->
<!-- -->    Column     |            Type             | Collation | Nullable |              Default<!-- -->
<!-- -->---------------+-----------------------------+-----------+----------+------------------------------------<!-- -->
<!-- --> id            | bigint                      |           | not null | nextval(&#x27;orders_id_seq&#x27;::regclass)<!-- -->
<!-- --> customer_name | character varying(60)       |           | not null |<!-- -->
<!-- --> product_name  | character varying(20)       |           | not null |<!-- -->
<!-- --> order_date    | timestamp without time zone |           | not null |<!-- -->
<!-- -->Indexes:<!-- -->
<!-- -->    &quot;orders_pkey&quot; PRIMARY KEY, btree (id)<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">[vagrant@demo ~]$ docker exec -it postgres psql -U postgres -d postgres</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">psql (10.3 (Debian 10.3-1.pgdg90+1))</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">Type &quot;help&quot; for help.</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">postgres=# \d orders</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                                          Table &quot;public.orders&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    Column     |            Type             | Collation | Nullable |              Default</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">---------------+-----------------------------+-----------+----------+------------------------------------</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> id            | bigint                      |           | not null | nextval(&#x27;orders_id_seq&#x27;::regclass)</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> customer_name | character varying(60)       |           | not null |</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> product_name  | character varying(20)       |           | not null |</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> order_date    | timestamp without time zone |           | not null |</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">Indexes:</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    &quot;orders_pkey&quot; PRIMARY KEY, btree (id)</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Let&#x27;s list the existing database roles.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">postgres-# \du<!-- -->
<!-- -->                                                     List of roles<!-- -->
<!-- -->                   Role name                   |                         Attributes                         | Member of<!-- -->
<!-- -->-----------------------------------------------+------------------------------------------------------------+-----------<!-- -->
<!-- --> postgres                                      | Superuser, Create role, Create DB, Replication, Bypass RLS | {}<!-- -->
<!-- --> v-token-order-rywqz61432yyx2x27w8r-1524067226 | Password valid until 2018-04-18 20:56:31+00                | {}<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">postgres-# \du</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                                                     List of roles</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                   Role name                   |                         Attributes                         | Member of</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">-----------------------------------------------+------------------------------------------------------------+-----------</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> postgres                                      | Superuser, Create role, Create DB, Replication, Bypass RLS | {}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> v-token-order-rywqz61432yyx2x27w8r-1524067226 | Password valid until 2018-04-18 20:56:31+00                | {}</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Notice that there is a role name starting with <code>v-token-order-</code> which was
dynamically created by the database secret engine.</p><div class="alert alert-warning g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> To learn more
about the database secret engine, read the <a href="/guides/secret-mgmt/dynamic-secrets">Secrets as a Service: Dynamic
Secrets</a> guide.</p></div><p class="g-type-long-body">Enter <code>\q</code> to exit out of the <code>psql</code> session, or you can open another terminal
and SSH into the demo virtual machine.</p><h3 class="g-type-display-4"><a class="__permalink-h" href="#step3" aria-label="step 3 run the demo application permalink">Â»</a><a class="__target-h __compat" id="step3" aria-hidden=""></a><a class="__target-h" id="step-3-run-the-demo-application" aria-hidden=""></a>Step 3: Run the demo application</h3><p class="g-type-long-body">If everything looked fine in <a href="#step2">Step 2</a>, you are ready to write some data.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-9.png" alt="Vault UI"/></p><p class="g-type-long-body">You have <a href="#task-3-examine-the-spring-container">verified in the <code>spring</code> log</a>
that the demo app successfully retrieved a database credential from the Vault
server during its initialization.</p><p class="g-type-long-body">The next step is to send a new order request via the demo app&#x27;s <em>orders</em> API
(http://localhost:8080/api/orders).</p><div class="g-code-block style_root__3eDLf language-shell style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token comment"># Create a new order data</span>
<span class="token punctuation">[</span>vagrant@demo ~<span class="token punctuation">]</span>$ <span class="token function">tee</span> payload.json<span class="token operator">&lt;&lt;</span><span class="token string">EOF</span>
<span class="token string">{</span>
<span class="token string">  &quot;customerName&quot;: &quot;John&quot;,</span>
<span class="token string">  &quot;productName&quot;: &quot;Nomad&quot;</span>
<span class="token string">}</span>
<span class="token string">EOF</span>
<!-- -->
<span class="token comment"># Send a request using cURL</span>
<span class="token punctuation">[</span>vagrant@demo ~<span class="token punctuation">]</span>$ <span class="token function">curl</span> --request POST --header <span class="token string">&quot;Content-Type: application/json&quot;</span> <span class="token punctuation">\</span>
<!-- -->                       --data @payload.json http://localhost:8080/api/orders <span class="token operator">|</span> jq<!-- -->
<span class="token punctuation">{</span>
<!-- -->  <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span>,<!-- -->
<!-- -->  <span class="token string">&quot;customerName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;John&quot;</span>,<!-- -->
<!-- -->  <span class="token string">&quot;productName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Nomad&quot;</span>,<!-- -->
<!-- -->  <span class="token string">&quot;orderDate&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2018-04-18T22:07:42.916+0000&quot;</span>
<span class="token punctuation">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell"><code class="style_code__2AMYw language-shell"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Create a new order data</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">[</span>vagrant@demo ~<span class="token punctuation">]</span>$ <span class="token function">tee</span> payload.json<span class="token operator">&lt;&lt;</span><span class="token string">EOF</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token string">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token string">  &quot;customerName&quot;: &quot;John&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token string">  &quot;productName&quot;: &quot;Nomad&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token string">}</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token string">EOF</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Send a request using cURL</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">[</span>vagrant@demo ~<span class="token punctuation">]</span>$ <span class="token function">curl</span> --request POST --header <span class="token string">&quot;Content-Type: application/json&quot;</span> <span class="token punctuation">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                       --data @payload.json http://localhost:8080/api/orders <span class="token operator">|</span> jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span>,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  <span class="token string">&quot;customerName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;John&quot;</span>,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  <span class="token string">&quot;productName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Nomad&quot;</span>,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  <span class="token string">&quot;orderDate&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2018-04-18T22:07:42.916+0000&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body"><strong>NOTE:</strong> Alternatively, you can use tool such as
<a href="https://www.getpostman.com/apps">Postman</a> instead of cURL to invoke the API if
you prefer.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-4.png" alt="Postman"/></p><p class="g-type-long-body">The order data you sent gets encrypted by Vault. The database only sees the
ciphertext. Let&#x27;s verify that the order information stored in the database
is encrypted.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">[vagrant@demo ~]$ docker exec -it postgres psql -U postgres -d postgres<!-- -->
<!-- -->
<!-- -->postgres=# select * from orders;<!-- -->
<!-- --> id |                     customer_name                     | product_name |       order_date<!-- -->
<!-- -->----+-------------------------------------------------------+--------------+-------------------------<!-- -->
<!-- -->  1 | vault:v1:Qj0lx5DSZvwcHeMOX/5UX/ErHTaDPA3mVlSSpaXd1tbM | VE           | 2018-04-18 21:56:37.924<!-- -->
<!-- -->  2 | vault:v1:UwL3HnyqTUac5ElS5WYAuNg3NdIMFtd6vvwukL+FaKun | Nomad        | 2018-04-18 22:07:42.916<!-- -->
<!-- -->(2 rows)<!-- -->
<!-- -->
<!-- -->postgres=# \q<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">[vagrant@demo ~]$ docker exec -it postgres psql -U postgres -d postgres</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">postgres=# select * from orders;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> id |                     customer_name                     | product_name |       order_date</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">----+-------------------------------------------------------+--------------+-------------------------</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  1 | vault:v1:Qj0lx5DSZvwcHeMOX/5UX/ErHTaDPA3mVlSSpaXd1tbM | VE           | 2018-04-18 21:56:37.924</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  2 | vault:v1:UwL3HnyqTUac5ElS5WYAuNg3NdIMFtd6vvwukL+FaKun | Nomad        | 2018-04-18 22:07:42.916</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">(2 rows)</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">postgres=# \q</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><blockquote><p class="g-type-long-body">In this demo, Vault encrypts the customer names; therefore, the values in the
<strong><code>customer_name</code></strong> column do not display the names in a human readable
manner (e.g. &quot;James&quot; and &quot;John&quot;).</p></blockquote><p class="g-type-long-body">Now, retrieve the order data via the orders API:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">[vagrant@demo ~]$ curl --header &quot;Content-Type: application/json&quot; \<!-- -->
<!-- -->                       http://localhost:8080/api/orders | jq<!-- -->
<!-- -->[<!-- -->
<!-- --> {<!-- -->
<!-- -->   &quot;id&quot;: 1,<!-- -->
<!-- -->   &quot;customerName&quot;: &quot;James&quot;,<!-- -->
<!-- -->   &quot;productName&quot;: &quot;VE&quot;,<!-- -->
<!-- -->   &quot;orderDate&quot;: &quot;2018-04-18T21:56:37.924+0000&quot;<!-- -->
<!-- --> },<!-- -->
<!-- --> {<!-- -->
<!-- -->   &quot;id&quot;: 2,<!-- -->
<!-- -->   &quot;customerName&quot;: &quot;John&quot;,<!-- -->
<!-- -->   &quot;productName&quot;: &quot;Nomad&quot;,<!-- -->
<!-- -->   &quot;orderDate&quot;: &quot;2018-04-18T22:07:42.916+0000&quot;<!-- -->
<!-- --> }<!-- -->
<!-- -->]<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">[vagrant@demo ~]$ curl --header &quot;Content-Type: application/json&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">                       http://localhost:8080/api/orders | jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">[</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;id&quot;: 1,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;customerName&quot;: &quot;James&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;productName&quot;: &quot;VE&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;orderDate&quot;: &quot;2018-04-18T21:56:37.924+0000&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> },</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;id&quot;: 2,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;customerName&quot;: &quot;John&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;productName&quot;: &quot;Nomad&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   &quot;orderDate&quot;: &quot;2018-04-18T22:07:42.916+0000&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> }</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">]</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The customer names should be readable. Remember that the <strong><code>order</code></strong> policy
permits the demo app to encrypt and decrypt data using the <code>order</code> encryption
key in Vault.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui" aria-label="web ui permalink">Â»</a><a class="__target-h" id="web-ui" aria-hidden=""></a>Web UI</h4><p class="g-type-long-body">Vault UI makes it easy to decrypt the data.</p><p class="g-type-long-body">In the <strong>Secrets</strong> tab, select <strong><code>transit/</code> &gt; <code>orders</code></strong>, and select <strong>Key
actions</strong>.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-5.png" alt="Web UI"/></p><p class="g-type-long-body">Select <strong>Decrypt</strong> from the transit actions. Now, copy the ciphertext from the
<strong><code>orders</code></strong> table and paste it in.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-6.png" alt="Web UI"/></p><p class="g-type-long-body">Click <strong>Decrypt</strong>.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-7.png" alt="Web UI"/></p><p class="g-type-long-body">Finally, click <strong>Decode from base64</strong> to reveal the customer name.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-8.png" alt="Web UI"/></p><h3 class="g-type-display-4"><a class="__permalink-h" href="#step4" aria-label="step 4 reloading the static secrets permalink">Â»</a><a class="__target-h __compat" id="step4" aria-hidden=""></a><a class="__target-h" id="step-4-reloading-the-static-secrets" aria-hidden=""></a>Step 4: Reloading the Static Secrets</h3><p class="g-type-long-body">Now, let&#x27;s test another API endpoint, <strong><code>api/secret</code></strong> provided by the demo app.
A plain old Java object, <code>Secret</code> defines a get method for <code>key</code> and <code>value</code>.
The <code>SecretController.java</code> defines an API endpoint, <strong><code>api/secret</code></strong>.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">package com.hashicorp.vault.spring.demo;<!-- -->
<!-- -->...<!-- -->
<!-- -->
<!-- -->@RefreshScope<!-- -->
<!-- -->@RestController<!-- -->
<!-- -->public class SecretController {<!-- -->
<!-- -->
<!-- -->    @Value(&quot;${secret:n/a}&quot;)<!-- -->
<!-- -->    String secret;<!-- -->
<!-- -->
<!-- -->    @RequestMapping(&quot;/api/secret&quot;)<!-- -->
<!-- -->    public Secret secret() {<!-- -->
<!-- -->        return new Secret(&quot;secret&quot;, secret);<!-- -->
<!-- -->    }<!-- -->
<!-- -->}<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">package com.hashicorp.vault.spring.demo;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">@RefreshScope</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">@RestController</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">public class SecretController {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    @Value(&quot;${secret:n/a}&quot;)</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    String secret;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    @RequestMapping(&quot;/api/secret&quot;)</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    public Secret secret() {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        return new Secret(&quot;secret&quot;, secret);</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">    }</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Remember from <a href="#task-2-examine-the-vault-environment">Step 2</a> that the
<strong><code>order</code></strong> policy granted permissions on the <code>secret/spring-vault-demo</code> path.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">path &quot;secret/spring-vault-demo&quot; {<!-- -->
<!-- -->  capabilities = [&quot;create&quot;, &quot;read&quot;, &quot;update&quot;, &quot;delete&quot;, &quot;list&quot;]<!-- -->
<!-- -->}<!-- -->
<!-- -->...<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">path &quot;secret/spring-vault-demo&quot; {</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  capabilities = [&quot;create&quot;, &quot;read&quot;, &quot;update&quot;, &quot;delete&quot;, &quot;list&quot;]</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The demo app retrieved the secret from <code>secret/spring-vault-demo</code> and has a
local copy. If someone (or perhaps another app) updates the secret, it makes the
secret held by the demo app to be obsolete.</p><p class="g-type-long-body"><img src="/img/vault-java-demo-11.png" alt="Static Secret"/></p><p class="g-type-long-body">Spring offers <a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#production-ready">Spring Boot
Actuator</a>
which can be used to facilitate the reloading of the static secret.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#task-1-read-the-secret" aria-label="task 1 read the secret permalink">Â»</a><a class="__target-h" id="task-1-read-the-secret" aria-hidden=""></a>Task 1: Read the secret</h4><p class="g-type-long-body">The initial key-value was set by Vagrant during the provisioning. (See the
<code>Vagrantfile</code> at line 48.)</p><p class="g-type-long-body">Let&#x27;s invoke the demo app&#x27;s secret API (<strong><code>api/secret</code></strong>):</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> -s http://localhost:8080/api/secret <span class="token operator">|</span> jq</span></span>
<span class="token output">{</span>
<span class="token output">  &quot;key&quot;: &quot;secret&quot;,</span>
<span class="token output">  &quot;value&quot;: &quot;hello-vault&quot;</span>
<span class="token output">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> -s http://localhost:8080/api/secret <span class="token operator">|</span> jq</span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;key&quot;: &quot;secret&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;value&quot;: &quot;hello-vault&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">This is the secret that the demo app knows about.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#task-2-update-the-secrets" aria-label="task 2 update the secrets permalink">Â»</a><a class="__target-h" id="task-2-update-the-secrets" aria-hidden=""></a>Task 2: Update the Secrets</h4><p class="g-type-long-body">Now, update the secret stored in Vault using API:</p><div class="g-code-block style_root__3eDLf language-shell style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token comment"># Update the value via API</span>
<!-- -->$ <span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: root&quot;</span> <span class="token punctuation">\</span>
<!-- -->       --request POST <span class="token punctuation">\</span>
<!-- -->       --data <span class="token string">&#x27;{ &quot;secret&quot;: &quot;my-api-key&quot; }&#x27;</span> <span class="token punctuation">\</span>
<!-- -->       http://127.0.0.1:8200/v1/secret/spring-vault-demo<!-- -->
<!-- -->
<span class="token comment"># Verify that the secret value was updated</span>
<!-- -->$ <span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: root&quot;</span> <span class="token punctuation">\</span>
<!-- -->       http://127.0.0.1:8200/v1/secret/spring-vault-demo <span class="token operator">|</span> jq<!-- -->
<span class="token punctuation">{</span>
<!-- --> <span class="token string">&quot;request_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;514601e4-a790-3dc6-14b0-537d6982a6c6&quot;</span>,<!-- -->
<!-- --> <span class="token string">&quot;lease_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,<!-- -->
<!-- --> <span class="token string">&quot;renewable&quot;</span><span class="token builtin class-name">:</span> false,<!-- -->
<!-- --> <span class="token string">&quot;lease_duration&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2764800</span>,<!-- -->
<!-- --> <span class="token string">&quot;data&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
<!-- -->   <span class="token string">&quot;secret&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;my-api-key&quot;</span>
<!-- --> <span class="token punctuation">}</span>,<!-- -->
<span class="token punctuation">..</span>.<!-- -->
<span class="token punctuation">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell"><code class="style_code__2AMYw language-shell"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Update the value via API</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ <span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: root&quot;</span> <span class="token punctuation">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --request POST <span class="token punctuation">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --data <span class="token string">&#x27;{ &quot;secret&quot;: &quot;my-api-key&quot; }&#x27;</span> <span class="token punctuation">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       http://127.0.0.1:8200/v1/secret/spring-vault-demo</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Verify that the secret value was updated</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ <span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: root&quot;</span> <span class="token punctuation">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       http://127.0.0.1:8200/v1/secret/spring-vault-demo <span class="token operator">|</span> jq</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> <span class="token string">&quot;request_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;514601e4-a790-3dc6-14b0-537d6982a6c6&quot;</span>,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> <span class="token string">&quot;lease_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> <span class="token string">&quot;renewable&quot;</span><span class="token builtin class-name">:</span> false,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> <span class="token string">&quot;lease_duration&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2764800</span>,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> <span class="token string">&quot;data&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">   <span class="token string">&quot;secret&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;my-api-key&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"> <span class="token punctuation">}</span>,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">..</span>.</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#task-3-refresh-the-secret-on-demo-app" aria-label="task 3 refresh the secret on demo app permalink">Â»</a><a class="__target-h" id="task-3-refresh-the-secret-on-demo-app" aria-hidden=""></a>Task 3: Refresh the secret on demo app</h4><p class="g-type-long-body">Run the demo app&#x27;s secret API again:</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> -s http://localhost:8080/api/secret <span class="token operator">|</span> jq</span></span>
<span class="token output">{</span>
<span class="token output">  &quot;key&quot;: &quot;secret&quot;,</span>
<span class="token output">  &quot;value&quot;: &quot;hello-vault&quot;</span>
<span class="token output">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> -s http://localhost:8080/api/secret <span class="token operator">|</span> jq</span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;key&quot;: &quot;secret&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;value&quot;: &quot;hello-vault&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The current value stored in Vault is now <code>my-api-key</code>; however, the demo app
still holds <code>hello-vault</code>.</p><p class="g-type-long-body">Spring provides an
<a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#production-ready">actuator</a>
which can be leveraged to refresh the secret value. At line 54 of the
<code>vault-guides/secrets/spring-cloud-vault/pom.xml</code>, you see that the actuator was
added to the project.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">...<!-- -->
<!-- -->&lt;dependency&gt;<!-- -->
<!-- -->  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<!-- -->
<!-- -->  &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;<!-- -->
<!-- -->&lt;/dependency&gt;<!-- -->
<!-- -->...<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">&lt;dependency&gt;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">&lt;/dependency&gt;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">...</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Let&#x27;s refresh the secret using the actuator:</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> -s --request POST http://localhost:8080/actuator/refresh <span class="token operator">|</span> jq</span></span>
<span class="token output">[</span>
<span class="token output">  &quot;secret&quot;</span>
<span class="token output">]</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> -s --request POST http://localhost:8080/actuator/refresh <span class="token operator">|</span> jq</span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">[</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;secret&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">]</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Read back the secret from the demo app again:</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> -s http://localhost:8080/api/secret <span class="token operator">|</span> jq</span></span>
<span class="token output">{</span>
<span class="token output">  &quot;key&quot;: &quot;secret&quot;,</span>
<span class="token output">  &quot;value&quot;: &quot;my-api-key&quot;</span>
<span class="token output">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> -s http://localhost:8080/api/secret <span class="token operator">|</span> jq</span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;key&quot;: &quot;secret&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;value&quot;: &quot;my-api-key&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">It should display the correct value.</p><hr/><p class="g-type-long-body">When you are done exploring the demo implementation, you can destroy the virtual
machine:</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vagrant destroy</span></span>
<span class="token output">demo: Are you sure you want to destroy the &#x27;demo&#x27; VM? [y/N] y</span>
<span class="token output">==&gt; demo: Forcing shutdown of VM...</span>
<span class="token output">==&gt; demo: Destroying VM and associated drives...</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vagrant destroy</span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">demo: Are you sure you want to destroy the &#x27;demo&#x27; VM? [y/N] y</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">==&gt; demo: Forcing shutdown of VM...</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">==&gt; demo: Destroying VM and associated drives...</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><div class="alert alert-warning g-type-body" role="alert"><p class="g-type-long-body">In the webinar, the demo environment was running in a public cloud, and Nomad
and Consul were also installed and configured. If you wish to build a similar
environment using Kubernetes, the assets in the <code>vault-guides/secrets/spring-cloud-vault/kubernetes</code>
folder provides you with some guidance.</p></div><h2 class="g-type-display-3"><a class="__permalink-h" href="#next-steps" aria-label="next steps permalink">Â»</a><a class="__target-h" id="next-steps" aria-hidden=""></a>Next steps</h2><p class="g-type-long-body"><a href="/docs/auth/approle">AppRole</a> is an authentication mechanism within Vault
to allow machines or apps to acquire a token to interact with Vault. Read the
<a href="/guides/identity/authentication">AppRole Pull Authentication</a> guide
which introduces the steps to generate tokens for machines or apps by enabling
AppRole auth method.</p></article></div></div><div id="edit-this-page" class="g-container"><a href="https://github.com/hashicorp/vault/blob/main/website/content/guides/encryption/spring-demo.mdx"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMiIGhlaWdodD0iMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTExLjYwOC4zNDJDNS41MzUuMzQyLjYxIDUuMTYyLjYxIDExLjEwOGMwIDQuNzU3IDMuMTUyIDguNzkyIDcuNTIzIDEwLjIxNS41NS4xLjc1MS0uMjMzLjc1MS0uNTE4IDAtLjI1Ni0uMDEtLjkzMy0uMDE1LTEuODMxLTMuMDYuNjUtMy43MDUtMS40NDQtMy43MDUtMS40NDQtLjUtMS4yNDMtMS4yMjItMS41NzQtMS4yMjItMS41NzQtLjk5OC0uNjY4LjA3Ni0uNjU1LjA3Ni0uNjU1IDEuMTA0LjA3NiAxLjY4NSAxLjExIDEuNjg1IDEuMTEuOTgxIDEuNjQ1IDIuNTc1IDEuMTcgMy4yMDEuODk0LjEtLjY5NS4zODUtMS4xNy42OTktMS40MzktMi40NDMtLjI3MS01LjAxMS0xLjE5NS01LjAxMS01LjMyIDAtMS4xNzYuNDI5LTIuMTM3IDEuMTMyLTIuODktLjExMy0uMjcyLS40OS0xLjM2Ny4xMDgtMi44NDkgMCAwIC45MjQtLjI4OSAzLjAyNSAxLjEwNC44NzctLjI0IDEuODE5LS4zNTggMi43NTQtLjM2My45MzQuMDA1IDEuODc1LjEyNCAyLjc1NC4zNjMgMi4xLTEuMzkzIDMuMDIyLTEuMTA0IDMuMDIyLTEuMTA0LjYgMS40ODIuMjIyIDIuNTc3LjExIDIuODUuNzA1Ljc1MiAxLjEzIDEuNzEzIDEuMTMgMi44ODggMCA0LjEzNi0yLjU3MiA1LjA0Ni01LjAyMiA1LjMxMy4zOTQuMzMyLjc0Ni45OS43NDYgMS45OTQgMCAxLjQzOC0uMDEzIDIuNi0uMDEzIDIuOTUzIDAgLjI4OC4xOTguNjIzLjc1Ni41MTggNC4zNjgtMS40MjcgNy41MTYtNS40NiA3LjUxNi0xMC4yMTUgMC01Ljk0Ni00LjkyNS0xMC43NjYtMTEtMTAuNzY2IiBmaWxsPSIjMTYxNTE0IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=" alt="github logo"/><span>Edit this page</span></a></div></div><footer class="g-footer"><div class="g-container"><div class="left"><a href="/docs/vault_v1.8.x/docs/">Docs</a><a href="/docs/vault_v1.8.x/api/">API</a><a href="https://learn.hashicorp.com/vault">Learn</a><a href="/docs/vault_v1.8.x/community/">Community</a><a href="https://hashicorp.com/privacy">Privacy</a><a href="/docs/vault_v1.8.x/security/">Security</a><a href="/docs/vault_v1.8.x/files/press-kit.zip">Press Kit</a><a>Consent Manager</a></div></div></footer><div id="g-consent-manager"></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"currentPath":"encryption/spring-demo","frontMatter":{"layout":"guides","page_title":"Java Application Demo - Guides","description":"This guide discusses the concepts necessary to help users\nunderstand Vault's AppRole authentication pattern and how to use it to\nsecurely introduce a Vault authentication token to a target server,\napplication, container, etc. in a Java environment."},"githubFileUrl":"https://github.com/hashicorp/vault/blob/main/website/content/guides/encryption/spring-demo.mdx","mdxSource":{"compiledSource":"var m=Object.defineProperty;var p=Object.prototype.hasOwnProperty;var r=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable;var l=(a,t,n)=\u003et in a?m(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,e=(a,t)=\u003e{for(var n in t||(t={}))p.call(t,n)\u0026\u0026l(a,n,t[n]);if(r)for(var n of r(t))o.call(t,n)\u0026\u0026l(a,n,t[n]);return a};var i=(a,t)=\u003e{var n={};for(var s in a)p.call(a,s)\u0026\u0026t.indexOf(s)\u003c0\u0026\u0026(n[s]=a[s]);if(a!=null\u0026\u0026r)for(var s of r(a))t.indexOf(s)\u003c0\u0026\u0026o.call(a,s)\u0026\u0026(n[s]=a[s]);return n};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var s=n,{components:a}=s,t=i(s,[\"components\"]);return mdx(MDXLayout,e(e(e({},layoutProps),t),{components:a,mdxType:\"MDXLayout\"}),mdx(\"h1\",e({},{className:\"g-type-display-2\"}),mdx(\"a\",e({parentName:\"h1\"},{className:\"__permalink-h\",href:\"#java-sample-app-using-spring-cloud-vault\",\"aria-label\":\"java sample app using spring cloud vault permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h1\"},{className:\"__target-h\",id:\"java-sample-app-using-spring-cloud-vault\",\"aria-hidden\":\"\"})),\"Java Sample App using Spring Cloud Vault\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Once you have learned the fundamentals of Vault, the next step is to start\nintegrating your system with Vault to secure your organization's secrets.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`The purpose of this guide is to go through the working implementation demo\nintroduced in the `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.hashicorp.com/resources/solutions-engineering-webinar-series-episode-2-vault\"}),`Manage secrets, access, and encryption in the public cloud\nwith\nVault`),`\nwebinar.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"p\"},{href:\"https://youtu.be/NxL2-XuZ3kc\"}),mdx(\"img\",e({parentName:\"a\"},{src:\"/img/vault-java-demo-1.png\",alt:\"YouTube\"})))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The Java application in this demo leverages the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://cloud.spring.io/spring-cloud-vault/\"}),mdx(\"em\",{parentName:\"a\"},`Spring Cloud\nVault`)),` library which provides\nlightweight client-side support for connecting to Vault in a distributed\nenvironment.`),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#reference-material\",\"aria-label\":\"reference material permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"reference-material\",\"aria-hidden\":\"\"})),\"Reference Material\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/guides/encryption/transit\"}),\"Encryption as a Service\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.hashicorp.com/resources/solutions-engineering-webinar-series-episode-2-vault\"}),`Manage secrets, access, and encryption in\nthe public cloud with\nVault`)),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"https://cloud.spring.io/spring-cloud-vault/\"}),\"Spring Cloud Vault\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/docs/secrets/transit\"}),\"Transit Secrets Engine\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/guides/secret-mgmt/dynamic-secrets\"}),\"Secrets as a Service: Dynamic Secrets\"))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#estimated-time-to-complete\",\"aria-label\":\"estimated time to complete permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"estimated-time-to-complete\",\"aria-hidden\":\"\"})),\"Estimated Time to Complete\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"15 minutes\"),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#challenge\",\"aria-label\":\"challenge permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"challenge\",\"aria-hidden\":\"\"})),\"Challenge\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Incidents of data breaches which expose sensitive information make headlines more\noften than we like to hear. It becomes more and more important to protect data\nby encrypting it whether the data is in-transit or at-rest. However, creating\na highly secure and sophisticated solution by yourself requires time and resources\nwhich are in demand when an organization is facing a constant threat.`),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#solution\",\"aria-label\":\"solution permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"solution\",\"aria-hidden\":\"\"})),\"Solution\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Vault centralizes management of cryptographic services used to protect your\ndata. Your system can communicate with Vault easily through the Vault API to\nencrypt and decrypt your data, and the encryption keys never have to leave the\nVault.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-eaas.png\",alt:\"Encryption as a Service\"}))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#prerequisites\",\"aria-label\":\"prerequisites permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"prerequisites\",\"aria-hidden\":\"\"})),\"Prerequisites\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"To perform the tasks described in this guide:\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Install \",mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.vagrantup.com/intro/getting-started/install\"}),\"HashiCorp Vagrant\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Clone or download the demo assets from the \",mdx(\"a\",e({parentName:\"li\"},{href:\"https://github.com/hashicorp/vault-guides/tree/master/secrets/spring-cloud-vault\"}),\"hashicorp/vault-guides\"),`\nGitHub repository`)),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#steps\",\"aria-label\":\"steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"steps\",\"aria-hidden\":\"\"})),\"Steps\"),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),`For the purposes of this guide, you are going to provision a Linux machine\nlocally using Vagrant. However, the GitHub repository provides supporting files\nto provision the environment demonstrated in the webinar.`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"After downloading the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#prerequisites\"}),\"demo assets\"),` from the GitHub repository,\nyou should find the following folders:`),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Folder\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Description\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"aws\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Supporting files to deploy the demo app to AWS\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"kubernetes\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Supporting files to deploy the demo app to Kubernetes\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"nomad\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Supporting files to deploy the demo app to Nomad\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"scripts\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Scripts to setup PostgreSQL and Vault\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"src/main\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Sample app source code\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"vagrant-local\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Vagrant file to deploy the demo locally\")))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"In this guide, you will perform the following:\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step1\"}),\"Review the demo application implementation\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step2\"}),\"Deploy and review the demo environment\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step3\"}),\"Run the demo application\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step4\"}),\"Reload the Static Secrets\"))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-10.png\",alt:\"Encryption as a Service\"}))),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step1\",\"aria-label\":\"step 1 review the demo application implementation permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step1\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-1-review-the-demo-application-implementation\",\"aria-hidden\":\"\"})),\"Step 1: Review the demo application implementation\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The source code can be found under the \",mdx(\"inlineCode\",{parentName:\"p\"},\"src/main\"),\" directory.\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"\\u251C\\u2500\\u2500 java\",`\n`,\"\\u2502\\xA0\\xA0 \\u2514\\u2500\\u2500 com\",`\n`,\"\\u2502\\xA0\\xA0     \\u2514\\u2500\\u2500 hashicorp\",`\n`,\"\\u2502\\xA0\\xA0         \\u2514\\u2500\\u2500 vault\",`\n`,\"\\u2502\\xA0\\xA0             \\u2514\\u2500\\u2500 spring\",`\n`,\"\\u2502\\xA0\\xA0                 \\u2514\\u2500\\u2500 demo\",`\n`,\"\\u2502\\xA0\\xA0                     \\u251C\\u2500\\u2500 BeanUtil.java\",`\n`,\"\\u2502\\xA0\\xA0                     \\u251C\\u2500\\u2500 Order.java\",`\n`,\"\\u2502\\xA0\\xA0                     \\u251C\\u2500\\u2500 OrderAPIController.java\",`\n`,\"\\u2502\\xA0\\xA0                     \\u251C\\u2500\\u2500 OrderRepository.java\",`\n`,\"\\u2502\\xA0\\xA0                     \\u251C\\u2500\\u2500 Secret.java\",`\n`,\"\\u2502\\xA0\\xA0                     \\u251C\\u2500\\u2500 SecretController.java\",`\n`,\"\\u2502\\xA0\\xA0                     \\u251C\\u2500\\u2500 TransitConverter.java\",`\n`,\"\\u2502\\xA0\\xA0                     \\u2514\\u2500\\u2500 VaultDemoOrderServiceApplication.java\",`\n`,\"\\u2514\\u2500\\u2500 resources\",`\n`,\"    \\u2514\\u2500\\u2500 application.yaml\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`The demo Java application leverages the Spring Cloud Vault library to\ncommunicate with Vault.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"In the \",mdx(\"inlineCode\",{parentName:\"p\"},\"TransitConverter\"),\" class, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"convertToDatabaseColumn\"),` method invokes a\nVault operation to encrypt the `,mdx(\"inlineCode\",{parentName:\"p\"},\"order\"),`. Similarly, the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"convertToEntityAttribute\"),\" method decrypts the \",mdx(\"inlineCode\",{parentName:\"p\"},\"order\"),\" data.\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"...\",`\n`,\"    @Override\",`\n`,\"    public String convertToDatabaseColumn(String customer) {\",`\n`,\"        VaultOperations vaultOps = BeanUtil.getBean(VaultOperations.class);\",`\n`,\"        Plaintext plaintext = Plaintext.of(customer);\",`\n`,'        String cipherText = vaultOps.opsForTransit().encrypt(\"order\", plaintext).getCiphertext();',`\n`,\"        return cipherText;\",`\n`,\"    }\",`\n`,`\n`,\"    @Override\",`\n`,\"    public String convertToEntityAttribute(String customer) {\",`\n`,\"        VaultOperations vaultOps = BeanUtil.getBean(VaultOperations.class);\",`\n`,\"        Ciphertext ciphertext = Ciphertext.of(customer);\",`\n`,'        String plaintext = vaultOps.opsForTransit().decrypt(\"order\", ciphertext).asString();',`\n`,\"        return plaintext;\",`\n`,\"...\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"VaultDemoOrderServiceApplication\"),\" class defines the \",mdx(\"inlineCode\",{parentName:\"p\"},\"main\"),\" method.\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"public class VaultDemoOrderServiceApplication  {\",`\n`,`\n`,\"    private static final Logger logger = LoggerFactory.getLogger(VaultDemoOrderServiceApplication.class);\",`\n`,`\n`,\"    @Autowired\",`\n`,\"        private SessionManager sessionManager;\",`\n`,`\n`,'    @Value(\"${spring.datasource.username}\")',`\n`,\"    private String dbUser;\",`\n`,`\n`,'    @Value(\"${spring.datasource.password}\")',`\n`,\"    private String dbPass;\",`\n`,`\n`,\"    public static void main(String[] args) {\",`\n`,\"        SpringApplication.run(VaultDemoOrderServiceApplication.class, args);\",`\n`,\"    }\",`\n`,`\n`,\"    @PostConstruct\",`\n`,\"    public void initIt() throws Exception {\",`\n`,'        logger.info(\"Got Vault Token: \" + sessionManager.getSessionToken().getToken());',`\n`,'        logger.info(\"Got DB User: \" + dbUser);',`\n`,\"    }\",`\n`,\"}\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"OrderAPIController\"),\" class defines the API endpoint (\",mdx(\"inlineCode\",{parentName:\"p\"},\"api/orders\"),\").\"),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step2\",\"aria-label\":\"step 2 deploy and review the demo environment permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step2\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-2-deploy-and-review-the-demo-environment\",\"aria-hidden\":\"\"})),\"Step 2: Deploy and review the demo environment\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Now let's run the demo app and examine how it behaves.\"),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),`To keep it simple and lightweight, you are going to run a Linux virtual\nmachine locally using Vagrant.`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#task-1-run-vagrant\",\"aria-label\":\"task 1 run vagrant permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"task-1-run-vagrant\",\"aria-hidden\":\"\"})),\"Task 1: Run Vagrant\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"In the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"vault-guides/secrets/spring-cloud-vault/vagrant-local\")),` folder,\na `,mdx(\"inlineCode\",{parentName:\"p\"},\"Vagrantfile\"),` is provided which spins up a Linux machine where the demo\ncomponents are installed and configured.`),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Change the working directory to vagrant-local\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\"cd\"),\" /vault-guides/secrets/spring-cloud-vault/vagrant-local\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create and configure a Linux machine. This takes about 3 minutes\"),`\n`,\"$ vagrant up\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"..\"),\".\",`\n`,\"demo: Success\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"!\"),\" Data written to: database/roles/order\",`\n`,\"demo: Success\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"!\"),\" Enabled the transit secrets engine at: transit/\",`\n`,\"demo: Success\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"!\"),\" Data written to: transit/keys/order\",`\n`,\"demo: Success\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"!\"),\" Data written to: secret/spring-vault-demo\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Verify that the virtual machine was successfully created and running\"),`\n`,\"$ vagrant status\",`\n`,\"Current machine states:\",`\n`,\"demo                      running \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"virtualbox\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"..\"),\".\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Connect to the demo machine\"),`\n`,\"$ vagrant \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"ssh\"),\" demo\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"There are 3 Docker containers running on the machine: \",mdx(\"inlineCode\",{parentName:\"p\"},\"spring\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"vault\"),\", and \",mdx(\"inlineCode\",{parentName:\"p\"},\"postgres\"),\".\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"[vagrant@demo ~]$ docker ps\",`\n`,\"CONTAINER ID     IMAGE            COMMAND                  CREATED           STATUS           NAMES\",`\n`,'684d8fb23ae5     spring           \"java -Djava.secur...\"   7 minutes ago     Up 7 minutes     spring',`\n`,'dc6a3454b323     vault:0.10.0     \"docker-entrypoint...\"   7 minutes ago     Up 7 minutes     vault',`\n`,'4093a45c209f     postgres         \"docker-entrypoint...\"   7 minutes ago     Up 7 minutes     postgres',`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#task-2-examine-the-vault-environment\",\"aria-label\":\"task 2 examine the vault environment permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"task-2-examine-the-vault-environment\",\"aria-hidden\":\"\"})),\"Task 2: Examine the Vault environment\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"During the demo machine provisioning, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"/scripts/vault.sh\"),` script was\nexecuted to perform the following:`),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Created a policy named, \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"order\"))),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Enabled the \",mdx(\"inlineCode\",{parentName:\"li\"},\"transit\"),\" secret engine and created an encryption key named, \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"order\"))),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Enabled the \",mdx(\"inlineCode\",{parentName:\"li\"},\"database\"),\" secret engine and created a role named, \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"order\")))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"View the \",mdx(\"inlineCode\",{parentName:\"p\"},\"vault\"),\" log:\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"[vagrant@demo ~]$  docker logs vault\",`\n`,\"...\",`\n`,\"==\u003e Vault shutdown triggered\",`\n`,\"==\u003e Vault server configuration:\",`\n`,\"             Api Address: http://0.0.0.0:8200\",`\n`,\"                     Cgo: disabled\",`\n`,\"         Cluster Address: https://0.0.0.0:8201\",`\n`,'              Listener 1: tcp (addr: \"0.0.0.0:8200\", cluster address: \"0.0.0.0:8201\", tls: \"disabled\")',`\n`,\"               Log Level: info\",`\n`,\"                   Mlock: supported: true, enabled: false\",`\n`,\"                 Storage: inmem\",`\n`,\"                 Version: Vault v0.10.0\",`\n`,\"             Version Sha: 5dd7f25f5c4b541f2da62d70075b6f82771a650d\",`\n`,\"WARNING! dev mode is enabled! In this mode, Vault runs entirely in-memory\",`\n`,\"and starts unsealed with a single unseal key. The root token is already\",`\n`,\"authenticated to the CLI, so you can immediately begin using Vault.\",`\n`,\"You may need to set the following environment variable:\",`\n`,\"    $ export VAULT_ADDR='http://0.0.0.0:8200'\",`\n`,\"The unseal key and root token are displayed below in case you want to\",`\n`,\"seal/unseal the Vault or re-authenticate.\",`\n`,\"Unseal Key: 2QIPWPDykRG/xWWl0quSHiXq8u+pFg3yEq0sgJPhMbA=\",`\n`,\"Root Token: root\",`\n`,\"...\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Notice that the log indicates that the Vault server is running in the \",mdx(\"inlineCode\",{parentName:\"p\"},\"dev\"),`\nmode, and the root token is `,mdx(\"inlineCode\",{parentName:\"p\"},\"root\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"You can visit the Vault UI at http://localhost:8200/ui. Enter \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"root\")),` and\nclick `,mdx(\"strong\",{parentName:\"p\"},\"Sign In\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Select the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"transit/\")),` secrets engine, and you should find an encryption key\nnamed, \"`,mdx(\"inlineCode\",{parentName:\"p\"},\"order\"),'\".'),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-2.png\",alt:\"Vault UI\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Under the \",mdx(\"strong\",{parentName:\"p\"},\"Policies\"),\", verify that the \",mdx(\"inlineCode\",{parentName:\"p\"},\"order\"),\" policy exists.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-3.png\",alt:\"Vault UI\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"This \",mdx(\"inlineCode\",{parentName:\"p\"},\"order\"),\" policy is for the application. It permits \",mdx(\"inlineCode\",{parentName:\"p\"},\"read\"),` on the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"database/creds/order\"),` path so that the demo app can get a dynamically generated\ndatabase credential from Vault. Therefore, the PostgreSQL credentials are not\nhard-coded anywhere.`),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'path \"database/creds/order\"',`\n`,\"{\",`\n`,'  capabilities = [\"read\"]',`\n`,\"}\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"An \",mdx(\"inlineCode\",{parentName:\"p\"},\"update\"),` permission allows the app to request data encryption and decryption\nusing the `,mdx(\"inlineCode\",{parentName:\"p\"},\"order\"),\" encryption key in Vault.\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"...\",`\n`,'path \"transit/decrypt/order\" {',`\n`,'  capabilities = [\"update\"]',`\n`,\"}\",`\n`,`\n`,'path \"transit/encrypt/order\" {',`\n`,'  capabilities = [\"update\"]',`\n`,\"}\",`\n`,\"...\",`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#task-3-examine-the-spring-container\",\"aria-label\":\"task 3 examine the spring container permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"task-3-examine-the-spring-container\",\"aria-hidden\":\"\"})),\"Task 3: Examine the Spring container\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Remember that the \",mdx(\"inlineCode\",{parentName:\"p\"},\"VaultDemoOrderServiceApplication\"),` class logs messages during\nthe successful execution of `,mdx(\"inlineCode\",{parentName:\"p\"},\"initIt()\"),\":\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"...\",`\n`,\"  @PostConstruct\",`\n`,\"    public void initIt() throws Exception {\",`\n`,'        logger.info(\"Got Vault Token: \" + sessionManager.getSessionToken().getToken());',`\n`,'        logger.info(\"Got DB User: \" + dbUser);',`\n`,\"...\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Verify that the log indicates that the demo app obtained a database\ncredentials from Vault successfully:`),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"[vagrant@demo ~]$  docker logs spring | grep Got\",`\n`,\"...VaultDemoOrderServiceApplication : Got Vault Token: root\",`\n`,\"...VaultDemoOrderServiceApplication : Got DB User: v-token-order-rywqz61432yyx2x27w8r-1524067226\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Create a new shell session in the \",mdx(\"inlineCode\",{parentName:\"p\"},\"spring\"),\" container.\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"[vagrant@demo ~]$  docker exec -it spring sh\",`\n`,\"/ #\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Find the \",mdx(\"inlineCode\",{parentName:\"p\"},\"bootstrap.yaml\"),\" file:\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"/ #  ls -al\",`\n`,\"total 36720\",`\n`,\"drwxr-xr-x    1 root     root            51 Apr 18 16:00 .\",`\n`,\"drwxr-xr-x    1 root     root            51 Apr 18 16:00 ..\",`\n`,\"-rwxr-xr-x    1 root     root             0 Apr 18 16:00 .dockerenv\",`\n`,\"-rwxr--r--    1 root     root      37587245 Apr 18 15:59 app.jar\",`\n`,\"drwxr-xr-x    2 root     root          4096 Jan  9 19:37 bin\",`\n`,\"-rw-r--r--    1 1000     1000           426 Apr 17 17:58 bootstrap.yaml\",`\n`,\"...\",`\n`,`\n`,\"/ # cat bootstrap.yaml\",`\n`,\"spring.application.name: spring-vault-demo\",`\n`,\"spring.cloud.vault:\",`\n`,\"    authentication: TOKEN\",`\n`,\"    token: ${VAULT_TOKEN}\",`\n`,\"    host: localhost\",`\n`,\"    port: 8200\",`\n`,\"    scheme: http\",`\n`,\"    fail-fast: true\",`\n`,\"    config.lifecycle.enabled: true\",`\n`,\"    generic:\",`\n`,\"      enabled: true\",`\n`,\"      backend: secret\",`\n`,\"    database:\",`\n`,\"        enabled: true\",`\n`,\"        role: order\",`\n`,\"        backend: database\",`\n`,\"spring.datasource:\",`\n`,\"  url: jdbc:postgresql://localhost:5432/postgres\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The client token was injected into the \",mdx(\"inlineCode\",{parentName:\"p\"},\"spring\"),` container as an environment\nvariable (`,mdx(\"inlineCode\",{parentName:\"p\"},\"VAULT_TOKEN\"),\") by Vagrant.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"inlineCode\",{parentName:\"p\"},\"exit\"),\" to close the shell session in the \",mdx(\"inlineCode\",{parentName:\"p\"},\"spring\"),\" container.\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#task-4-examine-the-postgresql-database\",\"aria-label\":\"task 4 examine the postgresql database permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"task-4-examine-the-postgresql-database\",\"aria-hidden\":\"\"})),\"Task 4: Examine the PostgreSQL database\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Connect to the PostgreSQL database running in the \",mdx(\"inlineCode\",{parentName:\"p\"},\"postgres\"),\" container:\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"[vagrant@demo ~]$ docker exec -it postgres psql -U postgres -d postgres\",`\n`,\"psql (10.3 (Debian 10.3-1.pgdg90+1))\",`\n`,'Type \"help\" for help.',`\n`,`\n`,`\n`,\"postgres=# \\\\d orders\",`\n`,'                                          Table \"public.orders\"',`\n`,\"    Column     |            Type             | Collation | Nullable |              Default\",`\n`,\"---------------+-----------------------------+-----------+----------+------------------------------------\",`\n`,\" id            | bigint                      |           | not null | nextval('orders_id_seq'::regclass)\",`\n`,\" customer_name | character varying(60)       |           | not null |\",`\n`,\" product_name  | character varying(20)       |           | not null |\",`\n`,\" order_date    | timestamp without time zone |           | not null |\",`\n`,\"Indexes:\",`\n`,'    \"orders_pkey\" PRIMARY KEY, btree (id)',`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Let's list the existing database roles.\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"postgres-# \\\\du\",`\n`,\"                                                     List of roles\",`\n`,\"                   Role name                   |                         Attributes                         | Member of\",`\n`,\"-----------------------------------------------+------------------------------------------------------------+-----------\",`\n`,\" postgres                                      | Superuser, Create role, Create DB, Replication, Bypass RLS | {}\",`\n`,\" v-token-order-rywqz61432yyx2x27w8r-1524067226 | Password valid until 2018-04-18 20:56:31+00                | {}\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Notice that there is a role name starting with \",mdx(\"inlineCode\",{parentName:\"p\"},\"v-token-order-\"),` which was\ndynamically created by the database secret engine.`),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` To learn more\nabout the database secret engine, read the `,mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/secret-mgmt/dynamic-secrets\"}),`Secrets as a Service: Dynamic\nSecrets`),\" guide.\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"inlineCode\",{parentName:\"p\"},\"\\\\q\"),\" to exit out of the \",mdx(\"inlineCode\",{parentName:\"p\"},\"psql\"),` session, or you can open another terminal\nand SSH into the demo virtual machine.`),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step3\",\"aria-label\":\"step 3 run the demo application permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step3\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-3-run-the-demo-application\",\"aria-hidden\":\"\"})),\"Step 3: Run the demo application\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"If everything looked fine in \",mdx(\"a\",e({parentName:\"p\"},{href:\"#step2\"}),\"Step 2\"),\", you are ready to write some data.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-9.png\",alt:\"Vault UI\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"You have \",mdx(\"a\",e({parentName:\"p\"},{href:\"#task-3-examine-the-spring-container\"}),\"verified in the \",mdx(\"inlineCode\",{parentName:\"a\"},\"spring\"),\" log\"),`\nthat the demo app successfully retrieved a database credential from the Vault\nserver during its initialization.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The next step is to send a new order request via the demo app's \",mdx(\"em\",{parentName:\"p\"},\"orders\"),` API\n(http://localhost:8080/api/orders).`),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create a new order data\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"vagrant@demo ~\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"tee\"),\" payload.json\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"\u003c\u003c\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"EOF\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'  \"customerName\": \"John\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'  \"productName\": \"Nomad\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"EOF\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Send a request using cURL\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"vagrant@demo ~\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --request POST --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Content-Type: application/json\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"                       --data @payload.json http://localhost:8080/api/orders \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"|\"),\" jq\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2\"),\",\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"customerName\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"John\"'),\",\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"productName\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Nomad\"'),\",\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"orderDate\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"2018-04-18T22:07:42.916+0000\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` Alternatively, you can use tool such as\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.getpostman.com/apps\"}),\"Postman\"),` instead of cURL to invoke the API if\nyou prefer.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-4.png\",alt:\"Postman\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`The order data you sent gets encrypted by Vault. The database only sees the\nciphertext. Let's verify that the order information stored in the database\nis encrypted.`),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"[vagrant@demo ~]$ docker exec -it postgres psql -U postgres -d postgres\",`\n`,`\n`,\"postgres=# select * from orders;\",`\n`,\" id |                     customer_name                     | product_name |       order_date\",`\n`,\"----+-------------------------------------------------------+--------------+-------------------------\",`\n`,\"  1 | vault:v1:Qj0lx5DSZvwcHeMOX/5UX/ErHTaDPA3mVlSSpaXd1tbM | VE           | 2018-04-18 21:56:37.924\",`\n`,\"  2 | vault:v1:UwL3HnyqTUac5ElS5WYAuNg3NdIMFtd6vvwukL+FaKun | Nomad        | 2018-04-18 22:07:42.916\",`\n`,\"(2 rows)\",`\n`,`\n`,\"postgres=# \\\\q\",`\n`)),mdx(\"blockquote\",null,mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),`In this demo, Vault encrypts the customer names; therefore, the values in the\n`,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"customer_name\")),` column do not display the names in a human readable\nmanner (e.g. \"James\" and \"John\").`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Now, retrieve the order data via the orders API:\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'[vagrant@demo ~]$ curl --header \"Content-Type: application/json\" \\\\',`\n`,\"                       http://localhost:8080/api/orders | jq\",`\n`,\"[\",`\n`,\" {\",`\n`,'   \"id\": 1,',`\n`,'   \"customerName\": \"James\",',`\n`,'   \"productName\": \"VE\",',`\n`,'   \"orderDate\": \"2018-04-18T21:56:37.924+0000\"',`\n`,\" },\",`\n`,\" {\",`\n`,'   \"id\": 2,',`\n`,'   \"customerName\": \"John\",',`\n`,'   \"productName\": \"Nomad\",',`\n`,'   \"orderDate\": \"2018-04-18T22:07:42.916+0000\"',`\n`,\" }\",`\n`,\"]\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The customer names should be readable. Remember that the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"order\")),` policy\npermits the demo app to encrypt and decrypt data using the `,mdx(\"inlineCode\",{parentName:\"p\"},\"order\"),` encryption\nkey in Vault.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Vault UI makes it easy to decrypt the data.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"In the \",mdx(\"strong\",{parentName:\"p\"},\"Secrets\"),\" tab, select \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"transit/\"),\" \u003e \",mdx(\"inlineCode\",{parentName:\"strong\"},\"orders\")),\", and select \",mdx(\"strong\",{parentName:\"p\"},`Key\nactions`),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-5.png\",alt:\"Web UI\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Decrypt\"),` from the transit actions. Now, copy the ciphertext from the\n`,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"orders\")),\" table and paste it in.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-6.png\",alt:\"Web UI\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Decrypt\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-7.png\",alt:\"Web UI\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Finally, click \",mdx(\"strong\",{parentName:\"p\"},\"Decode from base64\"),\" to reveal the customer name.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-8.png\",alt:\"Web UI\"}))),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step4\",\"aria-label\":\"step 4 reloading the static secrets permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step4\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-4-reloading-the-static-secrets\",\"aria-hidden\":\"\"})),\"Step 4: Reloading the Static Secrets\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Now, let's test another API endpoint, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"api/secret\")),` provided by the demo app.\nA plain old Java object, `,mdx(\"inlineCode\",{parentName:\"p\"},\"Secret\"),\" defines a get method for \",mdx(\"inlineCode\",{parentName:\"p\"},\"key\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"value\"),`.\nThe `,mdx(\"inlineCode\",{parentName:\"p\"},\"SecretController.java\"),\" defines an API endpoint, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"api/secret\")),\".\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"package com.hashicorp.vault.spring.demo;\",`\n`,\"...\",`\n`,`\n`,\"@RefreshScope\",`\n`,\"@RestController\",`\n`,\"public class SecretController {\",`\n`,`\n`,'    @Value(\"${secret:n/a}\")',`\n`,\"    String secret;\",`\n`,`\n`,'    @RequestMapping(\"/api/secret\")',`\n`,\"    public Secret secret() {\",`\n`,'        return new Secret(\"secret\", secret);',`\n`,\"    }\",`\n`,\"}\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Remember from \",mdx(\"a\",e({parentName:\"p\"},{href:\"#task-2-examine-the-vault-environment\"}),\"Step 2\"),` that the\n`,mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"order\")),\" policy granted permissions on the \",mdx(\"inlineCode\",{parentName:\"p\"},\"secret/spring-vault-demo\"),\" path.\"),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'path \"secret/spring-vault-demo\" {',`\n`,'  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]',`\n`,\"}\",`\n`,\"...\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The demo app retrieved the secret from \",mdx(\"inlineCode\",{parentName:\"p\"},\"secret/spring-vault-demo\"),` and has a\nlocal copy. If someone (or perhaps another app) updates the secret, it makes the\nsecret held by the demo app to be obsolete.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-java-demo-11.png\",alt:\"Static Secret\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Spring offers \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#production-ready\"}),`Spring Boot\nActuator`),`\nwhich can be used to facilitate the reloading of the static secret.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#task-1-read-the-secret\",\"aria-label\":\"task 1 read the secret permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"task-1-read-the-secret\",\"aria-hidden\":\"\"})),\"Task 1: Read the secret\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`The initial key-value was set by Vagrant during the provisioning. (See the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"Vagrantfile\"),\" at line 48.)\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Let's invoke the demo app's secret API (\",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"api/secret\")),\"):\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" -s http://localhost:8080/api/secret \",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"|\"),\" jq\")),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"key\": \"secret\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"value\": \"hello-vault\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"This is the secret that the demo app knows about.\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#task-2-update-the-secrets\",\"aria-label\":\"task 2 update the secrets permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"task-2-update-the-secrets\",\"aria-hidden\":\"\"})),\"Task 2: Update the Secrets\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Now, update the secret stored in Vault using API:\"),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Update the value via API\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: root\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --request POST \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       --data \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),`'{ \"secret\": \"my-api-key\" }'`),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       http://127.0.0.1:8200/v1/secret/spring-vault-demo\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Verify that the secret value was updated\"),`\n`,\"$ \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"X-Vault-Token: root\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"\\\\\"),`\n`,\"       http://127.0.0.1:8200/v1/secret/spring-vault-demo \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"|\"),\" jq\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"request_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"514601e4-a790-3dc6-14b0-537d6982a6c6\"'),\",\",`\n`,\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"lease_id\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),\",\",`\n`,\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"renewable\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" false,\",`\n`,\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"lease_duration\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2764800\"),\",\",`\n`,\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"data\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"secret\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin class-name\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"my-api-key\"'),`\n`,\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\",\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"..\"),\".\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#task-3-refresh-the-secret-on-demo-app\",\"aria-label\":\"task 3 refresh the secret on demo app permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"task-3-refresh-the-secret-on-demo-app\",\"aria-hidden\":\"\"})),\"Task 3: Refresh the secret on demo app\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Run the demo app's secret API again:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" -s http://localhost:8080/api/secret \",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"|\"),\" jq\")),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"key\": \"secret\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"value\": \"hello-vault\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The current value stored in Vault is now \",mdx(\"inlineCode\",{parentName:\"p\"},\"my-api-key\"),`; however, the demo app\nstill holds `,mdx(\"inlineCode\",{parentName:\"p\"},\"hello-vault\"),\".\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Spring provides an\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#production-ready\"}),\"actuator\"),`\nwhich can be leveraged to refresh the secret value. At line 54 of the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"vault-guides/secrets/spring-cloud-vault/pom.xml\"),`, you see that the actuator was\nadded to the project.`),mdx(\"pre\",e({},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"...\",`\n`,\"\u003cdependency\u003e\",`\n`,\"  \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e\",`\n`,\"  \u003cartifactId\u003espring-boot-starter-actuator\u003c/artifactId\u003e\",`\n`,\"\u003c/dependency\u003e\",`\n`,\"...\",`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Let's refresh the secret using the actuator:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" -s --request POST http://localhost:8080/actuator/refresh \",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"|\"),\" jq\")),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"[\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"secret\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"]\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Read back the secret from the demo app again:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" -s http://localhost:8080/api/secret \",mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"|\"),\" jq\")),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"key\": \"secret\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"value\": \"my-api-key\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"It should display the correct value.\"),mdx(\"hr\",null),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`When you are done exploring the demo implementation, you can destroy the virtual\nmachine:`),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vagrant destroy\")),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"demo: Are you sure you want to destroy the 'demo' VM? [y/N] y\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"==\u003e demo: Forcing shutdown of VM...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"==\u003e demo: Destroying VM and associated drives...\"),`\n`)),mdx(\"div\",e({},{className:\"alert alert-warning g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),`In the webinar, the demo environment was running in a public cloud, and Nomad\nand Consul were also installed and configured. If you wish to build a similar\nenvironment using Kubernetes, the assets in the `,mdx(\"inlineCode\",{parentName:\"p\"},\"vault-guides/secrets/spring-cloud-vault/kubernetes\"),`\nfolder provides you with some guidance.`)),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#next-steps\",\"aria-label\":\"next steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"next-steps\",\"aria-hidden\":\"\"})),\"Next steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"p\"},{href:\"/docs/auth/approle\"}),\"AppRole\"),` is an authentication mechanism within Vault\nto allow machines or apps to acquire a token to interact with Vault. Read the\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/identity/authentication\"}),\"AppRole Pull Authentication\"),` guide\nwhich introduces the steps to generate tokens for machines or apps by enabling\nAppRole auth method.`))}MDXContent.isMDXComponent=!0;\n","scope":{}},"navData":[{"title":"Getting Started","path":"getting-started","filePath":"content/guides/getting-started.mdx"},{"title":"Vault Operations","routes":[{"title":"Overview","path":"operations","filePath":"content/guides/operations/index.mdx"},{"title":"Reference Architecture","path":"operations/reference-architecture","filePath":"content/guides/operations/reference-architecture.mdx"},{"title":"Vault HA with Consul","path":"operations/vault-ha-consul","filePath":"content/guides/operations/vault-ha-consul.mdx"},{"title":"Production Hardening","path":"operations/production","filePath":"content/guides/operations/production.mdx"},{"title":"Root Token Generation","path":"operations/generate-root","filePath":"content/guides/operations/generate-root.mdx"},{"title":"Rekeying \u0026 Rotating","path":"operations/rekeying-and-rotating","filePath":"content/guides/operations/rekeying-and-rotating.mdx"},{"title":"Building Plugin Backends","path":"operations/plugin-backends","filePath":"content/guides/operations/plugin-backends.mdx"},{"divider":true},{"title":"Replication Setup \u0026 Guidance","path":"operations/replication","filePath":"content/guides/operations/replication.mdx"},{"title":"Disaster Recovery Setup","path":"operations/disaster-recovery","filePath":"content/guides/operations/disaster-recovery.mdx"},{"title":"Mount Filter","path":"operations/mount-filter","filePath":"content/guides/operations/mount-filter.mdx"},{"title":"Multi-Tenant: Namespaces","path":"operations/multi-tenant","filePath":"content/guides/operations/multi-tenant.mdx"},{"title":"Vault Auto-unseal with AWS KMS","path":"operations/autounseal-aws-kms","filePath":"content/guides/operations/autounseal-aws-kms.mdx"},{"title":"Seal Wrap / FIPS 140-2","path":"operations/seal-wrap","filePath":"content/guides/operations/seal-wrap.mdx"},{"title":"Vault Cluster Monitoring","path":"operations/monitoring","filePath":"content/guides/operations/monitoring.mdx"},{"title":"Vault Deployment Guide","path":"operations/deployment-guide","filePath":"content/guides/operations/deployment-guide.mdx"},{"title":"Performance Standby Nodes","path":"operations/performance-nodes","filePath":"content/guides/operations/performance-nodes.mdx"}]},{"title":"Identity and Access Management","routes":[{"title":"Overview","path":"identity","filePath":"content/guides/identity/index.mdx"},{"title":"Secure Introduction of Vault Clients","path":"identity/secure-intro","filePath":"content/guides/identity/secure-intro.mdx"},{"title":"Policies","path":"identity/policies","filePath":"content/guides/identity/policies.mdx"},{"title":"ACL Policy Path Templating","path":"identity/policy-templating","filePath":"content/guides/identity/policy-templating.mdx"},{"title":"AppRole Pull Authentication","path":"identity/authentication","filePath":"content/guides/identity/authentication.mdx"},{"title":"AppRole with Terraform and Chef","path":"identity/approle-trusted-entities","filePath":"content/guides/identity/approle-trusted-entities.mdx"},{"title":"Tokens and Leases","path":"identity/lease","filePath":"content/guides/identity/lease.mdx"},{"title":"Identity - Entities \u0026 Groups","path":"identity/identity","filePath":"content/guides/identity/identity.mdx"},{"divider":true},{"title":"Sentinel Policies","path":"identity/sentinel","filePath":"content/guides/identity/sentinel.mdx"},{"title":"Control Groups","path":"identity/control-groups","filePath":"content/guides/identity/control-groups.mdx"}]},{"title":"Secrets Management","routes":[{"title":"Overview","path":"secret-mgmt","filePath":"content/guides/secret-mgmt/index.mdx"},{"title":"Static Secrets","path":"secret-mgmt/static-secrets","filePath":"content/guides/secret-mgmt/static-secrets.mdx"},{"title":"Versioned KV Secret Engine","path":"secret-mgmt/versioned-kv","filePath":"content/guides/secret-mgmt/versioned-kv.mdx"},{"title":"Secret as a Service","path":"secret-mgmt/dynamic-secrets","filePath":"content/guides/secret-mgmt/dynamic-secrets.mdx"},{"title":"DB Root Credential Rotation","path":"secret-mgmt/db-root-rotation","filePath":"content/guides/secret-mgmt/db-root-rotation.mdx"},{"title":"Cubbyhole Response Wrapping","path":"secret-mgmt/cubbyhole","filePath":"content/guides/secret-mgmt/cubbyhole.mdx"},{"title":"One-Time SSH Password","path":"secret-mgmt/ssh-otp","filePath":"content/guides/secret-mgmt/ssh-otp.mdx"},{"title":"Build Your Own CA","path":"secret-mgmt/pki-engine","filePath":"content/guides/secret-mgmt/pki-engine.mdx"},{"title":"Direct Application Integration","path":"secret-mgmt/app-integration","filePath":"content/guides/secret-mgmt/app-integration.mdx"}]},{"title":"Encryption as a Service","routes":[{"title":"Overview","path":"encryption","filePath":"content/guides/encryption/index.mdx"},{"title":"Encryption as a Service","path":"encryption/transit","filePath":"content/guides/encryption/transit.mdx"},{"title":"Java Application Demo","path":"encryption/spring-demo","filePath":"content/guides/encryption/spring-demo.mdx"},{"title":"Transit Secrets Re-wrapping","path":"encryption/transit-rewrap","filePath":"content/guides/encryption/transit-rewrap.mdx"}]}],"versions":[]},"__N_SSG":true},"page":"/guides/[[...page]]","query":{"page":["encryption","spring-demo"]},"buildId":"pcCu12fyWK7PoQNj4BZ7-","assetPrefix":"/docs/vault_v1.8.x","isFallback":false,"gsp":true}</script><script nomodule="" src="/docs/vault_v1.8.x/_next/static/chunks/polyfills-e4c38ea28892f36667af.js"></script><script src="/docs/vault_v1.8.x/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/framework.3519294afa6a9ab53973.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/2bc72d9a08d5bd816ae6b580871df9fb671d43bb.52fd5ef7a8ab7d8fc0dd.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/9a5be27b89b50ff891e514a88cd42f143404f9a6.033857d62f5a01edf3b3.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/main-b0f1f3f8bd3bddd4e6cd.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/b49b08e2da573413c730dfc51ae423f080a0c275.00ac32ee45240d5b343f.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/b1542cc239bf56c8a14913c0a930efe682b5cf86.32bb900ad80311488529.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/pages/_app-d714c55ad24af91621ba.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/7dbdcaca29374b13a0799a901e26613767d72de2.d088888a4a1113f2bb24.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/92f0085e0e6c1f10382de10b8861ce89d7c192a2.e5495ede8461fc33ed98.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b.5052eda5c7f43583669b.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b_CSS.f6584926f1188e1b5b3e.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/pages/guides/%5B%5B...page%5D%5D-72f9db6e509b49c776de.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/pcCu12fyWK7PoQNj4BZ7-/_buildManifest.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/pcCu12fyWK7PoQNj4BZ7-/_ssgManifest.js" async=""></script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-custom-properties.js"><\x2fscript>');</script></body></html>