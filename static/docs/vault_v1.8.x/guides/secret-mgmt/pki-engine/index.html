<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta property="og:image" content="https://www.vaultproject.io/img/og-image.png"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=16&amp;w=16" type="image/png" sizes="16x16" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=32&amp;w=32" type="image/png" sizes="32x32" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=96&amp;w=96" type="image/png" sizes="96x96" rel="icon"/><link href="https://www.datocms-assets.com/2885/1597163356-vault-favicon.png?h=192&amp;w=192" type="image/png" sizes="192x192" rel="icon"/><title>Build Your Own Certificate Authority - Guides | Vault by HashiCorp</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="The PKI secrets engine generates dynamic X.509 certificates. With this secrets
engine, services can get certificates without going through the usual manual
process of generating a private key and CSR, submitting to a CA, and waiting
for a verification and signing process to complete. Vault&#x27;s built-in
authentication and authorization mechanisms provide the verification
functionality."/><meta property="og:site_name" content="Vault by HashiCorp"/><meta name="next-head-count" content="17"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/css/7246d51e322c1bb7fa92.css" as="style"/><link rel="stylesheet" href="/docs/vault_v1.8.x/_next/static/css/7246d51e322c1bb7fa92.css" data-n-g=""/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/css/fbe3b6b5804634e8fb99.css" as="style"/><link rel="stylesheet" href="/docs/vault_v1.8.x/_next/static/css/fbe3b6b5804634e8fb99.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/framework.3519294afa6a9ab53973.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/2bc72d9a08d5bd816ae6b580871df9fb671d43bb.52fd5ef7a8ab7d8fc0dd.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/9a5be27b89b50ff891e514a88cd42f143404f9a6.033857d62f5a01edf3b3.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/main-b0f1f3f8bd3bddd4e6cd.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/b49b08e2da573413c730dfc51ae423f080a0c275.00ac32ee45240d5b343f.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/b1542cc239bf56c8a14913c0a930efe682b5cf86.32bb900ad80311488529.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/pages/_app-d714c55ad24af91621ba.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/7dbdcaca29374b13a0799a901e26613767d72de2.d088888a4a1113f2bb24.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/92f0085e0e6c1f10382de10b8861ce89d7c192a2.e5495ede8461fc33ed98.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b.5052eda5c7f43583669b.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b_CSS.f6584926f1188e1b5b3e.js" as="script"/><link rel="preload" href="/docs/vault_v1.8.x/_next/static/chunks/pages/guides/%5B%5B...page%5D%5D-72f9db6e509b49c776de.js" as="script"/></head><body><div id="__next"><div class="g-alert-banner style_vault__1OYha show themed"><a href="https://hashiconf.com/europe" class="link"><span class="g-grid-container has-large-tag"><span class="tag g-type-body-small-x-strong">Thank you</span><span class="text g-type-body-small has-large-tag">HashiConf Europe is a wrap. Watch this yearâ€™s sessions on-demand.<!-- --> <span class="link-text g-type-body-small-x-strong">Watch Now</span></span></span></a><button class="close"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 5L5 15M5 5l10 10" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div><span class="visually-hidden">Dismiss alert</span></button></div><header class="hashi-stack-menu_hashiStackMenu__2dCgY"><nav class="hashi-stack-menu_nav__3DnqS g-grid-container" aria-label="Primary HashiCorp website navigation"><a aria-label="To main HashiCorp website" href="https://www.hashicorp.com/" class="hashi-stack-menu_logoLink__2cbDW"><div data-testid="root"><svg width="317" height="88" viewBox="0 0 317 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M107.692 64.421V47.4h-14.97v17.02h-7.623V24.06h7.622v16.602h14.971V24.06h7.622v40.36h-7.622zm35.567-.001h-6.053l-.548-1.996a16.137 16.137 0 01-8.789 2.607c-5.397 0-7.699-3.697-7.699-8.79 0-5.998 2.607-8.3 8.606-8.3h7.089v-3.095c0-3.27-.907-4.421-5.633-4.421a41.255 41.255 0 00-8.179.877l-.907-5.634a38.496 38.496 0 0110.122-1.395c9.269 0 11.998 3.27 11.998 10.672l-.007 19.476zm-7.394-11.151h-5.45c-2.424 0-3.087.663-3.087 2.912 0 2.058.663 2.973 2.972 2.973a11.629 11.629 0 005.572-1.525l-.007-4.36zm21.701 11.754a34.776 34.776 0 01-10.183-1.7l1.029-5.633a33.038 33.038 0 008.788 1.273c3.271 0 3.758-.762 3.758-2.973 0-1.814-.366-2.729-5.152-3.88-7.211-1.76-8.058-3.575-8.058-9.269 0-5.938 2.607-8.545 11.03-8.545 2.98.003 5.949.348 8.85 1.03l-.762 5.876a51.98 51.98 0 00-8.118-.846c-3.209 0-3.758.763-3.758 2.546 0 2.363.183 2.546 4.185 3.575 8.263 2.188 9.055 3.278 9.055 9.307 0 5.725-1.761 9.239-10.664 9.239zm32.663-.602V43.84c0-1.578-.663-2.363-2.363-2.363-1.814 0-5.031 1.09-7.699 2.485v20.459h-7.394V22.847l7.394-1.029v15.33a26.045 26.045 0 0110.786-2.852c4.909 0 6.662 3.453 6.662 8.728v21.397h-7.386zm12.844-33.692v-8.545h7.394v8.545h-7.394zm0 33.692V34.906h7.394v29.515h-7.394zM215.62 35.15c0-7.394 4.299-11.693 14.361-11.693 3.697 0 7.38.447 10.969 1.334l-.839 6.601a59.517 59.517 0 00-9.909-1.029c-5.275 0-6.967 1.822-6.967 6.098v15.512c0 4.3 1.7 6.098 6.967 6.098a59.506 59.506 0 009.909-1.029l.846 6.609a45.672 45.672 0 01-10.968 1.334c-10.062 0-14.361-4.3-14.361-11.693l-.008-18.142zm40.499 29.873c-10.123 0-12.844-5.572-12.844-11.632v-7.455c0-6.06 2.728-11.632 12.844-11.632 10.115 0 12.844 5.572 12.844 11.632v7.455c-.023 6.06-2.744 11.632-12.844 11.632zm0-24.392c-3.941 0-5.45 1.76-5.45 5.092v7.912c0 3.331 1.524 5.092 5.45 5.092 3.925 0 5.45-1.76 5.45-5.092v-7.943c-.015-3.33-1.532-5.092-5.45-5.092v.03zm32.457.457a57.835 57.835 0 00-7.821 4.3v19.056h-7.394V34.906h6.243l.488 3.27a33.064 33.064 0 017.76-3.88l.724 6.792zm28.035 13.515c0 6.548-2.911 10.42-9.756 10.42a40.76 40.76 0 01-7.882-.853v12.196l-7.394 1.029V34.906h5.877l.762 2.485a15.535 15.535 0 019.33-3.087c5.938 0 9.086 3.514 9.086 10.245l-.023 10.054zm-17.631 3.331c2.152.474 4.346.73 6.548.763 2.668 0 3.697-1.274 3.697-3.941V44.35c0-2.424-.907-3.758-3.636-3.758a10.46 10.46 0 00-6.609 2.668v14.673zM29.134 7L0 23.808v40.361l10.946 6.32V30.127l18.188-10.504V7z" fill="#000"/><path d="M40.758 7v32.144H29.133V27.147l-10.945 6.319V74.65l10.946 6.335V48.932h11.624v11.914l10.946-6.312V13.32L40.758 7z" fill="#000"/><path d="M40.758 81L69.89 64.192V23.831l-10.946-6.32v40.362L40.758 68.377V81z" fill="#000"/></svg></div></a><ul class="hashi-stack-menu_menu__33a9r"><li class="nav-item_navItem__KPnS0"><button type="button" class="nav-item_buttonReset__WeJA7 nav-item_link__1827H g-type-body-small-strong ">Browse Products<span class="nav-item_visuallyHidden__20aYI">Open this menu</span><img class="nav-item_dropdownCarat__2xha-" alt="" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iNyIgdmlld0JveD0iMCAwIDEwIDciIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTguMDUzIDJsLTMgMy4wMDYtMy0zLjAwNiIgc3Ryb2tlPSJ2YXIoLS1ncmF5LTMpIiBzdHJva2Utd2lkdGg9IjEuMjUiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiLz48L3N2Zz4="/></button><section class="browse-panel_browsePanel__1AT8q "><menu class="stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Infrastructure</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.terraform.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M55.522 32.97l32.96 19.02v38.06l-32.96-19.03V32.97zM92.09 51.99v38.06l32.95-19.03V32.97L92.09 51.99zM18.96 11.73v38.05l32.95 19.03V30.76L18.96 11.73zm36.562 101.51l32.95 19.03V94.22l-32.95-19.03v38.05z" fill="#7B42BC"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">terraform</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.packer.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M35.09 26.38L74.22 49v83.38l-39.13-22.62V26.38z" fill="#02A8EF"/><path d="M93.6 36.13L51.06 11.62v17L80 45.34v51.05l13.61 7.82c8.421 4.86 15.311 2 15.311-6.47V60.28c-.01-8.42-6.92-19.28-15.32-24.15z" fill="#02A8EF"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">packer</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.vagrantup.com" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M110.77 17.55L86.68 31.46V40L72 74.52 57.32 40v-8.54L33.23 17.55l-14.65 8.47v9.83l32.63 79.92 20.79 12 20.79-12 32.63-79.92v-9.83l-14.65-8.47z" fill="#0E67ED"/><path d="M125.42 26.02l-24.09 13.9v8.55L81.77 92.19 72 97.83v29.94l20.79-12 32.63-79.92v-9.83zM57.32 40v-8.54l-14.66 8.46v8.55l19.57 43.72L72 86.55V74.52L57.32 40z" fill="#0850C5"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vagrant</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Networking</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.consul.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72.53 128.7a54.787 54.787 0 01-45.258-23.85 54.784 54.784 0 019.368-72.355 54.78 54.78 0 0172.95 1.125l-13 13.6a36 36 0 100 53.43l13 13.6a54.638 54.638 0 01-37.06 14.45zm44.081-27.401a4.49 4.49 0 114.49-4.49 4.5 4.5 0 01-4.49 4.49z" fill="#E03875"/><path d="M72.18 85.79A11.87 11.87 0 1184 73.93a11.88 11.88 0 01-11.82 11.86zm49.58.21a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.495 4.495 0 012.772 4.148 4.503 4.503 0 01-4.49 4.49zm-13.35-.56a4.488 4.488 0 01-4.4-5.385 4.487 4.487 0 013.555-3.515 4.49 4.49 0 11.845 8.9zm13.35-14.57a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.496 4.496 0 012.772 4.149 4.503 4.503 0 01-4.49 4.49zm-13.35.51a4.493 4.493 0 01-4.148-2.772 4.491 4.491 0 114.148 2.771zm8.461-15.61a4.49 4.49 0 11-.02-8.981 4.49 4.49 0 01.02 8.981z" fill="#E03875"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">consul</span></a></li></ul></li></menu><menu class="stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Security</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.vaultproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.88 21.15L71.8 131.4l55.321-110.25H16.881zm61.46 22.12h6.39v6.4h-6.39v-6.4zM65.61 68.84h-6.39v-6.39h6.39v6.39zm0-9.59h-6.39v-6.39h6.39v6.39zm0-9.58h-6.39v-6.4h6.39v6.4zm9.59 28.76h-6.4V72h6.4v6.43zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.58h-6.4v-6.4h6.4v6.4zm3.14 3.19h6.39v6.39h-6.39v-6.39zm0 16v-6.41h6.39v6.39l-6.39.02z" fill="#000"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vault</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.boundaryproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M44.83 125.83v-8.27h17.18v-5.11h-8.33v-8.32h39.33L74.74 72.49l18.27-31.65H52.7v43.89H31V19.15h74.67l12.46 21.58L99.8 72.49l18.7 32.4-12.09 20.94H44.83z" fill="#F24C53"/><path d="M48.17 104.131h-8.32v8.32h8.32v-8.32zM39.32 117.5H31v8.32h8.32v-8.32z" fill="#F24C53"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">boundary</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Applications</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://www.nomadproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72 14L21.77 43v58L72 130l50.23-29V43L72 14zm22.38 63.78L81 85.51l-16.17-8.8v18.48l-15.2 9.64V66.19l12.06-7.38 16.73 8.82V48.76l16-9.59-.04 38.61z" fill="#00CA8E"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">nomad</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://www.waypointproject.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M143.228 27.66l-17.79 30.81-17.79-30.81h35.58zM48.26 48.23H36.39l29.67 51.4-11.87 20.56L.77 27.66h59.36l29.68 51.41 5.93-10.28L72 27.66h23.74l11.88 20.57 11.87 20.56-29.68 51.4-41.55-71.96z" fill="#14C6CB"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">waypoint</span></a></li></ul></li></menu><menu class="stack-menu-section_stackMenuSectionPlusDivider__1BPy6 stack-menu-section_stackMenuSection__2j2KK"><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">HashiCorp Cloud Platform</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a href="https://cloud.hashicorp.com/" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M72.53 128.7a54.787 54.787 0 01-45.258-23.85 54.784 54.784 0 019.368-72.355 54.78 54.78 0 0172.95 1.125l-13 13.6a36 36 0 100 53.43l13 13.6a54.638 54.638 0 01-37.06 14.45zm44.081-27.401a4.49 4.49 0 114.49-4.49 4.5 4.5 0 01-4.49 4.49z" fill="#E03875"/><path d="M72.18 85.79A11.87 11.87 0 1184 73.93a11.88 11.88 0 01-11.82 11.86zm49.58.21a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.495 4.495 0 012.772 4.148 4.503 4.503 0 01-4.49 4.49zm-13.35-.56a4.488 4.488 0 01-4.4-5.385 4.487 4.487 0 013.555-3.515 4.49 4.49 0 11.845 8.9zm13.35-14.57a4.488 4.488 0 01-4.404-5.366 4.488 4.488 0 016.122-3.273 4.496 4.496 0 012.772 4.149 4.503 4.503 0 01-4.49 4.49zm-13.35.51a4.493 4.493 0 01-4.148-2.772 4.491 4.491 0 114.148 2.771zm8.461-15.61a4.49 4.49 0 11-.02-8.981 4.49 4.49 0 01.02 8.981z" fill="#E03875"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">consul</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://app.terraform.io" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M55.522 32.97l32.96 19.02v38.06l-32.96-19.03V32.97zM92.09 51.99v38.06l32.95-19.03V32.97L92.09 51.99zM18.96 11.73v38.05l32.95 19.03V30.76L18.96 11.73zm36.562 101.51l32.95 19.03V94.22l-32.95-19.03v38.05z" fill="#7B42BC"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">terraform</span></a></li><li class="stack-item_stackItem__L41b6"><a href="https://cloud.hashicorp.com/" class="stack-item_itemLink__G2Qmk"><div data-testid="root" class="stack-item_productIcon__1pF_i"><svg width="144" height="144" viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.88 21.15L71.8 131.4l55.321-110.25H16.881zm61.46 22.12h6.39v6.4h-6.39v-6.4zM65.61 68.84h-6.39v-6.39h6.39v6.39zm0-9.59h-6.39v-6.39h6.39v6.39zm0-9.58h-6.39v-6.4h6.39v6.4zm9.59 28.76h-6.4V72h6.4v6.43zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.59h-6.4v-6.39h6.4v6.39zm0-9.58h-6.4v-6.4h6.4v6.4zm3.14 3.19h6.39v6.39h-6.39v-6.39zm0 16v-6.41h6.39v6.39l-6.39.02z" fill="#000"/></svg></div><span class="stack-item_productName__1lhye stack-item_itemName__1cUxR g-type-body-small-strong">vault</span></a></li></ul></li><li class="stack-group_stackGroup__SM4W1"><h5 class="stack-group_stackGroupHeading__U-K-0 g-type-display-6">Partner Services</h5><ul class="stack-group_stackGroupLinkList__4RMZ6"><li class="stack-item_stackItem__L41b6"><a class="stack-item_itemLink__G2Qmk" href="https://www.hashicorp.com/products/consul/service-on-azure"><span class="stack-item_itemName__1cUxR g-type-body-small-strong">HashiCorp Consul Service (HCS) on Azure</span></a></li></ul></li></menu></section></li></ul></nav></header><nav class="g-subnav" aria-label="vault website navigation"><div class="constrain-width-wrapper  g-grid-container"><div class="g-subnav-inner style_vault__1OYha is-constrained" data-overflow-target="true"><a href="/" data-testid="a-raw" class="title-link brand-vault " title="vault"><div data-testid="root"><svg width="208" height="88" viewBox="0 0 208 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M114.849 23.69h7.92L110.699 64h-11.25l-12-40.28h7.92l9.74 33.57 9.74-33.6zM144.75 64h-6l-.55-2a16.12 16.12 0 01-8.77 2.6c-5.38 0-7.68-3.69-7.68-8.77 0-6 2.6-8.29 8.59-8.29h7.08v-3.1c0-3.27-.91-4.42-5.63-4.42a40.71 40.71 0 00-8.16.91l-.91-5.63a38.678 38.678 0 0110.1-1.39c9.25 0 12 3.27 12 10.65L144.75 64zm-7.37-11.13h-5.45c-2.42 0-3.08.67-3.08 2.91 0 2 .66 3 3 3a11.72 11.72 0 005.57-1.51l-.04-4.4zm18.992-18.35v20.56c0 1.57.66 2.36 2.36 2.36 1.7 0 5-1.09 7.68-2.48V34.52h7.38V64h-5.63l-.72-2.48a29.437 29.437 0 01-11.8 3.09c-4.9 0-6.65-3.45-6.65-8.71V34.52h7.38zM177.719 64V22.48l7.38-1V64h-7.38zm29.388-.57a20.618 20.618 0 01-6.47 1.15c-5.38 0-8.11-2.54-8.11-7.8v-16.4h-4.41v-5.86h4.41V27.2l7.38-1v8.35h7.56l-.48 5.86h-7.08v15.4a2.323 2.323 0 001.596 2.514c.344.11.708.14 1.064.085a13.919 13.919 0 003.69-.61l.85 5.63zM0 12.6l31.85 63.92L63.92 12.6H0zm35.63 12.83h3.71v3.71h-3.71v-3.71zm-7.38 14.82h-3.7v-3.7h3.7v3.7zm0-5.56h-3.7V31h3.7v3.69zm0-5.55h-3.7v-3.71h3.7v3.71zm5.6 16.67h-3.7V42.1h3.7v3.71zm0-5.56h-3.7v-3.7h3.7v3.7zm0-5.56h-3.7V31h3.7v3.69zm0-5.55h-3.7v-3.71h3.7v3.71zM35.63 31h3.71v3.7h-3.71V31zm0 9.26v-3.7h3.71v3.7h-3.71z" fill="#000"/></svg></div></a><ul class="menu-items-default menu-items-align-right"><li><a href="/" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Overview</span></a></li><li><button class="dropdown-trigger g-type-body-small-strong brand-vault style-menu-item is-collapsed"><span class="text brand-vault">Use Cases</span><div data-testid="root"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 9l6 6 6-6" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></button><ul class="submenu-modal style-dropdown is-collapsed"><li><a href="/use-cases/secrets-management" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Secrets Management</span></a></li><li><a href="/use-cases/data-encryption" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Data Encryption</span></a></li><li><a href="/use-cases/identity-based-access" data-testid="a-raw" class="g-type-body-small-strong style-menu-item"><span class="text brand-vault">Identity-based Access</span></a></li></ul></li><li><a href="https://www.hashicorp.com/products/vault/enterprise" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Enterprise</span></a></li><li><span class="vertical-divider"></span></li><li><a href="https://learn.hashicorp.com/vault" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Tutorials</span></a></li><li><a href="/docs" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Docs</span></a></li><li><a href="/api-docs" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">API</span></a></li><li><a href="/community" data-testid="a-raw" class="nav-link g-type-body-small-strong style-menu-item "><span class="text brand-vault ">Community</span></a></li></ul><div class="cta-links "><a href="https://www.github.com/hashicorp/vault" class="github-button"><span class="github"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg><span class="hidden-text">GitHub</span></span></a><a class="g-btn size-small variant-secondary style_vault__1OYha background-light" data-ga-button="try-cloud" href="https://portal.cloud.hashicorp.com/sign-up?utm_source=vault_io&amp;utm_content=top_nav_vault"><span class="text g-type-buttons-and-standalone-links">Try Cloud</span></a><a class="g-btn size-small variant-primary style_vault__1OYha background-light" data-ga-button="download" href="/downloads"><span class="icon at-left is-animated" data-animation="download"><div data-testid="root"><svg role="img" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Download icon</title><path d="M3 17v3a2 2 0 002 2h14a2 2 0 002-2v-3" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path data-animation-target="true" d="M8 12l4 4m0 0l4-4m-4 4V2" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></span><span class="text g-type-buttons-and-standalone-links">Download</span></a></div></div></div></nav><div id="p-docs"><div class="content-wrap g-grid-container"><div id="sidebar" role="complementary"><div class="nav docs-nav"><div class="g-docs-sidenav style_root__-H22M style_vault__1OYha"><button class="style_mobileMenuToggle__2iMJX g-type-body-small-strong"><span><div><svg width="20" height="20" fill="none"><path fill="#000" fill-rule="evenodd" d="M3.083 14.411a.847.847 0 00-.267-.183.863.863 0 00-.483-.042c-.05.008-.109.025-.159.042a1.245 1.245 0 00-.266.183 1.01 1.01 0 00-.184.267.864.864 0 00-.058.325c0 .05 0 .108.017.158a.88.88 0 00.041.159c.025.05.05.1.084.141.025.05.066.092.1.125.041.042.082.075.125.108.05.025.091.059.141.075.05.017.109.034.159.05.058.009.107.017.166.017a.829.829 0 00.584-.25.534.534 0 00.108-.125c.025-.042.058-.091.075-.142.025-.05.042-.1.05-.158a1.06 1.06 0 00.017-.158.872.872 0 00-.067-.325.729.729 0 00-.183-.267zm0-5a.846.846 0 00-.267-.183.863.863 0 00-.483-.042 1.11 1.11 0 00-.159.042 1.252 1.252 0 00-.266.183.821.821 0 00-.242.592c0 .108.017.216.058.316a1.01 1.01 0 00.309.375c.05.025.091.05.141.075.05.017.109.034.159.05.058.009.107.017.166.017a.829.829 0 00.584-.25.83.83 0 00.25-.583.871.871 0 00-.067-.325.729.729 0 00-.183-.267zm0-5a.795.795 0 00-.75-.225 1.11 1.11 0 00-.159.042 1.255 1.255 0 00-.266.183.835.835 0 00-.242.592c0 .108.017.217.058.317a1.01 1.01 0 00.309.375c.05.025.091.05.141.075.05.016.109.033.159.05.058.008.107.016.166.016a.83.83 0 00.584-.25.83.83 0 00.25-.583.906.906 0 00-.067-.325.729.729 0 00-.183-.267zm14.414 9.756H6.663a.833.833 0 100 1.667h10.834a.833.833 0 100-1.667zm0-5H6.663a.833.833 0 100 1.667h10.834a.833.833 0 100-1.667zM18.33 5c0 .46-.372.834-.833.834H6.663a.833.833 0 110-1.667h10.834c.46 0 .833.372.833.833z" clip-rule="evenodd"/></svg></div> Documentation Menu</span></button><button type="button" aria-label="Show Search Bar" class="style_searchToggle__226HK"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M8.75 15a6.25 6.25 0 100-12.5 6.25 6.25 0 000 12.5z" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.5 17.5l-4.333-4.333" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div></button><ul class="style_rootList__1pfEP" data-is-mobile-hidden="true" data-is-mobile-open="false"><button class="style_mobileClose__3BcsD">Ã—</button><input class="style_filterInput__4ecGq" placeholder="Filter..." value=""/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/getting-started/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Getting Started</span></a></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Vault Operations</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/reference-architecture/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Reference Architecture</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/vault-ha-consul/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault HA with Consul</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/production/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Production Hardening</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/generate-root/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Root Token Generation</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/rekeying-and-rotating/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Rekeying & Rotating</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/plugin-backends/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Building Plugin Backends</span></a></li><hr class="style_divider__3H9xA"/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/replication/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Replication Setup & Guidance</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/disaster-recovery/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Disaster Recovery Setup</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/mount-filter/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Mount Filter</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/multi-tenant/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Multi-Tenant: Namespaces</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/autounseal-aws-kms/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Auto-unseal with AWS KMS</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/seal-wrap/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Seal Wrap / FIPS 140-2</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/monitoring/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Cluster Monitoring</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/deployment-guide/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Vault Deployment Guide</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/operations/performance-nodes/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Performance Standby Nodes</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Identity and Access Management</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/secure-intro/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Secure Introduction of Vault Clients</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/policies/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Policies</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/policy-templating/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>ACL Policy Path Templating</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/authentication/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>AppRole Pull Authentication</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/approle-trusted-entities/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>AppRole with Terraform and Chef</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/lease/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Tokens and Leases</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/identity/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Identity - Entities & Groups</span></a></li><hr class="style_divider__3H9xA"/><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/sentinel/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Sentinel Policies</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/identity/control-groups/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Control Groups</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Secrets Management</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/static-secrets/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Static Secrets</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/versioned-kv/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Versioned KV Secret Engine</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/dynamic-secrets/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Secret as a Service</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/db-root-rotation/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>DB Root Credential Rotation</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/cubbyhole/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Cubbyhole Response Wrapping</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/ssh-otp/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>One-Time SSH Password</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/pki-engine/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Build Your Own CA</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/secret-mgmt/app-integration/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Direct Application Integration</span></a></li></ul></li><li class=""><button class="style_navItem__1tCRc" data-is-open="false"><div class="style_navBranchIcon__-utfM style_navItemIcon__1KWKp" data-is-open="false"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.865.661a.498.498 0 10-.704.703l2.636 2.638L2.16 6.639a.498.498 0 10.704.704l2.989-2.989a.498.498 0 000-.705L2.864.66v.001z" fill="#000"/></svg></div><span>Encryption as a Service</span></button><ul class="style_navBranchSubnav__38wnh" data-is-open="false"><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Overview</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/transit/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Encryption as a Service</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/spring-demo/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Java Application Demo</span></a></li><li class=""><a class="style_navItem__1tCRc" href="/docs/vault_v1.8.x/guides/encryption/transit-rewrap/"><div class="style_navLeafIcon__49SuP style_navItemIcon__1KWKp"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="2" fill="#000"/></svg></div><span>Transit Secrets Re-wrapping</span></a></li></ul></li></ul></div></div></div><div id="inner" role="main" class=""><article class="g-content g-type-long-body style_vault__1OYha"><div class="g-search"><label id="search-box-label" for="search-box" class="visually-hidden">Search Vault documentation</label><div class="c-search-box"><form novalidate="" action="" role="search"><input type="search" id="search-box" class="g-type-body-strong" placeholder="Search Vault documentation" autoComplete="off" autoCorrect="off" autoCapitalize="off" spellcheck="false" maxLength="512" required="" value="" aria-autocomplete="list" aria-controls="search-results" aria-activedescendant="" data-heap-track="SearchBox"/><button type="submit" title="Submit your search query." class="btn-submit"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M8.75 15a6.25 6.25 0 100-12.5 6.25 6.25 0 000 12.5z" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M17.5 17.5l-4.333-4.333" stroke="var(--gray-3)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button><button type="reset" title="Clear the search query." class="btn-reset"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.915 1.077h13.684v13.684H1.915z"/><path d="M1.915 1.077l13.683 13.684M1.915 14.76L15.598 1.078" stroke="var(--gray-3)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button><div class="icon-loading"><svg width="18" height="18" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#444"><g fill="none" fill-rule="evenodd"><g transform="translate(1 1)" stroke-width="2"><circle stroke-opacity=".5" cx="18" cy="18" r="18"></circle><path d="M36 18c0-9.94-8.06-18-18-18" transform="rotate(296.263 18 18)"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="1s" repeatCount="indefinite"></animateTransform></path></g></g></svg></div><svg class="icon-slash" width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img"><title>Type &#x27;/&#x27; to Search</title><rect x=".5" y=".5" width="23" height="23" rx=".5" stroke="var(--gray-3)"></rect><path d="M9 18l6-12" stroke="var(--gray-3)" stroke-width="1.5"></path></svg></form></div></div><h1 class="g-type-display-2"><a class="__permalink-h" href="#build-your-own-certificate-authority-ca" aria-label="build your own certificate authority ca permalink">Â»</a><a class="__target-h" id="build-your-own-certificate-authority-ca" aria-hidden=""></a>Build Your Own Certificate Authority (CA)</h1><p class="g-type-long-body">Vault&#x27;s PKI secrets engine can dynamically generate X.509 certificates on
demand. This allows services to acquire certificates without going through the
usual manual process of generating a private key and Certificates Signing
Request (CSR), submitting to a CA, and then wait for the verification and
signing process to complete.</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#reference-material" aria-label="reference material permalink">Â»</a><a class="__target-h" id="reference-material" aria-hidden=""></a>Reference Material</h2><ul><li class="g-type-long-body"><a href="/docs/secrets/pki">PKI (Certificates) Secrets Engine</a></li><li class="g-type-long-body"><a href="/api/secret/pki">PKI Secrets Engine (API)</a></li><li class="g-type-long-body"><a href="https://tools.ietf.org/html/rfc5280">RFC 5280 Internet X.509 Public Key Infrastructure Certificate and Certificate
Revocation List (CRL) Profile</a></li><li class="g-type-long-body"><a href="https://www.openssl.org/docs/man1.1.0/apps/x509.html">OpenSSL x509 Man Pages</a></li></ul><h2 class="g-type-display-3"><a class="__permalink-h" href="#estimated-time-to-complete" aria-label="estimated time to complete permalink">Â»</a><a class="__target-h" id="estimated-time-to-complete" aria-hidden=""></a>Estimated Time to Complete</h2><p class="g-type-long-body">15 minutes</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#personas" aria-label="personas permalink">Â»</a><a class="__target-h" id="personas" aria-hidden=""></a>Personas</h2><p class="g-type-long-body">The steps described in this guide are typically performed by <strong>security
engineer</strong>.</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#challenge" aria-label="challenge permalink">Â»</a><a class="__target-h" id="challenge" aria-hidden=""></a>Challenge</h2><p class="g-type-long-body">Organizations should protect their website; however, the Traditional PKI process
workflow takes a long time which motivates organizations to create certificates
which do not expire for a year or more.</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#solution" aria-label="solution permalink">Â»</a><a class="__target-h" id="solution" aria-hidden=""></a>Solution</h2><p class="g-type-long-body">Use Vault to create X509 certificates for usage in MTLS or other arbitrary PKI
encryption. While this can be used to create web server certificates. If
users do not import the CA chains, the browser will complain about self-signed
certificates.</p><p class="g-type-long-body">Creating PKI certificates is generally a cumbersome process using traditional
tools like <code>openssl</code> or even more advanced frameworks like CFSSL. These tools
also require a human component to verify certificate distribution meets
organizational security policies.</p><p class="g-type-long-body">Vault PKI secrets engine makes this a lot simpler. The PKI secrets engine can
be an Intermediate-Only certificate authority which potentially allows for
higher levels of security.</p><ol><li class="g-type-long-body">Store CA outside the Vault (air gapped)</li><li class="g-type-long-body">Create CSRs for the intermediates</li><li class="g-type-long-body">Sign CSR outside Vault and import intermediate</li><li class="g-type-long-body">Issue leaf certificates from the Intermediate CA</li></ol><h2 class="g-type-display-3"><a class="__permalink-h" href="#prerequisites" aria-label="prerequisites permalink">Â»</a><a class="__target-h" id="prerequisites" aria-hidden=""></a>Prerequisites</h2><p class="g-type-long-body">To perform the tasks described in this guide, you need to have a Vault
environment. Refer to the <a href="/intro/getting-started/install">Getting
Started</a> guide to install Vault.</p><p class="g-type-long-body">Alternatively, you can use the <a href="https://www.katacoda.com/hashicorp/scenarios/vault-playground">Vault
Playground</a>
environment.</p><h3 class="g-type-display-4"><a class="__permalink-h" href="#policy" aria-label="policy requirements permalink">Â»</a><a class="__target-h __compat" id="policy" aria-hidden=""></a><a class="__target-h" id="policy-requirements" aria-hidden=""></a>Policy requirements</h3><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> For the purpose of this guide, you can use <strong><code>root</code></strong> token to work
with Vault. However, it is recommended that root tokens are only used for just
enough initial setup or in emergencies. As a best practice, use tokens with
appropriate set of policies based on your role in the organization.</p></div><p class="g-type-long-body">To perform all tasks demonstrated in this guide, your policy must include the
following permissions:</p><div class="g-code-block style_root__3eDLf language-shell style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token comment"># Enable secrets engine</span>
<!-- -->path <span class="token string">&quot;sys/mounts/*&quot;</span> <span class="token punctuation">{</span>
<!-- -->  capabilities <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;create&quot;</span>, <span class="token string">&quot;read&quot;</span>, <span class="token string">&quot;update&quot;</span>, <span class="token string">&quot;delete&quot;</span>, <span class="token string">&quot;list&quot;</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<!-- -->
<span class="token comment"># List enabled secrets engine</span>
<!-- -->path <span class="token string">&quot;sys/mounts&quot;</span> <span class="token punctuation">{</span>
<!-- -->  capabilities <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;read&quot;</span>, <span class="token string">&quot;list&quot;</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<!-- -->
<span class="token comment"># Work with pki secrets engine</span>
<!-- -->path <span class="token string">&quot;pki*&quot;</span> <span class="token punctuation">{</span>
<!-- -->  capabilities <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;create&quot;</span>, <span class="token string">&quot;read&quot;</span>, <span class="token string">&quot;update&quot;</span>, <span class="token string">&quot;delete&quot;</span>, <span class="token string">&quot;list&quot;</span>, <span class="token string">&quot;sudo&quot;</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell"><code class="style_code__2AMYw language-shell"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Enable secrets engine</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">path <span class="token string">&quot;sys/mounts/*&quot;</span> <span class="token punctuation">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  capabilities <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;create&quot;</span>, <span class="token string">&quot;read&quot;</span>, <span class="token string">&quot;update&quot;</span>, <span class="token string">&quot;delete&quot;</span>, <span class="token string">&quot;list&quot;</span> <span class="token punctuation">]</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">}</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># List enabled secrets engine</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">path <span class="token string">&quot;sys/mounts&quot;</span> <span class="token punctuation">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  capabilities <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;read&quot;</span>, <span class="token string">&quot;list&quot;</span> <span class="token punctuation">]</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">}</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Work with pki secrets engine</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">path <span class="token string">&quot;pki*&quot;</span> <span class="token punctuation">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  capabilities <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;create&quot;</span>, <span class="token string">&quot;read&quot;</span>, <span class="token string">&quot;update&quot;</span>, <span class="token string">&quot;delete&quot;</span>, <span class="token string">&quot;list&quot;</span>, <span class="token string">&quot;sudo&quot;</span> <span class="token punctuation">]</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token punctuation">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">If you are not familiar with policies, complete the
<a href="/guides/identity/policies">policies</a> guide.</p><h2 class="g-type-display-3"><a class="__permalink-h" href="#steps" aria-label="steps permalink">Â»</a><a class="__target-h" id="steps" aria-hidden=""></a>Steps</h2><p class="g-type-long-body">In this guide, you are going to first generate a self-signed root certificate.
Then you are going to generate an intermediate certificate which is signed by
the root. Finally, you are going to generate a certificate for
<code>test.example.com</code> domain.</p><p class="g-type-long-body"><img src="/img/vault-pki-4.png" alt="Overview"/></p><p class="g-type-long-body">In this guide, you perform the following:</p><ol><li class="g-type-long-body"><a href="#step1">Generate Root CA</a></li><li class="g-type-long-body"><a href="#step2">Generate Intermediate CA</a></li><li class="g-type-long-body"><a href="#step3">Create a Role</a></li><li class="g-type-long-body"><a href="#step4">Request Certificates</a></li><li class="g-type-long-body"><a href="#step5">Revoke Certificates</a></li><li class="g-type-long-body"><a href="#step6">Remove Expired Certificates</a></li></ol><h3 class="g-type-display-4"><a class="__permalink-h" href="#step1" aria-label="step 1 generate root ca permalink">Â»</a><a class="__target-h __compat" id="step1" aria-hidden=""></a><a class="__target-h" id="step-1-generate-root-ca" aria-hidden=""></a>Step 1: Generate Root CA</h3><p class="g-type-long-body">In this step, you are going to generate a self-signed root certificate using
PKI secrets engine.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command" aria-label="cli command permalink">Â»</a><a class="__target-h" id="cli-command" aria-hidden=""></a>CLI command</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">First, enable the <code>pki</code> secrets engine at <code>pki</code> path:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault secrets enable pki<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault secrets enable pki</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Tune the <code>pki</code> secrets engine to issue certificates with a maximum time-to-live (TTL) of 87600 hours.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault secrets tune -max-lease-ttl=87600h pki<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault secrets tune -max-lease-ttl=87600h pki</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Generate the <strong><em>root</em></strong> certificate and save the certificate in <code>CA_cert.crt</code>.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault write -field=certificate pki/root/generate/internal common_name=&quot;example.com&quot; \<!-- -->
<!-- -->        ttl=87600h &gt; CA_cert.crt<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault write -field=certificate pki/root/generate/internal common_name=&quot;example.com&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        ttl=87600h &gt; CA_cert.crt</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">This generates a new self-signed CA certificate and private key. Vault will
<em>automatically</em> revoke the generated root at the end of its lease period
(TTL); the CA certificate will sign its own Certificate Revocation List
(CRL).</p></li><li class="g-type-long-body"><p class="g-type-long-body">Configure the CA and CRL URLs:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault write pki/config/urls \<!-- -->
<!-- -->        issuing_certificates=&quot;http://127.0.0.1:8200/v1/pki/ca&quot; \<!-- -->
<!-- -->        crl_distribution_points=&quot;http://127.0.0.1:8200/v1/pki/crl&quot;<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault write pki/config/urls \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        issuing_certificates=&quot;http://127.0.0.1:8200/v1/pki/ca&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        crl_distribution_points=&quot;http://127.0.0.1:8200/v1/pki/crl&quot;</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl" aria-label="api call using curl permalink">Â»</a><a class="__target-h" id="api-call-using-curl" aria-hidden=""></a>API call using cURL</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">First, enable the <code>pki</code> secrets engine at <code>pki</code> path using <code>/sys/mounts</code> endpoint:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ curl --header &quot;X-Vault-Token: &lt;TOKEN&gt;&quot; \<!-- -->
<!-- -->       --request POST \<!-- -->
<!-- -->       --data &lt;PARAMETERS&gt; \<!-- -->
<!-- -->       &lt;VAULT_ADDRESS&gt;/v1/sys/mounts/&lt;PATH&gt;<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: &lt;TOKEN&gt;&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --data &lt;PARAMETERS&gt; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       &lt;VAULT_ADDRESS&gt;/v1/sys/mounts/&lt;PATH&gt;</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Where <code>&lt;TOKEN&gt;</code> is your valid token, and <code>&lt;PARAMETERS&gt;</code> holds <a href="/api/system/mounts#enable-secrets-engine">configuration
parameters</a> of the secret engine.</p><p class="g-type-long-body"><strong>Example:</strong></p><p class="g-type-long-body">The following example mounts <code>pki</code> secret engine.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->       --request POST \<!-- -->
<!-- -->       --data &#x27;{&quot;type&quot;:&quot;pki&quot;}&#x27; \<!-- -->
<!-- -->       https://127.0.0.1:8200/v1/sys/mounts/pki<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --data &#x27;{&quot;type&quot;:&quot;pki&quot;}&#x27; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       https://127.0.0.1:8200/v1/sys/mounts/pki</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Tune the <code>pki</code> secrets engine to issue certificates with a maximum
time-to-live (TTL) of 87600 hours.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->        --request POST \<!-- -->
<!-- -->        --data &#x27;{&quot;max_lease_ttl&quot;:&quot;87600h&quot;}&#x27; \<!-- -->
<!-- -->        https://127.0.0.1:8200/v1/sys/mounts/pki/tune<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --data &#x27;{&quot;max_lease_ttl&quot;:&quot;87600h&quot;}&#x27; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        https://127.0.0.1:8200/v1/sys/mounts/pki/tune</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Generate the <strong><em>root</em></strong> certificate and extract the CA certificate and save
it as <code>CA_cert.crt</code>.</p><blockquote><p class="g-type-long-body"><strong>NOTE:</strong> The following command uses <code>jq</code> tool to parse the output JSON.
You can install <a href="https://stedolan.github.io/jq/download/"><code>jq</code></a> or manually
copy and paste the certificate in a file, <code>CA_cert.crt</code>.</p></blockquote><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;common_name&quot;: &quot;example.com&quot;,<!-- -->
<!-- -->  &quot;ttl&quot;: &quot;87600h&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->        --request POST \<!-- -->
<!-- -->        --data @payload.json \<!-- -->
<!-- -->        https://127.0.0.1:8200/v1/pki/root/generate/internal \<!-- -->
<!-- -->        | jq -r &quot;.data.certificate&quot; &gt; CA_cert.crt<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;common_name&quot;: &quot;example.com&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;ttl&quot;: &quot;87600h&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --data @payload.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        https://127.0.0.1:8200/v1/pki/root/generate/internal \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        | jq -r &quot;.data.certificate&quot; &gt; CA_cert.crt</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">This generates a new self-signed CA certificate and private key. Vault will
<em>automatically</em> revoke the generated root at the end of its lease period
(TTL); the CA certificate will sign its own Certificate Revocation List
(CRL).</p></li><li class="g-type-long-body"><p class="g-type-long-body">Configure the CA and CRL URLs:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload-url.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;issuing_certificates&quot;: &quot;http://127.0.0.1:8200/v1/pki/ca&quot;,<!-- -->
<!-- -->  &quot;crl_distribution_points&quot;: &quot;http://127.0.0.1:8200/v1/pki/crl&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->       --request POST \<!-- -->
<!-- -->       --data @payload-url.json \<!-- -->
<!-- -->       https://127.0.0.1:8200/v1/pki/config/urls<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload-url.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;issuing_certificates&quot;: &quot;http://127.0.0.1:8200/v1/pki/ca&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;crl_distribution_points&quot;: &quot;http://127.0.0.1:8200/v1/pki/crl&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --data @payload-url.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       https://127.0.0.1:8200/v1/pki/config/urls</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui" aria-label="web ui permalink">Â»</a><a class="__target-h" id="web-ui" aria-hidden=""></a>Web UI</h4><p class="g-type-long-body">Open a web browser and launch the Vault UI (e.g. <a href="http://127.0.0.1:8200/ui">http://127.0.0.1:8200/ui</a>) and
then login.</p><ol><li class="g-type-long-body">Select <strong>Enable new engine</strong>.</li><li class="g-type-long-body">Select <strong>PKI</strong> from the <strong>Secrets engine type</strong> drop-down list.</li><li class="g-type-long-body">Click <strong>More options</strong> to expand and set the <strong>Maximum lease TTL</strong> to <strong><code>87600 hours</code></strong>.</li><li class="g-type-long-body">Click <strong>Enable Engine</strong>.</li><li class="g-type-long-body">Select <strong>Configure</strong>.</li><li class="g-type-long-body">Click <strong>Configure CA</strong>.</li><li class="g-type-long-body">Leave <strong>CA Type</strong> as <strong>root</strong>, and <strong>Type</strong> to be <strong>internal</strong>. Enter
<strong><code>example.com</code></strong> in the <strong>Common Name</strong> field.</li><li class="g-type-long-body">Select <strong>Options</strong> and then set <strong>TTL</strong> field to be <strong>87600 hours</strong>.</li><li class="g-type-long-body">Click <strong>Save</strong>.</li><li class="g-type-long-body">Click <strong>Copy Certificate</strong> and save it in a file named, <strong><code>CA_cert.crt</code></strong>.</li><li class="g-type-long-body">Click the <strong>URLs</strong> tab, and then set:<ul><li class="g-type-long-body">Issuing certificates: <code>http://127.0.0.1:8200/v1/pki/ca</code></li><li class="g-type-long-body">CRL Distribution Points: <code>http://127.0.0.1:8200/v1/pki/crl</code><img src="/img/vault-pki-1.png" alt="Configure URL"/></li></ul></li><li class="g-type-long-body">Click <strong>Save</strong>.</li></ol><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> To examine the generated root certificate, you can use
<a href="https://www.openssl.org/source/">OpenSSL</a>.</p></div><div class="g-code-block style_root__3eDLf language-shell style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token comment"># Print the certificate in text form</span>
<!-- -->$ openssl x509 -in CA_cert.crt -text<!-- -->
<!-- -->
<span class="token comment"># Print the validity dates</span>
<!-- -->$ openssl x509 -in CA_cert.crt -noout -dates<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell"><code class="style_code__2AMYw language-shell"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Print the certificate in text form</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ openssl x509 -in CA_cert.crt -text</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token comment"># Print the validity dates</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ openssl x509 -in CA_cert.crt -noout -dates</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h3 class="g-type-display-4"><a class="__permalink-h" href="#step2" aria-label="step 2 generate intermediate ca permalink">Â»</a><a class="__target-h __compat" id="step2" aria-hidden=""></a><a class="__target-h" id="step-2-generate-intermediate-ca" aria-hidden=""></a>Step 2: Generate Intermediate CA</h3><p class="g-type-long-body">Now, you are going to create an intermediate CA using the root CA you regenerate
in the previous step.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command-1" aria-label="cli command permalink">Â»</a><a class="__target-h" id="cli-command-1" aria-hidden=""></a>CLI Command</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">First, enable the <code>pki</code> secrets engine at <strong><code>pki_int</code></strong> path:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault secrets enable -path=pki_int pki<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault secrets enable -path=pki_int pki</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Tune the <code>pki_int</code> secrets engine to issue certificates with a maximum
time-to-live (TTL) of 43800 hours.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault secrets tune -max-lease-ttl=43800h pki_int<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault secrets tune -max-lease-ttl=43800h pki_int</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Execute the following command to generate an intermediate and save the CSR as
<code>pki_intermediate.csr</code>:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault write -format=json pki_int/intermediate/generate/internal \<!-- -->
<!-- -->        common_name=&quot;example.com Intermediate Authority&quot; ttl=&quot;43800h&quot; \<!-- -->
<!-- -->        | jq -r &#x27;.data.csr&#x27; &gt; pki_intermediate.csr<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault write -format=json pki_int/intermediate/generate/internal \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        common_name=&quot;example.com Intermediate Authority&quot; ttl=&quot;43800h&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        | jq -r &#x27;.data.csr&#x27; &gt; pki_intermediate.csr</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Sign the intermediate certificate with the root certificate and save the
generated certificate as <code>intermediate.cert.pem</code>:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault write -format=json pki/root/sign-intermediate csr=@pki_intermediate.csr \<!-- -->
<!-- -->        format=pem_bundle ttl=&quot;43800h&quot; \<!-- -->
<!-- -->        | jq -r &#x27;.data.certificate&#x27; &gt; intermediate.cert.pem<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault write -format=json pki/root/sign-intermediate csr=@pki_intermediate.csr \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        format=pem_bundle ttl=&quot;43800h&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        | jq -r &#x27;.data.certificate&#x27; &gt; intermediate.cert.pem</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Once the CSR is signed and the root CA returns a certificate, it can be
imported back into Vault:</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ vault write pki_int/intermediate/set-signed certificate=@intermediate.cert.pem<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ vault write pki_int/intermediate/set-signed certificate=@intermediate.cert.pem</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl-1" aria-label="api call using curl permalink">Â»</a><a class="__target-h" id="api-call-using-curl-1" aria-hidden=""></a>API call using cURL</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">First, enable the <code>pki</code> secrets engine at <strong><code>pki_int</code></strong> path:</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->       --request POST \<!-- -->
<!-- -->       --data &#x27;{&quot;type&quot;:&quot;pki&quot;}&#x27; \<!-- -->
<!-- -->       https://127.0.0.1:8200/v1/sys/mounts/pki_int<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       --data &#x27;{&quot;type&quot;:&quot;pki&quot;}&#x27; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">       https://127.0.0.1:8200/v1/sys/mounts/pki_int</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Tune the <code>pki_int</code> secrets engine to issue certificates with a maximum
time-to-live (TTL) of 43800 hours.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->        --request POST \<!-- -->
<!-- -->        --data &#x27;{&quot;max_lease_ttl&quot;:&quot;43800h&quot;}&#x27; \<!-- -->
<!-- -->        https://127.0.0.1:8200/v1/sys/mounts/pki_int/tune<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --data &#x27;{&quot;max_lease_ttl&quot;:&quot;43800h&quot;}&#x27; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        https://127.0.0.1:8200/v1/sys/mounts/pki_int/tune</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li><li class="g-type-long-body"><p class="g-type-long-body">Generate an intermediate using the <code>/pki_int/intermediate/generate/internal</code>
endpoint.</p><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload-int.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;common_name&quot;: &quot;example.com Intermediate Authority&quot;,<!-- -->
<!-- -->  &quot;ttl&quot;: &quot;43800h&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->        --request POST \<!-- -->
<!-- -->        --data @payload-int.json \<!-- -->
<!-- -->        https://127.0.0.1:8200/v1/pki_int/intermediate/generate/internal | jq<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload-int.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;common_name&quot;: &quot;example.com Intermediate Authority&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;ttl&quot;: &quot;43800h&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --data @payload-int.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        https://127.0.0.1:8200/v1/pki_int/intermediate/generate/internal | jq</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">Copy the generated CSR.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Sign the intermediate certificate with the root certificate and save the
certificate as <code>intermediate.cert.pem</code>.</p><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> The API request payload should contain the CSR you obtained.</p></div><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload-int-cert.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;csr&quot;: &quot;...&quot;,<!-- -->
<!-- -->  &quot;format&quot;: &quot;pem_bundle&quot;,<!-- -->
<!-- -->  &quot;ttl&quot;: &quot;43800h&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->        --request POST \<!-- -->
<!-- -->        --data @payload-int-cert.json \<!-- -->
<!-- -->        https://127.0.0.1:8200/v1/pki/root/sign-intermediate | jq<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload-int-cert.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;csr&quot;: &quot;...&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;format&quot;: &quot;pem_bundle&quot;,</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;ttl&quot;: &quot;43800h&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --data @payload-int-cert.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        https://127.0.0.1:8200/v1/pki/root/sign-intermediate | jq</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><blockquote><p class="g-type-long-body"><strong>NOTE:</strong> The <strong><code>format</code></strong> in the payload specifies the format of the
returned data. When <code>pem_bundle</code>, the certificate field will contain the
certificate.</p></blockquote><p class="g-type-long-body">Copy the generated certificate.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Once the CSR is signed and the root CA returns a certificate, it can be
imported back into Vault using the <code>/pki_int/intermediate/set-signed</code> endpoint.</p><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> The API request payload should contain the certificate you
obtained.</p></div><div class="g-code-block style_root__3eDLf language-plaintext style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none">$ tee payload-signed.json &lt;&lt;EOF<!-- -->
<!-- -->{<!-- -->
<!-- -->  &quot;certificate&quot;: &quot;...&quot;<!-- -->
<!-- -->}<!-- -->
<!-- -->EOF<!-- -->
<!-- -->
<!-- -->$ curl --header &quot;X-Vault-Token: ...&quot; \<!-- -->
<!-- -->        --request POST \<!-- -->
<!-- -->        --data @payload-signed.json \<!-- -->
<!-- -->        https://127.0.0.1:8200/v1/pki_int/intermediate/set-signed<!-- -->
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-plaintext"><code class="style_code__2AMYw language-plaintext"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ tee payload-signed.json &lt;&lt;EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">{</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">  &quot;certificate&quot;: &quot;...&quot;</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">}</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">EOF</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">$ curl --header &quot;X-Vault-Token: ...&quot; \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --request POST \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        --data @payload-signed.json \</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">        https://127.0.0.1:8200/v1/pki_int/intermediate/set-signed</span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div></li></ol><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-1" aria-label="web ui permalink">Â»</a><a class="__target-h" id="web-ui-1" aria-hidden=""></a>Web UI</h4><ol><li class="g-type-long-body">Select <strong>Enable new engine</strong> in the <strong>Secrets</strong> tab.</li><li class="g-type-long-body">Select <strong>PKI</strong> from the <strong>Secrets engine type</strong> drop-down list.</li><li class="g-type-long-body">Enter <strong><code>pki_int</code></strong> in the <strong>Path</strong> field.</li><li class="g-type-long-body">Click <strong>More options</strong> to expand and set the <strong>Maximum lease TTL</strong> to <strong><code>43800 hours</code></strong>.</li><li class="g-type-long-body">Click <strong>Enable Engine</strong>.</li><li class="g-type-long-body">Select <strong>Configure</strong>.</li><li class="g-type-long-body">Click <strong>Configure CA</strong>.</li><li class="g-type-long-body">Select <strong>intermediate</strong> from <strong>CA Type</strong> drop-down list.</li><li class="g-type-long-body">Enter <strong><code>example.com Intermediate Authority</code></strong> in the <strong>Common Name</strong> field.</li><li class="g-type-long-body">Enter <strong><code>43800</code></strong> in the <strong>TTL</strong> field, choose <strong><code>hours</code></strong> and then click <strong>Save</strong>.</li><li class="g-type-long-body">Click <strong>Copy CSR</strong> and save it in a file, <code>pki_intermediate.csr</code>.</li><li class="g-type-long-body">Select <strong>pki</strong> from the <strong>Secrets</strong> tab to return to the root CA.</li><li class="g-type-long-body">Select <strong>Configure</strong> and then click <strong>Sign intermediate</strong>.</li><li class="g-type-long-body">Paste in the CSR in the <strong>Certificate Signing Request (CSR)</strong> field.</li><li class="g-type-long-body">Enter <strong><code>example.com</code></strong> in the <strong>Common Name</strong>.</li><li class="g-type-long-body">Select <strong>pem_bundle</strong> from the <strong>Format</strong> drop-down list, and then click
<strong>Save</strong>.</li><li class="g-type-long-body">Click <strong>Copy Certificate</strong> and save the generated certificate in a file, <code>intermediate.cert.pem</code>.</li><li class="g-type-long-body">Select <strong>pki_int</strong> from the <strong>Secrets</strong> tab to return to the intermediate CA.</li><li class="g-type-long-body">Select <strong>Configure</strong> and then click <strong>Set signed intermediate</strong>.</li><li class="g-type-long-body">Paste in the certificate in the <strong>Signed Intermediate Certificate</strong> field and
then click <strong>Save</strong>.</li></ol><h3 class="g-type-display-4"><a class="__permalink-h" href="#step3" aria-label="step 3 create a role permalink">Â»</a><a class="__target-h __compat" id="step3" aria-hidden=""></a><a class="__target-h" id="step-3-create-a-role" aria-hidden=""></a>Step 3: Create a Role</h3><p class="g-type-long-body">A role is a logical name that maps to a policy used to generate those
credentials. It allows <a href="/api/secret/pki#create-update-role">configuration
parameters</a> to control
certificate common names, alternate names, the key usages that they are valid
for, and more.</p><p class="g-type-long-body">Calling out some of the parameters:</p><ul><li class="g-type-long-body"><strong><code>allowed_domains</code></strong> - specifies the domains of the role (used with
<code>allow_bare_domains</code> and <code>allow-subdomains</code> options)</li><li class="g-type-long-body"><strong><code>allow_bare_domains</code></strong> - specifies if clients can request certificates
matching the value of the actual domains themselves</li><li class="g-type-long-body"><strong><code>allow_subdomains</code></strong> - specifies if clients can request certificates with
CNs that are subdomains of the CNs allowed by the other role options (NOTE: This
includes wildcard subdomains.)</li><li class="g-type-long-body"><strong><code>allow_glob_domains</code></strong> - allows names specified in allowed_domains to
contain glob patterns (e.g. ftp<!-- -->*<!-- -->.example.com)</li></ul><p class="g-type-long-body">In this step, you are going to create a role named, <strong><code>example-dot-com</code></strong>.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command-2" aria-label="cli command permalink">Â»</a><a class="__target-h" id="cli-command-2" aria-hidden=""></a>CLI Command</h4><p class="g-type-long-body">Create a role named <strong><code>example-dot-com</code></strong> which allows subdomains.</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/roles/example-dot-com </span></span><span class="token output">\</span>
<span class="token output">        allowed_domains=&quot;example.com&quot; \</span>
<span class="token output">        allow_subdomains=true \</span>
<span class="token output">        max_ttl=&quot;720h&quot;</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/roles/example-dot-com </span></span><span class="token output">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">        allowed_domains=&quot;example.com&quot; \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">        allow_subdomains=true \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">        max_ttl=&quot;720h&quot;</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl-2" aria-label="api call using curl permalink">Â»</a><a class="__target-h" id="api-call-using-curl-2" aria-hidden=""></a>API call using cURL</h4><p class="g-type-long-body">Create a role named <strong><code>example-dot-com</code></strong> which allows subdomains.</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tee</span> payload-role.json </span></span><span class="token output">&lt;&lt;EOF</span>
<span class="token output">{</span>
<span class="token output">  &quot;allowed_domains&quot;: &quot;example.com&quot;,</span>
<span class="token output">  &quot;allow_subdomains&quot;: true,</span>
<span class="token output">  &quot;max_ttl&quot;: &quot;720h&quot;</span>
<span class="token output">}</span>
<!-- -->
<span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span>
<span class="token output">       --request POST \</span>
<span class="token output">       --data @payload-role.json \</span>
<span class="token output">       https://127.0.0.1:8200/v1/pki_int/roles/example-dot-com</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tee</span> payload-role.json </span></span><span class="token output">&lt;&lt;EOF</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;allowed_domains&quot;: &quot;example.com&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;allow_subdomains&quot;: true,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">  &quot;max_ttl&quot;: &quot;720h&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">}</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --request POST \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --data @payload-role.json \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       https://127.0.0.1:8200/v1/pki_int/roles/example-dot-com</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-2" aria-label="web ui permalink">Â»</a><a class="__target-h" id="web-ui-2" aria-hidden=""></a>Web UI</h4><p class="g-type-long-body">Create a role named <strong><code>example-dot-com</code></strong> which allows subdomains.</p><ol><li class="g-type-long-body">Click <strong>pki_int</strong> and then select <strong>Create role</strong>.</li><li class="g-type-long-body">Enter <strong><code>example-dot-com</code></strong> in the <strong>Role name</strong> field.</li><li class="g-type-long-body">Select <strong>Options</strong> to expand, and then set the <strong>Max TTL</strong> to <strong><code>43800 hours</code></strong>. Select <strong>Hide Options</strong>.</li><li class="g-type-long-body">Select <strong>Domain Handling</strong> to expand, and then select the <strong>Allow
subdomains</strong> check-box. Enter <strong><code>example.com</code></strong> in the <strong>Allowed domains</strong>
field.
<img src="/img/vault-pki-2.png" alt="Create Role"/></li><li class="g-type-long-body">Click <strong>Create role</strong>.</li></ol><h3 class="g-type-display-4"><a class="__permalink-h" href="#step4" aria-label="step 4 request certificates permalink">Â»</a><a class="__target-h __compat" id="step4" aria-hidden=""></a><a class="__target-h" id="step-4-request-certificates" aria-hidden=""></a>Step 4: Request Certificates</h3><p class="g-type-long-body">Keep certificate lifetimes to be short to align with Vault&#x27;s philosophy of
short-lived secrets.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command-3" aria-label="cli command permalink">Â»</a><a class="__target-h" id="cli-command-3" aria-hidden=""></a>CLI Command</h4><p class="g-type-long-body">Execute the following command to request a new certificate for <code>test.example.com</code>
domain based on the <code>example-dot-com</code> role:</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/issue/example-dot-com <span class="token assign-left variable">common_name</span><span class="token operator">=</span><span class="token string">&quot;test.example.com&quot;</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token string">&quot;24h&quot;</span></span></span>
<!-- -->
<span class="token output">Key                 Value</span>
<span class="token output">---                 -----</span>
<span class="token output">certificate         -----BEGIN CERTIFICATE-----</span>
<span class="token output">MIIDwzCCAqugAwIBAgIUTQABMCAsXjG6ExFTX8201xKVH4IwDQYJKoZIhvcNAQEL</span>
<span class="token output">BQAwGjEYMBYGA1UEAxMPd3d3LmV4YW1wbGUuY29tMB4XDTE4MDcyNDIxMTMxOVoX</span>
<span class="token output">             ...</span>
<!-- -->
<span class="token output">-----END CERTIFICATE-----</span>
<span class="token output">issuing_ca          -----BEGIN CERTIFICATE-----</span>
<span class="token output">MIIDQTCCAimgAwIBAgIUbMYp39mdj7dKX033ZjK18rx05x8wDQYJKoZIhvcNAQEL</span>
<span class="token output">             ...</span>
<!-- -->
<span class="token output">-----END CERTIFICATE-----</span>
<span class="token output">private_key         -----BEGIN RSA PRIVATE KEY-----</span>
<span class="token output">MIIEowIBAAKCAQEAte1fqy2Ekj+EFqKV6N5QJlBgMo/U4IIxwLZI6a87yAC/rDhm</span>
<span class="token output">W58liadXrwjzRgWeqVOoCRr/B5JnRLbyIKBVp6MMFwZVkynEPzDmy0ynuomSfJkM</span>
<span class="token output">             ...</span>
<!-- -->
<span class="token output">-----END RSA PRIVATE KEY-----</span>
<span class="token output">private_key_type    rsa</span>
<span class="token output">serial_number       4d:00:01:30:20:2c:5e:31:ba:13:11:53:5f:cd:b4:d7:12:95:1f:82</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/issue/example-dot-com <span class="token assign-left variable">common_name</span><span class="token operator">=</span><span class="token string">&quot;test.example.com&quot;</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token string">&quot;24h&quot;</span></span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">Key                 Value</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">---                 -----</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">certificate         -----BEGIN CERTIFICATE-----</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">MIIDwzCCAqugAwIBAgIUTQABMCAsXjG6ExFTX8201xKVH4IwDQYJKoZIhvcNAQEL</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">BQAwGjEYMBYGA1UEAxMPd3d3LmV4YW1wbGUuY29tMB4XDTE4MDcyNDIxMTMxOVoX</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">             ...</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">-----END CERTIFICATE-----</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">issuing_ca          -----BEGIN CERTIFICATE-----</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">MIIDQTCCAimgAwIBAgIUbMYp39mdj7dKX033ZjK18rx05x8wDQYJKoZIhvcNAQEL</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">             ...</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">-----END CERTIFICATE-----</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">private_key         -----BEGIN RSA PRIVATE KEY-----</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">MIIEowIBAAKCAQEAte1fqy2Ekj+EFqKV6N5QJlBgMo/U4IIxwLZI6a87yAC/rDhm</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">W58liadXrwjzRgWeqVOoCRr/B5JnRLbyIKBVp6MMFwZVkynEPzDmy0ynuomSfJkM</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">             ...</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl">
</span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">-----END RSA PRIVATE KEY-----</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">private_key_type    rsa</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">serial_number       4d:00:01:30:20:2c:5e:31:ba:13:11:53:5f:cd:b4:d7:12:95:1f:82</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The response contains the PEM-encoded private key, key type and certificate
serial number.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl-3" aria-label="api call using curl permalink">Â»</a><a class="__target-h" id="api-call-using-curl-3" aria-hidden=""></a>API call using cURL</h4><p class="g-type-long-body">Invoke the <strong><code>/pki_int/issue/&lt;role_name&gt;</code></strong> endpoint to request a new certificate.</p><p class="g-type-long-body"><strong>Example:</strong></p><p class="g-type-long-body">Request a certificate for <code>test.example.com</code> domain based on the
<code>example-dot-com</code> role:</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span>
<span class="token output">       --request POST \</span>
<span class="token output">       --data &#x27;{&quot;common_name&quot;: &quot;test.example.com&quot;, &quot;ttl&quot;: &quot;24h&quot;}&#x27; \</span>
<span class="token output">       https://127.0.0.1:8200/v1/pki_int/issue/example-dot-com | jq</span>
<span class="token output">{</span>
<span class="token output"> &quot;request_id&quot;: &quot;6fa8d77d-0758-33ae-b5ea-8b3d15014fd1&quot;,</span>
<span class="token output"> &quot;lease_id&quot;: &quot;&quot;,</span>
<span class="token output"> &quot;renewable&quot;: false,</span>
<span class="token output"> &quot;lease_duration&quot;: 0,</span>
<span class="token output"> &quot;data&quot;: {</span>
<span class="token output">   &quot;certificate&quot;: &quot;-----BEGIN CERTIFICATE-----\nMIIDvzCCAqegAwIBAgIUG7H0Pzpqm+...-----END CERTIFICATE-----&quot;,</span>
<span class="token output">   &quot;issuing_ca&quot;: &quot;-----BEGIN CERTIFICATE-----\nMIIDNTCCAh2gAwIBAgIUQhIX9D...-----END CERTIFICATE-----&quot;,</span>
<span class="token output">   &quot;private_key&quot;: &quot;-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAr6IsROOW5...-----END RSA PRIVATE KEY-----&quot;,</span>
<span class="token output">   &quot;private_key_type&quot;: &quot;rsa&quot;,</span>
<span class="token output">   &quot;serial_number&quot;: &quot;1b:b1:f4:3f:3a:6a:9b:e8:33:af:f7:1b:b1:4d:57:7f:65:65:39:c1&quot;</span>
<span class="token output"> },</span>
<span class="token output"> &quot;wrap_info&quot;: null,</span>
<span class="token output"> &quot;warnings&quot;: null,</span>
<span class="token output"> &quot;auth&quot;: null</span>
<span class="token output">}</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --request POST \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --data &#x27;{&quot;common_name&quot;: &quot;test.example.com&quot;, &quot;ttl&quot;: &quot;24h&quot;}&#x27; \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       https://127.0.0.1:8200/v1/pki_int/issue/example-dot-com | jq</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">{</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> &quot;request_id&quot;: &quot;6fa8d77d-0758-33ae-b5ea-8b3d15014fd1&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> &quot;lease_id&quot;: &quot;&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> &quot;renewable&quot;: false,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> &quot;lease_duration&quot;: 0,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> &quot;data&quot;: {</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;certificate&quot;: &quot;-----BEGIN CERTIFICATE-----\nMIIDvzCCAqegAwIBAgIUG7H0Pzpqm+...-----END CERTIFICATE-----&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;issuing_ca&quot;: &quot;-----BEGIN CERTIFICATE-----\nMIIDNTCCAh2gAwIBAgIUQhIX9D...-----END CERTIFICATE-----&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;private_key&quot;: &quot;-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAr6IsROOW5...-----END RSA PRIVATE KEY-----&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;private_key_type&quot;: &quot;rsa&quot;,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">   &quot;serial_number&quot;: &quot;1b:b1:f4:3f:3a:6a:9b:e8:33:af:f7:1b:b1:4d:57:7f:65:65:39:c1&quot;</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> },</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> &quot;wrap_info&quot;: null,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> &quot;warnings&quot;: null,</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output"> &quot;auth&quot;: null</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">}</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body">The response contains the PEM-encoded private key, key type and certificate
serial number.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-3" aria-label="web ui permalink">Â»</a><a class="__target-h" id="web-ui-3" aria-hidden=""></a>Web UI</h4><ol><li class="g-type-long-body"><p class="g-type-long-body">Select <strong>Secrets</strong>.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Select <strong>pki_int</strong> from the <strong>Secrets Engines</strong> list.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Select <strong>example-dot-com</strong> under <strong>Roles</strong>.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Enter <strong><code>test.example.com</code></strong> in the <strong>Common Name</strong> field.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Select <strong>Options</strong> to expand, and then set the <strong>TTL</strong> to <strong><code>24 hours</code></strong>.</p></li><li class="g-type-long-body"><p class="g-type-long-body">Select <strong>Hide Options</strong> and then click <strong>Generate</strong>.
<img src="/img/vault-pki-3.png" alt="Issue Certificate"/></p><blockquote><p class="g-type-long-body">The response contains the PEM-encoded private key, key type and certificate
serial number.</p></blockquote></li><li class="g-type-long-body"><p class="g-type-long-body">Click <strong>Copy credentials</strong> and save it in a file.</p></li></ol><div class="alert alert-info g-type-body" role="alert"><p class="g-type-long-body"><strong>NOTE:</strong> A certificate can be rotated at any time by simply issuing a new
certificate with the same CN.</p></div><h3 class="g-type-display-4"><a class="__permalink-h" href="#step5" aria-label="step 5 revoke certificates permalink">Â»</a><a class="__target-h __compat" id="step5" aria-hidden=""></a><a class="__target-h" id="step-5-revoke-certificates" aria-hidden=""></a>Step 5: Revoke Certificates</h3><p class="g-type-long-body">If a certificate must be revoked, you can easily perform the revocation action
which will cause the CRL to be regenerated. When the CRL is regenerated, any
expired certificates are removed from the CRL.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command-4" aria-label="cli command permalink">Â»</a><a class="__target-h" id="cli-command-4" aria-hidden=""></a>CLI Command</h4><p class="g-type-long-body">In a certain circumstances, you may wish to revoke an issued certificate.</p><p class="g-type-long-body">To revoke:</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/revoke <span class="token assign-left variable">serial_number</span><span class="token operator">=</span></span></span><span class="token output">&lt;serial_number&gt;</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/revoke <span class="token assign-left variable">serial_number</span><span class="token operator">=</span></span></span><span class="token output">&lt;serial_number&gt;</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/revoke <span class="token assign-left variable">serial_number</span><span class="token operator">=</span><span class="token string">&quot;48:97:82:dd:f0:d3:d9:7e:53:25:ba:fd:f6:77:3e:89:e5:65:cc:e7&quot;</span></span></span>
<span class="token output">Key                        Value</span>
<span class="token output">---                        -----</span>
<span class="token output">revocation_time            1532539632</span>
<span class="token output">revocation_time_rfc3339    2018-07-25T17:27:12.165206399Z</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/revoke <span class="token assign-left variable">serial_number</span><span class="token operator">=</span><span class="token string">&quot;48:97:82:dd:f0:d3:d9:7e:53:25:ba:fd:f6:77:3e:89:e5:65:cc:e7&quot;</span></span></span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">Key                        Value</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">---                        -----</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">revocation_time            1532539632</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">revocation_time_rfc3339    2018-07-25T17:27:12.165206399Z</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl-4" aria-label="api call using curl permalink">Â»</a><a class="__target-h" id="api-call-using-curl-4" aria-hidden=""></a>API call using cURL</h4><p class="g-type-long-body">Invoke the <strong><code>/pki_int/revoke</code></strong> endpoint to invoke a certificate using its
serial number.</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span>
<span class="token output">       --request POST \</span>
<span class="token output">       --data &#x27;{&quot;serial_number&quot;: &quot;48:97:82:dd:f0:d3:d9:7e:53:25:ba:fd:f6:77:3e:89:e5:65:cc:e7&quot;}&#x27; \</span>
<span class="token output">       https://127.0.0.1:8200/v1/pki_int/revoke</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --request POST \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --data &#x27;{&quot;serial_number&quot;: &quot;48:97:82:dd:f0:d3:d9:7e:53:25:ba:fd:f6:77:3e:89:e5:65:cc:e7&quot;}&#x27; \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       https://127.0.0.1:8200/v1/pki_int/revoke</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-4" aria-label="web ui permalink">Â»</a><a class="__target-h" id="web-ui-4" aria-hidden=""></a>Web UI</h4><ol><li class="g-type-long-body">Select <strong>Secrets</strong>.</li><li class="g-type-long-body">Select <strong>pki_int</strong> from the <strong>Secrets Engines</strong> list.</li><li class="g-type-long-body">Select the <strong>eCertificates</strong> tab.</li><li class="g-type-long-body">Select the serial number for the certificate you wish to revoke.</li><li class="g-type-long-body">Click <strong>Revoke</strong>. At the confirmation, click <strong>Revoke</strong> again.</li></ol><h3 class="g-type-display-4"><a class="__permalink-h" href="#step6" aria-label="step 6 remove expired certificates permalink">Â»</a><a class="__target-h __compat" id="step6" aria-hidden=""></a><a class="__target-h" id="step-6-remove-expired-certificates" aria-hidden=""></a>Step 6: Remove Expired Certificates</h3><p class="g-type-long-body">Keep the storage backend and CRL by periodically removing certificates that have
expired and are past a certain buffer period beyond their expiration time.</p><h4 class="g-type-display-5"><a class="__permalink-h" href="#cli-command-5" aria-label="cli command permalink">Â»</a><a class="__target-h" id="cli-command-5" aria-hidden=""></a>CLI Command</h4><p class="g-type-long-body">To remove revoked certificate and clean the CRL.</p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/tidy <span class="token assign-left variable">tidy_cert_store</span><span class="token operator">=</span>true <span class="token assign-left variable">tidy_revoked_certs</span><span class="token operator">=</span>true</span></span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vault <span class="token function">write</span> pki_int/tidy <span class="token assign-left variable">tidy_cert_store</span><span class="token operator">=</span>true <span class="token assign-left variable">tidy_revoked_certs</span><span class="token operator">=</span>true</span></span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#api-call-using-curl-5" aria-label="api call using curl permalink">Â»</a><a class="__target-h" id="api-call-using-curl-5" aria-hidden=""></a>API call using cURL</h4><p class="g-type-long-body">Invoke the <strong><code>/pki_int/tidy</code></strong> endpoint to remove revoked certificate and clean
the CRL.</p><p class="g-type-long-body"><strong>Example:</strong></p><div class="g-code-block style_root__3eDLf language-shell-session style_codeMargin__gCa5y theme-dark_base__2i1UN theme-dark_syntax__1ok1Y" data-heap-track="code-block"><pre style="display:none"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span>
<span class="token output">       --request POST \</span>
<span class="token output">       --data &#x27;{&quot;tidy_cert_store&quot;: true, &quot;tidy_revoked_certs&quot;: true}&#x27; \</span>
<span class="token output">       https://127.0.0.1:8200/v1/pki_int/tidy</span>
</pre><div class="style_linesContainer__3neRW"><pre class="style_pre__1vh6Z language-shell-session"><code class="style_code__2AMYw language-shell-session"><span class="style_linesColumn__33g5m style_styledScrollbars__2aszk"><span class="style_linesWrapper__3Hf6o"><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">curl</span> --header <span class="token string">&quot;X-Vault-Token: ...&quot;</span> </span></span><span class="token output">\</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --request POST \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       --data &#x27;{&quot;tidy_cert_store&quot;: true, &quot;tidy_revoked_certs&quot;: true}&#x27; \</span></span><span class="style_LineOfCode__Ykefu g-type-code style_hasFloatingCopyButton__18ybl"><span class="token output">       https://127.0.0.1:8200/v1/pki_int/tidy</span></span></span></span></code></pre><div class="style_copyButtonContainer__1tl-z"><div class="style_copyButtonBackground__1VUWz"><button class="style_button__3y017 g-type-body-small-strong" data-heap-track="code-block-clipboard-icon" type="button">Copy<div class="style_svg__1ZhpC"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.82 3C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-4.18zM10 13H7v2h3v-2zm-3 6h5v-2H7v2zM7 9v2h6V9H7zm5-6c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM5 21V5h2v1.007h10V5h2v5.992h2.003V17H19v4H5zm11.99-3v-3H24v-2h-7.01v-3L13 14l3.99 4z" fill="#000"/></svg></div></button></div></div></div></div><h4 class="g-type-display-5"><a class="__permalink-h" href="#web-ui-5" aria-label="web ui permalink">Â»</a><a class="__target-h" id="web-ui-5" aria-hidden=""></a>Web UI</h4><ol><li class="g-type-long-body">Select <strong>Secrets</strong>.</li><li class="g-type-long-body">Select <strong>pki_int</strong> from the <strong>Secrets Engines</strong> list.</li><li class="g-type-long-body">Select <strong>Configure</strong>.</li><li class="g-type-long-body">Select the <strong>Tidy</strong> tab.</li><li class="g-type-long-body">Select the check-box for <strong>Tidy the Certificate Store</strong> and <strong>Tidy the Revocation List (CRL)</strong>.</li><li class="g-type-long-body">Click <strong>Save</strong>.</li></ol><h2 class="g-type-display-3"><a class="__permalink-h" href="#next-steps" aria-label="next steps permalink">Â»</a><a class="__target-h" id="next-steps" aria-hidden=""></a>Next steps</h2><p class="g-type-long-body">Check out the <a href="https://www.hashicorp.com/resources/streamline-certificate-management-with-vault">Streamline Certificate Management with HashiCorp
Vault</a>
webinar recording.</p></article></div></div><div id="edit-this-page" class="g-container"><a href="https://github.com/hashicorp/vault/blob/main/website/content/guides/secret-mgmt/pki-engine.mdx"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMiIGhlaWdodD0iMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTExLjYwOC4zNDJDNS41MzUuMzQyLjYxIDUuMTYyLjYxIDExLjEwOGMwIDQuNzU3IDMuMTUyIDguNzkyIDcuNTIzIDEwLjIxNS41NS4xLjc1MS0uMjMzLjc1MS0uNTE4IDAtLjI1Ni0uMDEtLjkzMy0uMDE1LTEuODMxLTMuMDYuNjUtMy43MDUtMS40NDQtMy43MDUtMS40NDQtLjUtMS4yNDMtMS4yMjItMS41NzQtMS4yMjItMS41NzQtLjk5OC0uNjY4LjA3Ni0uNjU1LjA3Ni0uNjU1IDEuMTA0LjA3NiAxLjY4NSAxLjExIDEuNjg1IDEuMTEuOTgxIDEuNjQ1IDIuNTc1IDEuMTcgMy4yMDEuODk0LjEtLjY5NS4zODUtMS4xNy42OTktMS40MzktMi40NDMtLjI3MS01LjAxMS0xLjE5NS01LjAxMS01LjMyIDAtMS4xNzYuNDI5LTIuMTM3IDEuMTMyLTIuODktLjExMy0uMjcyLS40OS0xLjM2Ny4xMDgtMi44NDkgMCAwIC45MjQtLjI4OSAzLjAyNSAxLjEwNC44NzctLjI0IDEuODE5LS4zNTggMi43NTQtLjM2My45MzQuMDA1IDEuODc1LjEyNCAyLjc1NC4zNjMgMi4xLTEuMzkzIDMuMDIyLTEuMTA0IDMuMDIyLTEuMTA0LjYgMS40ODIuMjIyIDIuNTc3LjExIDIuODUuNzA1Ljc1MiAxLjEzIDEuNzEzIDEuMTMgMi44ODggMCA0LjEzNi0yLjU3MiA1LjA0Ni01LjAyMiA1LjMxMy4zOTQuMzMyLjc0Ni45OS43NDYgMS45OTQgMCAxLjQzOC0uMDEzIDIuNi0uMDEzIDIuOTUzIDAgLjI4OC4xOTguNjIzLjc1Ni41MTggNC4zNjgtMS40MjcgNy41MTYtNS40NiA3LjUxNi0xMC4yMTUgMC01Ljk0Ni00LjkyNS0xMC43NjYtMTEtMTAuNzY2IiBmaWxsPSIjMTYxNTE0IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=" alt="github logo"/><span>Edit this page</span></a></div></div><footer class="g-footer"><div class="g-container"><div class="left"><a href="/docs/vault_v1.8.x/docs/">Docs</a><a href="/docs/vault_v1.8.x/api/">API</a><a href="https://learn.hashicorp.com/vault">Learn</a><a href="/docs/vault_v1.8.x/community/">Community</a><a href="https://hashicorp.com/privacy">Privacy</a><a href="/docs/vault_v1.8.x/security/">Security</a><a href="/docs/vault_v1.8.x/files/press-kit.zip">Press Kit</a><a>Consent Manager</a></div></div></footer><div id="g-consent-manager"></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"currentPath":"secret-mgmt/pki-engine","frontMatter":{"layout":"guides","page_title":"Build Your Own Certificate Authority - Guides","description":"The PKI secrets engine generates dynamic X.509 certificates. With this secrets\nengine, services can get certificates without going through the usual manual\nprocess of generating a private key and CSR, submitting to a CA, and waiting\nfor a verification and signing process to complete. Vault's built-in\nauthentication and authorization mechanisms provide the verification\nfunctionality."},"githubFileUrl":"https://github.com/hashicorp/vault/blob/main/website/content/guides/secret-mgmt/pki-engine.mdx","mdxSource":{"compiledSource":"var m=Object.defineProperty;var p=Object.prototype.hasOwnProperty;var l=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable;var r=(a,t,n)=\u003et in a?m(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,e=(a,t)=\u003e{for(var n in t||(t={}))p.call(t,n)\u0026\u0026r(a,n,t[n]);if(l)for(var n of l(t))o.call(t,n)\u0026\u0026r(a,n,t[n]);return a};var i=(a,t)=\u003e{var n={};for(var s in a)p.call(a,s)\u0026\u0026t.indexOf(s)\u003c0\u0026\u0026(n[s]=a[s]);if(a!=null\u0026\u0026l)for(var s of l(a))t.indexOf(s)\u003c0\u0026\u0026o.call(a,s)\u0026\u0026(n[s]=a[s]);return n};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var s=n,{components:a}=s,t=i(s,[\"components\"]);return mdx(MDXLayout,e(e(e({},layoutProps),t),{components:a,mdxType:\"MDXLayout\"}),mdx(\"h1\",e({},{className:\"g-type-display-2\"}),mdx(\"a\",e({parentName:\"h1\"},{className:\"__permalink-h\",href:\"#build-your-own-certificate-authority-ca\",\"aria-label\":\"build your own certificate authority ca permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h1\"},{className:\"__target-h\",id:\"build-your-own-certificate-authority-ca\",\"aria-hidden\":\"\"})),\"Build Your Own Certificate Authority (CA)\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Vault's PKI secrets engine can dynamically generate X.509 certificates on\ndemand. This allows services to acquire certificates without going through the\nusual manual process of generating a private key and Certificates Signing\nRequest (CSR), submitting to a CA, and then wait for the verification and\nsigning process to complete.`),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#reference-material\",\"aria-label\":\"reference material permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"reference-material\",\"aria-hidden\":\"\"})),\"Reference Material\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/docs/secrets/pki\"}),\"PKI (Certificates) Secrets Engine\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"/api/secret/pki\"}),\"PKI Secrets Engine (API)\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"https://tools.ietf.org/html/rfc5280\"}),`RFC 5280 Internet X.509 Public Key Infrastructure Certificate and Certificate\nRevocation List (CRL) Profile`)),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"https://www.openssl.org/docs/man1.1.0/apps/x509.html\"}),\"OpenSSL x509 Man Pages\"))),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#estimated-time-to-complete\",\"aria-label\":\"estimated time to complete permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"estimated-time-to-complete\",\"aria-hidden\":\"\"})),\"Estimated Time to Complete\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"15 minutes\"),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#personas\",\"aria-label\":\"personas permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"personas\",\"aria-hidden\":\"\"})),\"Personas\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"The steps described in this guide are typically performed by \",mdx(\"strong\",{parentName:\"p\"},`security\nengineer`),\".\"),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#challenge\",\"aria-label\":\"challenge permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"challenge\",\"aria-hidden\":\"\"})),\"Challenge\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Organizations should protect their website; however, the Traditional PKI process\nworkflow takes a long time which motivates organizations to create certificates\nwhich do not expire for a year or more.`),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#solution\",\"aria-label\":\"solution permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"solution\",\"aria-hidden\":\"\"})),\"Solution\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Use Vault to create X509 certificates for usage in MTLS or other arbitrary PKI\nencryption. While this can be used to create web server certificates. If\nusers do not import the CA chains, the browser will complain about self-signed\ncertificates.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Creating PKI certificates is generally a cumbersome process using traditional\ntools like `,mdx(\"inlineCode\",{parentName:\"p\"},\"openssl\"),` or even more advanced frameworks like CFSSL. These tools\nalso require a human component to verify certificate distribution meets\norganizational security policies.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Vault PKI secrets engine makes this a lot simpler. The PKI secrets engine can\nbe an Intermediate-Only certificate authority which potentially allows for\nhigher levels of security.`),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Store CA outside the Vault (air gapped)\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Create CSRs for the intermediates\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Sign CSR outside Vault and import intermediate\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Issue leaf certificates from the Intermediate CA\")),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#prerequisites\",\"aria-label\":\"prerequisites permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"prerequisites\",\"aria-hidden\":\"\"})),\"Prerequisites\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`To perform the tasks described in this guide, you need to have a Vault\nenvironment. Refer to the `,mdx(\"a\",e({parentName:\"p\"},{href:\"/intro/getting-started/install\"}),`Getting\nStarted`),\" guide to install Vault.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Alternatively, you can use the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.katacoda.com/hashicorp/scenarios/vault-playground\"}),`Vault\nPlayground`),`\nenvironment.`),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#policy\",\"aria-label\":\"policy requirements permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"policy\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"policy-requirements\",\"aria-hidden\":\"\"})),\"Policy requirements\"),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" For the purpose of this guide, you can use \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"root\")),` token to work\nwith Vault. However, it is recommended that root tokens are only used for just\nenough initial setup or in emergencies. As a best practice, use tokens with\nappropriate set of policies based on your role in the organization.`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`To perform all tasks demonstrated in this guide, your policy must include the\nfollowing permissions:`),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Enable secrets engine\"),`\n`,\"path \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"sys/mounts/*\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  capabilities \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"create\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"read\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"update\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"delete\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"list\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# List enabled secrets engine\"),`\n`,\"path \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"sys/mounts\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  capabilities \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"read\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"list\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Work with pki secrets engine\"),`\n`,\"path \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"pki*\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  capabilities \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"create\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"read\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"update\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"delete\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"list\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"sudo\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`If you are not familiar with policies, complete the\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"/guides/identity/policies\"}),\"policies\"),\" guide.\"),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#steps\",\"aria-label\":\"steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"steps\",\"aria-hidden\":\"\"})),\"Steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`In this guide, you are going to first generate a self-signed root certificate.\nThen you are going to generate an intermediate certificate which is signed by\nthe root. Finally, you are going to generate a certificate for\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"test.example.com\"),\" domain.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-pki-4.png\",alt:\"Overview\"}))),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"In this guide, you perform the following:\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step1\"}),\"Generate Root CA\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step2\"}),\"Generate Intermediate CA\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step3\"}),\"Create a Role\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step4\"}),\"Request Certificates\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step5\"}),\"Revoke Certificates\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"a\",e({parentName:\"li\"},{href:\"#step6\"}),\"Remove Expired Certificates\"))),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step1\",\"aria-label\":\"step 1 generate root ca permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step1\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-1-generate-root-ca\",\"aria-hidden\":\"\"})),\"Step 1: Generate Root CA\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`In this step, you are going to generate a self-signed root certificate using\nPKI secrets engine.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command\",\"aria-hidden\":\"\"})),\"CLI command\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"First, enable the \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),\" secrets engine at \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),\" path:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault secrets enable pki\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Tune the \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),\" secrets engine to issue certificates with a maximum time-to-live (TTL) of 87600 hours.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault secrets tune -max-lease-ttl=87600h pki\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"em\",{parentName:\"strong\"},\"root\")),\" certificate and save the certificate in \",mdx(\"inlineCode\",{parentName:\"p\"},\"CA_cert.crt\"),\".\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ vault write -field=certificate pki/root/generate/internal common_name=\"example.com\" \\\\',`\n`,\"        ttl=87600h \u003e CA_cert.crt\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`This generates a new self-signed CA certificate and private key. Vault will\n`,mdx(\"em\",{parentName:\"p\"},\"automatically\"),` revoke the generated root at the end of its lease period\n(TTL); the CA certificate will sign its own Certificate Revocation List\n(CRL).`)),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Configure the CA and CRL URLs:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault write pki/config/urls \\\\\",`\n`,'        issuing_certificates=\"http://127.0.0.1:8200/v1/pki/ca\" \\\\',`\n`,'        crl_distribution_points=\"http://127.0.0.1:8200/v1/pki/crl\"',`\n`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"First, enable the \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),\" secrets engine at \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),\" path using \",mdx(\"inlineCode\",{parentName:\"p\"},\"/sys/mounts\"),\" endpoint:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: \u003cTOKEN\u003e\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,\"       --data \u003cPARAMETERS\u003e \\\\\",`\n`,\"       \u003cVAULT_ADDRESS\u003e/v1/sys/mounts/\u003cPATH\u003e\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Where \",mdx(\"inlineCode\",{parentName:\"p\"},\"\u003cTOKEN\u003e\"),\" is your valid token, and \",mdx(\"inlineCode\",{parentName:\"p\"},\"\u003cPARAMETERS\u003e\"),\" holds \",mdx(\"a\",e({parentName:\"p\"},{href:\"/api/system/mounts#enable-secrets-engine\"}),`configuration\nparameters`),\" of the secret engine.\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"The following example mounts \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),\" secret engine.\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,`       --data '{\"type\":\"pki\"}' \\\\`,`\n`,\"       https://127.0.0.1:8200/v1/sys/mounts/pki\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Tune the \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),` secrets engine to issue certificates with a maximum\ntime-to-live (TTL) of 87600 hours.`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"        --request POST \\\\\",`\n`,`        --data '{\"max_lease_ttl\":\"87600h\"}' \\\\`,`\n`,\"        https://127.0.0.1:8200/v1/sys/mounts/pki/tune\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"em\",{parentName:\"strong\"},\"root\")),` certificate and extract the CA certificate and save\nit as `,mdx(\"inlineCode\",{parentName:\"p\"},\"CA_cert.crt\"),\".\"),mdx(\"blockquote\",{parentName:\"li\"},mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" The following command uses \",mdx(\"inlineCode\",{parentName:\"p\"},\"jq\"),` tool to parse the output JSON.\nYou can install `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://stedolan.github.io/jq/download/\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"jq\")),` or manually\ncopy and paste the certificate in a file, `,mdx(\"inlineCode\",{parentName:\"p\"},\"CA_cert.crt\"),\".\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'  \"common_name\": \"example.com\",',`\n`,'  \"ttl\": \"87600h\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"        --request POST \\\\\",`\n`,\"        --data @payload.json \\\\\",`\n`,\"        https://127.0.0.1:8200/v1/pki/root/generate/internal \\\\\",`\n`,'        | jq -r \".data.certificate\" \u003e CA_cert.crt',`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`This generates a new self-signed CA certificate and private key. Vault will\n`,mdx(\"em\",{parentName:\"p\"},\"automatically\"),` revoke the generated root at the end of its lease period\n(TTL); the CA certificate will sign its own Certificate Revocation List\n(CRL).`)),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Configure the CA and CRL URLs:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload-url.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'  \"issuing_certificates\": \"http://127.0.0.1:8200/v1/pki/ca\",',`\n`,'  \"crl_distribution_points\": \"http://127.0.0.1:8200/v1/pki/crl\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,\"       --data @payload-url.json \\\\\",`\n`,\"       https://127.0.0.1:8200/v1/pki/config/urls\",`\n`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Open a web browser and launch the Vault UI (e.g. \",mdx(\"a\",e({parentName:\"p\"},{href:\"http://127.0.0.1:8200/ui\"}),\"http://127.0.0.1:8200/ui\"),`) and\nthen login.`),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Enable new engine\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"PKI\"),\" from the \",mdx(\"strong\",{parentName:\"li\"},\"Secrets engine type\"),\" drop-down list.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"More options\"),\" to expand and set the \",mdx(\"strong\",{parentName:\"li\"},\"Maximum lease TTL\"),\" to \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"87600 hours\")),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Enable Engine\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Configure\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Configure CA\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Leave \",mdx(\"strong\",{parentName:\"li\"},\"CA Type\"),\" as \",mdx(\"strong\",{parentName:\"li\"},\"root\"),\", and \",mdx(\"strong\",{parentName:\"li\"},\"Type\"),\" to be \",mdx(\"strong\",{parentName:\"li\"},\"internal\"),`. Enter\n`,mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example.com\")),\" in the \",mdx(\"strong\",{parentName:\"li\"},\"Common Name\"),\" field.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Options\"),\" and then set \",mdx(\"strong\",{parentName:\"li\"},\"TTL\"),\" field to be \",mdx(\"strong\",{parentName:\"li\"},\"87600 hours\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Save\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Copy Certificate\"),\" and save it in a file named, \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"CA_cert.crt\")),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click the \",mdx(\"strong\",{parentName:\"li\"},\"URLs\"),\" tab, and then set:\",mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"Issuing certificates: \",mdx(\"inlineCode\",{parentName:\"li\"},\"http://127.0.0.1:8200/v1/pki/ca\")),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),\"CRL Distribution Points: \",mdx(\"inlineCode\",{parentName:\"li\"},\"http://127.0.0.1:8200/v1/pki/crl\"),mdx(\"img\",e({parentName:\"li\"},{src:\"/img/vault-pki-1.png\",alt:\"Configure URL\"}))))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Save\"),\".\")),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` To examine the generated root certificate, you can use\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.openssl.org/source/\"}),\"OpenSSL\"),\".\")),mdx(\"pre\",e({},{className:\"language-shell\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Print the certificate in text form\"),`\n`,\"$ openssl x509 -in CA_cert.crt -text\",`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Print the validity dates\"),`\n`,\"$ openssl x509 -in CA_cert.crt -noout -dates\",`\n`)),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step2\",\"aria-label\":\"step 2 generate intermediate ca permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step2\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-2-generate-intermediate-ca\",\"aria-hidden\":\"\"})),\"Step 2: Generate Intermediate CA\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Now, you are going to create an intermediate CA using the root CA you regenerate\nin the previous step.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-1\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-1\",\"aria-hidden\":\"\"})),\"CLI Command\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"First, enable the \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),\" secrets engine at \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"pki_int\")),\" path:\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault secrets enable -path=pki_int pki\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Tune the \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki_int\"),` secrets engine to issue certificates with a maximum\ntime-to-live (TTL) of 43800 hours.`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault secrets tune -max-lease-ttl=43800h pki_int\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`Execute the following command to generate an intermediate and save the CSR as\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"pki_intermediate.csr\"),\":\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault write -format=json pki_int/intermediate/generate/internal \\\\\",`\n`,'        common_name=\"example.com Intermediate Authority\" ttl=\"43800h\" \\\\',`\n`,\"        | jq -r '.data.csr' \u003e pki_intermediate.csr\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`Sign the intermediate certificate with the root certificate and save the\ngenerated certificate as `,mdx(\"inlineCode\",{parentName:\"p\"},\"intermediate.cert.pem\"),\":\"),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault write -format=json pki/root/sign-intermediate csr=@pki_intermediate.csr \\\\\",`\n`,'        format=pem_bundle ttl=\"43800h\" \\\\',`\n`,\"        | jq -r '.data.certificate' \u003e intermediate.cert.pem\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`Once the CSR is signed and the root CA returns a certificate, it can be\nimported back into Vault:`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ vault write pki_int/intermediate/set-signed certificate=@intermediate.cert.pem\",`\n`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-1\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-1\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"First, enable the \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki\"),\" secrets engine at \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"pki_int\")),\" path:\"),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"       --request POST \\\\\",`\n`,`       --data '{\"type\":\"pki\"}' \\\\`,`\n`,\"       https://127.0.0.1:8200/v1/sys/mounts/pki_int\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Tune the \",mdx(\"inlineCode\",{parentName:\"p\"},\"pki_int\"),` secrets engine to issue certificates with a maximum\ntime-to-live (TTL) of 43800 hours.`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"        --request POST \\\\\",`\n`,`        --data '{\"max_lease_ttl\":\"43800h\"}' \\\\`,`\n`,\"        https://127.0.0.1:8200/v1/sys/mounts/pki_int/tune\",`\n`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Generate an intermediate using the \",mdx(\"inlineCode\",{parentName:\"p\"},\"/pki_int/intermediate/generate/internal\"),`\nendpoint.`),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload-int.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'  \"common_name\": \"example.com Intermediate Authority\",',`\n`,'  \"ttl\": \"43800h\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"        --request POST \\\\\",`\n`,\"        --data @payload-int.json \\\\\",`\n`,\"        https://127.0.0.1:8200/v1/pki_int/intermediate/generate/internal | jq\",`\n`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Copy the generated CSR.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`Sign the intermediate certificate with the root certificate and save the\ncertificate as `,mdx(\"inlineCode\",{parentName:\"p\"},\"intermediate.cert.pem\"),\".\"),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" The API request payload should contain the CSR you obtained.\")),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload-int-cert.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'  \"csr\": \"...\",',`\n`,'  \"format\": \"pem_bundle\",',`\n`,'  \"ttl\": \"43800h\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"        --request POST \\\\\",`\n`,\"        --data @payload-int-cert.json \\\\\",`\n`,\"        https://127.0.0.1:8200/v1/pki/root/sign-intermediate | jq\",`\n`)),mdx(\"blockquote\",{parentName:\"li\"},mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),\" The \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"format\")),` in the payload specifies the format of the\nreturned data. When `,mdx(\"inlineCode\",{parentName:\"p\"},\"pem_bundle\"),`, the certificate field will contain the\ncertificate.`)),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Copy the generated certificate.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),`Once the CSR is signed and the root CA returns a certificate, it can be\nimported back into Vault using the `,mdx(\"inlineCode\",{parentName:\"p\"},\"/pki_int/intermediate/set-signed\"),\" endpoint.\"),mdx(\"div\",e({parentName:\"li\"},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` The API request payload should contain the certificate you\nobtained.`)),mdx(\"pre\",e({parentName:\"li\"},{className:\"language-plaintext\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-plaintext\"}),\"$ tee payload-signed.json \u003c\u003cEOF\",`\n`,\"{\",`\n`,'  \"certificate\": \"...\"',`\n`,\"}\",`\n`,\"EOF\",`\n`,`\n`,'$ curl --header \"X-Vault-Token: ...\" \\\\',`\n`,\"        --request POST \\\\\",`\n`,\"        --data @payload-signed.json \\\\\",`\n`,\"        https://127.0.0.1:8200/v1/pki_int/intermediate/set-signed\",`\n`)))),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-1\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-1\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Enable new engine\"),\" in the \",mdx(\"strong\",{parentName:\"li\"},\"Secrets\"),\" tab.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"PKI\"),\" from the \",mdx(\"strong\",{parentName:\"li\"},\"Secrets engine type\"),\" drop-down list.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"pki_int\")),\" in the \",mdx(\"strong\",{parentName:\"li\"},\"Path\"),\" field.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"More options\"),\" to expand and set the \",mdx(\"strong\",{parentName:\"li\"},\"Maximum lease TTL\"),\" to \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"43800 hours\")),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Enable Engine\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Configure\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Configure CA\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"intermediate\"),\" from \",mdx(\"strong\",{parentName:\"li\"},\"CA Type\"),\" drop-down list.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example.com Intermediate Authority\")),\" in the \",mdx(\"strong\",{parentName:\"li\"},\"Common Name\"),\" field.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"43800\")),\" in the \",mdx(\"strong\",{parentName:\"li\"},\"TTL\"),\" field, choose \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"hours\")),\" and then click \",mdx(\"strong\",{parentName:\"li\"},\"Save\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Copy CSR\"),\" and save it in a file, \",mdx(\"inlineCode\",{parentName:\"li\"},\"pki_intermediate.csr\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"pki\"),\" from the \",mdx(\"strong\",{parentName:\"li\"},\"Secrets\"),\" tab to return to the root CA.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Configure\"),\" and then click \",mdx(\"strong\",{parentName:\"li\"},\"Sign intermediate\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Paste in the CSR in the \",mdx(\"strong\",{parentName:\"li\"},\"Certificate Signing Request (CSR)\"),\" field.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example.com\")),\" in the \",mdx(\"strong\",{parentName:\"li\"},\"Common Name\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"pem_bundle\"),\" from the \",mdx(\"strong\",{parentName:\"li\"},\"Format\"),` drop-down list, and then click\n`,mdx(\"strong\",{parentName:\"li\"},\"Save\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Copy Certificate\"),\" and save the generated certificate in a file, \",mdx(\"inlineCode\",{parentName:\"li\"},\"intermediate.cert.pem\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"pki_int\"),\" from the \",mdx(\"strong\",{parentName:\"li\"},\"Secrets\"),\" tab to return to the intermediate CA.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Configure\"),\" and then click \",mdx(\"strong\",{parentName:\"li\"},\"Set signed intermediate\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Paste in the certificate in the \",mdx(\"strong\",{parentName:\"li\"},\"Signed Intermediate Certificate\"),` field and\nthen click `,mdx(\"strong\",{parentName:\"li\"},\"Save\"),\".\")),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step3\",\"aria-label\":\"step 3 create a role permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step3\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-3-create-a-role\",\"aria-hidden\":\"\"})),\"Step 3: Create a Role\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`A role is a logical name that maps to a policy used to generate those\ncredentials. It allows `,mdx(\"a\",e({parentName:\"p\"},{href:\"/api/secret/pki#create-update-role\"}),`configuration\nparameters`),` to control\ncertificate common names, alternate names, the key usages that they are valid\nfor, and more.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Calling out some of the parameters:\"),mdx(\"ul\",null,mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"allowed_domains\")),` - specifies the domains of the role (used with\n`,mdx(\"inlineCode\",{parentName:\"li\"},\"allow_bare_domains\"),\" and \",mdx(\"inlineCode\",{parentName:\"li\"},\"allow-subdomains\"),\" options)\"),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"allow_bare_domains\")),` - specifies if clients can request certificates\nmatching the value of the actual domains themselves`),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"allow_subdomains\")),` - specifies if clients can request certificates with\nCNs that are subdomains of the CNs allowed by the other role options (NOTE: This\nincludes wildcard subdomains.)`),mdx(\"li\",e({parentName:\"ul\"},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"allow_glob_domains\")),` - allows names specified in allowed_domains to\ncontain glob patterns (e.g. ftp`,\"*\",\".example.com)\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"In this step, you are going to create a role named, \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example-dot-com\")),\".\"),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-2\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-2\",\"aria-hidden\":\"\"})),\"CLI Command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Create a role named \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example-dot-com\")),\" which allows subdomains.\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault \",mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"write\"),\" pki_int/roles/example-dot-com \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'        allowed_domains=\"example.com\" \\\\'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"        allow_subdomains=true \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'        max_ttl=\"720h\"'),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-2\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-2\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Create a role named \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example-dot-com\")),\" which allows subdomains.\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"tee\"),\" payload-role.json \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\u003c\u003cEOF\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"allowed_domains\": \"example.com\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"allow_subdomains\": true,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'  \"max_ttl\": \"720h\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --request POST \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --data @payload-role.json \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       https://127.0.0.1:8200/v1/pki_int/roles/example-dot-com\"),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-2\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-2\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Create a role named \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example-dot-com\")),\" which allows subdomains.\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"pki_int\"),\" and then select \",mdx(\"strong\",{parentName:\"li\"},\"Create role\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example-dot-com\")),\" in the \",mdx(\"strong\",{parentName:\"li\"},\"Role name\"),\" field.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Options\"),\" to expand, and then set the \",mdx(\"strong\",{parentName:\"li\"},\"Max TTL\"),\" to \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"43800 hours\")),\". Select \",mdx(\"strong\",{parentName:\"li\"},\"Hide Options\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Domain Handling\"),\" to expand, and then select the \",mdx(\"strong\",{parentName:\"li\"},`Allow\nsubdomains`),\" check-box. Enter \",mdx(\"strong\",{parentName:\"li\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"example.com\")),\" in the \",mdx(\"strong\",{parentName:\"li\"},\"Allowed domains\"),`\nfield.\n`,mdx(\"img\",e({parentName:\"li\"},{src:\"/img/vault-pki-2.png\",alt:\"Create Role\"}))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Create role\"),\".\")),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step4\",\"aria-label\":\"step 4 request certificates permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step4\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-4-request-certificates\",\"aria-hidden\":\"\"})),\"Step 4: Request Certificates\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Keep certificate lifetimes to be short to align with Vault's philosophy of\nshort-lived secrets.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-3\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-3\",\"aria-hidden\":\"\"})),\"CLI Command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Execute the following command to request a new certificate for \",mdx(\"inlineCode\",{parentName:\"p\"},\"test.example.com\"),`\ndomain based on the `,mdx(\"inlineCode\",{parentName:\"p\"},\"example-dot-com\"),\" role:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault \",mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"write\"),\" pki_int/issue/example-dot-com \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"common_name\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"test.example.com\"'),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"ttl\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"24h\"'))),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"Key                 Value\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"---                 -----\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"certificate         -----BEGIN CERTIFICATE-----\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"MIIDwzCCAqugAwIBAgIUTQABMCAsXjG6ExFTX8201xKVH4IwDQYJKoZIhvcNAQEL\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"BQAwGjEYMBYGA1UEAxMPd3d3LmV4YW1wbGUuY29tMB4XDTE4MDcyNDIxMTMxOVoX\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"             ...\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"-----END CERTIFICATE-----\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"issuing_ca          -----BEGIN CERTIFICATE-----\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"MIIDQTCCAimgAwIBAgIUbMYp39mdj7dKX033ZjK18rx05x8wDQYJKoZIhvcNAQEL\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"             ...\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"-----END CERTIFICATE-----\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"private_key         -----BEGIN RSA PRIVATE KEY-----\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"MIIEowIBAAKCAQEAte1fqy2Ekj+EFqKV6N5QJlBgMo/U4IIxwLZI6a87yAC/rDhm\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"W58liadXrwjzRgWeqVOoCRr/B5JnRLbyIKBVp6MMFwZVkynEPzDmy0ynuomSfJkM\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"             ...\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"-----END RSA PRIVATE KEY-----\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"private_key_type    rsa\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"serial_number       4d:00:01:30:20:2c:5e:31:ba:13:11:53:5f:cd:b4:d7:12:95:1f:82\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`The response contains the PEM-encoded private key, key type and certificate\nserial number.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-3\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-3\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Invoke the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"/pki_int/issue/\u003crole_name\u003e\")),\" endpoint to request a new certificate.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Request a certificate for \",mdx(\"inlineCode\",{parentName:\"p\"},\"test.example.com\"),` domain based on the\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"example-dot-com\"),\" role:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --request POST \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),`       --data '{\"common_name\": \"test.example.com\", \"ttl\": \"24h\"}' \\\\`),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       https://127.0.0.1:8200/v1/pki_int/issue/example-dot-com | jq\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"{\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),' \"request_id\": \"6fa8d77d-0758-33ae-b5ea-8b3d15014fd1\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),' \"lease_id\": \"\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),' \"renewable\": false,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),' \"lease_duration\": 0,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),' \"data\": {'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"certificate\": \"-----BEGIN CERTIFICATE-----\\\\nMIIDvzCCAqegAwIBAgIUG7H0Pzpqm+...-----END CERTIFICATE-----\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"issuing_ca\": \"-----BEGIN CERTIFICATE-----\\\\nMIIDNTCCAh2gAwIBAgIUQhIX9D...-----END CERTIFICATE-----\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"private_key\": \"-----BEGIN RSA PRIVATE KEY-----\\\\nMIIEpAIBAAKCAQEAr6IsROOW5...-----END RSA PRIVATE KEY-----\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"private_key_type\": \"rsa\",'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),'   \"serial_number\": \"1b:b1:f4:3f:3a:6a:9b:e8:33:af:f7:1b:b1:4d:57:7f:65:65:39:c1\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\" },\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),' \"wrap_info\": null,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),' \"warnings\": null,'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),' \"auth\": null'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"}\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`The response contains the PEM-encoded private key, key type and certificate\nserial number.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-3\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-3\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Secrets\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"pki_int\"),\" from the \",mdx(\"strong\",{parentName:\"p\"},\"Secrets Engines\"),\" list.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"example-dot-com\"),\" under \",mdx(\"strong\",{parentName:\"p\"},\"Roles\"),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Enter \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"test.example.com\")),\" in the \",mdx(\"strong\",{parentName:\"p\"},\"Common Name\"),\" field.\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Options\"),\" to expand, and then set the \",mdx(\"strong\",{parentName:\"p\"},\"TTL\"),\" to \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"24 hours\")),\".\")),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"p\"},\"Hide Options\"),\" and then click \",mdx(\"strong\",{parentName:\"p\"},\"Generate\"),`.\n`,mdx(\"img\",e({parentName:\"p\"},{src:\"/img/vault-pki-3.png\",alt:\"Issue Certificate\"}))),mdx(\"blockquote\",{parentName:\"li\"},mdx(\"p\",e({parentName:\"blockquote\"},{className:\"g-type-long-body\"}),`The response contains the PEM-encoded private key, key type and certificate\nserial number.`))),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),mdx(\"p\",e({parentName:\"li\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"p\"},\"Copy credentials\"),\" and save it in a file.\"))),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\",role:\"alert\"}),mdx(\"p\",e({parentName:\"div\"},{className:\"g-type-long-body\"}),\"\",mdx(\"strong\",{parentName:\"p\"},\"NOTE:\"),` A certificate can be rotated at any time by simply issuing a new\ncertificate with the same CN.`)),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step5\",\"aria-label\":\"step 5 revoke certificates permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step5\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-5-revoke-certificates\",\"aria-hidden\":\"\"})),\"Step 5: Revoke Certificates\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`If a certificate must be revoked, you can easily perform the revocation action\nwhich will cause the CRL to be regenerated. When the CRL is regenerated, any\nexpired certificates are removed from the CRL.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-4\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-4\",\"aria-hidden\":\"\"})),\"CLI Command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"In a certain circumstances, you may wish to revoke an issued certificate.\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"To revoke:\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault \",mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"write\"),\" pki_int/revoke \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"serial_number\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"))),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\u003cserial_number\u003e\"),`\n`)),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault \",mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"write\"),\" pki_int/revoke \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"serial_number\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"48:97:82:dd:f0:d3:d9:7e:53:25:ba:fd:f6:77:3e:89:e5:65:cc:e7\"'))),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"Key                        Value\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"---                        -----\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"revocation_time            1532539632\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"revocation_time_rfc3339    2018-07-25T17:27:12.165206399Z\"),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-4\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-4\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Invoke the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"/pki_int/revoke\")),` endpoint to invoke a certificate using its\nserial number.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --request POST \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),`       --data '{\"serial_number\": \"48:97:82:dd:f0:d3:d9:7e:53:25:ba:fd:f6:77:3e:89:e5:65:cc:e7\"}' \\\\`),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       https://127.0.0.1:8200/v1/pki_int/revoke\"),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-4\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-4\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Secrets\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"pki_int\"),\" from the \",mdx(\"strong\",{parentName:\"li\"},\"Secrets Engines\"),\" list.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select the \",mdx(\"strong\",{parentName:\"li\"},\"eCertificates\"),\" tab.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select the serial number for the certificate you wish to revoke.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Revoke\"),\". At the confirmation, click \",mdx(\"strong\",{parentName:\"li\"},\"Revoke\"),\" again.\")),mdx(\"h3\",e({},{className:\"g-type-display-4\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#step6\",\"aria-label\":\"step 6 remove expired certificates permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h __compat\",id:\"step6\",\"aria-hidden\":\"\"})),mdx(\"a\",e({parentName:\"h3\"},{className:\"__target-h\",id:\"step-6-remove-expired-certificates\",\"aria-hidden\":\"\"})),\"Step 6: Remove Expired Certificates\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),`Keep the storage backend and CRL by periodically removing certificates that have\nexpired and are past a certain buffer period beyond their expiration time.`),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#cli-command-5\",\"aria-label\":\"cli command permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"cli-command-5\",\"aria-hidden\":\"\"})),\"CLI Command\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"To remove revoked certificate and clean the CRL.\"),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),\"vault \",mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"write\"),\" pki_int/tidy \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"tidy_cert_store\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"true \",mdx(\"span\",e({parentName:\"span\"},{className:\"token assign-left variable\"}),\"tidy_revoked_certs\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token operator\"}),\"=\"),\"true\")),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#api-call-using-curl-5\",\"aria-label\":\"api call using curl permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"api-call-using-curl-5\",\"aria-hidden\":\"\"})),\"API call using cURL\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Invoke the \",mdx(\"strong\",{parentName:\"p\"},mdx(\"inlineCode\",{parentName:\"strong\"},\"/pki_int/tidy\")),` endpoint to remove revoked certificate and clean\nthe CRL.`),mdx(\"p\",e({},{className:\"g-type-long-body\"}),mdx(\"strong\",{parentName:\"p\"},\"Example:\")),mdx(\"pre\",e({},{className:\"language-shell-session\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-shell-session\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token command\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token shell-symbol important\"}),\"$\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"token bash language-bash\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token function\"}),\"curl\"),\" --header \",mdx(\"span\",e({parentName:\"span\"},{className:\"token string\"}),'\"X-Vault-Token: ...\"'),\" \")),mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"\\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       --request POST \\\\\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),`       --data '{\"tidy_cert_store\": true, \"tidy_revoked_certs\": true}' \\\\`),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token output\"}),\"       https://127.0.0.1:8200/v1/pki_int/tidy\"),`\n`)),mdx(\"h4\",e({},{className:\"g-type-display-5\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#web-ui-5\",\"aria-label\":\"web ui permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h4\"},{className:\"__target-h\",id:\"web-ui-5\",\"aria-hidden\":\"\"})),\"Web UI\"),mdx(\"ol\",null,mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Secrets\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"pki_int\"),\" from the \",mdx(\"strong\",{parentName:\"li\"},\"Secrets Engines\"),\" list.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select \",mdx(\"strong\",{parentName:\"li\"},\"Configure\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select the \",mdx(\"strong\",{parentName:\"li\"},\"Tidy\"),\" tab.\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Select the check-box for \",mdx(\"strong\",{parentName:\"li\"},\"Tidy the Certificate Store\"),\" and \",mdx(\"strong\",{parentName:\"li\"},\"Tidy the Revocation List (CRL)\"),\".\"),mdx(\"li\",e({parentName:\"ol\"},{className:\"g-type-long-body\"}),\"Click \",mdx(\"strong\",{parentName:\"li\"},\"Save\"),\".\")),mdx(\"h2\",e({},{className:\"g-type-display-3\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#next-steps\",\"aria-label\":\"next steps permalink\"}),\"\\xBB\"),mdx(\"a\",e({parentName:\"h2\"},{className:\"__target-h\",id:\"next-steps\",\"aria-hidden\":\"\"})),\"Next steps\"),mdx(\"p\",e({},{className:\"g-type-long-body\"}),\"Check out the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.hashicorp.com/resources/streamline-certificate-management-with-vault\"}),`Streamline Certificate Management with HashiCorp\nVault`),`\nwebinar recording.`))}MDXContent.isMDXComponent=!0;\n","scope":{}},"navData":[{"title":"Getting Started","path":"getting-started","filePath":"content/guides/getting-started.mdx"},{"title":"Vault Operations","routes":[{"title":"Overview","path":"operations","filePath":"content/guides/operations/index.mdx"},{"title":"Reference Architecture","path":"operations/reference-architecture","filePath":"content/guides/operations/reference-architecture.mdx"},{"title":"Vault HA with Consul","path":"operations/vault-ha-consul","filePath":"content/guides/operations/vault-ha-consul.mdx"},{"title":"Production Hardening","path":"operations/production","filePath":"content/guides/operations/production.mdx"},{"title":"Root Token Generation","path":"operations/generate-root","filePath":"content/guides/operations/generate-root.mdx"},{"title":"Rekeying \u0026 Rotating","path":"operations/rekeying-and-rotating","filePath":"content/guides/operations/rekeying-and-rotating.mdx"},{"title":"Building Plugin Backends","path":"operations/plugin-backends","filePath":"content/guides/operations/plugin-backends.mdx"},{"divider":true},{"title":"Replication Setup \u0026 Guidance","path":"operations/replication","filePath":"content/guides/operations/replication.mdx"},{"title":"Disaster Recovery Setup","path":"operations/disaster-recovery","filePath":"content/guides/operations/disaster-recovery.mdx"},{"title":"Mount Filter","path":"operations/mount-filter","filePath":"content/guides/operations/mount-filter.mdx"},{"title":"Multi-Tenant: Namespaces","path":"operations/multi-tenant","filePath":"content/guides/operations/multi-tenant.mdx"},{"title":"Vault Auto-unseal with AWS KMS","path":"operations/autounseal-aws-kms","filePath":"content/guides/operations/autounseal-aws-kms.mdx"},{"title":"Seal Wrap / FIPS 140-2","path":"operations/seal-wrap","filePath":"content/guides/operations/seal-wrap.mdx"},{"title":"Vault Cluster Monitoring","path":"operations/monitoring","filePath":"content/guides/operations/monitoring.mdx"},{"title":"Vault Deployment Guide","path":"operations/deployment-guide","filePath":"content/guides/operations/deployment-guide.mdx"},{"title":"Performance Standby Nodes","path":"operations/performance-nodes","filePath":"content/guides/operations/performance-nodes.mdx"}]},{"title":"Identity and Access Management","routes":[{"title":"Overview","path":"identity","filePath":"content/guides/identity/index.mdx"},{"title":"Secure Introduction of Vault Clients","path":"identity/secure-intro","filePath":"content/guides/identity/secure-intro.mdx"},{"title":"Policies","path":"identity/policies","filePath":"content/guides/identity/policies.mdx"},{"title":"ACL Policy Path Templating","path":"identity/policy-templating","filePath":"content/guides/identity/policy-templating.mdx"},{"title":"AppRole Pull Authentication","path":"identity/authentication","filePath":"content/guides/identity/authentication.mdx"},{"title":"AppRole with Terraform and Chef","path":"identity/approle-trusted-entities","filePath":"content/guides/identity/approle-trusted-entities.mdx"},{"title":"Tokens and Leases","path":"identity/lease","filePath":"content/guides/identity/lease.mdx"},{"title":"Identity - Entities \u0026 Groups","path":"identity/identity","filePath":"content/guides/identity/identity.mdx"},{"divider":true},{"title":"Sentinel Policies","path":"identity/sentinel","filePath":"content/guides/identity/sentinel.mdx"},{"title":"Control Groups","path":"identity/control-groups","filePath":"content/guides/identity/control-groups.mdx"}]},{"title":"Secrets Management","routes":[{"title":"Overview","path":"secret-mgmt","filePath":"content/guides/secret-mgmt/index.mdx"},{"title":"Static Secrets","path":"secret-mgmt/static-secrets","filePath":"content/guides/secret-mgmt/static-secrets.mdx"},{"title":"Versioned KV Secret Engine","path":"secret-mgmt/versioned-kv","filePath":"content/guides/secret-mgmt/versioned-kv.mdx"},{"title":"Secret as a Service","path":"secret-mgmt/dynamic-secrets","filePath":"content/guides/secret-mgmt/dynamic-secrets.mdx"},{"title":"DB Root Credential Rotation","path":"secret-mgmt/db-root-rotation","filePath":"content/guides/secret-mgmt/db-root-rotation.mdx"},{"title":"Cubbyhole Response Wrapping","path":"secret-mgmt/cubbyhole","filePath":"content/guides/secret-mgmt/cubbyhole.mdx"},{"title":"One-Time SSH Password","path":"secret-mgmt/ssh-otp","filePath":"content/guides/secret-mgmt/ssh-otp.mdx"},{"title":"Build Your Own CA","path":"secret-mgmt/pki-engine","filePath":"content/guides/secret-mgmt/pki-engine.mdx"},{"title":"Direct Application Integration","path":"secret-mgmt/app-integration","filePath":"content/guides/secret-mgmt/app-integration.mdx"}]},{"title":"Encryption as a Service","routes":[{"title":"Overview","path":"encryption","filePath":"content/guides/encryption/index.mdx"},{"title":"Encryption as a Service","path":"encryption/transit","filePath":"content/guides/encryption/transit.mdx"},{"title":"Java Application Demo","path":"encryption/spring-demo","filePath":"content/guides/encryption/spring-demo.mdx"},{"title":"Transit Secrets Re-wrapping","path":"encryption/transit-rewrap","filePath":"content/guides/encryption/transit-rewrap.mdx"}]}],"versions":[]},"__N_SSG":true},"page":"/guides/[[...page]]","query":{"page":["secret-mgmt","pki-engine"]},"buildId":"pcCu12fyWK7PoQNj4BZ7-","assetPrefix":"/docs/vault_v1.8.x","isFallback":false,"gsp":true}</script><script nomodule="" src="/docs/vault_v1.8.x/_next/static/chunks/polyfills-e4c38ea28892f36667af.js"></script><script src="/docs/vault_v1.8.x/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/framework.3519294afa6a9ab53973.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/2bc72d9a08d5bd816ae6b580871df9fb671d43bb.52fd5ef7a8ab7d8fc0dd.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/9a5be27b89b50ff891e514a88cd42f143404f9a6.033857d62f5a01edf3b3.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/main-b0f1f3f8bd3bddd4e6cd.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/b49b08e2da573413c730dfc51ae423f080a0c275.00ac32ee45240d5b343f.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/b1542cc239bf56c8a14913c0a930efe682b5cf86.32bb900ad80311488529.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/pages/_app-d714c55ad24af91621ba.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/7dbdcaca29374b13a0799a901e26613767d72de2.d088888a4a1113f2bb24.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/92f0085e0e6c1f10382de10b8861ce89d7c192a2.e5495ede8461fc33ed98.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b.5052eda5c7f43583669b.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/e697469aff49e0b13fc0c4d2651008fc1aaadc2b_CSS.f6584926f1188e1b5b3e.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/chunks/pages/guides/%5B%5B...page%5D%5D-72f9db6e509b49c776de.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/pcCu12fyWK7PoQNj4BZ7-/_buildManifest.js" async=""></script><script src="/docs/vault_v1.8.x/_next/static/pcCu12fyWK7PoQNj4BZ7-/_ssgManifest.js" async=""></script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-custom-properties.js"><\x2fscript>');</script></body></html>