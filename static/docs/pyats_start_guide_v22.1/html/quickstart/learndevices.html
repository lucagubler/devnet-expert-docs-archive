

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Learn Device Features &mdash; Get Started with pyATS  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=83f4edbc" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7f41d439"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/js/custom.js?v=80dc6f7b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configure Devices" href="configuredevices.html" />
    <link rel="prev" title="Parse Device Output" href="parseoutput.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Get Started with pyATS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/architecture.html">Test Ecosystem Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prereqs/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/installpyATS.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basic Concepts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="structureofastatement.html">Everything is Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="manageconnections.html">Device Connection</a></li>
<li class="toctree-l1"><a class="reference internal" href="parseoutput.html">Parse Device Output</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Learn Device Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#learning-mechanism-explained">“Learning” Mechanism Explained</a></li>
<li class="toctree-l2"><a class="reference internal" href="#supported-features">Supported Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#learn-examples">“Learn” Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#learn-a-single-feature">Learn a Single Feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#learn-multiple-features">Learn Multiple Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#across-multiple-devices">Across Multiple Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#on-a-single-device">On a Single Device</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuredevices.html">Configure Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparebeforeafter.html">Compare Network States</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtestcase.html">Run Test Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="deviceapis.html">Helpful Device APIs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Best Practices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/intro.html">Concept Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/design.html">Design &amp; Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/style.html">Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/general.html">General Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/test.html">Test Suite Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/lib.html">Library Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/topology.html">Topology Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/job.html">Job Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bestpractices/doAndDont.html">Do &amp; Don’t</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/scenarios.html">Real-world examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="keyconcepts.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Get Started with pyATS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Learn Device Features</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
.question {background-color: yellow; font-weight:bold; padding: .25em;}
.monospace {font-family: monospace; color: #404040; font-size: 14px;}
.border {border: 1px #404040;}
</style><section id="learn-device-features">
<span id="learn-features"></span><h1>Learn Device Features<a class="headerlink" href="#learn-device-features" title="Link to this heading"></a></h1>
<p>This topic describes how to use the <code class="docutils literal notranslate"><span class="pre">learn</span></code> function of the <strong>pyATS Library</strong> <code class="docutils literal notranslate"><span class="pre">Ops</span></code> module for stateful network validation of device features, such as protocols, interfaces, line cards, and other hardware.</p>
<p>The term <em>feature</em> typically refers to a network protocol, represented by the pyATS Library as a Python object, with attributes that represent the feature (protocol) configuration on a device. Many networks use a combination of different features, such as BGP, OSPF, and Interface.</p>
<section id="learning-mechanism-explained">
<span id="cli-learn"></span><h2>“Learning” Mechanism Explained<a class="headerlink" href="#learning-mechanism-explained" title="Link to this heading"></a></h2>
<p>The pyATS Library Ops module provides a representation of the current operational state of a device, per feature (protocol). It “learns” the operational state by executing a series of commands and parsing the output into a common data structure across different operating systems.</p>
<p>The output is stored with the same <a class="reference internal" href="keyconcepts.html#term-Key-value-pair"><span class="xref std std-term">key-value pair</span></a> structure across devices. The stored output makes it possible for you to take a snapshot of the network state at different points in time, and then to <a class="reference internal" href="comparebeforeafter.html#compare-network-states"><span class="std std-ref">compare network states</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Why use <code class="docutils literal notranslate"><span class="pre">learn</span></code> instead of a <a class="reference internal" href="keyconcepts.html#term-Parser"><span class="xref std std-term">parser</span></a>? The parsed output for different devices can result in different data structures. The <code class="docutils literal notranslate"><span class="pre">learn</span></code> function, by contrast, results in a <em>consistent</em> set of keys, which means that you can write <em>one</em> script that works on different devices.</p>
</div>
</section>
<section id="supported-features">
<span id="id1"></span><h2>Supported Features<a class="headerlink" href="#supported-features" title="Link to this heading"></a></h2>
<p>To see a complete list of the features that the pyATS Library can learn, and to see the resulting data structure for each feature, visit the <a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/models">Models</a> page.</p>
<p>If you try to “learn” a feature that we don’t yet support, the system returns the following exception:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>|---------------------------------------------------------------------------------|
|  Could not learn feature &#39;acl&#39;                                                  |
|  -  Exception:      genie_learn_all/acl_nxos_nx-osv-1_exception.txt             |
|  -  Feature not yet developed for this os                                       |
|---------------------------------------------------------------------------------|
</pre></div>
</div>
</div></blockquote>
<p>If you want to request support for a new feature, please contact us at <a class="reference external" href="mailto:pyats-support-ext&#37;&#52;&#48;cisco&#46;com">pyats-support-ext<span>&#64;</span>cisco<span>&#46;</span>com</a></p>
</section>
<section id="learn-examples">
<h2>“Learn” Examples<a class="headerlink" href="#learn-examples" title="Link to this heading"></a></h2>
<p>This topic describes how you can tell the system to learn one or more features.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Before you try these examples, make sure that you <a class="reference download internal" download="" href="../_downloads/04c1c0ffd3a875e85db16c7408c0f784/mock.zip"><code class="xref download docutils literal notranslate"><span class="pre">download</span> <span class="pre">and</span> <span class="pre">extract</span> <span class="pre">the</span> <span class="pre">zip</span> <span class="pre">file</span></code></a> that contains the mock data and Python script.</p>
</div>
<section id="learn-a-single-feature">
<h3>Learn a Single Feature<a class="headerlink" href="#learn-a-single-feature" title="Link to this heading"></a></h3>
<p>To learn one feature on a single device, you can use the device hostname or the device alias (defined in the testbed YAML file). In the following example, <code class="docutils literal notranslate"><span class="pre">uut</span></code> is the alias “unit under test” for the host <code class="docutils literal notranslate"><span class="pre">nx-osv-1</span></code>.</p>
<ol class="arabic">
<li><p>In your virtual environment, change to the directory that contains the mock YAML file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ cd mock
</pre></div>
</div>
</li>
<li><p>You can use a Python interpreter or the <a class="reference internal" href="keyconcepts.html#term-Library-command-line"><span class="xref std std-term">library command line</span></a>.</p>
<blockquote>
<div><ul>
<li><p>If you want to use Python, you can use <code class="docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">shell</span></code> to load the <code class="docutils literal notranslate"><span class="pre">testbed</span></code> API and create your testbed and device objects. Then, connect to the device and tell the system to learn the feature. In this example, the system stores the output as a Python dictionary in the variable <code class="docutils literal notranslate"><span class="pre">output</span></code>:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ pyats shell --testbed-file mock.yaml
  &gt;&gt;&gt; dev = testbed.devices[&#39;uut&#39;]
  &gt;&gt;&gt; dev.connect()
  &gt;&gt;&gt; output = dev.learn(&#39;ospf&#39;)
</pre></div>
</div>
</div></blockquote>
<p><em>Result</em>: The system displays a summary of the parsed <code class="docutils literal notranslate"><span class="pre">show</span></code> commands that ran. <br /> <br /></p>
</li>
<li><p>If you want to use the CLI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ pyats learn ospf --testbed-file mock.yaml --devices uut --output output_folder
</pre></div>
</div>
<p><em>Result</em>: The system connects to the device, runs the show commands, stores the output in JSON format in the specified directory, and displays a “Learn Summary” that shows the names of the output files. These include:</p>
<blockquote>
<div><ul class="simple">
<li><p>Connection log</p></li>
<li><p>Structured JSON output</p></li>
<li><p>Device console output <br /> <br /></p></li>
</ul>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+==============================================================================+
| Genie Learn Summary for device nx-osv-1                                      |
+==============================================================================+
|  Connected to nx-osv-1                                                       |
|  -   Log: output_folder/connection_uut.txt                                   |
|------------------------------------------------------------------------------|
|  Learnt feature &#39;ospf&#39;                                                       |
|  -  Ops structure:  output_folder/ospf_nxos_nx-osv-1_ops.txt                 |
|  -  Device Console: output_folder/ospf_nxos_nx-osv-1_console.txt             |
|==============================================================================|
</pre></div>
</div>
</div></blockquote>
<p>To see the structured data, use a text editor to open the file <span class="monospace">output_folder/ospf_nxos_nx-osv-1_ops.txt</span>.</p>
</li>
</ul>
</div></blockquote>
</li>
</ol>
</section>
<section id="learn-multiple-features">
<h3>Learn Multiple Features<a class="headerlink" href="#learn-multiple-features" title="Link to this heading"></a></h3>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">learn</span></code> function to get the operational states of multiple or all features, as shown in the following examples.</p>
<section id="across-multiple-devices">
<h4>Across Multiple Devices<a class="headerlink" href="#across-multiple-devices" title="Link to this heading"></a></h4>
<p>This example shows you how to learn the <code class="docutils literal notranslate"><span class="pre">bgp</span></code> and <code class="docutils literal notranslate"><span class="pre">ospf</span></code> features on all of the devices in your testbed.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The mock data only contains one device, so you will only see the results for that device.</p>
</div>
</div></blockquote>
<ol class="arabic">
<li><p>In your virtual environment, change to the directory that contains the mock YAML file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ cd mock
</pre></div>
</div>
</li>
<li><p>You can use a Python interpreter or the <a class="reference internal" href="keyconcepts.html#term-Library-command-line"><span class="xref std std-term">library command line</span></a>.</p>
<blockquote>
<div><ul>
<li><p>If you want to use Python, you can use <code class="docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">shell</span></code> to load the <code class="docutils literal notranslate"><span class="pre">testbed</span></code> API and create your testbed and device objects. Then, tell the system to connect to each device and to learn the specified features. In this example, the system stores the output as a Python dictionary in the variable <code class="docutils literal notranslate"><span class="pre">learnt</span></code> and displays the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ pyats shell --testbed-file mock.yaml
   &gt;&gt;&gt; learnt = {}
   &gt;&gt;&gt; for name, dev in testbed.devices.items():
   ...     dev.connect()
   ...     learnt[name] = {}
   ...     learnt[name][&#39;bgp&#39;] = dev.learn(&#39;bgp&#39;)
   ...     learnt[name][&#39;ospf&#39;] = dev.learn(&#39;ospf&#39;)
   ...
</pre></div>
</div>
<p>This example uses a Python <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to execute each statement on all devices in the testbed. The system stores the feature information in Python dictionaries, each identified by the device name. <br /> <br /></p>
</li>
<li><p>If you want to use the CLI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ pyats learn bgp ospf --testbed-file mock.yaml --output output_folder
</pre></div>
</div>
<p><em>Result</em>: Within the output directory, the system creates the output files and displays a summary for each device.</p>
<p>The following example shows what you would see.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+==============================================================================+
| Genie Learn Summary for device nx-osv-1                                      |
+==============================================================================+
|  Connected to nx-osv-1                                                       |
|  -   Log: output_folder/connection_nx-osv-1.txt                              |
|------------------------------------------------------------------------------|
|  Learnt feature &#39;bgp&#39;                                                        |
|  -  Ops structure:  output_folder/bgp_nxos_nx-osv-1_ops.txt                  |
|  -  Device Console: output_folder/bgp_nxos_nx-osv-1_console.txt              |
|------------------------------------------------------------------------------|
|  Learnt feature &#39;ospf&#39;                                                       |
|  -  Ops structure:  output_folder/ospf_nxos_nx-osv-1_ops.txt                 |
|  -  Device Console: output_folder/ospf_nxos_nx-osv-1_console.txt             |
|==============================================================================|


+==============================================================================+
| Genie Learn Summary for device csr1000v-1                                    |
+==============================================================================+
|  Connected to csr1000v-1                                                     |
|  -   Log: output_folder/connection_csr1000v-1.txt                            |
|------------------------------------------------------------------------------|
|  Learnt feature &#39;bgp&#39;                                                        |
|  -  Ops structure:  output_folder/bgp_iosxe_csr1000v-1_ops.txt               |
|  -  Device Console: output_folder/bgp_iosxe_csr1000v-1_console.txt           |
|------------------------------------------------------------------------------|
|  Learnt feature &#39;ospf&#39;                                                       |
|  -  Ops structure:  output_folder/ospf_iosxe_csr1000v-1_ops.txt              |
|  -  Device Console: output_folder/ospf_iosxe_csr1000v-1_console.txt          |
|==============================================================================|
</pre></div>
</div>
<p>To see the structured data, use a text editor to open any of the <code class="docutils literal notranslate"><span class="pre">ops.txt</span></code> files.</p>
</li>
</ul>
</div></blockquote>
</li>
</ol>
</section>
<section id="on-a-single-device">
<h4>On a Single Device<a class="headerlink" href="#on-a-single-device" title="Link to this heading"></a></h4>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">learn</span> <span class="pre">all</span></code> functionality to learn all of the supported features on a device. The system returns the results in a format with key-value pairs, and notifies you of any exceptions for features it did not learn.</p>
</div>
<ol class="arabic">
<li><p>In your virtual environment, change to the directory that contains the mock YAML file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ cd mock
</pre></div>
</div>
</li>
<li><p>You can use a Python interpreter or the <a class="reference internal" href="keyconcepts.html#term-Library-command-line"><span class="xref std std-term">library command line</span></a>.</p>
<blockquote>
<div><ul>
<li><p>If you want to use Python, you can use <code class="docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">shell</span></code> to load the <code class="docutils literal notranslate"><span class="pre">testbed</span></code> API and create your testbed and device objects. Then, connect to the device and tell the system to learn all of the features. In this example, the system stores the output as a Python dictionary in the variable <code class="docutils literal notranslate"><span class="pre">output</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ pyats shell --testbed-file mock.yaml
   &gt;&gt;&gt; dev = testbed.devices[&#39;uut&#39;]
   &gt;&gt;&gt; dev.connect()
   &gt;&gt;&gt; output = dev.learn(&#39;all&#39;)
</pre></div>
</div>
</li>
<li><p>If you want to use the CLI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(pyats) $ pyats learn all --testbed-file mock.yaml --devices uut --output output_folder
</pre></div>
</div>
<p><em>Result</em>: The system saves all of the console and structured output files in JSON format to the specified directory and displays a summary of the results, as shown in the following example.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+=================================================================================+
| Genie Learn Summary for device nx-osv-1                                         |
+=================================================================================+
|  Connected to nx-osv-1                                                          |
|  -   Log: genie_learn_all/connection_uut.txt                                    |
|---------------------------------------------------------------------------------|
|  Could not learn feature &#39;acl&#39;                                                  |
|  -  Exception:      genie_learn_all/acl_nxos_nx-osv-1_exception.txt             |
|  -  Feature not yet developed for this os                                      |
|---------------------------------------------------------------------------------|
|  Learnt feature &#39;bgp&#39;                                                           |
|  -  Ops structure:  genie_learn_all/bgp_nxos_nx-osv-1_ops.txt                   |
|  -  Device Console: genie_learn_all/bgp_nxos_nx-osv-1_console.txt               |
|---------------------------------------------------------------------------------|
|  Could not learn feature &#39;dot1x&#39;                                                |
|  -  Exception:      genie_learn_all/dot1x_nxos_nx-osv-1_exception.txt           |
|  -  Feature not yet developed for this os                                       |
|---------------------------------------------------------------------------------|
</pre></div>
</div>
<p>To see the structured data, use a text editor to open any of the <code class="docutils literal notranslate"><span class="pre">ops.txt</span></code> files.</p>
</li>
</ul>
</div></blockquote>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If we don’t support a feature on a device, the system returns an exception, as shown in this example. For more information, see the section <a class="reference internal" href="#supported-features"><span class="std std-ref">Supported Features</span></a>.</p>
</div>
<p>See also…</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-docs/docs/userguide/Ops/index.html#ops-guide">Description of the Ops module</a></p></li>
</ul>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parseoutput.html" class="btn btn-neutral float-left" title="Parse Device Output" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="configuredevices.html" class="btn btn-neutral float-right" title="Configure Devices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Cisco Systems Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>