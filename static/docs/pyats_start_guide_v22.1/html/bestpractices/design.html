

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Design &amp; Development &mdash; Get Started with pyATS  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=83f4edbc" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7f41d439"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/js/custom.js?v=80dc6f7b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Style Guide" href="style.html" />
    <link rel="prev" title="Concept Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Get Started with pyATS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/architecture.html">Test Ecosystem Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prereqs/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/installpyATS.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basic Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/structureofastatement.html">Everything is Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/manageconnections.html">Device Connection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/parseoutput.html">Parse Device Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/learndevices.html">Learn Device Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/configuredevices.html">Configure Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/comparebeforeafter.html">Compare Network States</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/runtestcase.html">Run Test Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/deviceapis.html">Helpful Device APIs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Best Practices</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Concept Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Design &amp; Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#automate-everything">Automate Everything?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#make-it-simple">Make It Simple</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-k-i-s-s-principle">The K.I.S.S. Principle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#don-t-reinvent-the-wheel">Don’t reinvent the wheel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#leave-it-to-the-pros">Leave it to the pros</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#make-it-modular">Make it Modular</a></li>
<li class="toctree-l2"><a class="reference internal" href="#make-it-dynamic">Make It Dynamic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#make-it-agnostic">Make It Agnostic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#make-it-unique-independent">Make it Unique &amp; Independent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimize-optimize-optimize">Optimize, Optimize, Optimize</a></li>
<li class="toctree-l2"><a class="reference internal" href="#assume-nothing">Assume Nothing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#follow-the-guidelines">Follow the Guidelines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="style.html">Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="general.html">General Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Test Suite Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">Library Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="topology.html">Topology Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="job.html">Job Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="doAndDont.html">Do &amp; Don’t</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/scenarios.html">Real-world examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/keyconcepts.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Get Started with pyATS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Design &amp; Development</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
.question {background-color: yellow; font-weight:bold; padding: .25em;}
.monospace {font-family: monospace; color: #404040; font-size: 14px;}
.border {border: 1px #404040;}
</style><section id="design-development">
<h1>Design &amp; Development<a class="headerlink" href="#design-development" title="Link to this heading"></a></h1>
<p>Following Agile software development methodology, test suites shall be carefully
planned, designed, and iteratively developed. This section provides high-level
insights on how pyATS test automation development should be properly carried
out.</p>
<section id="automate-everything">
<h2>Automate Everything?<a class="headerlink" href="#automate-everything" title="Link to this heading"></a></h2>
<p>Ideally, all tests should be automated. However, this isn’t always practical,
feasible, and/or cost-effective. The following questions should be answered as
part of your design phase for determining which tests should be automated:</p>
<ul class="simple">
<li><p>How critical is this feature?</p></li>
<li><p>How likely will this test find potential bugs/errors/problems?</p></li>
<li><p>What are the costs (both time/effort and hardware/software requirements) of
automating this test?</p></li>
<li><p>What is the longevity and long-term benefits of automating this test?</p></li>
<li><p>Will it generate by-products (e.g., libraries) that others may leverage?</p></li>
</ul>
</section>
<section id="make-it-simple">
<h2>Make It Simple<a class="headerlink" href="#make-it-simple" title="Link to this heading"></a></h2>
<p>The simplest things are often the hardest: use and perform only what is
necessary to achieve your goals, and avoid overly complicating your design,
implementation and requirements. However, do not confuse simplicity and
straightforwardness with poor designs. A simple design can still be elegant,
extendable and effective.</p>
<section id="the-k-i-s-s-principle">
<h3>The K.I.S.S. Principle<a class="headerlink" href="#the-k-i-s-s-principle" title="Link to this heading"></a></h3>
<p>Always consider factors such as hardware/software/license costs,
development/setup/execution times, and the skills &amp; efforts required to use and
maintain your product. Keep in mind that your creations will be
used for years to come, passed from one engineer to the next: simplicity
facilitates the long-term sustenance costs.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad</span>
<span class="k">def</span> <span class="nf">GetMemory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">testbed</span><span class="p">,</span> <span class="n">testscript</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">param</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">uut_arr</span> <span class="o">=</span> <span class="n">testscript</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;devices&#39;</span><span class="p">]</span>
    <span class="n">uut</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="n">uut_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">uut</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">uut</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;show memory&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">param</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">free_memory</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">free_memory</span> <span class="o">&lt;=</span> <span class="mi">1048576</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Not enough free memory&quot;</span><span class="p">)</span>
            <span class="n">method</span><span class="o">.</span><span class="n">failed</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Good</span>
<span class="k">def</span> <span class="nf">verify_minimum_size</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">minimum_size</span><span class="p">):</span>
<span class="n">device</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;show memory&#39;</span><span class="p">)</span>
<span class="n">free_memory</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;free_memory&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="n">free_memory</span> <span class="o">&lt;=</span> <span class="n">minimum_size</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Requires at least </span><span class="si">{minimium_size}</span><span class="s1"> of free memory; &#39;</span>
                    <span class="s1">&#39;but only </span><span class="si">{free_memory}</span><span class="s1"> is available&#39;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">minimum_size</span><span class="o">=</span><span class="n">minimum_size</span><span class="p">,</span>
                            <span class="n">free_memory</span><span class="o">=</span><span class="n">free_memory</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="don-t-reinvent-the-wheel">
<h3>Don’t reinvent the wheel<a class="headerlink" href="#don-t-reinvent-the-wheel" title="Link to this heading"></a></h3>
<p>Prioritize the use of existing tools, packages and libraries. Where needed,
use best-of-breed open-source solutions – when doing so, make sure it is
popular, well developed &amp; supported.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># Bad</span>
    <span class="n">d</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;reload</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="s2">&quot;Proceed with reload?&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;y</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Sleeping 200 seconds for CSR image reload&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>


<span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">python</span>

    <span class="c1"># Good</span>
    <span class="n">device</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">sleep_time</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="leave-it-to-the-pros">
<h3>Leave it to the pros<a class="headerlink" href="#leave-it-to-the-pros" title="Link to this heading"></a></h3>
<p>Always use these external components in
their originally intended fashion: taking unintended shortcuts and hacking
internals often leads to long-term technical debt.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">uut</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;show processes | include CPU&quot;</span><span class="p">)</span>
<span class="n">words</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="c1">#for five seconds</span>
<span class="n">fives_string</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">fives_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fives_string</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span>
<span class="k">return</span> <span class="n">fives_number</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Good</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">dev</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;show processes&#39;</span><span class="p">)</span>
<span class="n">cpu</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;cpu_load&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="make-it-modular">
<h2>Make it Modular<a class="headerlink" href="#make-it-modular" title="Link to this heading"></a></h2>
<p>Properly designed, modular software is independent, interchangeable, easy to
read, extend and debug. Test automation itself is software: and thus also
benefits from modular programming techniques. This includes both implementing
in an object-oriented fashion, as well as grouping these objects (classes) into
corresponding modules &amp; packages, making it easy for others to leverage and use.</p>
<p>Use and enhance existing, shared libraries whenever possible (either through
direct modification and/or inheritance). Make sure your changes are backwards
compatible and/or do not break existing test suites and functionalities.</p>
<p>When developing from scratch, follow object-oriented programming practices,
and create objects (classes) that contains both data (attributes), and code
(methods) that acts on those data, encapsulating unnecessary details and complex
operations, promoting code reuse, and enabling object inheritance/extensions. If
applicable, commit your newly creations into corresponding existing libraries in
order to further expand their usefulness. Otherwise, create a new shared
library. Avoid local, private libraries and silo-development.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad</span>
<span class="k">def</span> <span class="nf">get_release_version</span><span class="p">(</span><span class="n">ctlr</span><span class="p">):</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">ctlr</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">ctlr</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="n">ctlr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show version&#39;</span><span class="p">)</span>
    <span class="n">ver</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
    <span class="n">ver_line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">version_num</span> <span class="o">=</span> <span class="s1">&#39;16.12&#39;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ver</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Experimental Version (\d+\.\d+)\.\d+\:\d+.*&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">version_num</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">version_num</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Release Image version : &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">version_num</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">version_num</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Unable to get release Image version from the device: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctlr</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Exception Debug </span><span class="si">{}</span><span class="s2"> ....&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Good</span>
<span class="k">def</span> <span class="nf">get_release_version</span><span class="p">(</span><span class="n">device</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">device</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
        <span class="n">device</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;show version&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>

<span class="k">if</span> <span class="n">get_release_version</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;16.12&#39;</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Here are some generic principles to remember when coding:</p>
<ul class="simple">
<li><p>Use classes, objects and methods over functions and procedures</p></li>
<li><p>Segregate independent concepts/features/functionalities into different classes &amp; objects</p></li>
<li><p>Inherit &amp; extend existing classes when commonalities exist</p></li>
<li><p>Make your implementation generic and catch-all</p></li>
<li><p>Avoid unnecessary deep nesting of loops and procedures</p></li>
<li><p>Limit the number of logic path per function, avoid using too many input parameters</p></li>
</ul>
</section>
<section id="make-it-dynamic">
<h2>Make It Dynamic<a class="headerlink" href="#make-it-dynamic" title="Link to this heading"></a></h2>
<p>Dynamic software can be driven with different inputs (parameters) yield
different results and/or do different things. This promotes code-reusability
and increases code flexibility.</p>
<p>Avoid hard-coding values within your classes, functions and test suite. Avoid
duplicating the same code and only changing a minor piece of it
(configuration/data/value). Always separate data variables (such as
configuration, timing, name, etc) apart from the procedural implementation
(eg, function, class, method). This encourages for a design that is more
generic, robust and extendable.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad</span>
<span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
<span class="k">def</span> <span class="nf">copy_codecov</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">testbed</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="s1">&#39;csr127&#39;</span><span class="p">]</span>
    <span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;cflow copy&#39;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;request platform software system shell</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="s2">&quot;Are you sure you want to continue?&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;y</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="s2">&quot;\[csr127:\/\]\$&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;chmod 777 bootflash/cflow</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="s2">&quot;\[csr127:\/\]\$&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;tar -zcvf bootflash/codecov.tar.gz bootflash/cflow/</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="s2">&quot;\[csr127:\/\]\$&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;exit</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="s2">&quot;csr127#&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">## config &quot;file prompt quiet&quot; to disable prompts</span>
    <span class="n">d</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;copy bootflash:codecov.tar.gz tftp://223.255.254.254/alllo/FIBModelTest/copyout/</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="s2">&quot;csr127#&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span> <span class="c1">#always on the last action on box</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Good</span>
<span class="nd">@aetest</span><span class="o">.</span><span class="n">subsection</span>
<span class="k">def</span> <span class="nf">copy_codecov</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">testbed</span><span class="p">,</span> <span class="n">device_name</span><span class="p">,</span> <span class="n">base_dir</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">,</span> <span class="n">zip_file</span><span class="p">,</span> <span class="n">ip_mount</span><span class="p">):</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="n">device_name</span><span class="p">]</span>
    <span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;cflow copy&#39;</span><span class="p">)</span>

    <span class="n">dialog</span> <span class="o">=</span> <span class="n">Dialog</span><span class="p">([</span>
        <span class="n">Statement</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Are you sure you want to continue\?&#39;</span><span class="p">,</span>
                <span class="n">action</span><span class="o">=</span><span class="s1">&#39;sendline(y)&#39;</span><span class="p">)])</span>

    <span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;request platform software system shell&quot;</span><span class="p">,</span> <span class="n">reply</span><span class="o">=</span><span class="n">dialog</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;chmod 777 </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">target_dir</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;tar -zcvf </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">zip_file</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;exit&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;copy </span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1"> tftp:</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">zip_file</span><span class="p">,</span> <span class="n">ip_mount</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">d</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>The best approach to test automation is to design generic test suites and
libraries that can be driven with data that alters its footprint (e.g.
configuration/scaling/HW/SW) whilst still performing, testing and reporting to
the same degree. This way, test cases become only a particular combination of
calls to library functions with arguments/parameters unique to that test case,
offsetting major development effort into creating sharable, reusable and
independent libraries.</p>
</section>
<section id="make-it-agnostic">
<h2>Make It Agnostic<a class="headerlink" href="#make-it-agnostic" title="Link to this heading"></a></h2>
<p>Agnostic, single-source test suites have the potential to work across a variety
of releases, platforms, OSes, as well as through different management interfaces
such as CLI, NETCONF, RESTCONF and gRPC. This vastly increases test suite
sustainability, reducing development and maintenance costs by allowing users
to keep reusing the same suite and simply provide the set of libraries that
handles these new deltas.</p>
<p>Take advantage of object-oriented programming paradigms such as inheritance,
duck-typing and factory functions.  Avoid duplicating anything
(scripts/libraries), and always look for ways to re-use, uplift and/or
refactor existing ones. Your neighbors will thank you dearly when your test
suites are written to leverage abstraction (genie.abstract) from day-one.</p>
</section>
<section id="make-it-unique-independent">
<h2>Make it Unique &amp; Independent<a class="headerlink" href="#make-it-unique-independent" title="Link to this heading"></a></h2>
<p>Each test suite should be unique, and should contain a collection of independent
tests that tests the different facets of the same feature or component. This
allows runs to be able to pick &amp; choose tests (tiers), and as well be able to
run tests in randomized order.</p>
<p>Each library should also be unique. E.g. it is a collection of classes,
functions, methods and procedures that acts on a common, unique domain/topic.
Leverage code search tools (eg, grep, GitHub search) to find out whether what
you’re looking for already exists.</p>
</section>
<section id="optimize-optimize-optimize">
<h2>Optimize, Optimize, Optimize<a class="headerlink" href="#optimize-optimize-optimize" title="Link to this heading"></a></h2>
<p>Optimization can be done in many ways: logic flow optimization, test pattern
optimization, runtime optimization (asynchronous executions), source code
modularization/modernization, etc. As your libraries and test suites grow in
order to support the ever-increasing number of releases, hardware and features,
it’s important to refactor and optimize when possible (without reducing
coverage) in order to keep the source code lean and effective.</p>
<p>Here are some tips regarding generic optimizations:</p>
<ul class="simple">
<li><p>Run things in parallel: when possible (e.g., no race conditions),
run functions/methods/tests/suites in parallel (asynchronously) in order
to save runtime.</p></li>
<li><p>Poll states: instead of flat-out waiting a number of seconds for an external
system to finish processing, polling for expected states using short
intervals with a maximum timeout is a better, more effective method.</p></li>
<li><p>Prioritize tests through tiers: group test cases and suites into different
priority/feature tiers, and only run the necessary tiers at each
regression/test level.</p></li>
<li><p>Concatenate similar tests: combine similar tests into a larger test
(if applicable), saving overheads.</p></li>
<li><p>Test only what makes sense: do not try to test all possible hardware/software
combinations. Select only those that are architecturally significant. Identify
the reference platform for each feature, release, branch, and test
accordingly.</p></li>
<li><p>Mixed coverage trails: Use varying methods to setup, test and teardown in
order to test the product from different directions. (e.g., CLI, NETCONF,
RESTCONF, SNMP, … etc)</p></li>
</ul>
</section>
<section id="assume-nothing">
<h2>Assume Nothing<a class="headerlink" href="#assume-nothing" title="Link to this heading"></a></h2>
<p>The purpose of test automation is to comb through a given target
(software/hardware) for errors, bugs and problems, and validating for expected
states, outputs and results. Do not impose unreasonable requirements on the
test environment, but as well, do not assume that things will “just work”.</p>
<p>As a general rule of thumb, design your test suites so that they are easy
to set-up and run in a variety of possible environments:</p>
<ul class="simple">
<li><p>Be explicit with input requirements: if your test suite requires inputs,
they should be provided as script arguments. If environment variables are to
be used, they should be processed and converted to script arguments instead
of being directly accessed through the script.</p></li>
<li><p>Avoid hard-coding names: decouple device/server/interface names from the
actual topology/device requirement and map them using aliases and/or labels
instead. This allows your test suite to run on a variety of hardware
environments.</p></li>
<li><p>Check your inputs: even-though Python does not promote type-checking inside
core libraries, it is often beneficial in test automation to validate script
inputs (type/range) before starting, in order to avoid wasting valuable
testbed time.</p></li>
</ul>
</section>
<section id="follow-the-guidelines">
<h2>Follow the Guidelines<a class="headerlink" href="#follow-the-guidelines" title="Link to this heading"></a></h2>
<p>Always follow the guidelines and templates when creating test suites and
libraries. This ensures that the end product always looks &amp; feels the same,
and assures easy hand-off between teams, greatly simplifying long-term
maintenance costs.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="intro.html" class="btn btn-neutral float-left" title="Concept Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="style.html" class="btn btn-neutral float-right" title="Style Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Cisco Systems Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>